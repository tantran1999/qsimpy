{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -47.857938813783, "episode_reward_min": -217.51113819246092, "episode_reward_mean": -143.88009297142784, "episode_len_mean": 39.57142857142857, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-217.51113819246092, -169.14292032027438, -87.15139560636044, -198.85416268278536, -179.16851982967245, -188.0079050670247, -139.60723593848545, -159.19476386989012, -185.6464549539094, -47.857938813783, -149.12028866768213, -97.6499266404448, -167.98452708219475, -127.14844002285555, -176.82214965956365, -118.17360015415356, -127.32178103884482, -49.05963219551517, -118.45512850835424, -107.99786065845232, -209.606182497278], "episode_lengths": [47, 42, 34, 45, 43, 44, 39, 41, 44, 30, 40, 35, 42, 38, 43, 37, 38, 30, 37, 36, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 233.10865260215758, "mean_inference_ms": 2.1928275793858396, "mean_action_processing_ms": 0.15424366530737732, "mean_env_wait_ms": 85.39700381970279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012646402631487166, "StateBufferConnector_ms": 0.007364863441103981, "ViewRequirementAgentConnector_ms": 0.1815023876371838}}, "episode_reward_max": -47.857938813783, "episode_reward_min": -217.51113819246092, "episode_reward_mean": -143.88009297142784, "episode_len_mean": 39.57142857142857, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-217.51113819246092, -169.14292032027438, -87.15139560636044, -198.85416268278536, -179.16851982967245, -188.0079050670247, -139.60723593848545, -159.19476386989012, -185.6464549539094, -47.857938813783, -149.12028866768213, -97.6499266404448, -167.98452708219475, -127.14844002285555, -176.82214965956365, -118.17360015415356, -127.32178103884482, -49.05963219551517, -118.45512850835424, -107.99786065845232, -209.606182497278], "episode_lengths": [47, 42, 34, 45, 43, 44, 39, 41, 44, 30, 40, 35, 42, 38, 43, 37, 38, 30, 37, 36, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 233.10865260215758, "mean_inference_ms": 2.1928275793858396, "mean_action_processing_ms": 0.15424366530737732, "mean_env_wait_ms": 85.39700381970279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012646402631487166, "StateBufferConnector_ms": 0.007364863441103981, "ViewRequirementAgentConnector_ms": 0.1815023876371838}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.058244901791473, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 7627.921, "sample_time_ms": 7622.648}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 1, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-13-08", "timestamp": 1713406388, "time_this_iter_s": 141.6844494342804, "time_total_s": 141.6844494342804, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 141.6844494342804, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 14.803960396039605, "ram_util_percent": 13.652970297029702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.016140291467308998, "cur_lr": 0.01}, "td_error": [2.3092472553253174, 2.303008794784546, 2.310105800628662, 2.310137987136841, 2.2878589630126953, 2.309241771697998, 2.3113632202148438, 2.1978344917297363, 2.2477023601531982, 2.310004472732544, 2.3091936111450195, 2.184962272644043, 2.329329490661621, 2.305171012878418, 2.124452590942383, 2.316572666168213, 2.3084847927093506, 2.3091938495635986, 2.3057425022125244, 2.2481164932250977, 2.3294708728790283, 2.124452590942383, 2.2871036529541016, 2.184962272644043, 2.305936098098755, 2.184962272644043, 2.3108978271484375, 2.309213638305664, 2.184180498123169, 2.1980841159820557, 2.3091659545898438, 2.3125174045562744, 2.310232400894165, 2.124452590942383, 2.305943489074707, 2.30568790435791, 2.184962272644043, 2.3057565689086914, 2.2616450786590576, 2.309152364730835, 2.184962272644043, 2.184962272644043, 2.3302602767944336, 2.3091037273406982, 2.247908353805542, 2.3058395385742188, 2.347959518432617, 2.2477869987487793, 2.305859088897705, 2.3059568405151367, 2.1979966163635254, 2.184962272644043, 2.3293631076812744, 2.329430341720581, 2.3404507637023926, 2.3092031478881836, 2.288918972015381, 2.329347848892212, 2.305934429168701, 2.124452590942383, 2.305752754211426, 2.2885384559631348, 2.305793285369873, 2.347538471221924, 2.3306949138641357, 2.39151930809021, 2.124452590942383, 2.248476028442383, 2.310349464416504, 2.3050055503845215, 2.341315984725952, 2.3101449012756348, 2.1986594200134277, 2.3113105297088623, 2.184962272644043, 2.2885384559631348, 2.197794198989868, 2.248432159423828], "mean_td_error": 2.2735443115234375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 1950, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 1950, "last_target_update_ts": 1560, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": -19.58376235700792, "episode_reward_min": -259.23937516949917, "episode_reward_mean": -118.73649005872942, "episode_len_mean": 37.285714285714285, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-217.51113819246092, -169.14292032027438, -87.15139560636044, -198.85416268278536, -179.16851982967245, -188.0079050670247, -139.60723593848545, -159.19476386989012, -185.6464549539094, -47.857938813783, -149.12028866768213, -97.6499266404448, -167.98452708219475, -127.14844002285555, -176.82214965956365, -118.17360015415356, -127.32178103884482, -49.05963219551517, -118.45512850835424, -107.99786065845232, -209.606182497278, -119.6223144213338, -177.5494389779725, -72.0724372455794, -49.16338375684991, -108.32158179790962, -112.14734903159594, -59.03621666059501, -138.81538610256098, -93.62194734524608, -37.92766088917786, -69.43747256179383, -88.0630352952123, -19.58376235700792, -109.7447010206985, -259.23937516949917, -77.95812468616454, -63.601933971898696, -63.050479916975235, -208.24494265246545, -88.04539406374786, -182.87561818737376, -40.77922697284944, -117.73484770161579, -110.66957909666432, -90.09676480664226, -87.6170402850348, -28.591053987039086, -122.99499151625285], "episode_lengths": [47, 42, 34, 45, 43, 44, 39, 41, 44, 30, 40, 35, 42, 38, 43, 37, 38, 30, 37, 36, 46, 37, 43, 33, 32, 36, 37, 31, 39, 35, 31, 32, 35, 28, 36, 51, 33, 32, 32, 46, 34, 44, 30, 37, 37, 35, 34, 28, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 250.2038980998779, "mean_inference_ms": 2.16092664997856, "mean_action_processing_ms": 0.15165757855203113, "mean_env_wait_ms": 61.1440622495632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011726788112095423, "StateBufferConnector_ms": 0.007141366296884965, "ViewRequirementAgentConnector_ms": 0.17693821264773}}, "episode_reward_max": -19.58376235700792, "episode_reward_min": -259.23937516949917, "episode_reward_mean": -118.73649005872942, "episode_len_mean": 37.285714285714285, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-217.51113819246092, -169.14292032027438, -87.15139560636044, -198.85416268278536, -179.16851982967245, -188.0079050670247, -139.60723593848545, -159.19476386989012, -185.6464549539094, -47.857938813783, -149.12028866768213, -97.6499266404448, -167.98452708219475, -127.14844002285555, -176.82214965956365, -118.17360015415356, -127.32178103884482, -49.05963219551517, -118.45512850835424, -107.99786065845232, -209.606182497278, -119.6223144213338, -177.5494389779725, -72.0724372455794, -49.16338375684991, -108.32158179790962, -112.14734903159594, -59.03621666059501, -138.81538610256098, -93.62194734524608, -37.92766088917786, -69.43747256179383, -88.0630352952123, -19.58376235700792, -109.7447010206985, -259.23937516949917, -77.95812468616454, -63.601933971898696, -63.050479916975235, -208.24494265246545, -88.04539406374786, -182.87561818737376, -40.77922697284944, -117.73484770161579, -110.66957909666432, -90.09676480664226, -87.6170402850348, -28.591053987039086, -122.99499151625285], "episode_lengths": [47, 42, 34, 45, 43, 44, 39, 41, 44, 30, 40, 35, 42, 38, 43, 37, 38, 30, 37, 36, 46, 37, 43, 33, 32, 36, 37, 31, 39, 35, 31, 32, 35, 28, 36, 51, 33, 32, 32, 46, 34, 44, 30, 37, 37, 35, 34, 28, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 250.2038980998779, "mean_inference_ms": 2.16092664997856, "mean_action_processing_ms": 0.15165757855203113, "mean_env_wait_ms": 61.1440622495632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011726788112095423, "StateBufferConnector_ms": 0.007141366296884965, "ViewRequirementAgentConnector_ms": 0.17693821264773}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 1950, "num_env_steps_sampled": 2000, "num_env_steps_trained": 1950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.862812061373956, "num_env_steps_trained_throughput_per_sec": 9.482483519679214, "timesteps_total": 2000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 8709.135, "sample_time_ms": 8647.385, "load_time_ms": 0.239, "load_throughput": 326144.664, "learn_time_ms": 12.958, "learn_throughput": 6019.491, "synch_weights_time_ms": 12.07}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 1950, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 1950, "last_target_update_ts": 1560, "num_target_updates": 2}, "done": false, "episodes_total": 49, "training_iteration": 2, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-16-33", "timestamp": 1713406593, "time_this_iter_s": 205.65087270736694, "time_total_s": 347.33532214164734, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 347.33532214164734, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 10.232764505119453, "ram_util_percent": 13.859044368600683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.023100117221474648, "cur_lr": 0.01}, "td_error": [2.3011162281036377, 2.0894057750701904, 1.9167417287826538, 2.319246530532837, 1.794263243675232, 2.298144817352295, 2.3014631271362305, 2.336672782897949, 2.3026208877563477, 2.2173516750335693, 2.3014914989471436, 1.9167417287826538, 2.0890514850616455, 2.301086664199829, 1.9167417287826538, 2.30161190032959, 2.0898163318634033, 2.309115171432495, 2.319215774536133, 2.017298698425293, 2.3014638423919678, 2.3010783195495605, 2.317289352416992, 2.0377705097198486, 2.3014426231384277, 2.0890514850616455, 1.9633674621582031, 1.9167417287826538, 2.301096200942993, 1.794263243675232, 1.9167417287826538, 2.2176225185394287, 2.3011069297790527, 2.0890514850616455, 2.3011043071746826, 2.1827714443206787, 2.303151845932007, 2.301071882247925, 2.3015592098236084, 2.301499843597412, 1.9167417287826538, 2.0892333984375, 1.794263243675232, 2.3038456439971924, 2.0181100368499756, 2.0181100368499756, 2.30151629447937, 2.301109552383423, 2.3173699378967285, 2.3013839721679688, 2.017239570617676, 2.3175950050354004, 1.9167417287826538, 1.794263243675232, 2.317342519760132, 2.343876361846924, 1.9167417287826538, 2.443284511566162, 2.3172993659973145, 2.3014633655548096, 2.0177838802337646, 2.18308162689209, 2.089066505432129, 1.9167417287826538, 2.3013317584991455, 1.9181476831436157, 1.794263243675232, 1.794263243675232, 2.2302486896514893, 2.017239570617676, 1.9167417287826538, 1.794263243675232, 2.3033223152160645, 2.2303740978240967, 2.3039448261260986, 1.794263243675232, 2.0244548320770264, 2.3010833263397217], "mean_td_error": 2.1404690742492676, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 3900, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 3900, "last_target_update_ts": 2600, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": -12.28915008244793, "episode_reward_min": -259.23937516949917, "episode_reward_mean": -108.84315666332782, "episode_len_mean": 36.243589743589745, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-217.51113819246092, -169.14292032027438, -87.15139560636044, -198.85416268278536, -179.16851982967245, -188.0079050670247, -139.60723593848545, -159.19476386989012, -185.6464549539094, -47.857938813783, -149.12028866768213, -97.6499266404448, -167.98452708219475, -127.14844002285555, -176.82214965956365, -118.17360015415356, -127.32178103884482, -49.05963219551517, -118.45512850835424, -107.99786065845232, -209.606182497278, -119.6223144213338, -177.5494389779725, -72.0724372455794, -49.16338375684991, -108.32158179790962, -112.14734903159594, -59.03621666059501, -138.81538610256098, -93.62194734524608, -37.92766088917786, -69.43747256179383, -88.0630352952123, -19.58376235700792, -109.7447010206985, -259.23937516949917, -77.95812468616454, -63.601933971898696, -63.050479916975235, -208.24494265246545, -88.04539406374786, -182.87561818737376, -40.77922697284944, -117.73484770161579, -110.66957909666432, -90.09676480664226, -87.6170402850348, -28.591053987039086, -122.99499151625285, -149.60735849991957, -179.31493881434608, -96.52534885952197, -79.67260935715501, -88.83777875071401, -61.24341531493771, -12.28915008244793, -88.68799160845413, -99.83093333535531, -65.10610563766312, -88.87176513763158, -69.41608473153163, -95.92339752662053, -69.76753231129014, -89.355034588722, -129.82301372461015, -159.48741890689462, -62.1201090060236, -109.18161333863078, -109.7258995763351, -128.85165024084006, -116.8302214915002, -119.28876035925572, -47.05781914126712, -88.24940331105276, -79.75194498711572, -69.36303550223504, -48.08069319208391, -69.41717952767286], "episode_lengths": [47, 42, 34, 45, 43, 44, 39, 41, 44, 30, 40, 35, 42, 38, 43, 37, 38, 30, 37, 36, 46, 37, 43, 33, 32, 36, 37, 31, 39, 35, 31, 32, 35, 28, 36, 51, 33, 32, 32, 46, 34, 44, 30, 37, 37, 35, 34, 28, 38, 40, 43, 35, 33, 34, 32, 28, 34, 35, 32, 34, 32, 35, 32, 34, 38, 41, 32, 36, 36, 38, 37, 37, 30, 35, 33, 32, 30, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 261.9391135533027, "mean_inference_ms": 2.159807451540826, "mean_action_processing_ms": 0.15121880751991812, "mean_env_wait_ms": 49.08751990580977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011412302652994791, "StateBufferConnector_ms": 0.007141247773781801, "ViewRequirementAgentConnector_ms": 0.17836430133917394}}, "episode_reward_max": -12.28915008244793, "episode_reward_min": -259.23937516949917, "episode_reward_mean": -108.84315666332782, "episode_len_mean": 36.243589743589745, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-217.51113819246092, -169.14292032027438, -87.15139560636044, -198.85416268278536, -179.16851982967245, -188.0079050670247, -139.60723593848545, -159.19476386989012, -185.6464549539094, -47.857938813783, -149.12028866768213, -97.6499266404448, -167.98452708219475, -127.14844002285555, -176.82214965956365, -118.17360015415356, -127.32178103884482, -49.05963219551517, -118.45512850835424, -107.99786065845232, -209.606182497278, -119.6223144213338, -177.5494389779725, -72.0724372455794, -49.16338375684991, -108.32158179790962, -112.14734903159594, -59.03621666059501, -138.81538610256098, -93.62194734524608, -37.92766088917786, -69.43747256179383, -88.0630352952123, -19.58376235700792, -109.7447010206985, -259.23937516949917, -77.95812468616454, -63.601933971898696, -63.050479916975235, -208.24494265246545, -88.04539406374786, -182.87561818737376, -40.77922697284944, -117.73484770161579, -110.66957909666432, -90.09676480664226, -87.6170402850348, -28.591053987039086, -122.99499151625285, -149.60735849991957, -179.31493881434608, -96.52534885952197, -79.67260935715501, -88.83777875071401, -61.24341531493771, -12.28915008244793, -88.68799160845413, -99.83093333535531, -65.10610563766312, -88.87176513763158, -69.41608473153163, -95.92339752662053, -69.76753231129014, -89.355034588722, -129.82301372461015, -159.48741890689462, -62.1201090060236, -109.18161333863078, -109.7258995763351, -128.85165024084006, -116.8302214915002, -119.28876035925572, -47.05781914126712, -88.24940331105276, -79.75194498711572, -69.36303550223504, -48.08069319208391, -69.41717952767286], "episode_lengths": [47, 42, 34, 45, 43, 44, 39, 41, 44, 30, 40, 35, 42, 38, 43, 37, 38, 30, 37, 36, 46, 37, 43, 33, 32, 36, 37, 31, 39, 35, 31, 32, 35, 28, 36, 51, 33, 32, 32, 46, 34, 44, 30, 37, 37, 35, 34, 28, 38, 40, 43, 35, 33, 34, 32, 28, 34, 35, 32, 34, 32, 35, 32, 34, 38, 41, 32, 36, 36, 38, 37, 37, 30, 35, 33, 32, 30, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 261.9391135533027, "mean_inference_ms": 2.159807451540826, "mean_action_processing_ms": 0.15121880751991812, "mean_env_wait_ms": 49.08751990580977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011412302652994791, "StateBufferConnector_ms": 0.007141247773781801, "ViewRequirementAgentConnector_ms": 0.17836430133917394}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 3900, "num_env_steps_sampled": 3000, "num_env_steps_trained": 3900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.520990210060119, "num_env_steps_trained_throughput_per_sec": 8.815930909617233, "timesteps_total": 3000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 7706.223, "sample_time_ms": 7645.003, "load_time_ms": 0.246, "load_throughput": 316459.385, "learn_time_ms": 13.34, "learn_throughput": 5846.994, "synch_weights_time_ms": 12.283}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 3900, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 3900, "last_target_update_ts": 2600, "num_target_updates": 4}, "done": false, "episodes_total": 78, "training_iteration": 3, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-20-15", "timestamp": 1713406815, "time_this_iter_s": 221.1982798576355, "time_total_s": 568.5336019992828, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 568.5336019992828, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 10.136507936507936, "ram_util_percent": 13.974920634920636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02208336442708969, "cur_lr": 0.01}, "td_error": [1.7155629396438599, 2.370230197906494, 2.309206008911133, 2.309135675430298, 2.1502294540405273, 2.1502294540405273, 2.2250778675079346, 2.250469923019409, 1.9945907592773438, 2.2901062965393066, 2.1502294540405273, 2.195889711380005, 1.6221997737884521, 2.214512586593628, 2.2655067443847656, 2.215331792831421, 1.9586429595947266, 1.6221997737884521, 1.7155629396438599, 2.3079490661621094, 2.3080577850341797, 2.3091561794281006, 1.9589649438858032, 2.195889711380005, 2.309008836746216, 1.6221997737884521, 2.3094241619110107, 2.1502294540405273, 2.35347580909729, 2.3091747760772705, 2.0119986534118652, 2.3091471195220947, 1.958910346031189, 2.2251603603363037, 2.1961567401885986, 1.9583168029785156, 2.150599479675293, 2.3501577377319336, 2.250469923019409, 1.9935578107833862, 2.309149742126465, 2.3079752922058105, 2.250472068786621, 1.9582377672195435, 2.2445712089538574, 2.195889711380005, 1.9600136280059814, 2.3079798221588135, 1.995422124862671, 2.309152126312256, 2.3089685440063477, 2.2247865200042725, 1.9595293998718262, 1.9582377672195435, 2.310671806335449, 1.9952116012573242, 2.2147367000579834, 1.6221997737884521, 2.3115158081054688, 2.3091330528259277, 2.2242186069488525, 1.7279751300811768, 1.959537148475647, 2.2900424003601074, 1.6221997737884521, 2.309093475341797, 2.150599479675293, 2.2143404483795166, 1.6221997737884521, 1.7155629396438599, 1.99375319480896, 2.3089828491210938, 1.9602690935134888, 2.3091042041778564, 2.308692693710327, 1.7155629396438599, 2.30914306640625, 2.309131145477295], "mean_td_error": 2.1200919151306152, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 5850, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 5850, "last_target_update_ts": 3640, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": -9.057256929727593, "episode_reward_min": -259.23937516949917, "episode_reward_mean": -88.75266290348172, "episode_len_mean": 34.27, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.6499266404448, -167.98452708219475, -127.14844002285555, -176.82214965956365, -118.17360015415356, -127.32178103884482, -49.05963219551517, -118.45512850835424, -107.99786065845232, -209.606182497278, -119.6223144213338, -177.5494389779725, -72.0724372455794, -49.16338375684991, -108.32158179790962, -112.14734903159594, -59.03621666059501, -138.81538610256098, -93.62194734524608, -37.92766088917786, -69.43747256179383, -88.0630352952123, -19.58376235700792, -109.7447010206985, -259.23937516949917, -77.95812468616454, -63.601933971898696, -63.050479916975235, -208.24494265246545, -88.04539406374786, -182.87561818737376, -40.77922697284944, -117.73484770161579, -110.66957909666432, -90.09676480664226, -87.6170402850348, -28.591053987039086, -122.99499151625285, -149.60735849991957, -179.31493881434608, -96.52534885952197, -79.67260935715501, -88.83777875071401, -61.24341531493771, -12.28915008244793, -88.68799160845413, -99.83093333535531, -65.10610563766312, -88.87176513763158, -69.41608473153163, -95.92339752662053, -69.76753231129014, -89.355034588722, -129.82301372461015, -159.48741890689462, -62.1201090060236, -109.18161333863078, -109.7258995763351, -128.85165024084006, -116.8302214915002, -119.28876035925572, -47.05781914126712, -88.24940331105276, -79.75194498711572, -69.36303550223504, -48.08069319208391, -69.41717952767286, -69.33190171283607, -29.24420984528611, -66.28515678012089, -96.52718755247392, -38.2573586352452, -94.47878723213034, -94.45484889701802, -22.915701211975914, -107.5727918057439, -9.057256929727593, -107.0691432911734, -68.97334006865049, -88.46210230992638, -37.59249207095473, -88.75622708758574, -38.28865200310159, -25.557894464117336, -28.24327322918324, -76.69078837321551, -98.63564612692787, -32.16119826727959, -108.34140880123167, -119.48890064524109, -9.731844859987337, -28.526012516207768, -28.611661009984868, -145.6627422580379, -86.04416844987108, -63.35609503076823, -59.755083767855474, -48.0157365733227, -64.16677321756407, -26.506409526183035], "episode_lengths": [35, 42, 38, 43, 37, 38, 30, 37, 36, 46, 37, 43, 33, 32, 36, 37, 31, 39, 35, 31, 32, 35, 28, 36, 51, 33, 32, 32, 46, 34, 44, 30, 37, 37, 35, 34, 28, 38, 40, 43, 35, 33, 34, 32, 28, 34, 35, 32, 34, 32, 35, 32, 34, 38, 41, 32, 36, 36, 38, 37, 37, 30, 35, 33, 32, 30, 32, 32, 28, 32, 35, 29, 35, 35, 29, 36, 26, 36, 32, 34, 29, 34, 29, 28, 28, 33, 35, 30, 36, 37, 26, 28, 28, 40, 34, 33, 31, 30, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 277.0527024249128, "mean_inference_ms": 2.1439837492664036, "mean_action_processing_ms": 0.15015963496237378, "mean_env_wait_ms": 36.054619518542005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010999679565429688, "StateBufferConnector_ms": 0.0070705413818359375, "ViewRequirementAgentConnector_ms": 0.1789569854736328}}, "episode_reward_max": -9.057256929727593, "episode_reward_min": -259.23937516949917, "episode_reward_mean": -88.75266290348172, "episode_len_mean": 34.27, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.6499266404448, -167.98452708219475, -127.14844002285555, -176.82214965956365, -118.17360015415356, -127.32178103884482, -49.05963219551517, -118.45512850835424, -107.99786065845232, -209.606182497278, -119.6223144213338, -177.5494389779725, -72.0724372455794, -49.16338375684991, -108.32158179790962, -112.14734903159594, -59.03621666059501, -138.81538610256098, -93.62194734524608, -37.92766088917786, -69.43747256179383, -88.0630352952123, -19.58376235700792, -109.7447010206985, -259.23937516949917, -77.95812468616454, -63.601933971898696, -63.050479916975235, -208.24494265246545, -88.04539406374786, -182.87561818737376, -40.77922697284944, -117.73484770161579, -110.66957909666432, -90.09676480664226, -87.6170402850348, -28.591053987039086, -122.99499151625285, -149.60735849991957, -179.31493881434608, -96.52534885952197, -79.67260935715501, -88.83777875071401, -61.24341531493771, -12.28915008244793, -88.68799160845413, -99.83093333535531, -65.10610563766312, -88.87176513763158, -69.41608473153163, -95.92339752662053, -69.76753231129014, -89.355034588722, -129.82301372461015, -159.48741890689462, -62.1201090060236, -109.18161333863078, -109.7258995763351, -128.85165024084006, -116.8302214915002, -119.28876035925572, -47.05781914126712, -88.24940331105276, -79.75194498711572, -69.36303550223504, -48.08069319208391, -69.41717952767286, -69.33190171283607, -29.24420984528611, -66.28515678012089, -96.52718755247392, -38.2573586352452, -94.47878723213034, -94.45484889701802, -22.915701211975914, -107.5727918057439, -9.057256929727593, -107.0691432911734, -68.97334006865049, -88.46210230992638, -37.59249207095473, -88.75622708758574, -38.28865200310159, -25.557894464117336, -28.24327322918324, -76.69078837321551, -98.63564612692787, -32.16119826727959, -108.34140880123167, -119.48890064524109, -9.731844859987337, -28.526012516207768, -28.611661009984868, -145.6627422580379, -86.04416844987108, -63.35609503076823, -59.755083767855474, -48.0157365733227, -64.16677321756407, -26.506409526183035], "episode_lengths": [35, 42, 38, 43, 37, 38, 30, 37, 36, 46, 37, 43, 33, 32, 36, 37, 31, 39, 35, 31, 32, 35, 28, 36, 51, 33, 32, 32, 46, 34, 44, 30, 37, 37, 35, 34, 28, 38, 40, 43, 35, 33, 34, 32, 28, 34, 35, 32, 34, 32, 35, 32, 34, 38, 41, 32, 36, 36, 38, 37, 37, 30, 35, 33, 32, 30, 32, 32, 28, 32, 35, 29, 35, 35, 29, 36, 26, 36, 32, 34, 29, 34, 29, 28, 28, 33, 35, 30, 36, 37, 26, 28, 28, 40, 34, 33, 31, 30, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 277.0527024249128, "mean_inference_ms": 2.1439837492664036, "mean_action_processing_ms": 0.15015963496237378, "mean_env_wait_ms": 36.054619518542005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010999679565429688, "StateBufferConnector_ms": 0.0070705413818359375, "ViewRequirementAgentConnector_ms": 0.1789569854736328}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 5850, "num_env_steps_sampled": 4000, "num_env_steps_trained": 5850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.5348691593430654, "num_env_steps_trained_throughput_per_sec": 8.842994860718978, "timesteps_total": 4000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9891.983, "sample_time_ms": 9831.911, "load_time_ms": 0.245, "load_throughput": 318865.216, "learn_time_ms": 13.22, "learn_throughput": 5900.183, "synch_weights_time_ms": 11.175}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 5850, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 5850, "last_target_update_ts": 3640, "num_target_updates": 6}, "done": false, "episodes_total": 111, "training_iteration": 4, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-23-55", "timestamp": 1713407035, "time_this_iter_s": 220.52304339408875, "time_total_s": 789.0566453933716, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 789.0566453933716, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.179872204472842, "ram_util_percent": 14.093290734824278}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.016742976382374763, "cur_lr": 0.01}, "td_error": [2.298837184906006, 2.2707974910736084, 2.1809401512145996, 2.2988877296447754, 2.3044769763946533, 2.302849054336548, 2.107786178588867, 2.5331172943115234, 2.2869510650634766, 2.286738634109497, 1.9278202056884766, 2.5210444927215576, 2.3056678771972656, 1.602159857749939, 2.286738634109497, 2.460893154144287, 2.3058173656463623, 1.602159857749939, 2.298844337463379, 2.1082065105438232, 2.286738634109497, 1.602159857749939, 2.3025121688842773, 2.1812503337860107, 2.1082065105438232, 2.1817593574523926, 1.602159857749939, 2.3023698329925537, 2.3025879859924316, 2.298839807510376, 2.1824471950531006, 2.305608034133911, 2.3023791313171387, 2.3030996322631836, 2.271352767944336, 2.298964262008667, 2.2988502979278564, 2.30560302734375, 2.488211154937744, 2.1229171752929688, 1.855035424232483, 2.122812509536743, 2.1809401512145996, 1.8525898456573486, 2.1810121536254883, 2.182443857192993, 2.302335262298584, 2.153080701828003, 1.434503436088562, 1.9256688356399536, 2.181013584136963, 2.2709803581237793, 1.9248998165130615, 1.8809715509414673, 1.925411581993103, 2.269596576690674, 1.8527591228485107, 2.303020477294922, 2.3056132793426514, 2.3345422744750977, 2.2992985248565674, 2.3024590015411377, 2.3039026260375977, 1.602159857749939, 2.1809709072113037, 2.305825710296631, 2.3024682998657227, 2.3055968284606934, 2.271343469619751, 2.298875331878662, 1.9248998165130615, 2.306981086730957, 2.3055200576782227, 2.298848867416382, 1.8525898456573486, 2.1828207969665527, 2.305520534515381, 2.1820788383483887], "mean_td_error": 2.1706430912017822, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 7800, "last_target_update_ts": 4680, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": -9.048503716892913, "episode_reward_min": -179.31493881434608, "episode_reward_mean": -69.79330530014526, "episode_len_mean": 32.26, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.66957909666432, -90.09676480664226, -87.6170402850348, -28.591053987039086, -122.99499151625285, -149.60735849991957, -179.31493881434608, -96.52534885952197, -79.67260935715501, -88.83777875071401, -61.24341531493771, -12.28915008244793, -88.68799160845413, -99.83093333535531, -65.10610563766312, -88.87176513763158, -69.41608473153163, -95.92339752662053, -69.76753231129014, -89.355034588722, -129.82301372461015, -159.48741890689462, -62.1201090060236, -109.18161333863078, -109.7258995763351, -128.85165024084006, -116.8302214915002, -119.28876035925572, -47.05781914126712, -88.24940331105276, -79.75194498711572, -69.36303550223504, -48.08069319208391, -69.41717952767286, -69.33190171283607, -29.24420984528611, -66.28515678012089, -96.52718755247392, -38.2573586352452, -94.47878723213034, -94.45484889701802, -22.915701211975914, -107.5727918057439, -9.057256929727593, -107.0691432911734, -68.97334006865049, -88.46210230992638, -37.59249207095473, -88.75622708758574, -38.28865200310159, -25.557894464117336, -28.24327322918324, -76.69078837321551, -98.63564612692787, -32.16119826727959, -108.34140880123167, -119.48890064524109, -9.731844859987337, -28.526012516207768, -28.611661009984868, -145.6627422580379, -86.04416844987108, -63.35609503076823, -59.755083767855474, -48.0157365733227, -64.16677321756407, -26.506409526183035, -66.68063683937368, -29.308201937526654, -78.79281075727177, -39.35690356972753, -35.46564998900994, -99.8081291474267, -49.03833874345599, -79.5279078319418, -9.048503716892913, -19.32545647797068, -17.62905457229198, -39.491686618044795, -49.87911088415813, -49.53101251492354, -39.865380518198236, -69.90163359810079, -49.440429102418875, -69.16215759463063, -39.88273293408, -29.84319159080149, -75.0408111111152, -56.34871176529204, -119.31739615701632, -49.79258471071093, -19.04651698647495, -78.38110516491969, -37.052091487670936, -59.88554096119972, -96.70587435884461, -39.570052620144224, -49.49076982148728, -69.75622373173167, -49.55349109528174], "episode_lengths": [37, 35, 34, 28, 38, 40, 43, 35, 33, 34, 32, 28, 34, 35, 32, 34, 32, 35, 32, 34, 38, 41, 32, 36, 36, 38, 37, 37, 30, 35, 33, 32, 30, 32, 32, 28, 32, 35, 29, 35, 35, 29, 36, 26, 36, 32, 34, 29, 34, 29, 28, 28, 33, 35, 30, 36, 37, 26, 28, 28, 40, 34, 33, 31, 30, 32, 29, 32, 28, 33, 29, 29, 35, 30, 33, 26, 27, 27, 29, 30, 30, 29, 32, 30, 32, 29, 28, 33, 31, 37, 30, 27, 33, 29, 31, 35, 29, 30, 32, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 297.0400995449597, "mean_inference_ms": 2.143311790862805, "mean_action_processing_ms": 0.14971253775655147, "mean_env_wait_ms": 23.299709451335453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010951519012451172, "StateBufferConnector_ms": 0.007236003875732422, "ViewRequirementAgentConnector_ms": 0.18056344985961914}}, "episode_reward_max": -9.048503716892913, "episode_reward_min": -179.31493881434608, "episode_reward_mean": -69.79330530014526, "episode_len_mean": 32.26, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.66957909666432, -90.09676480664226, -87.6170402850348, -28.591053987039086, -122.99499151625285, -149.60735849991957, -179.31493881434608, -96.52534885952197, -79.67260935715501, -88.83777875071401, -61.24341531493771, -12.28915008244793, -88.68799160845413, -99.83093333535531, -65.10610563766312, -88.87176513763158, -69.41608473153163, -95.92339752662053, -69.76753231129014, -89.355034588722, -129.82301372461015, -159.48741890689462, -62.1201090060236, -109.18161333863078, -109.7258995763351, -128.85165024084006, -116.8302214915002, -119.28876035925572, -47.05781914126712, -88.24940331105276, -79.75194498711572, -69.36303550223504, -48.08069319208391, -69.41717952767286, -69.33190171283607, -29.24420984528611, -66.28515678012089, -96.52718755247392, -38.2573586352452, -94.47878723213034, -94.45484889701802, -22.915701211975914, -107.5727918057439, -9.057256929727593, -107.0691432911734, -68.97334006865049, -88.46210230992638, -37.59249207095473, -88.75622708758574, -38.28865200310159, -25.557894464117336, -28.24327322918324, -76.69078837321551, -98.63564612692787, -32.16119826727959, -108.34140880123167, -119.48890064524109, -9.731844859987337, -28.526012516207768, -28.611661009984868, -145.6627422580379, -86.04416844987108, -63.35609503076823, -59.755083767855474, -48.0157365733227, -64.16677321756407, -26.506409526183035, -66.68063683937368, -29.308201937526654, -78.79281075727177, -39.35690356972753, -35.46564998900994, -99.8081291474267, -49.03833874345599, -79.5279078319418, -9.048503716892913, -19.32545647797068, -17.62905457229198, -39.491686618044795, -49.87911088415813, -49.53101251492354, -39.865380518198236, -69.90163359810079, -49.440429102418875, -69.16215759463063, -39.88273293408, -29.84319159080149, -75.0408111111152, -56.34871176529204, -119.31739615701632, -49.79258471071093, -19.04651698647495, -78.38110516491969, -37.052091487670936, -59.88554096119972, -96.70587435884461, -39.570052620144224, -49.49076982148728, -69.75622373173167, -49.55349109528174], "episode_lengths": [37, 35, 34, 28, 38, 40, 43, 35, 33, 34, 32, 28, 34, 35, 32, 34, 32, 35, 32, 34, 38, 41, 32, 36, 36, 38, 37, 37, 30, 35, 33, 32, 30, 32, 32, 28, 32, 35, 29, 35, 35, 29, 36, 26, 36, 32, 34, 29, 34, 29, 28, 28, 33, 35, 30, 36, 37, 26, 28, 28, 40, 34, 33, 31, 30, 32, 29, 32, 28, 33, 29, 29, 35, 30, 33, 26, 27, 27, 29, 30, 30, 29, 32, 30, 32, 29, 28, 33, 31, 37, 30, 27, 33, 29, 31, 35, 29, 30, 32, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 297.0400995449597, "mean_inference_ms": 2.143311790862805, "mean_action_processing_ms": 0.14971253775655147, "mean_env_wait_ms": 23.299709451335453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010951519012451172, "StateBufferConnector_ms": 0.007236003875732422, "ViewRequirementAgentConnector_ms": 0.18056344985961914}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 7800, "num_env_steps_sampled": 5000, "num_env_steps_trained": 7800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.530810508835892, "num_env_steps_trained_throughput_per_sec": 8.83508049222999, "timesteps_total": 5000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 8824.605, "sample_time_ms": 8762.699, "load_time_ms": 0.241, "load_throughput": 323724.235, "learn_time_ms": 13.295, "learn_throughput": 5866.727, "synch_weights_time_ms": 11.018}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 7800, "last_target_update_ts": 4680, "num_target_updates": 8}, "done": false, "episodes_total": 144, "training_iteration": 5, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-27-36", "timestamp": 1713407256, "time_this_iter_s": 220.72048211097717, "time_total_s": 1009.7771275043488, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 1009.7771275043488, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.252380952380951, "ram_util_percent": 14.22761904761905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.014629126526415348, "cur_lr": 0.01}, "td_error": [2.3007113933563232, 1.4731847047805786, 2.1388847827911377, 2.301306962966919, 1.2990399599075317, 2.300755500793457, 2.0195670127868652, 2.3016011714935303, 1.8572041988372803, 2.1346795558929443, 1.4731847047805786, 1.2990399599075317, 1.8566277027130127, 2.041454792022705, 2.1299450397491455, 2.300684690475464, 1.782167911529541, 2.302337169647217, 2.300809621810913, 2.30000638961792, 1.2990399599075317, 1.4731847047805786, 2.3005897998809814, 2.135051965713501, 2.358100652694702, 1.8572691679000854, 2.301152229309082, 2.123589038848877, 1.7819461822509766, 1.7856944799423218, 1.2990399599075317, 2.3862409591674805, 2.3002734184265137, 1.8595603704452515, 1.8564075231552124, 1.8574532270431519, 2.1346399784088135, 1.8568713665008545, 2.017965078353882, 2.3021016120910645, 2.300248146057129, 2.300462007522583, 2.1577961444854736, 2.1387927532196045, 1.9385603666305542, 2.1577961444854736, 2.300086498260498, 1.8565738201141357, 2.3032140731811523, 2.145689010620117, 2.032010078430176, 1.8574532270431519, 2.3009822368621826, 2.134589910507202, 2.310133934020996, 1.8564292192459106, 2.299956798553467, 1.857824683189392, 2.134697198867798, 1.4731847047805786, 2.301544666290283, 2.3014135360717773, 1.4731847047805786, 2.15810489654541, 2.1567556858062744, 2.159075975418091, 2.1280858516693115, 1.4731847047805786, 1.7819461822509766, 2.3001084327697754, 2.3009190559387207, 1.2990399599075317, 2.0552968978881836, 2.032010078430176, 2.300704002380371, 2.3007800579071045, 1.2990399599075317, 2.3850436210632324], "mean_td_error": 2.0161805152893066, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 125.0, "diff_num_grad_updates_vs_sampler_policy": 124.0}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 9750, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 9750, "last_target_update_ts": 5720, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": 1.1293932227627403, "episode_reward_min": -145.6627422580379, "episode_reward_mean": -57.09478952908342, "episode_len_mean": 30.92, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.41717952767286, -69.33190171283607, -29.24420984528611, -66.28515678012089, -96.52718755247392, -38.2573586352452, -94.47878723213034, -94.45484889701802, -22.915701211975914, -107.5727918057439, -9.057256929727593, -107.0691432911734, -68.97334006865049, -88.46210230992638, -37.59249207095473, -88.75622708758574, -38.28865200310159, -25.557894464117336, -28.24327322918324, -76.69078837321551, -98.63564612692787, -32.16119826727959, -108.34140880123167, -119.48890064524109, -9.731844859987337, -28.526012516207768, -28.611661009984868, -145.6627422580379, -86.04416844987108, -63.35609503076823, -59.755083767855474, -48.0157365733227, -64.16677321756407, -26.506409526183035, -66.68063683937368, -29.308201937526654, -78.79281075727177, -39.35690356972753, -35.46564998900994, -99.8081291474267, -49.03833874345599, -79.5279078319418, -9.048503716892913, -19.32545647797068, -17.62905457229198, -39.491686618044795, -49.87911088415813, -49.53101251492354, -39.865380518198236, -69.90163359810079, -49.440429102418875, -69.16215759463063, -39.88273293408, -29.84319159080149, -75.0408111111152, -56.34871176529204, -119.31739615701632, -49.79258471071093, -19.04651698647495, -78.38110516491969, -37.052091487670936, -59.88554096119972, -96.70587435884461, -39.570052620144224, -49.49076982148728, -69.75622373173167, -49.55349109528174, -49.85175597943614, -19.89999006095336, -49.90217825320555, -39.918166722594, 1.1293932227627403, -29.036437971218557, -79.3576695885647, -49.92850855698818, -39.9299586889558, -109.90534258485243, -57.75597693228477, -89.90970157224092, -39.47337506240227, -62.07814152520639, -79.9261196876309, -69.93998263117636, -26.020631732879863, -107.77736644885101, -53.09007411134732, -99.78275012954592, -39.90407048834233, -59.52401385892385, -59.87070185695726, -22.845430729264397, -69.83789675631105, -49.90691338479176, -49.48986156750089, -59.914088298622374, -49.898852414895714, -39.41938874646303, -69.88599303135304, -29.579324466467945, -19.947609302139195], "episode_lengths": [32, 32, 28, 32, 35, 29, 35, 35, 29, 36, 26, 36, 32, 34, 29, 34, 29, 28, 28, 33, 35, 30, 36, 37, 26, 28, 28, 40, 34, 33, 31, 30, 32, 29, 32, 28, 33, 29, 29, 35, 30, 33, 26, 27, 27, 29, 30, 30, 29, 32, 30, 32, 29, 28, 33, 31, 37, 30, 27, 33, 29, 31, 35, 29, 30, 32, 30, 30, 27, 30, 29, 25, 28, 33, 30, 29, 36, 31, 34, 29, 32, 33, 32, 28, 36, 31, 35, 29, 31, 31, 28, 32, 30, 30, 31, 30, 29, 32, 28, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 310.9137142333426, "mean_inference_ms": 2.148425484983405, "mean_action_processing_ms": 0.14982163447136962, "mean_env_wait_ms": 17.875677738926512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011290311813354492, "StateBufferConnector_ms": 0.0073320865631103516, "ViewRequirementAgentConnector_ms": 0.18259668350219727}}, "episode_reward_max": 1.1293932227627403, "episode_reward_min": -145.6627422580379, "episode_reward_mean": -57.09478952908342, "episode_len_mean": 30.92, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-69.41717952767286, -69.33190171283607, -29.24420984528611, -66.28515678012089, -96.52718755247392, -38.2573586352452, -94.47878723213034, -94.45484889701802, -22.915701211975914, -107.5727918057439, -9.057256929727593, -107.0691432911734, -68.97334006865049, -88.46210230992638, -37.59249207095473, -88.75622708758574, -38.28865200310159, -25.557894464117336, -28.24327322918324, -76.69078837321551, -98.63564612692787, -32.16119826727959, -108.34140880123167, -119.48890064524109, -9.731844859987337, -28.526012516207768, -28.611661009984868, -145.6627422580379, -86.04416844987108, -63.35609503076823, -59.755083767855474, -48.0157365733227, -64.16677321756407, -26.506409526183035, -66.68063683937368, -29.308201937526654, -78.79281075727177, -39.35690356972753, -35.46564998900994, -99.8081291474267, -49.03833874345599, -79.5279078319418, -9.048503716892913, -19.32545647797068, -17.62905457229198, -39.491686618044795, -49.87911088415813, -49.53101251492354, -39.865380518198236, -69.90163359810079, -49.440429102418875, -69.16215759463063, -39.88273293408, -29.84319159080149, -75.0408111111152, -56.34871176529204, -119.31739615701632, -49.79258471071093, -19.04651698647495, -78.38110516491969, -37.052091487670936, -59.88554096119972, -96.70587435884461, -39.570052620144224, -49.49076982148728, -69.75622373173167, -49.55349109528174, -49.85175597943614, -19.89999006095336, -49.90217825320555, -39.918166722594, 1.1293932227627403, -29.036437971218557, -79.3576695885647, -49.92850855698818, -39.9299586889558, -109.90534258485243, -57.75597693228477, -89.90970157224092, -39.47337506240227, -62.07814152520639, -79.9261196876309, -69.93998263117636, -26.020631732879863, -107.77736644885101, -53.09007411134732, -99.78275012954592, -39.90407048834233, -59.52401385892385, -59.87070185695726, -22.845430729264397, -69.83789675631105, -49.90691338479176, -49.48986156750089, -59.914088298622374, -49.898852414895714, -39.41938874646303, -69.88599303135304, -29.579324466467945, -19.947609302139195], "episode_lengths": [32, 32, 28, 32, 35, 29, 35, 35, 29, 36, 26, 36, 32, 34, 29, 34, 29, 28, 28, 33, 35, 30, 36, 37, 26, 28, 28, 40, 34, 33, 31, 30, 32, 29, 32, 28, 33, 29, 29, 35, 30, 33, 26, 27, 27, 29, 30, 30, 29, 32, 30, 32, 29, 28, 33, 31, 37, 30, 27, 33, 29, 31, 35, 29, 30, 32, 30, 30, 27, 30, 29, 25, 28, 33, 30, 29, 36, 31, 34, 29, 32, 33, 32, 28, 36, 31, 35, 29, 31, 31, 28, 32, 30, 30, 31, 30, 29, 32, 28, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 310.9137142333426, "mean_inference_ms": 2.148425484983405, "mean_action_processing_ms": 0.14982163447136962, "mean_env_wait_ms": 17.875677738926512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011290311813354492, "StateBufferConnector_ms": 0.0073320865631103516, "ViewRequirementAgentConnector_ms": 0.18259668350219727}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 9750, "num_env_steps_sampled": 6000, "num_env_steps_trained": 9750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.764176850033385, "num_env_steps_trained_throughput_per_sec": 9.2901448575651, "timesteps_total": 6000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 9956.529, "sample_time_ms": 9896.515, "load_time_ms": 0.234, "load_throughput": 333866.427, "learn_time_ms": 12.781, "learn_throughput": 6102.797, "synch_weights_time_ms": 11.807}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 9750, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 9750, "last_target_update_ts": 5720, "num_target_updates": 10}, "done": false, "episodes_total": 177, "training_iteration": 6, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-31-06", "timestamp": 1713407466, "time_this_iter_s": 209.90838193893433, "time_total_s": 1219.685509443283, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 1219.685509443283, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.840604026845638, "ram_util_percent": 14.363422818791946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.011186446063220501, "cur_lr": 0.01}, "td_error": [1.3440699577331543, 2.0667781829833984, 1.654211163520813, 1.7327487468719482, 2.2818920612335205, 2.0635952949523926, 1.7337323427200317, 2.2818965911865234, 2.284698486328125, 2.0992345809936523, 2.280550003051758, 2.279961347579956, 2.279961347579956, 2.303410053253174, 1.3440699577331543, 1.7327487468719482, 2.2852258682250977, 2.2822961807250977, 2.066812753677368, 2.000276565551758, 1.7330561876296997, 2.2843384742736816, 2.2799928188323975, 1.6603306531906128, 2.0412375926971436, 2.280575752258301, 2.28631591796875, 2.001838207244873, 1.7345855236053467, 2.000276565551758, 2.409186840057373, 1.3440699577331543, 1.7332135438919067, 2.066828489303589, 1.654902458190918, 2.2799930572509766, 1.9435240030288696, 2.282048225402832, 1.3440699577331543, 2.2836756706237793, 2.2838387489318848, 2.097360849380493, 2.2801311016082764, 2.2843310832977295, 2.000822067260742, 2.2922866344451904, 2.159832715988159, 2.159832715988159, 2.063117504119873, 2.184163808822632, 2.3420917987823486, 2.0980422496795654, 2.2800183296203613, 2.2837655544281006, 1.720129132270813, 2.185356616973877, 2.2828609943389893, 2.279985189437866, 2.2819128036499023, 2.2818665504455566, 2.184457778930664, 1.7340776920318604, 2.2800519466400146, 2.2818961143493652, 1.6560454368591309, 2.2826268672943115, 2.4745922088623047, 2.2801706790924072, 2.5816822052001953, 2.280036449432373, 1.1660364866256714, 2.185331106185913, 2.279970645904541, 2.28691029548645, 1.6935776472091675, 2.0975146293640137, 2.282501220703125, 2.282015800476074], "mean_td_error": 2.0794036388397217, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 150.0, "diff_num_grad_updates_vs_sampler_policy": 149.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 11700, "last_target_update_ts": 6760, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 2.9960799696551974, "episode_reward_min": -119.31739615701632, "episode_reward_mean": -44.61579838239093, "episode_len_mean": 29.18, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.35690356972753, -35.46564998900994, -99.8081291474267, -49.03833874345599, -79.5279078319418, -9.048503716892913, -19.32545647797068, -17.62905457229198, -39.491686618044795, -49.87911088415813, -49.53101251492354, -39.865380518198236, -69.90163359810079, -49.440429102418875, -69.16215759463063, -39.88273293408, -29.84319159080149, -75.0408111111152, -56.34871176529204, -119.31739615701632, -49.79258471071093, -19.04651698647495, -78.38110516491969, -37.052091487670936, -59.88554096119972, -96.70587435884461, -39.570052620144224, -49.49076982148728, -69.75622373173167, -49.55349109528174, -49.85175597943614, -19.89999006095336, -49.90217825320555, -39.918166722594, 1.1293932227627403, -29.036437971218557, -79.3576695885647, -49.92850855698818, -39.9299586889558, -109.90534258485243, -57.75597693228477, -89.90970157224092, -39.47337506240227, -62.07814152520639, -79.9261196876309, -69.93998263117636, -26.020631732879863, -107.77736644885101, -53.09007411134732, -99.78275012954592, -39.90407048834233, -59.52401385892385, -59.87070185695726, -22.845430729264397, -69.83789675631105, -49.90691338479176, -49.48986156750089, -59.914088298622374, -49.898852414895714, -39.41938874646303, -69.88599303135304, -29.579324466467945, -19.947609302139195, -48.750243312773996, -29.377740586026786, 2.9960799696551974, -19.483015120201088, -49.93864623842332, -79.28985259356017, 1.4520534360625703, -39.390841790695056, -29.92423809441855, -48.948472075337314, -49.936158045887446, -14.576649112207654, -49.919530336972656, -39.88408472329573, -39.942991830186706, -19.970500359562568, -9.949670182939046, -17.71948709402674, -9.780812165806642, 0.13169958825490016, -30.746971328138528, -9.336974716130053, -29.595089087820263, -28.9461833471189, -5.549670427458561, -28.053927427405064, -26.383403947380927, -29.38947789985184, -48.414090071223384, -39.9008227554456, -39.94263064536117, -9.582624557674396, -29.875328859087304, -49.92199537822095, -47.18482117372047, -19.22299606164823, -38.81240059149179], "episode_lengths": [29, 29, 35, 30, 33, 26, 27, 27, 29, 30, 30, 29, 32, 30, 32, 29, 28, 33, 31, 37, 30, 27, 33, 29, 31, 35, 29, 30, 32, 30, 30, 27, 30, 29, 25, 28, 33, 30, 29, 36, 31, 34, 29, 32, 33, 32, 28, 36, 31, 35, 29, 31, 31, 28, 32, 30, 30, 31, 30, 29, 32, 28, 27, 30, 28, 20, 27, 30, 33, 20, 29, 28, 30, 30, 22, 30, 29, 29, 22, 26, 27, 26, 25, 24, 26, 28, 28, 26, 28, 23, 28, 30, 29, 24, 26, 28, 30, 25, 27, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 322.90218491796554, "mean_inference_ms": 2.1536518552332073, "mean_action_processing_ms": 0.14998399403187512, "mean_env_wait_ms": 14.545538188491383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011299848556518555, "StateBufferConnector_ms": 0.007432222366333008, "ViewRequirementAgentConnector_ms": 0.18756651878356934}}, "episode_reward_max": 2.9960799696551974, "episode_reward_min": -119.31739615701632, "episode_reward_mean": -44.61579838239093, "episode_len_mean": 29.18, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.35690356972753, -35.46564998900994, -99.8081291474267, -49.03833874345599, -79.5279078319418, -9.048503716892913, -19.32545647797068, -17.62905457229198, -39.491686618044795, -49.87911088415813, -49.53101251492354, -39.865380518198236, -69.90163359810079, -49.440429102418875, -69.16215759463063, -39.88273293408, -29.84319159080149, -75.0408111111152, -56.34871176529204, -119.31739615701632, -49.79258471071093, -19.04651698647495, -78.38110516491969, -37.052091487670936, -59.88554096119972, -96.70587435884461, -39.570052620144224, -49.49076982148728, -69.75622373173167, -49.55349109528174, -49.85175597943614, -19.89999006095336, -49.90217825320555, -39.918166722594, 1.1293932227627403, -29.036437971218557, -79.3576695885647, -49.92850855698818, -39.9299586889558, -109.90534258485243, -57.75597693228477, -89.90970157224092, -39.47337506240227, -62.07814152520639, -79.9261196876309, -69.93998263117636, -26.020631732879863, -107.77736644885101, -53.09007411134732, -99.78275012954592, -39.90407048834233, -59.52401385892385, -59.87070185695726, -22.845430729264397, -69.83789675631105, -49.90691338479176, -49.48986156750089, -59.914088298622374, -49.898852414895714, -39.41938874646303, -69.88599303135304, -29.579324466467945, -19.947609302139195, -48.750243312773996, -29.377740586026786, 2.9960799696551974, -19.483015120201088, -49.93864623842332, -79.28985259356017, 1.4520534360625703, -39.390841790695056, -29.92423809441855, -48.948472075337314, -49.936158045887446, -14.576649112207654, -49.919530336972656, -39.88408472329573, -39.942991830186706, -19.970500359562568, -9.949670182939046, -17.71948709402674, -9.780812165806642, 0.13169958825490016, -30.746971328138528, -9.336974716130053, -29.595089087820263, -28.9461833471189, -5.549670427458561, -28.053927427405064, -26.383403947380927, -29.38947789985184, -48.414090071223384, -39.9008227554456, -39.94263064536117, -9.582624557674396, -29.875328859087304, -49.92199537822095, -47.18482117372047, -19.22299606164823, -38.81240059149179], "episode_lengths": [29, 29, 35, 30, 33, 26, 27, 27, 29, 30, 30, 29, 32, 30, 32, 29, 28, 33, 31, 37, 30, 27, 33, 29, 31, 35, 29, 30, 32, 30, 30, 27, 30, 29, 25, 28, 33, 30, 29, 36, 31, 34, 29, 32, 33, 32, 28, 36, 31, 35, 29, 31, 31, 28, 32, 30, 30, 31, 30, 29, 32, 28, 27, 30, 28, 20, 27, 30, 33, 20, 29, 28, 30, 30, 22, 30, 29, 29, 22, 26, 27, 26, 25, 24, 26, 28, 28, 26, 28, 23, 28, 30, 29, 24, 26, 28, 30, 25, 27, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 322.90218491796554, "mean_inference_ms": 2.1536518552332073, "mean_action_processing_ms": 0.14998399403187512, "mean_env_wait_ms": 14.545538188491383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011299848556518555, "StateBufferConnector_ms": 0.007432222366333008, "ViewRequirementAgentConnector_ms": 0.18756651878356934}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 11700, "num_env_steps_sampled": 7000, "num_env_steps_trained": 11700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.30784470405454, "num_env_steps_trained_throughput_per_sec": 8.400297172906352, "timesteps_total": 7000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 8900.201, "sample_time_ms": 8839.252, "load_time_ms": 0.232, "load_throughput": 335647.596, "learn_time_ms": 13.071, "learn_throughput": 5967.512, "synch_weights_time_ms": 11.188}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 11700, "last_target_update_ts": 6760, "num_target_updates": 12}, "done": false, "episodes_total": 214, "training_iteration": 7, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-34-58", "timestamp": 1713407698, "time_this_iter_s": 232.1471700668335, "time_total_s": 1451.8326795101166, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 1451.8326795101166, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.901208459214502, "ram_util_percent": 14.463746223564955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0073688095435500145, "cur_lr": 0.01}, "td_error": [2.042895555496216, 2.4531779289245605, 2.274394989013672, 2.271413564682007, 2.272062063217163, 2.274839162826538, 1.6738345623016357, 2.043917655944824, 1.672377347946167, 2.271404266357422, 2.275238513946533, 2.272963285446167, 2.3118057250976562, 2.2739713191986084, 2.4256129264831543, 2.0190985202789307, 2.272062063217163, 2.062286376953125, 2.0183708667755127, 2.0340476036071777, 1.672377347946167, 2.282928705215454, 1.988811731338501, 1.624963402748108, 2.4825124740600586, 1.9897682666778564, 2.2762157917022705, 2.2747092247009277, 1.8926970958709717, 1.6747208833694458, 2.0639896392822266, 2.278597354888916, 2.275507926940918, 2.271446466445923, 2.6704046726226807, 1.6724052429199219, 2.2725889682769775, 2.0440802574157715, 2.524165153503418, 2.271815538406372, 2.2747044563293457, 1.22265625, 2.034250020980835, 2.2716658115386963, 1.672377347946167, 2.2778358459472656, 2.0467982292175293, 2.2755329608917236, 1.22265625, 1.6738632917404175, 2.277296781539917, 2.411698818206787, 2.0618927478790283, 1.672377347946167, 2.274270534515381, 2.059983491897583, 1.22265625, 1.8952685594558716, 2.274892568588257, 2.274400472640991, 2.0354509353637695, 2.0474369525909424, 2.274545907974243, 2.2782912254333496, 2.0322113037109375, 2.2720911502838135, 2.0608010292053223, 2.271425724029541, 1.0908042192459106, 2.2741949558258057, 2.2714192867279053, 2.2713940143585205, 1.0908042192459106, 2.271784543991089, 2.3118057250976562, 1.22265625, 1.672377347946167, 2.27484130859375], "mean_td_error": 2.0659217834472656, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 175.0, "diff_num_grad_updates_vs_sampler_policy": 174.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 13650, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 13650, "last_target_update_ts": 7800, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 2.9960799696551974, "episode_reward_min": -109.90534258485243, "episode_reward_mean": -34.188941492915426, "episode_len_mean": 28.12, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.92850855698818, -39.9299586889558, -109.90534258485243, -57.75597693228477, -89.90970157224092, -39.47337506240227, -62.07814152520639, -79.9261196876309, -69.93998263117636, -26.020631732879863, -107.77736644885101, -53.09007411134732, -99.78275012954592, -39.90407048834233, -59.52401385892385, -59.87070185695726, -22.845430729264397, -69.83789675631105, -49.90691338479176, -49.48986156750089, -59.914088298622374, -49.898852414895714, -39.41938874646303, -69.88599303135304, -29.579324466467945, -19.947609302139195, -48.750243312773996, -29.377740586026786, 2.9960799696551974, -19.483015120201088, -49.93864623842332, -79.28985259356017, 1.4520534360625703, -39.390841790695056, -29.92423809441855, -48.948472075337314, -49.936158045887446, -14.576649112207654, -49.919530336972656, -39.88408472329573, -39.942991830186706, -19.970500359562568, -9.949670182939046, -17.71948709402674, -9.780812165806642, 0.13169958825490016, -30.746971328138528, -9.336974716130053, -29.595089087820263, -28.9461833471189, -5.549670427458561, -28.053927427405064, -26.383403947380927, -29.38947789985184, -48.414090071223384, -39.9008227554456, -39.94263064536117, -9.582624557674396, -29.875328859087304, -49.92199537822095, -47.18482117372047, -19.22299606164823, -38.81240059149179, -49.64774673513697, -59.84900664554877, -9.538104796940546, 0.8966966782798159, -39.72760057517476, 0.08484103270240459, -9.950743306471084, -59.952833965853614, -29.170833250544838, 0.07555965858597671, -8.803431190209029, -29.840754303223957, -39.430507850742224, -49.920869758909404, -49.95048234317241, -39.930518919102354, -19.938878848699755, -19.939674090318217, -39.714700061760986, 2.2122061335790977, 0.9057269973686041, -19.696722975192305, -46.82332000707477, -19.576025457808306, -9.630727744150755, -19.726644143303144, 0.5729652748268325, 0.47206974766891413, -6.039743422236592, -29.606579283085747, -19.876573394011817, -19.807588447366594, -19.84982568078223, -29.829523190020737, 0.07193896577558094, -19.91003669746873, 0.09842681390124808], "episode_lengths": [30, 29, 36, 31, 34, 29, 32, 33, 32, 28, 36, 31, 35, 29, 31, 31, 28, 32, 30, 30, 31, 30, 29, 32, 28, 27, 30, 28, 20, 27, 30, 33, 20, 29, 28, 30, 30, 22, 30, 29, 29, 22, 26, 27, 26, 25, 24, 26, 28, 28, 26, 28, 23, 28, 30, 29, 24, 26, 28, 30, 25, 27, 29, 30, 31, 26, 25, 29, 25, 26, 31, 28, 25, 26, 28, 29, 30, 30, 29, 27, 27, 29, 25, 25, 27, 30, 27, 26, 27, 25, 25, 26, 28, 27, 27, 27, 28, 25, 27, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 332.8680853757325, "mean_inference_ms": 2.158228068702296, "mean_action_processing_ms": 0.1504174848234191, "mean_env_wait_ms": 12.368955745086073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011266231536865234, "StateBufferConnector_ms": 0.0072879791259765625, "ViewRequirementAgentConnector_ms": 0.18777966499328613}}, "episode_reward_max": 2.9960799696551974, "episode_reward_min": -109.90534258485243, "episode_reward_mean": -34.188941492915426, "episode_len_mean": 28.12, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.92850855698818, -39.9299586889558, -109.90534258485243, -57.75597693228477, -89.90970157224092, -39.47337506240227, -62.07814152520639, -79.9261196876309, -69.93998263117636, -26.020631732879863, -107.77736644885101, -53.09007411134732, -99.78275012954592, -39.90407048834233, -59.52401385892385, -59.87070185695726, -22.845430729264397, -69.83789675631105, -49.90691338479176, -49.48986156750089, -59.914088298622374, -49.898852414895714, -39.41938874646303, -69.88599303135304, -29.579324466467945, -19.947609302139195, -48.750243312773996, -29.377740586026786, 2.9960799696551974, -19.483015120201088, -49.93864623842332, -79.28985259356017, 1.4520534360625703, -39.390841790695056, -29.92423809441855, -48.948472075337314, -49.936158045887446, -14.576649112207654, -49.919530336972656, -39.88408472329573, -39.942991830186706, -19.970500359562568, -9.949670182939046, -17.71948709402674, -9.780812165806642, 0.13169958825490016, -30.746971328138528, -9.336974716130053, -29.595089087820263, -28.9461833471189, -5.549670427458561, -28.053927427405064, -26.383403947380927, -29.38947789985184, -48.414090071223384, -39.9008227554456, -39.94263064536117, -9.582624557674396, -29.875328859087304, -49.92199537822095, -47.18482117372047, -19.22299606164823, -38.81240059149179, -49.64774673513697, -59.84900664554877, -9.538104796940546, 0.8966966782798159, -39.72760057517476, 0.08484103270240459, -9.950743306471084, -59.952833965853614, -29.170833250544838, 0.07555965858597671, -8.803431190209029, -29.840754303223957, -39.430507850742224, -49.920869758909404, -49.95048234317241, -39.930518919102354, -19.938878848699755, -19.939674090318217, -39.714700061760986, 2.2122061335790977, 0.9057269973686041, -19.696722975192305, -46.82332000707477, -19.576025457808306, -9.630727744150755, -19.726644143303144, 0.5729652748268325, 0.47206974766891413, -6.039743422236592, -29.606579283085747, -19.876573394011817, -19.807588447366594, -19.84982568078223, -29.829523190020737, 0.07193896577558094, -19.91003669746873, 0.09842681390124808], "episode_lengths": [30, 29, 36, 31, 34, 29, 32, 33, 32, 28, 36, 31, 35, 29, 31, 31, 28, 32, 30, 30, 31, 30, 29, 32, 28, 27, 30, 28, 20, 27, 30, 33, 20, 29, 28, 30, 30, 22, 30, 29, 29, 22, 26, 27, 26, 25, 24, 26, 28, 28, 26, 28, 23, 28, 30, 29, 24, 26, 28, 30, 25, 27, 29, 30, 31, 26, 25, 29, 25, 26, 31, 28, 25, 26, 28, 29, 30, 30, 29, 27, 27, 29, 25, 25, 27, 30, 27, 26, 27, 25, 25, 26, 28, 27, 27, 27, 28, 25, 27, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 332.8680853757325, "mean_inference_ms": 2.158228068702296, "mean_action_processing_ms": 0.1504174848234191, "mean_env_wait_ms": 12.368955745086073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011266231536865234, "StateBufferConnector_ms": 0.0072879791259765625, "ViewRequirementAgentConnector_ms": 0.18777966499328613}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 13650, "num_env_steps_sampled": 8000, "num_env_steps_trained": 13650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7334636360717153, "num_env_steps_trained_throughput_per_sec": 7.280254090339844, "timesteps_total": 8000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11138.116, "sample_time_ms": 11077.66, "load_time_ms": 0.244, "load_throughput": 320113.221, "learn_time_ms": 13.237, "learn_throughput": 5892.5, "synch_weights_time_ms": 11.306}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 13650, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 13650, "last_target_update_ts": 7800, "num_target_updates": 14}, "done": false, "episodes_total": 251, "training_iteration": 8, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-39-26", "timestamp": 1713407966, "time_this_iter_s": 267.85629987716675, "time_total_s": 1719.6889793872833, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 1719.6889793872833, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 10.508398950131234, "ram_util_percent": 14.63280839895013}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.009246745146811008, "cur_lr": 0.01}, "td_error": [2.271028757095337, 2.0273122787475586, 2.000781297683716, 2.27127742767334, 2.0213828086853027, 1.9708161354064941, 2.2680530548095703, 2.2675373554229736, 1.9789961576461792, 2.271670341491699, 1.0603587627410889, 2.2709732055664062, 2.023850917816162, 1.999815821647644, 1.555484652519226, 2.0060946941375732, 2.4827170372009277, 1.8448712825775146, 1.5887322425842285, 2.272341728210449, 2.27174973487854, 2.2710459232330322, 2.0024447441101074, 2.0020151138305664, 1.7876362800598145, 2.2718605995178223, 1.9687353372573853, 1.9687836170196533, 2.268026351928711, 1.5496976375579834, 2.2675185203552246, 1.5807664394378662, 1.9701772928237915, 2.002048969268799, 1.5508637428283691, 1.9712443351745605, 1.920874834060669, 1.5496976375579834, 2.2707667350769043, 2.270909547805786, 2.270521640777588, 0.9840470552444458, 2.2895917892456055, 2.031127691268921, 2.023707151412964, 2.273094415664673, 2.2705647945404053, 1.8862948417663574, 2.00488543510437, 2.2718605995178223, 2.2705163955688477, 2.2716071605682373, 2.273057699203491, 2.271029472351074, 2.2721340656280518, 0.9840470552444458, 2.0040242671966553, 2.2675554752349854, 2.2696950435638428, 1.5496976375579834, 2.026740074157715, 2.273094415664673, 1.935299277305603, 2.267530679702759, 1.9663364887237549, 2.2711377143859863, 2.2748947143554688, 2.0031018257141113, 2.267524480819702, 1.935089111328125, 1.951340913772583, 1.97287118434906, 1.9351857900619507, 2.271090269088745, 2.0021698474884033, 1.5545873641967773, 1.0603587627410889, 2.272033929824829], "mean_td_error": 2.0147488117218018, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 200.0, "diff_num_grad_updates_vs_sampler_policy": 199.0}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 15600, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 15600, "last_target_update_ts": 8840, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": 3.4435656925423044, "episode_reward_min": -59.952833965853614, "episode_reward_mean": -19.382594954956122, "episode_len_mean": 26.76, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.88408472329573, -39.942991830186706, -19.970500359562568, -9.949670182939046, -17.71948709402674, -9.780812165806642, 0.13169958825490016, -30.746971328138528, -9.336974716130053, -29.595089087820263, -28.9461833471189, -5.549670427458561, -28.053927427405064, -26.383403947380927, -29.38947789985184, -48.414090071223384, -39.9008227554456, -39.94263064536117, -9.582624557674396, -29.875328859087304, -49.92199537822095, -47.18482117372047, -19.22299606164823, -38.81240059149179, -49.64774673513697, -59.84900664554877, -9.538104796940546, 0.8966966782798159, -39.72760057517476, 0.08484103270240459, -9.950743306471084, -59.952833965853614, -29.170833250544838, 0.07555965858597671, -8.803431190209029, -29.840754303223957, -39.430507850742224, -49.920869758909404, -49.95048234317241, -39.930518919102354, -19.938878848699755, -19.939674090318217, -39.714700061760986, 2.2122061335790977, 0.9057269973686041, -19.696722975192305, -46.82332000707477, -19.576025457808306, -9.630727744150755, -19.726644143303144, 0.5729652748268325, 0.47206974766891413, -6.039743422236592, -29.606579283085747, -19.876573394011817, -19.807588447366594, -19.84982568078223, -29.829523190020737, 0.07193896577558094, -19.91003669746873, 0.09842681390124808, 0.31378761833417007, -39.57316790352083, -9.528300692062556, -19.839625114888094, 0.05966398647464305, -9.960584913433385, -19.965932553713028, 0.04444363028531411, -9.946651361276208, 0.040266093071990125, -9.424998449195424, 0.5338993239822976, 0.5904500272918218, -49.20948755421828, 0.3352993197883631, -12.852929730017268, -29.932998092310566, -19.953892919216763, -19.947365512382273, 0.04967037361491992, -29.76114326020732, -39.83893955317576, -9.865121792914561, 0.07582232510803046, -9.693058751908229, -9.422689970058581, -9.889336532004878, -18.669783200236747, -9.499737232136106, -9.955655749049559, 0.09519845385073693, 0.0914486188157697, -9.932877172329698, 0.06962980043208244, -19.875793576965805, -9.847041734009627, -19.51142485642321, -29.839281757187823, 3.4435656925423044], "episode_lengths": [29, 29, 22, 26, 27, 26, 25, 24, 26, 28, 28, 26, 28, 23, 28, 30, 29, 24, 26, 28, 30, 25, 27, 29, 30, 31, 26, 25, 29, 25, 26, 31, 28, 25, 26, 28, 29, 30, 30, 29, 27, 27, 29, 25, 25, 27, 30, 27, 26, 27, 25, 25, 26, 28, 27, 27, 27, 28, 25, 27, 25, 25, 29, 26, 27, 25, 26, 27, 25, 26, 25, 26, 25, 25, 30, 25, 27, 28, 27, 27, 25, 28, 29, 26, 25, 26, 26, 26, 27, 26, 26, 25, 25, 26, 25, 27, 26, 27, 28, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 343.375586182307, "mean_inference_ms": 2.154917000552134, "mean_action_processing_ms": 0.1502139706541255, "mean_env_wait_ms": 10.774325093125121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011361122131347656, "StateBufferConnector_ms": 0.007044315338134766, "ViewRequirementAgentConnector_ms": 0.1880049705505371}}, "episode_reward_max": 3.4435656925423044, "episode_reward_min": -59.952833965853614, "episode_reward_mean": -19.382594954956122, "episode_len_mean": 26.76, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.88408472329573, -39.942991830186706, -19.970500359562568, -9.949670182939046, -17.71948709402674, -9.780812165806642, 0.13169958825490016, -30.746971328138528, -9.336974716130053, -29.595089087820263, -28.9461833471189, -5.549670427458561, -28.053927427405064, -26.383403947380927, -29.38947789985184, -48.414090071223384, -39.9008227554456, -39.94263064536117, -9.582624557674396, -29.875328859087304, -49.92199537822095, -47.18482117372047, -19.22299606164823, -38.81240059149179, -49.64774673513697, -59.84900664554877, -9.538104796940546, 0.8966966782798159, -39.72760057517476, 0.08484103270240459, -9.950743306471084, -59.952833965853614, -29.170833250544838, 0.07555965858597671, -8.803431190209029, -29.840754303223957, -39.430507850742224, -49.920869758909404, -49.95048234317241, -39.930518919102354, -19.938878848699755, -19.939674090318217, -39.714700061760986, 2.2122061335790977, 0.9057269973686041, -19.696722975192305, -46.82332000707477, -19.576025457808306, -9.630727744150755, -19.726644143303144, 0.5729652748268325, 0.47206974766891413, -6.039743422236592, -29.606579283085747, -19.876573394011817, -19.807588447366594, -19.84982568078223, -29.829523190020737, 0.07193896577558094, -19.91003669746873, 0.09842681390124808, 0.31378761833417007, -39.57316790352083, -9.528300692062556, -19.839625114888094, 0.05966398647464305, -9.960584913433385, -19.965932553713028, 0.04444363028531411, -9.946651361276208, 0.040266093071990125, -9.424998449195424, 0.5338993239822976, 0.5904500272918218, -49.20948755421828, 0.3352993197883631, -12.852929730017268, -29.932998092310566, -19.953892919216763, -19.947365512382273, 0.04967037361491992, -29.76114326020732, -39.83893955317576, -9.865121792914561, 0.07582232510803046, -9.693058751908229, -9.422689970058581, -9.889336532004878, -18.669783200236747, -9.499737232136106, -9.955655749049559, 0.09519845385073693, 0.0914486188157697, -9.932877172329698, 0.06962980043208244, -19.875793576965805, -9.847041734009627, -19.51142485642321, -29.839281757187823, 3.4435656925423044], "episode_lengths": [29, 29, 22, 26, 27, 26, 25, 24, 26, 28, 28, 26, 28, 23, 28, 30, 29, 24, 26, 28, 30, 25, 27, 29, 30, 31, 26, 25, 29, 25, 26, 31, 28, 25, 26, 28, 29, 30, 30, 29, 27, 27, 29, 25, 25, 27, 30, 27, 26, 27, 25, 25, 26, 28, 27, 27, 27, 28, 25, 27, 25, 25, 29, 26, 27, 25, 26, 27, 25, 26, 25, 26, 25, 25, 30, 25, 27, 28, 27, 27, 25, 28, 29, 26, 25, 26, 26, 26, 27, 26, 26, 25, 25, 26, 25, 27, 26, 27, 28, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 343.375586182307, "mean_inference_ms": 2.154917000552134, "mean_action_processing_ms": 0.1502139706541255, "mean_env_wait_ms": 10.774325093125121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011361122131347656, "StateBufferConnector_ms": 0.007044315338134766, "ViewRequirementAgentConnector_ms": 0.1880049705505371}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 15600, "num_env_steps_sampled": 9000, "num_env_steps_trained": 15600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.2857060675875935, "num_env_steps_trained_throughput_per_sec": 8.357126831795807, "timesteps_total": 9000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 8860.996, "sample_time_ms": 8799.344, "load_time_ms": 0.244, "load_throughput": 320081.902, "learn_time_ms": 13.168, "learn_throughput": 5923.236, "synch_weights_time_ms": 11.276}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 15600, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 15600, "last_target_update_ts": 8840, "num_target_updates": 16}, "done": false, "episodes_total": 290, "training_iteration": 9, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-43-19", "timestamp": 1713408199, "time_this_iter_s": 233.34272265434265, "time_total_s": 1953.031702041626, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 1953.031702041626, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.561329305135953, "ram_util_percent": 14.76737160120846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.005734589882194996, "cur_lr": 0.01}, "td_error": [2.2640750408172607, 1.9923207759857178, 2.2642595767974854, 2.2663111686706543, 2.2668392658233643, 2.2640912532806396, 1.9924596548080444, 1.9514394998550415, 1.9411070346832275, 2.264130115509033, 2.267927646636963, 0.9225966334342957, 1.9965524673461914, 1.9490957260131836, 1.9955722093582153, 2.268087387084961, 1.527537226676941, 2.266603946685791, 2.2683098316192627, 1.9922540187835693, 1.8982923030853271, 2.268303155899048, 2.2642149925231934, 1.9530725479125977, 2.2923386096954346, 2.2801129817962646, 2.265430450439453, 2.264134168624878, 2.8749938011169434, 2.0241403579711914, 2.264334201812744, 1.8983123302459717, 2.2651660442352295, 2.2689571380615234, 2.264648914337158, 1.9409103393554688, 2.2641444206237793, 2.266441822052002, 2.2640936374664307, 1.9512500762939453, 2.2845678329467773, 1.5305265188217163, 2.5565226078033447, 0.9225966334342957, 2.2680130004882812, 2.264309883117676, 2.299349069595337, 2.2688236236572266, 1.950862169265747, 2.2645833492279053, 1.9436079263687134, 1.9532363414764404, 2.2669789791107178, 2.266308069229126, 1.5093942880630493, 1.52504563331604, 2.2667486667633057, 2.26487135887146, 2.2665557861328125, 2.264110565185547, 2.26424241065979, 2.264120101928711, 0.9225966334342957, 2.024118423461914, 2.2679622173309326, 2.2641234397888184, 0.9225966334342957, 1.5094586610794067, 2.2665421962738037, 2.264287233352661, 2.269526243209839, 2.5963995456695557, 2.2640833854675293, 1.9964390993118286, 1.7791547775268555, 2.267904043197632, 2.5322492122650146, 1.526917576789856], "mean_td_error": 2.080699920654297, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 225.0, "diff_num_grad_updates_vs_sampler_policy": 224.0}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 17550, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 17550, "last_target_update_ts": 9880, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": 3.4435656925423044, "episode_reward_min": -49.95048234317241, "episode_reward_mean": -11.807653126671212, "episode_len_mean": 26.23, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.95048234317241, -39.930518919102354, -19.938878848699755, -19.939674090318217, -39.714700061760986, 2.2122061335790977, 0.9057269973686041, -19.696722975192305, -46.82332000707477, -19.576025457808306, -9.630727744150755, -19.726644143303144, 0.5729652748268325, 0.47206974766891413, -6.039743422236592, -29.606579283085747, -19.876573394011817, -19.807588447366594, -19.84982568078223, -29.829523190020737, 0.07193896577558094, -19.91003669746873, 0.09842681390124808, 0.31378761833417007, -39.57316790352083, -9.528300692062556, -19.839625114888094, 0.05966398647464305, -9.960584913433385, -19.965932553713028, 0.04444363028531411, -9.946651361276208, 0.040266093071990125, -9.424998449195424, 0.5338993239822976, 0.5904500272918218, -49.20948755421828, 0.3352993197883631, -12.852929730017268, -29.932998092310566, -19.953892919216763, -19.947365512382273, 0.04967037361491992, -29.76114326020732, -39.83893955317576, -9.865121792914561, 0.07582232510803046, -9.693058751908229, -9.422689970058581, -9.889336532004878, -18.669783200236747, -9.499737232136106, -9.955655749049559, 0.09519845385073693, 0.0914486188157697, -9.932877172329698, 0.06962980043208244, -19.875793576965805, -9.847041734009627, -19.51142485642321, -29.839281757187823, 3.4435656925423044, 0.07659961821417656, 0.07955608195756438, -9.905583291236507, 0.0640254932623568, -9.93594724567927, -19.965188894206754, -9.967489593346123, 0.02883700552561539, 0.03443621440393455, 0.04366640598437077, -25.93329302989543, -9.892245176535969, -9.791220039602178, -9.407768616338782, 0.377005918739615, 0.05038425341365305, 0.03145011550007265, -29.96389293974109, 0.03342974353026487, -9.929163934233467, 0.5363696205574909, 0.07734696800461603, 3.384203044016939, 0.12642314727939047, -6.445185400005434, -19.950395059346125, 0.027023515182120164, -19.89808802438139, -19.919441362539885, -19.908884178594178, 0.06154201805900349, -19.928241014030455, 0.07922873265878361, -29.908388452015863, 0.052436900550004696, 0.08026596468669164, 0.0705294853231188, 0.07924878144306305], "episode_lengths": [30, 29, 27, 27, 29, 25, 25, 27, 30, 27, 26, 27, 25, 25, 26, 28, 27, 27, 27, 28, 25, 27, 25, 25, 29, 26, 27, 25, 26, 27, 25, 26, 25, 26, 25, 25, 30, 25, 27, 28, 27, 27, 25, 28, 29, 26, 25, 26, 26, 26, 27, 26, 26, 25, 25, 26, 25, 27, 26, 27, 28, 25, 25, 25, 26, 25, 26, 27, 26, 25, 25, 25, 28, 26, 26, 26, 25, 25, 25, 28, 25, 26, 25, 25, 25, 25, 26, 27, 25, 27, 27, 27, 25, 27, 25, 28, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 352.29871420774435, "mean_inference_ms": 2.1570895027805523, "mean_action_processing_ms": 0.1500974270426505, "mean_env_wait_ms": 9.58878765247542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01123666763305664, "StateBufferConnector_ms": 0.006801605224609375, "ViewRequirementAgentConnector_ms": 0.18279004096984863}}, "episode_reward_max": 3.4435656925423044, "episode_reward_min": -49.95048234317241, "episode_reward_mean": -11.807653126671212, "episode_len_mean": 26.23, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.95048234317241, -39.930518919102354, -19.938878848699755, -19.939674090318217, -39.714700061760986, 2.2122061335790977, 0.9057269973686041, -19.696722975192305, -46.82332000707477, -19.576025457808306, -9.630727744150755, -19.726644143303144, 0.5729652748268325, 0.47206974766891413, -6.039743422236592, -29.606579283085747, -19.876573394011817, -19.807588447366594, -19.84982568078223, -29.829523190020737, 0.07193896577558094, -19.91003669746873, 0.09842681390124808, 0.31378761833417007, -39.57316790352083, -9.528300692062556, -19.839625114888094, 0.05966398647464305, -9.960584913433385, -19.965932553713028, 0.04444363028531411, -9.946651361276208, 0.040266093071990125, -9.424998449195424, 0.5338993239822976, 0.5904500272918218, -49.20948755421828, 0.3352993197883631, -12.852929730017268, -29.932998092310566, -19.953892919216763, -19.947365512382273, 0.04967037361491992, -29.76114326020732, -39.83893955317576, -9.865121792914561, 0.07582232510803046, -9.693058751908229, -9.422689970058581, -9.889336532004878, -18.669783200236747, -9.499737232136106, -9.955655749049559, 0.09519845385073693, 0.0914486188157697, -9.932877172329698, 0.06962980043208244, -19.875793576965805, -9.847041734009627, -19.51142485642321, -29.839281757187823, 3.4435656925423044, 0.07659961821417656, 0.07955608195756438, -9.905583291236507, 0.0640254932623568, -9.93594724567927, -19.965188894206754, -9.967489593346123, 0.02883700552561539, 0.03443621440393455, 0.04366640598437077, -25.93329302989543, -9.892245176535969, -9.791220039602178, -9.407768616338782, 0.377005918739615, 0.05038425341365305, 0.03145011550007265, -29.96389293974109, 0.03342974353026487, -9.929163934233467, 0.5363696205574909, 0.07734696800461603, 3.384203044016939, 0.12642314727939047, -6.445185400005434, -19.950395059346125, 0.027023515182120164, -19.89808802438139, -19.919441362539885, -19.908884178594178, 0.06154201805900349, -19.928241014030455, 0.07922873265878361, -29.908388452015863, 0.052436900550004696, 0.08026596468669164, 0.0705294853231188, 0.07924878144306305], "episode_lengths": [30, 29, 27, 27, 29, 25, 25, 27, 30, 27, 26, 27, 25, 25, 26, 28, 27, 27, 27, 28, 25, 27, 25, 25, 29, 26, 27, 25, 26, 27, 25, 26, 25, 26, 25, 25, 30, 25, 27, 28, 27, 27, 25, 28, 29, 26, 25, 26, 26, 26, 27, 26, 26, 25, 25, 26, 25, 27, 26, 27, 28, 25, 25, 25, 26, 25, 26, 27, 26, 25, 25, 25, 28, 26, 26, 26, 25, 25, 25, 28, 25, 26, 25, 25, 25, 25, 26, 27, 25, 27, 27, 27, 25, 27, 25, 28, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 352.29871420774435, "mean_inference_ms": 2.1570895027805523, "mean_action_processing_ms": 0.1500974270426505, "mean_env_wait_ms": 9.58878765247542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01123666763305664, "StateBufferConnector_ms": 0.006801605224609375, "ViewRequirementAgentConnector_ms": 0.18279004096984863}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 17550, "num_env_steps_sampled": 10000, "num_env_steps_trained": 17550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.485326986933743, "num_env_steps_trained_throughput_per_sec": 8.7463876245208, "timesteps_total": 10000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 9001.014, "sample_time_ms": 8939.812, "load_time_ms": 0.244, "load_throughput": 320019.282, "learn_time_ms": 13.072, "learn_throughput": 5967.044, "synch_weights_time_ms": 11.809}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 17550, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 17550, "last_target_update_ts": 9880, "num_target_updates": 18}, "done": false, "episodes_total": 328, "training_iteration": 10, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-47-02", "timestamp": 1713408422, "time_this_iter_s": 222.95775270462036, "time_total_s": 2175.9894547462463, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 2175.9894547462463, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.767295597484276, "ram_util_percent": 14.907547169811322}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.007666465360671282, "cur_lr": 0.01}, "td_error": [2.245304584503174, 2.2471559047698975, 1.9593234062194824, 2.5750081539154053, 2.247399091720581, 1.9098944664001465, 1.8921841382980347, 0.8840706944465637, 1.4598867893218994, 1.540667176246643, 2.4688453674316406, 2.0039849281311035, 2.2456765174865723, 2.247164249420166, 1.8921669721603394, 2.004026174545288, 2.0040509700775146, 2.519228935241699, 2.5460073947906494, 2.2496514320373535, 2.291562080383301, 1.892342448234558, 1.4601500034332275, 2.2472143173217773, 2.2482264041900635, 1.7299773693084717, 1.7302460670471191, 0.945884644985199, 2.2486608028411865, 2.2539632320404053, 0.9384750723838806, 2.7825496196746826, 2.0047523975372314, 1.9330335855484009, 1.939781904220581, 2.2481348514556885, 2.245293378829956, 2.2476913928985596, 2.250049591064453, 2.2475180625915527, 2.2453627586364746, 2.2456214427948, 0.9384750723838806, 2.2498281002044678, 0.8840706944465637, 2.254876136779785, 2.24564528465271, 2.250054359436035, 1.8928858041763306, 1.477542519569397, 0.8840706944465637, 2.245628833770752, 2.2471773624420166, 2.2724666595458984, 1.941929817199707, 2.247189998626709, 2.2471415996551514, 2.2850427627563477, 2.2458412647247314, 2.2468924522399902, 0.8928524255752563, 1.7777544260025024, 2.2472188472747803, 1.912435531616211, 1.4643476009368896, 1.8921756744384766, 2.2471442222595215, 2.248110055923462, 1.772279977798462, 2.249570608139038, 2.2607247829437256, 2.24617338180542, 2.2475953102111816, 1.89292311668396, 1.9085750579833984, 2.2484092712402344, 2.2455644607543945, 2.2516090869903564], "mean_td_error": 2.0074410438537598, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 250.0, "diff_num_grad_updates_vs_sampler_policy": 249.0}}, "num_env_steps_sampled": 11000, "num_env_steps_trained": 19500, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 19500, "last_target_update_ts": 10920, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": 3.4435656925423044, "episode_reward_min": -39.83893955317576, "episode_reward_mean": -6.259368853025378, "episode_len_mean": 25.66, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.953892919216763, -19.947365512382273, 0.04967037361491992, -29.76114326020732, -39.83893955317576, -9.865121792914561, 0.07582232510803046, -9.693058751908229, -9.422689970058581, -9.889336532004878, -18.669783200236747, -9.499737232136106, -9.955655749049559, 0.09519845385073693, 0.0914486188157697, -9.932877172329698, 0.06962980043208244, -19.875793576965805, -9.847041734009627, -19.51142485642321, -29.839281757187823, 3.4435656925423044, 0.07659961821417656, 0.07955608195756438, -9.905583291236507, 0.0640254932623568, -9.93594724567927, -19.965188894206754, -9.967489593346123, 0.02883700552561539, 0.03443621440393455, 0.04366640598437077, -25.93329302989543, -9.892245176535969, -9.791220039602178, -9.407768616338782, 0.377005918739615, 0.05038425341365305, 0.03145011550007265, -29.96389293974109, 0.03342974353026487, -9.929163934233467, 0.5363696205574909, 0.07734696800461603, 3.384203044016939, 0.12642314727939047, -6.445185400005434, -19.950395059346125, 0.027023515182120164, -19.89808802438139, -19.919441362539885, -19.908884178594178, 0.06154201805900349, -19.928241014030455, 0.07922873265878361, -29.908388452015863, 0.052436900550004696, 0.08026596468669164, 0.0705294853231188, 0.07924878144306305, 0.0946735235223539, 0.08563896195686166, 0.12269362380235306, 0.16748388979836554, 0.3287491897430299, -9.96502364904239, 0.03453428828524617, 0.039254348297890915, 0.027609285436657024, 0.023449482979065687, -9.812242933977933, 2.0554033299085503, 0.7587161950178878, 2.408475025388552, 0.2735848659646436, 0.024800210201404056, 0.04114183803365132, 0.044466913078329964, 0.033989532014880613, 0.025706827347605883, 0.09448134377458438, 0.07158836031572013, 0.07286606819724102, 0.09539297920092953, 0.11675841844904013, 0.031834333403328426, -9.875117093135907, 0.09785532317535159, -8.445709913340721, -9.833565116567557, -9.936329332089702, -9.937085310580699, -9.932303590264672, 0.43566032907548924, 0.652104812937677, 0.10430275691310499, -9.881230498934652, 0.07228433568960177, 0.09304102992535217, 0.08739624284091617], "episode_lengths": [27, 27, 25, 28, 29, 26, 25, 26, 26, 26, 27, 26, 26, 25, 25, 26, 25, 27, 26, 27, 28, 25, 25, 25, 26, 25, 26, 27, 26, 25, 25, 25, 28, 26, 26, 26, 25, 25, 25, 28, 25, 26, 25, 25, 25, 25, 26, 27, 25, 27, 27, 27, 25, 27, 25, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 359.83125868943563, "mean_inference_ms": 2.1559495347128097, "mean_action_processing_ms": 0.14971037482776617, "mean_env_wait_ms": 8.621256665095157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010867834091186523, "StateBufferConnector_ms": 0.006773233413696289, "ViewRequirementAgentConnector_ms": 0.178452730178833}}, "episode_reward_max": 3.4435656925423044, "episode_reward_min": -39.83893955317576, "episode_reward_mean": -6.259368853025378, "episode_len_mean": 25.66, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.953892919216763, -19.947365512382273, 0.04967037361491992, -29.76114326020732, -39.83893955317576, -9.865121792914561, 0.07582232510803046, -9.693058751908229, -9.422689970058581, -9.889336532004878, -18.669783200236747, -9.499737232136106, -9.955655749049559, 0.09519845385073693, 0.0914486188157697, -9.932877172329698, 0.06962980043208244, -19.875793576965805, -9.847041734009627, -19.51142485642321, -29.839281757187823, 3.4435656925423044, 0.07659961821417656, 0.07955608195756438, -9.905583291236507, 0.0640254932623568, -9.93594724567927, -19.965188894206754, -9.967489593346123, 0.02883700552561539, 0.03443621440393455, 0.04366640598437077, -25.93329302989543, -9.892245176535969, -9.791220039602178, -9.407768616338782, 0.377005918739615, 0.05038425341365305, 0.03145011550007265, -29.96389293974109, 0.03342974353026487, -9.929163934233467, 0.5363696205574909, 0.07734696800461603, 3.384203044016939, 0.12642314727939047, -6.445185400005434, -19.950395059346125, 0.027023515182120164, -19.89808802438139, -19.919441362539885, -19.908884178594178, 0.06154201805900349, -19.928241014030455, 0.07922873265878361, -29.908388452015863, 0.052436900550004696, 0.08026596468669164, 0.0705294853231188, 0.07924878144306305, 0.0946735235223539, 0.08563896195686166, 0.12269362380235306, 0.16748388979836554, 0.3287491897430299, -9.96502364904239, 0.03453428828524617, 0.039254348297890915, 0.027609285436657024, 0.023449482979065687, -9.812242933977933, 2.0554033299085503, 0.7587161950178878, 2.408475025388552, 0.2735848659646436, 0.024800210201404056, 0.04114183803365132, 0.044466913078329964, 0.033989532014880613, 0.025706827347605883, 0.09448134377458438, 0.07158836031572013, 0.07286606819724102, 0.09539297920092953, 0.11675841844904013, 0.031834333403328426, -9.875117093135907, 0.09785532317535159, -8.445709913340721, -9.833565116567557, -9.936329332089702, -9.937085310580699, -9.932303590264672, 0.43566032907548924, 0.652104812937677, 0.10430275691310499, -9.881230498934652, 0.07228433568960177, 0.09304102992535217, 0.08739624284091617], "episode_lengths": [27, 27, 25, 28, 29, 26, 25, 26, 26, 26, 27, 26, 26, 25, 25, 26, 25, 27, 26, 27, 28, 25, 25, 25, 26, 25, 26, 27, 26, 25, 25, 25, 28, 26, 26, 26, 25, 25, 25, 28, 25, 26, 25, 25, 25, 25, 26, 27, 25, 27, 27, 27, 25, 27, 25, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 359.83125868943563, "mean_inference_ms": 2.1559495347128097, "mean_action_processing_ms": 0.14971037482776617, "mean_env_wait_ms": 8.621256665095157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010867834091186523, "StateBufferConnector_ms": 0.006773233413696289, "ViewRequirementAgentConnector_ms": 0.178452730178833}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 19500, "num_env_steps_sampled": 11000, "num_env_steps_trained": 19500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.609045217762971, "num_env_steps_trained_throughput_per_sec": 7.0376381746377925, "timesteps_total": 11000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 11000, "timers": {"training_iteration_time_ms": 11100.681, "sample_time_ms": 11039.354, "load_time_ms": 0.246, "load_throughput": 317657.745, "learn_time_ms": 13.082, "learn_throughput": 5962.303, "synch_weights_time_ms": 11.269}, "counters": {"num_env_steps_sampled": 11000, "num_env_steps_trained": 19500, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 19500, "last_target_update_ts": 10920, "num_target_updates": 20}, "done": false, "episodes_total": 368, "training_iteration": 11, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-51-39", "timestamp": 1713408699, "time_this_iter_s": 277.0919587612152, "time_total_s": 2453.0814135074615, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 2453.0814135074615, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 10.984517766497461, "ram_util_percent": 15.047969543147207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.006649630609899759, "cur_lr": 0.01}, "td_error": [2.016314744949341, 2.2250640392303467, 2.212374210357666, 1.8253858089447021, 2.2125208377838135, 0.7599351406097412, 2.212688446044922, 2.2284398078918457, 2.228376865386963, 2.534649610519409, 2.228440999984741, 2.228513240814209, 1.366036295890808, 0.7582458257675171, 2.212376356124878, 2.212831974029541, 1.82943856716156, 1.3706891536712646, 1.8054896593093872, 0.7822704911231995, 2.215928792953491, 2.2241976261138916, 2.228429079055786, 1.9027063846588135, 2.22841739654541, 2.223036050796509, 0.7582458257675171, 2.2789719104766846, 1.8255378007888794, 2.212367296218872, 1.605394721031189, 0.7582458257675171, 1.3969343900680542, 2.2285149097442627, 2.228382110595703, 2.2124369144439697, 1.3768880367279053, 2.228362560272217, 1.3768548965454102, 1.9150291681289673, 2.634593963623047, 2.223897695541382, 2.212491750717163, 0.7582458257675171, 2.2301602363586426, 2.2124412059783936, 2.2506821155548096, 2.224090814590454, 1.8868913650512695, 2.228364944458008, 2.2284162044525146, 2.0312747955322266, 0.7582458257675171, 2.261430263519287, 2.223484516143799, 1.810752272605896, 1.7825778722763062, 1.8055055141448975, 2.223257303237915, 2.2284610271453857, 2.240614652633667, 2.2233264446258545, 2.21303129196167, 1.8858939409255981, 1.3767508268356323, 2.2237548828125, 1.3658584356307983, 2.22845458984375, 2.212383508682251, 0.7822704911231995, 2.229801893234253, 2.212916612625122, 2.228461503982544, 2.21242618560791, 1.7825839519500732, 2.2192587852478027, 1.366288661956787, 2.2737655639648438], "mean_td_error": 1.925231695175171, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 274.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 21450, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 21450, "last_target_update_ts": 11960, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": 3.792161148951553, "episode_reward_min": -29.908388452015863, "episode_reward_mean": -2.3592408225067736, "episode_len_mean": 25.29, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.03342974353026487, -9.929163934233467, 0.5363696205574909, 0.07734696800461603, 3.384203044016939, 0.12642314727939047, -6.445185400005434, -19.950395059346125, 0.027023515182120164, -19.89808802438139, -19.919441362539885, -19.908884178594178, 0.06154201805900349, -19.928241014030455, 0.07922873265878361, -29.908388452015863, 0.052436900550004696, 0.08026596468669164, 0.0705294853231188, 0.07924878144306305, 0.0946735235223539, 0.08563896195686166, 0.12269362380235306, 0.16748388979836554, 0.3287491897430299, -9.96502364904239, 0.03453428828524617, 0.039254348297890915, 0.027609285436657024, 0.023449482979065687, -9.812242933977933, 2.0554033299085503, 0.7587161950178878, 2.408475025388552, 0.2735848659646436, 0.024800210201404056, 0.04114183803365132, 0.044466913078329964, 0.033989532014880613, 0.025706827347605883, 0.09448134377458438, 0.07158836031572013, 0.07286606819724102, 0.09539297920092953, 0.11675841844904013, 0.031834333403328426, -9.875117093135907, 0.09785532317535159, -8.445709913340721, -9.833565116567557, -9.936329332089702, -9.937085310580699, -9.932303590264672, 0.43566032907548924, 0.652104812937677, 0.10430275691310499, -9.881230498934652, 0.07228433568960177, 0.09304102992535217, 0.08739624284091617, 0.7459046265981218, 2.8921565777022633, 2.526349260075788, 0.27780347156976626, 0.5058604130757528, 3.3467604580527586, 0.028665029870708875, 0.841464228218168, 0.02154998408755268, 0.007652983619292615, 3.7219975384271318, 0.6040140511790388, 0.0096255731447553, 2.2483808220286288, 0.9296917374012252, 0.04527577324309798, 0.040275034611223386, 0.049491657943657674, 0.06445802475858883, 0.23865038850138734, 0.0673079217427779, -9.840018194624689, 0.2390362850123723, 0.06770278053244257, -6.546603389632964, -9.83366297202354, 0.2848458458348311, 0.10824333589919759, 0.22691921967359807, 0.9743673057915824, 3.792161148951553, 0.6257800416113893, 0.21465131672279203, 0.20679068095964856, 0.21875128228847843, 0.03664351358743863, -9.899074343371703, 0.4925709443714333, 3.5132798260561264, -9.737393157055152], "episode_lengths": [25, 26, 25, 25, 25, 25, 26, 27, 25, 27, 27, 27, 25, 27, 25, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 366.5352555296946, "mean_inference_ms": 2.1510839874809453, "mean_action_processing_ms": 0.14916932520989562, "mean_env_wait_ms": 7.838345448052881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010744333267211914, "StateBufferConnector_ms": 0.0068776607513427734, "ViewRequirementAgentConnector_ms": 0.1775038242340088}}, "episode_reward_max": 3.792161148951553, "episode_reward_min": -29.908388452015863, "episode_reward_mean": -2.3592408225067736, "episode_len_mean": 25.29, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.03342974353026487, -9.929163934233467, 0.5363696205574909, 0.07734696800461603, 3.384203044016939, 0.12642314727939047, -6.445185400005434, -19.950395059346125, 0.027023515182120164, -19.89808802438139, -19.919441362539885, -19.908884178594178, 0.06154201805900349, -19.928241014030455, 0.07922873265878361, -29.908388452015863, 0.052436900550004696, 0.08026596468669164, 0.0705294853231188, 0.07924878144306305, 0.0946735235223539, 0.08563896195686166, 0.12269362380235306, 0.16748388979836554, 0.3287491897430299, -9.96502364904239, 0.03453428828524617, 0.039254348297890915, 0.027609285436657024, 0.023449482979065687, -9.812242933977933, 2.0554033299085503, 0.7587161950178878, 2.408475025388552, 0.2735848659646436, 0.024800210201404056, 0.04114183803365132, 0.044466913078329964, 0.033989532014880613, 0.025706827347605883, 0.09448134377458438, 0.07158836031572013, 0.07286606819724102, 0.09539297920092953, 0.11675841844904013, 0.031834333403328426, -9.875117093135907, 0.09785532317535159, -8.445709913340721, -9.833565116567557, -9.936329332089702, -9.937085310580699, -9.932303590264672, 0.43566032907548924, 0.652104812937677, 0.10430275691310499, -9.881230498934652, 0.07228433568960177, 0.09304102992535217, 0.08739624284091617, 0.7459046265981218, 2.8921565777022633, 2.526349260075788, 0.27780347156976626, 0.5058604130757528, 3.3467604580527586, 0.028665029870708875, 0.841464228218168, 0.02154998408755268, 0.007652983619292615, 3.7219975384271318, 0.6040140511790388, 0.0096255731447553, 2.2483808220286288, 0.9296917374012252, 0.04527577324309798, 0.040275034611223386, 0.049491657943657674, 0.06445802475858883, 0.23865038850138734, 0.0673079217427779, -9.840018194624689, 0.2390362850123723, 0.06770278053244257, -6.546603389632964, -9.83366297202354, 0.2848458458348311, 0.10824333589919759, 0.22691921967359807, 0.9743673057915824, 3.792161148951553, 0.6257800416113893, 0.21465131672279203, 0.20679068095964856, 0.21875128228847843, 0.03664351358743863, -9.899074343371703, 0.4925709443714333, 3.5132798260561264, -9.737393157055152], "episode_lengths": [25, 26, 25, 25, 25, 25, 26, 27, 25, 27, 27, 27, 25, 27, 25, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 366.5352555296946, "mean_inference_ms": 2.1510839874809453, "mean_action_processing_ms": 0.14916932520989562, "mean_env_wait_ms": 7.838345448052881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010744333267211914, "StateBufferConnector_ms": 0.0068776607513427734, "ViewRequirementAgentConnector_ms": 0.1775038242340088}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 21450, "num_env_steps_sampled": 12000, "num_env_steps_trained": 21450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.615909511141699, "num_env_steps_trained_throughput_per_sec": 7.051023546726313, "timesteps_total": 12000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11060.83, "sample_time_ms": 10998.809, "load_time_ms": 0.242, "load_throughput": 322447.972, "learn_time_ms": 12.738, "learn_throughput": 6123.415, "synch_weights_time_ms": 11.315}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 21450, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 21450, "last_target_update_ts": 11960, "num_target_updates": 22}, "done": false, "episodes_total": 408, "training_iteration": 12, "trial_id": "cbb9a_00000", "date": "2024-04-18_02-56-16", "timestamp": 1713408976, "time_this_iter_s": 276.56607723236084, "time_total_s": 2729.6474907398224, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 2729.6474907398224, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 10.940862944162436, "ram_util_percent": 15.212690355329947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.005484315566718578, "cur_lr": 0.01}, "td_error": [1.8394402265548706, 1.7867341041564941, 2.2107887268066406, 2.206909656524658, 2.2055916786193848, 2.7332637310028076, 2.2130842208862305, 1.3534924983978271, 0.7427037954330444, 0.7427037954330444, 1.8061473369598389, 1.3627485036849976, 0.788984477519989, 2.2103147506713867, 2.2058651447296143, 2.208082437515259, 1.6333423852920532, 2.2104296684265137, 2.205822706222534, 1.7892968654632568, 0.788984477519989, 0.7746082544326782, 1.6159615516662598, 2.2082934379577637, 2.212353229522705, 3.114452362060547, 1.3648980855941772, 2.272704601287842, 2.2080488204956055, 2.185800552368164, 2.2125911712646484, 1.8326354026794434, 2.2056360244750977, 2.205639123916626, 1.8394838571548462, 2.211507797241211, 2.208190441131592, 2.2108752727508545, 2.2055554389953613, 2.208127975463867, 1.873185396194458, 2.5974087715148926, 2.580505609512329, 1.3588809967041016, 1.3615882396697998, 2.2082159519195557, 2.2055575847625732, 2.2055773735046387, 2.2091832160949707, 2.4063234329223633, 1.8132591247558594, 2.2102911472320557, 2.1133580207824707, 1.8366974592208862, 0.7435184717178345, 1.8730498552322388, 2.206723213195801, 1.7936716079711914, 1.3504992723464966, 2.2080156803131104, 0.7427037954330444, 2.2055470943450928, 2.2055609226226807, 2.2057137489318848, 2.208038568496704, 0.7736626863479614, 2.208048105239868, 2.209979295730591, 1.87301766872406, 2.215477466583252, 0.788984477519989, 2.206798791885376, 2.2083427906036377, 2.2105143070220947, 2.2103073596954346, 1.787975549697876, 2.208656072616577, 2.2080116271972656], "mean_td_error": 1.9278839826583862, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 300.0, "diff_num_grad_updates_vs_sampler_policy": 299.0}}, "num_env_steps_sampled": 13000, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 23400, "last_target_update_ts": 13000, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": 3.792161148951553, "episode_reward_min": -19.845176265286646, "episode_reward_mean": -1.2670707933993561, "episode_len_mean": 25.18, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.09448134377458438, 0.07158836031572013, 0.07286606819724102, 0.09539297920092953, 0.11675841844904013, 0.031834333403328426, -9.875117093135907, 0.09785532317535159, -8.445709913340721, -9.833565116567557, -9.936329332089702, -9.937085310580699, -9.932303590264672, 0.43566032907548924, 0.652104812937677, 0.10430275691310499, -9.881230498934652, 0.07228433568960177, 0.09304102992535217, 0.08739624284091617, 0.7459046265981218, 2.8921565777022633, 2.526349260075788, 0.27780347156976626, 0.5058604130757528, 3.3467604580527586, 0.028665029870708875, 0.841464228218168, 0.02154998408755268, 0.007652983619292615, 3.7219975384271318, 0.6040140511790388, 0.0096255731447553, 2.2483808220286288, 0.9296917374012252, 0.04527577324309798, 0.040275034611223386, 0.049491657943657674, 0.06445802475858883, 0.23865038850138734, 0.0673079217427779, -9.840018194624689, 0.2390362850123723, 0.06770278053244257, -6.546603389632964, -9.83366297202354, 0.2848458458348311, 0.10824333589919759, 0.22691921967359807, 0.9743673057915824, 3.792161148951553, 0.6257800416113893, 0.21465131672279203, 0.20679068095964856, 0.21875128228847843, 0.03664351358743863, -9.899074343371703, 0.4925709443714333, 3.5132798260561264, -9.737393157055152, -9.746966851242943, 0.4952567216804023, 0.006254688386400583, 0.36037442932346864, 0.005179767366079902, -9.95875426381958, 0.005937683460544962, -9.790364321824969, 0.18123765857308777, 0.005395117579039975, 0.07145000586351888, 0.0064708589193224805, 0.08451748547242292, 0.20411652611656264, 0.005878051137676313, 0.9094979684385294, 0.7937580846121002, 1.33529246261008, 0.0059720542591395025, 0.006563315496579766, -19.845176265286646, 0.31010281003537427, 0.4809202128421918, 0.09601127516671877, 0.007769421261675652, 1.1445817477301103, 0.11919774405178442, 0.0655368213308347, 0.00446500961419551, 0.6781848227217754, 0.1780848374299308, 2.3856404262397732, 1.9592524764763783, 0.1642959407686083, 0.6789232864908417, 0.4857670263028039, 0.656317132811333, 0.18094599592478078, 0.005979953937661078, -9.993499963614152], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 372.5674470220263, "mean_inference_ms": 2.1516954257031786, "mean_action_processing_ms": 0.1489471747939669, "mean_env_wait_ms": 7.203016456456944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010701656341552734, "StateBufferConnector_ms": 0.00666046142578125, "ViewRequirementAgentConnector_ms": 0.18222618103027344}}, "episode_reward_max": 3.792161148951553, "episode_reward_min": -19.845176265286646, "episode_reward_mean": -1.2670707933993561, "episode_len_mean": 25.18, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.09448134377458438, 0.07158836031572013, 0.07286606819724102, 0.09539297920092953, 0.11675841844904013, 0.031834333403328426, -9.875117093135907, 0.09785532317535159, -8.445709913340721, -9.833565116567557, -9.936329332089702, -9.937085310580699, -9.932303590264672, 0.43566032907548924, 0.652104812937677, 0.10430275691310499, -9.881230498934652, 0.07228433568960177, 0.09304102992535217, 0.08739624284091617, 0.7459046265981218, 2.8921565777022633, 2.526349260075788, 0.27780347156976626, 0.5058604130757528, 3.3467604580527586, 0.028665029870708875, 0.841464228218168, 0.02154998408755268, 0.007652983619292615, 3.7219975384271318, 0.6040140511790388, 0.0096255731447553, 2.2483808220286288, 0.9296917374012252, 0.04527577324309798, 0.040275034611223386, 0.049491657943657674, 0.06445802475858883, 0.23865038850138734, 0.0673079217427779, -9.840018194624689, 0.2390362850123723, 0.06770278053244257, -6.546603389632964, -9.83366297202354, 0.2848458458348311, 0.10824333589919759, 0.22691921967359807, 0.9743673057915824, 3.792161148951553, 0.6257800416113893, 0.21465131672279203, 0.20679068095964856, 0.21875128228847843, 0.03664351358743863, -9.899074343371703, 0.4925709443714333, 3.5132798260561264, -9.737393157055152, -9.746966851242943, 0.4952567216804023, 0.006254688386400583, 0.36037442932346864, 0.005179767366079902, -9.95875426381958, 0.005937683460544962, -9.790364321824969, 0.18123765857308777, 0.005395117579039975, 0.07145000586351888, 0.0064708589193224805, 0.08451748547242292, 0.20411652611656264, 0.005878051137676313, 0.9094979684385294, 0.7937580846121002, 1.33529246261008, 0.0059720542591395025, 0.006563315496579766, -19.845176265286646, 0.31010281003537427, 0.4809202128421918, 0.09601127516671877, 0.007769421261675652, 1.1445817477301103, 0.11919774405178442, 0.0655368213308347, 0.00446500961419551, 0.6781848227217754, 0.1780848374299308, 2.3856404262397732, 1.9592524764763783, 0.1642959407686083, 0.6789232864908417, 0.4857670263028039, 0.656317132811333, 0.18094599592478078, 0.005979953937661078, -9.993499963614152], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 372.5674470220263, "mean_inference_ms": 2.1516954257031786, "mean_action_processing_ms": 0.1489471747939669, "mean_env_wait_ms": 7.203016456456944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010701656341552734, "StateBufferConnector_ms": 0.00666046142578125, "ViewRequirementAgentConnector_ms": 0.18222618103027344}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 23400, "num_env_steps_sampled": 13000, "num_env_steps_trained": 23400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5834300837031927, "num_env_steps_trained_throughput_per_sec": 6.987688663221226, "timesteps_total": 13000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 13000, "timers": {"training_iteration_time_ms": 11133.66, "sample_time_ms": 11073.514, "load_time_ms": 0.242, "load_throughput": 322511.546, "learn_time_ms": 12.761, "learn_throughput": 6112.215, "synch_weights_time_ms": 11.492}, "counters": {"num_env_steps_sampled": 13000, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 23400, "last_target_update_ts": 13000, "num_target_updates": 24}, "done": false, "episodes_total": 448, "training_iteration": 13, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-00-55", "timestamp": 1713409255, "time_this_iter_s": 279.07047271728516, "time_total_s": 3008.7179634571075, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3008.7179634571075, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 10.993181818181819, "ram_util_percent": 15.328282828282832}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.004050960298627615, "cur_lr": 0.01}, "td_error": [2.176514148712158, 2.177262306213379, 2.1748993396759033, 2.176548480987549, 2.180882453918457, 2.1815783977508545, 2.1774630546569824, 1.8092111349105835, 2.173781633377075, 2.1835150718688965, 1.7861391305923462, 1.8012725114822388, 2.182321071624756, 2.1772091388702393, 2.174656391143799, 2.193474531173706, 2.7093265056610107, 2.1838455200195312, 2.587005138397217, 1.7441133260726929, 1.744218349456787, 2.199652910232544, 2.173628330230713, 2.18062686920166, 1.2853007316589355, 2.1766011714935303, 2.178809881210327, 1.8353062868118286, 1.8688468933105469, 1.6821260452270508, 2.174561023712158, 1.2898240089416504, 2.176866292953491, 1.745294213294983, 2.2096285820007324, 1.6837462186813354, 2.185331344604492, 1.3015656471252441, 1.7859952449798584, 2.176525831222534, 2.1737167835235596, 2.1759793758392334, 2.7564220428466797, 1.8013938665390015, 1.8662253618240356, 2.1746907234191895, 2.177164077758789, 2.1774165630340576, 1.8306562900543213, 2.181121826171875, 1.307627558708191, 2.18121600151062, 2.1737489700317383, 1.835634469985962, 1.785998821258545, 2.1738662719726562, 2.1812641620635986, 2.1829710006713867, 2.1765224933624268, 2.1736111640930176, 1.86879563331604, 2.183593988418579, 2.174048900604248, 1.859748125076294, 2.173762083053589, 2.1987991333007812, 1.8636754751205444, 2.1772091388702393, 1.8658981323242188, 1.6840182542800903, 2.176664113998413, 2.2938425540924072, 2.1811282634735107, 2.181644916534424, 1.7973754405975342, 2.176621675491333, 2.1765971183776855, 1.6813960075378418], "mean_td_error": 2.0411224365234375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 325.0, "diff_num_grad_updates_vs_sampler_policy": 324.0}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 25350, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 25350, "last_target_update_ts": 13520, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": 5.583822431591318, "episode_reward_min": -19.845176265286646, "episode_reward_mean": -1.1362366184270247, "episode_len_mean": 25.2, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0673079217427779, -9.840018194624689, 0.2390362850123723, 0.06770278053244257, -6.546603389632964, -9.83366297202354, 0.2848458458348311, 0.10824333589919759, 0.22691921967359807, 0.9743673057915824, 3.792161148951553, 0.6257800416113893, 0.21465131672279203, 0.20679068095964856, 0.21875128228847843, 0.03664351358743863, -9.899074343371703, 0.4925709443714333, 3.5132798260561264, -9.737393157055152, -9.746966851242943, 0.4952567216804023, 0.006254688386400583, 0.36037442932346864, 0.005179767366079902, -9.95875426381958, 0.005937683460544962, -9.790364321824969, 0.18123765857308777, 0.005395117579039975, 0.07145000586351888, 0.0064708589193224805, 0.08451748547242292, 0.20411652611656264, 0.005878051137676313, 0.9094979684385294, 0.7937580846121002, 1.33529246261008, 0.0059720542591395025, 0.006563315496579766, -19.845176265286646, 0.31010281003537427, 0.4809202128421918, 0.09601127516671877, 0.007769421261675652, 1.1445817477301103, 0.11919774405178442, 0.0655368213308347, 0.00446500961419551, 0.6781848227217754, 0.1780848374299308, 2.3856404262397732, 1.9592524764763783, 0.1642959407686083, 0.6789232864908417, 0.4857670263028039, 0.656317132811333, 0.18094599592478078, 0.005979953937661078, -9.993499963614152, -7.396585674459088, 0.12987578824850102, 4.247242563649718, 0.8281163034513073, 0.3053508072455362, 0.8203082616921676, 1.1136365097012686, 0.1773743736795646, 1.636719597325108, 0.5160580373105921, 0.00572955959574407, 0.6374919101767867, -9.937645115871643, 0.24931150665104743, 0.2305823159703736, -16.77986277990432, 1.8728288333238512, 1.777783835377834, 0.6942469784637273, -9.73610365078788, 5.104578251008258, 0.007210600707976611, -9.55336528472246, -9.245550733451767, 1.0478275012001947, 1.343282457297861, 2.2557466853485595, 1.9804860075027932, 4.193703025172729, 0.3318857565737738, 4.983654850896352, 0.3961643507768385, 5.583822431591318, -9.496282299540276, 0.3254185928342002, 0.005628330158954181, 0.6330508260356744, 3.4117148272088826, -9.619141254089538, 1.3313757269759432], "episode_lengths": [25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 377.81140808714883, "mean_inference_ms": 2.157009250065042, "mean_action_processing_ms": 0.1490777412602317, "mean_env_wait_ms": 6.663346670208178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01108098030090332, "StateBufferConnector_ms": 0.006657838821411133, "ViewRequirementAgentConnector_ms": 0.18686485290527344}}, "episode_reward_max": 5.583822431591318, "episode_reward_min": -19.845176265286646, "episode_reward_mean": -1.1362366184270247, "episode_len_mean": 25.2, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0673079217427779, -9.840018194624689, 0.2390362850123723, 0.06770278053244257, -6.546603389632964, -9.83366297202354, 0.2848458458348311, 0.10824333589919759, 0.22691921967359807, 0.9743673057915824, 3.792161148951553, 0.6257800416113893, 0.21465131672279203, 0.20679068095964856, 0.21875128228847843, 0.03664351358743863, -9.899074343371703, 0.4925709443714333, 3.5132798260561264, -9.737393157055152, -9.746966851242943, 0.4952567216804023, 0.006254688386400583, 0.36037442932346864, 0.005179767366079902, -9.95875426381958, 0.005937683460544962, -9.790364321824969, 0.18123765857308777, 0.005395117579039975, 0.07145000586351888, 0.0064708589193224805, 0.08451748547242292, 0.20411652611656264, 0.005878051137676313, 0.9094979684385294, 0.7937580846121002, 1.33529246261008, 0.0059720542591395025, 0.006563315496579766, -19.845176265286646, 0.31010281003537427, 0.4809202128421918, 0.09601127516671877, 0.007769421261675652, 1.1445817477301103, 0.11919774405178442, 0.0655368213308347, 0.00446500961419551, 0.6781848227217754, 0.1780848374299308, 2.3856404262397732, 1.9592524764763783, 0.1642959407686083, 0.6789232864908417, 0.4857670263028039, 0.656317132811333, 0.18094599592478078, 0.005979953937661078, -9.993499963614152, -7.396585674459088, 0.12987578824850102, 4.247242563649718, 0.8281163034513073, 0.3053508072455362, 0.8203082616921676, 1.1136365097012686, 0.1773743736795646, 1.636719597325108, 0.5160580373105921, 0.00572955959574407, 0.6374919101767867, -9.937645115871643, 0.24931150665104743, 0.2305823159703736, -16.77986277990432, 1.8728288333238512, 1.777783835377834, 0.6942469784637273, -9.73610365078788, 5.104578251008258, 0.007210600707976611, -9.55336528472246, -9.245550733451767, 1.0478275012001947, 1.343282457297861, 2.2557466853485595, 1.9804860075027932, 4.193703025172729, 0.3318857565737738, 4.983654850896352, 0.3961643507768385, 5.583822431591318, -9.496282299540276, 0.3254185928342002, 0.005628330158954181, 0.6330508260356744, 3.4117148272088826, -9.619141254089538, 1.3313757269759432], "episode_lengths": [25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 377.81140808714883, "mean_inference_ms": 2.157009250065042, "mean_action_processing_ms": 0.1490777412602317, "mean_env_wait_ms": 6.663346670208178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01108098030090332, "StateBufferConnector_ms": 0.006657838821411133, "ViewRequirementAgentConnector_ms": 0.18686485290527344}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 25350, "num_env_steps_sampled": 14000, "num_env_steps_trained": 25350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.280619848349142, "num_env_steps_trained_throughput_per_sec": 8.347208704280826, "timesteps_total": 14000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 7842.327, "sample_time_ms": 7783.007, "load_time_ms": 0.237, "load_throughput": 328568.557, "learn_time_ms": 12.5, "learn_throughput": 6239.976, "synch_weights_time_ms": 10.522}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 25350, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 25350, "last_target_update_ts": 13520, "num_target_updates": 25}, "done": false, "episodes_total": 488, "training_iteration": 14, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-04-49", "timestamp": 1713409489, "time_this_iter_s": 233.61955380439758, "time_total_s": 3242.337517261505, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3242.337517261505, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.81981981981982, "ram_util_percent": 15.456456456456456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0032540345564484596, "cur_lr": 0.01}, "td_error": [1.2987810373306274, 2.1645920276641846, 2.1643521785736084, 2.167104721069336, 2.165541172027588, 2.164275646209717, 1.269909143447876, 2.1792948246002197, 2.171231746673584, 2.165513038635254, 2.1931207180023193, 2.16428279876709, 1.716443657875061, 2.166437864303589, 2.1655173301696777, 1.6351346969604492, 1.873538851737976, 0.6429187059402466, 1.7486226558685303, 2.1718554496765137, 0.6429187059402466, 2.1642963886260986, 1.2987810373306274, 2.172761917114258, 1.8204594850540161, 2.1649041175842285, 0.6429187059402466, 1.8716307878494263, 2.1654763221740723, 2.1654586791992188, 2.188528060913086, 2.1731231212615967, 1.8269619941711426, 2.1730244159698486, 1.8282068967819214, 1.2734785079956055, 2.8327717781066895, 1.6351571083068848, 2.1721715927124023, 2.1654794216156006, 2.165579319000244, 2.201310873031616, 2.1718316078186035, 2.165348529815674, 2.164724111557007, 2.194584369659424, 2.164397716522217, 2.1662437915802, 1.6802705526351929, 2.3711867332458496, 2.1718006134033203, 2.168687343597412, 2.1673693656921387, 1.8735860586166382, 1.6351903676986694, 2.179748773574829, 2.171475410461426, 1.6802432537078857, 2.164407730102539, 2.168687343597412, 2.1643006801605225, 2.1656436920166016, 1.8270366191864014, 2.1668941974639893, 1.269909143447876, 2.2176034450531006, 2.1711020469665527, 2.1642816066741943, 2.1715590953826904, 1.6802444458007812, 2.1658124923706055, 1.6802762746810913, 2.171079158782959, 2.1654722690582275, 2.172086477279663, 1.2717732191085815, 2.91507625579834, 2.1732070446014404], "mean_td_error": 1.9782949686050415, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 350.0, "diff_num_grad_updates_vs_sampler_policy": 349.0}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 27300, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 27300, "last_target_update_ts": 14560, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": 5.583822431591318, "episode_reward_min": -19.845176265286646, "episode_reward_mean": -0.9751826066558587, "episode_len_mean": 25.2, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006563315496579766, -19.845176265286646, 0.31010281003537427, 0.4809202128421918, 0.09601127516671877, 0.007769421261675652, 1.1445817477301103, 0.11919774405178442, 0.0655368213308347, 0.00446500961419551, 0.6781848227217754, 0.1780848374299308, 2.3856404262397732, 1.9592524764763783, 0.1642959407686083, 0.6789232864908417, 0.4857670263028039, 0.656317132811333, 0.18094599592478078, 0.005979953937661078, -9.993499963614152, -7.396585674459088, 0.12987578824850102, 4.247242563649718, 0.8281163034513073, 0.3053508072455362, 0.8203082616921676, 1.1136365097012686, 0.1773743736795646, 1.636719597325108, 0.5160580373105921, 0.00572955959574407, 0.6374919101767867, -9.937645115871643, 0.24931150665104743, 0.2305823159703736, -16.77986277990432, 1.8728288333238512, 1.777783835377834, 0.6942469784637273, -9.73610365078788, 5.104578251008258, 0.007210600707976611, -9.55336528472246, -9.245550733451767, 1.0478275012001947, 1.343282457297861, 2.2557466853485595, 1.9804860075027932, 4.193703025172729, 0.3318857565737738, 4.983654850896352, 0.3961643507768385, 5.583822431591318, -9.496282299540276, 0.3254185928342002, 0.005628330158954181, 0.6330508260356744, 3.4117148272088826, -9.619141254089538, 1.3313757269759432, 0.17886800981224535, 0.6636225055558569, -9.157258201388242, -9.25757366187851, 2.796145430322879, -8.428415448751476, 0.5082007000435388, 0.4020400223686764, 0.5423699921674977, 1.143989348069556, 0.5306362250147011, 0.1027778643315109, 0.12038969372366912, 0.05798563652383714, 3.7410983830281026, 0.3965718248205869, -9.550188361301576, 0.18601576709049467, 0.1018052911152026, 3.441102468842253, -8.381571184653986, 0.12940538839450916, -9.904247775605873, 0.08754728249167457, 0.24793506509949806, 3.956866563002723, 0.47285822658763016, -9.886900555956416, 0.13178331999136786, 3.7521040310618634, 0.37485450295230033, -7.3875051958718405, 0.09016865533058153, 0.061811294323348955, 0.7416083421915981, 2.257355078599381, 0.46224428829925074, 0.3435731827675947, 0.22813069783910037], "episode_lengths": [25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 382.11392235155887, "mean_inference_ms": 2.160621470619732, "mean_action_processing_ms": 0.14932976358808536, "mean_env_wait_ms": 6.20928835676403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01076054573059082, "StateBufferConnector_ms": 0.006663084030151367, "ViewRequirementAgentConnector_ms": 0.18646526336669922}}, "episode_reward_max": 5.583822431591318, "episode_reward_min": -19.845176265286646, "episode_reward_mean": -0.9751826066558587, "episode_len_mean": 25.2, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.006563315496579766, -19.845176265286646, 0.31010281003537427, 0.4809202128421918, 0.09601127516671877, 0.007769421261675652, 1.1445817477301103, 0.11919774405178442, 0.0655368213308347, 0.00446500961419551, 0.6781848227217754, 0.1780848374299308, 2.3856404262397732, 1.9592524764763783, 0.1642959407686083, 0.6789232864908417, 0.4857670263028039, 0.656317132811333, 0.18094599592478078, 0.005979953937661078, -9.993499963614152, -7.396585674459088, 0.12987578824850102, 4.247242563649718, 0.8281163034513073, 0.3053508072455362, 0.8203082616921676, 1.1136365097012686, 0.1773743736795646, 1.636719597325108, 0.5160580373105921, 0.00572955959574407, 0.6374919101767867, -9.937645115871643, 0.24931150665104743, 0.2305823159703736, -16.77986277990432, 1.8728288333238512, 1.777783835377834, 0.6942469784637273, -9.73610365078788, 5.104578251008258, 0.007210600707976611, -9.55336528472246, -9.245550733451767, 1.0478275012001947, 1.343282457297861, 2.2557466853485595, 1.9804860075027932, 4.193703025172729, 0.3318857565737738, 4.983654850896352, 0.3961643507768385, 5.583822431591318, -9.496282299540276, 0.3254185928342002, 0.005628330158954181, 0.6330508260356744, 3.4117148272088826, -9.619141254089538, 1.3313757269759432, 0.17886800981224535, 0.6636225055558569, -9.157258201388242, -9.25757366187851, 2.796145430322879, -8.428415448751476, 0.5082007000435388, 0.4020400223686764, 0.5423699921674977, 1.143989348069556, 0.5306362250147011, 0.1027778643315109, 0.12038969372366912, 0.05798563652383714, 3.7410983830281026, 0.3965718248205869, -9.550188361301576, 0.18601576709049467, 0.1018052911152026, 3.441102468842253, -8.381571184653986, 0.12940538839450916, -9.904247775605873, 0.08754728249167457, 0.24793506509949806, 3.956866563002723, 0.47285822658763016, -9.886900555956416, 0.13178331999136786, 3.7521040310618634, 0.37485450295230033, -7.3875051958718405, 0.09016865533058153, 0.061811294323348955, 0.7416083421915981, 2.257355078599381, 0.46224428829925074, 0.3435731827675947, 0.22813069783910037], "episode_lengths": [25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 382.11392235155887, "mean_inference_ms": 2.160621470619732, "mean_action_processing_ms": 0.14932976358808536, "mean_env_wait_ms": 6.20928835676403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01076054573059082, "StateBufferConnector_ms": 0.006663084030151367, "ViewRequirementAgentConnector_ms": 0.18646526336669922}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 27300, "num_env_steps_sampled": 15000, "num_env_steps_trained": 27300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.511035018848778, "num_env_steps_trained_throughput_per_sec": 10.746518286755117, "timesteps_total": 15000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 8054.465, "sample_time_ms": 7989.063, "load_time_ms": 0.275, "load_throughput": 283964.684, "learn_time_ms": 13.404, "learn_throughput": 5819.236, "synch_weights_time_ms": 11.467}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 27300, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 27300, "last_target_update_ts": 14560, "num_target_updates": 27}, "done": false, "episodes_total": 527, "training_iteration": 15, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-07-50", "timestamp": 1713409670, "time_this_iter_s": 181.46337628364563, "time_total_s": 3423.8008935451508, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3423.8008935451508, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 16.02674418604651, "ram_util_percent": 15.628682170542636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.003311396576464176, "cur_lr": 0.01}, "td_error": [2.120637893676758, 1.2160472869873047, 2.1570377349853516, 1.2191901206970215, 1.8322328329086304, 2.133687973022461, 2.7545206546783447, 2.1190526485443115, 2.1234352588653564, 1.8243249654769897, 1.6790657043457031, 1.9475713968276978, 2.1692843437194824, 2.1569113731384277, 2.124772787094116, 2.210430860519409, 1.2559679746627808, 2.1183810234069824, 2.1184000968933105, 2.120697259902954, 2.1211092472076416, 2.1394271850585938, 1.602334976196289, 2.121253490447998, 2.123809337615967, 1.602352261543274, 2.1207098960876465, 1.6790671348571777, 1.2559679746627808, 1.216879963874817, 2.1704413890838623, 1.636566162109375, 2.12068772315979, 1.2561390399932861, 2.663808584213257, 2.1214311122894287, 1.5491199493408203, 2.1311495304107666, 2.118821382522583, 2.118359327316284, 1.877020001411438, 1.8739184141159058, 2.1297106742858887, 2.119619131088257, 1.638071894645691, 2.1213583946228027, 2.1750009059906006, 1.942420482635498, 2.120663642883301, 2.121100425720215, 2.129213333129883, 2.11844539642334, 2.120924711227417, 2.1222004890441895, 2.1183595657348633, 1.5491087436676025, 2.137176752090454, 2.120786428451538, 1.8519798517227173, 1.9417506456375122, 1.9409061670303345, 1.826309084892273, 2.120227813720703, 2.129711151123047, 2.1219983100891113, 2.120676279067993, 1.5491271018981934, 2.1207618713378906, 2.12064266204834, 2.118882656097412, 2.132185935974121, 2.1482419967651367, 2.1292498111724854, 2.11836838722229, 2.122565269470215, 1.8744248151779175, 1.8770684003829956, 2.1300113201141357], "mean_td_error": 1.9782216548919678, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 375.0, "diff_num_grad_updates_vs_sampler_policy": 374.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 29250, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 29250, "last_target_update_ts": 15600, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": 6.736516265019486, "episode_reward_min": -9.99762564188655, "episode_reward_mean": -0.8676208833913205, "episode_len_mean": 25.18, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.73610365078788, 5.104578251008258, 0.007210600707976611, -9.55336528472246, -9.245550733451767, 1.0478275012001947, 1.343282457297861, 2.2557466853485595, 1.9804860075027932, 4.193703025172729, 0.3318857565737738, 4.983654850896352, 0.3961643507768385, 5.583822431591318, -9.496282299540276, 0.3254185928342002, 0.005628330158954181, 0.6330508260356744, 3.4117148272088826, -9.619141254089538, 1.3313757269759432, 0.17886800981224535, 0.6636225055558569, -9.157258201388242, -9.25757366187851, 2.796145430322879, -8.428415448751476, 0.5082007000435388, 0.4020400223686764, 0.5423699921674977, 1.143989348069556, 0.5306362250147011, 0.1027778643315109, 0.12038969372366912, 0.05798563652383714, 3.7410983830281026, 0.3965718248205869, -9.550188361301576, 0.18601576709049467, 0.1018052911152026, 3.441102468842253, -8.381571184653986, 0.12940538839450916, -9.904247775605873, 0.08754728249167457, 0.24793506509949806, 3.956866563002723, 0.47285822658763016, -9.886900555956416, 0.13178331999136786, 3.7521040310618634, 0.37485450295230033, -7.3875051958718405, 0.09016865533058153, 0.061811294323348955, 0.7416083421915981, 2.257355078599381, 0.46224428829925074, 0.3435731827675947, 0.22813069783910037, 0.07662160470556158, 0.06470628182693637, 0.0683731120354078, 0.04923248700966298, 0.049641137243345346, 0.26609531365111294, 1.2493615209289246, 0.1727501539833428, -9.99762564188655, -9.952363614247488, 0.9959577017584531, 0.05305432577242599, 3.509348545772356, 0.0025064527072018636, 0.0023935760967489566, 0.08350036929501166, 0.06612575675332716, 0.031883106565238975, 0.0025052006909329237, 0.1230797473441448, 0.18629248774889007, 0.07438145920367399, 0.7604126161858157, 2.6382185622935785, 0.7617417988053744, 0.13010532817878942, 0.04514937584062887, -9.949881154590164, 0.02833287492392819, 0.10512725458928883, 0.12081970846133763, 0.09656490568139686, 0.04321782135929947, 6.736516265019486, -8.040982196751905, 0.09629264551838124, -9.883602634208364, 0.13058938658645353, 0.6080332602359008, 0.050123062726570446], "episode_lengths": [26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 385.9860338778346, "mean_inference_ms": 2.162942468163732, "mean_action_processing_ms": 0.14945684345484284, "mean_env_wait_ms": 5.8028980663953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010628938674926758, "StateBufferConnector_ms": 0.00676274299621582, "ViewRequirementAgentConnector_ms": 0.18459224700927734}}, "episode_reward_max": 6.736516265019486, "episode_reward_min": -9.99762564188655, "episode_reward_mean": -0.8676208833913205, "episode_len_mean": 25.18, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.73610365078788, 5.104578251008258, 0.007210600707976611, -9.55336528472246, -9.245550733451767, 1.0478275012001947, 1.343282457297861, 2.2557466853485595, 1.9804860075027932, 4.193703025172729, 0.3318857565737738, 4.983654850896352, 0.3961643507768385, 5.583822431591318, -9.496282299540276, 0.3254185928342002, 0.005628330158954181, 0.6330508260356744, 3.4117148272088826, -9.619141254089538, 1.3313757269759432, 0.17886800981224535, 0.6636225055558569, -9.157258201388242, -9.25757366187851, 2.796145430322879, -8.428415448751476, 0.5082007000435388, 0.4020400223686764, 0.5423699921674977, 1.143989348069556, 0.5306362250147011, 0.1027778643315109, 0.12038969372366912, 0.05798563652383714, 3.7410983830281026, 0.3965718248205869, -9.550188361301576, 0.18601576709049467, 0.1018052911152026, 3.441102468842253, -8.381571184653986, 0.12940538839450916, -9.904247775605873, 0.08754728249167457, 0.24793506509949806, 3.956866563002723, 0.47285822658763016, -9.886900555956416, 0.13178331999136786, 3.7521040310618634, 0.37485450295230033, -7.3875051958718405, 0.09016865533058153, 0.061811294323348955, 0.7416083421915981, 2.257355078599381, 0.46224428829925074, 0.3435731827675947, 0.22813069783910037, 0.07662160470556158, 0.06470628182693637, 0.0683731120354078, 0.04923248700966298, 0.049641137243345346, 0.26609531365111294, 1.2493615209289246, 0.1727501539833428, -9.99762564188655, -9.952363614247488, 0.9959577017584531, 0.05305432577242599, 3.509348545772356, 0.0025064527072018636, 0.0023935760967489566, 0.08350036929501166, 0.06612575675332716, 0.031883106565238975, 0.0025052006909329237, 0.1230797473441448, 0.18629248774889007, 0.07438145920367399, 0.7604126161858157, 2.6382185622935785, 0.7617417988053744, 0.13010532817878942, 0.04514937584062887, -9.949881154590164, 0.02833287492392819, 0.10512725458928883, 0.12081970846133763, 0.09656490568139686, 0.04321782135929947, 6.736516265019486, -8.040982196751905, 0.09629264551838124, -9.883602634208364, 0.13058938658645353, 0.6080332602359008, 0.050123062726570446], "episode_lengths": [26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 385.9860338778346, "mean_inference_ms": 2.162942468163732, "mean_action_processing_ms": 0.14945684345484284, "mean_env_wait_ms": 5.8028980663953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010628938674926758, "StateBufferConnector_ms": 0.00676274299621582, "ViewRequirementAgentConnector_ms": 0.18459224700927734}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 29250, "num_env_steps_sampled": 16000, "num_env_steps_trained": 29250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.227189023882716, "num_env_steps_trained_throughput_per_sec": 8.243018596571297, "timesteps_total": 16000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10114.067, "sample_time_ms": 10051.925, "load_time_ms": 0.239, "load_throughput": 326763.596, "learn_time_ms": 13.626, "learn_throughput": 5724.379, "synch_weights_time_ms": 10.415}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 29250, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 29250, "last_target_update_ts": 15600, "num_target_updates": 29}, "done": false, "episodes_total": 567, "training_iteration": 16, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-11-47", "timestamp": 1713409907, "time_this_iter_s": 236.57171869277954, "time_total_s": 3660.3726122379303, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3660.3726122379303, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.87232142857143, "ram_util_percent": 15.742857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.005650619510561228, "cur_lr": 0.01}, "td_error": [1.8193495273590088, 2.094006299972534, 2.0998685359954834, 2.081432819366455, 2.0814812183380127, 2.0757641792297363, 1.4889600276947021, 2.0769200325012207, 2.075425624847412, 1.814592957496643, 2.082336902618408, 0.6425096392631531, 2.0803816318511963, 2.075432300567627, 2.0754730701446533, 2.075632333755493, 2.0942018032073975, 2.0754213333129883, 2.081350326538086, 0.6425096392631531, 2.0987489223480225, 2.0821077823638916, 1.6324286460876465, 1.8794554471969604, 1.9549570083618164, 2.081716537475586, 2.0815539360046387, 2.083726644515991, 2.0824601650238037, 2.075490951538086, 1.9576090574264526, 2.0838398933410645, 2.094622850418091, 2.082498073577881, 2.120509386062622, 2.075438976287842, 2.0813632011413574, 1.6222425699234009, 2.0771639347076416, 2.095566987991333, 2.105191946029663, 1.9551013708114624, 0.5810412168502808, 2.0791420936584473, 1.8146636486053467, 2.075416088104248, 2.081444263458252, 1.6222425699234009, 2.075622081756592, 2.0952155590057373, 1.5387921333312988, 2.0961122512817383, 1.819248914718628, 2.0754270553588867, 2.0826900005340576, 1.9525268077850342, 2.0831899642944336, 2.094433069229126, 2.094909906387329, 1.8347004652023315, 1.95497727394104, 1.1904196739196777, 2.094618558883667, 2.0918235778808594, 2.0760691165924072, 2.0941903591156006, 2.0872371196746826, 2.0944573879241943, 1.8836617469787598, 2.0944619178771973, 2.1767163276672363, 2.0813827514648438, 1.817824363708496, 2.0792617797851562, 2.0813968181610107, 2.095372438430786, 2.081921100616455, 2.0820577144622803], "mean_td_error": 1.9524554014205933, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 400.0, "diff_num_grad_updates_vs_sampler_policy": 399.0}}, "num_env_steps_sampled": 17000, "num_env_steps_trained": 31200, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 31200, "last_target_update_ts": 16640, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": 6.736516265019486, "episode_reward_min": -19.99725719670816, "episode_reward_mean": -0.9934360598748504, "episode_len_mean": 25.17, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.1018052911152026, 3.441102468842253, -8.381571184653986, 0.12940538839450916, -9.904247775605873, 0.08754728249167457, 0.24793506509949806, 3.956866563002723, 0.47285822658763016, -9.886900555956416, 0.13178331999136786, 3.7521040310618634, 0.37485450295230033, -7.3875051958718405, 0.09016865533058153, 0.061811294323348955, 0.7416083421915981, 2.257355078599381, 0.46224428829925074, 0.3435731827675947, 0.22813069783910037, 0.07662160470556158, 0.06470628182693637, 0.0683731120354078, 0.04923248700966298, 0.049641137243345346, 0.26609531365111294, 1.2493615209289246, 0.1727501539833428, -9.99762564188655, -9.952363614247488, 0.9959577017584531, 0.05305432577242599, 3.509348545772356, 0.0025064527072018636, 0.0023935760967489566, 0.08350036929501166, 0.06612575675332716, 0.031883106565238975, 0.0025052006909329237, 0.1230797473441448, 0.18629248774889007, 0.07438145920367399, 0.7604126161858157, 2.6382185622935785, 0.7617417988053744, 0.13010532817878942, 0.04514937584062887, -9.949881154590164, 0.02833287492392819, 0.10512725458928883, 0.12081970846133763, 0.09656490568139686, 0.04321782135929947, 6.736516265019486, -8.040982196751905, 0.09629264551838124, -9.883602634208364, 0.13058938658645353, 0.6080332602359008, 0.050123062726570446, 0.05008273806293365, 0.5939260851748782, 0.002873785714686374, -9.388750334431743, 0.11314330812734243, 0.0021991180087633133, 0.6363462593489612, -19.870924900310413, 0.17531935082051298, 0.18399314976330483, 0.002298968181248827, 0.05145516467587903, -9.93614843758367, 0.3293599510250436, 0.8535784948424174, 0.21141653963735973, 0.002210831943946108, 0.0021254674857155965, 0.0020509447610639418, 0.09240359374167967, 0.1262248111149232, 5.582683841139749, 2.3506456392514257, 0.0449945820188049, 0.24153232123102286, 0.06169300487383599, 0.1337281803473617, -4.428147840615794, 0.002044524936460175, 3.3311815937639446, 1.9269196260756565, 0.5231977293625636, 2.325723904891489, 0.11750301219427656, 0.046082653651309195, 0.402911489064364, 0.6537517246184776, -9.87350860030287, -19.99725719670816], "episode_lengths": [25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 389.235026302357, "mean_inference_ms": 2.1668228287463633, "mean_action_processing_ms": 0.14959497459417082, "mean_env_wait_ms": 5.453209793108072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010654926300048828, "StateBufferConnector_ms": 0.006998777389526367, "ViewRequirementAgentConnector_ms": 0.18591880798339844}}, "episode_reward_max": 6.736516265019486, "episode_reward_min": -19.99725719670816, "episode_reward_mean": -0.9934360598748504, "episode_len_mean": 25.17, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.1018052911152026, 3.441102468842253, -8.381571184653986, 0.12940538839450916, -9.904247775605873, 0.08754728249167457, 0.24793506509949806, 3.956866563002723, 0.47285822658763016, -9.886900555956416, 0.13178331999136786, 3.7521040310618634, 0.37485450295230033, -7.3875051958718405, 0.09016865533058153, 0.061811294323348955, 0.7416083421915981, 2.257355078599381, 0.46224428829925074, 0.3435731827675947, 0.22813069783910037, 0.07662160470556158, 0.06470628182693637, 0.0683731120354078, 0.04923248700966298, 0.049641137243345346, 0.26609531365111294, 1.2493615209289246, 0.1727501539833428, -9.99762564188655, -9.952363614247488, 0.9959577017584531, 0.05305432577242599, 3.509348545772356, 0.0025064527072018636, 0.0023935760967489566, 0.08350036929501166, 0.06612575675332716, 0.031883106565238975, 0.0025052006909329237, 0.1230797473441448, 0.18629248774889007, 0.07438145920367399, 0.7604126161858157, 2.6382185622935785, 0.7617417988053744, 0.13010532817878942, 0.04514937584062887, -9.949881154590164, 0.02833287492392819, 0.10512725458928883, 0.12081970846133763, 0.09656490568139686, 0.04321782135929947, 6.736516265019486, -8.040982196751905, 0.09629264551838124, -9.883602634208364, 0.13058938658645353, 0.6080332602359008, 0.050123062726570446, 0.05008273806293365, 0.5939260851748782, 0.002873785714686374, -9.388750334431743, 0.11314330812734243, 0.0021991180087633133, 0.6363462593489612, -19.870924900310413, 0.17531935082051298, 0.18399314976330483, 0.002298968181248827, 0.05145516467587903, -9.93614843758367, 0.3293599510250436, 0.8535784948424174, 0.21141653963735973, 0.002210831943946108, 0.0021254674857155965, 0.0020509447610639418, 0.09240359374167967, 0.1262248111149232, 5.582683841139749, 2.3506456392514257, 0.0449945820188049, 0.24153232123102286, 0.06169300487383599, 0.1337281803473617, -4.428147840615794, 0.002044524936460175, 3.3311815937639446, 1.9269196260756565, 0.5231977293625636, 2.325723904891489, 0.11750301219427656, 0.046082653651309195, 0.402911489064364, 0.6537517246184776, -9.87350860030287, -19.99725719670816], "episode_lengths": [25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 389.235026302357, "mean_inference_ms": 2.1668228287463633, "mean_action_processing_ms": 0.14959497459417082, "mean_env_wait_ms": 5.453209793108072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010654926300048828, "StateBufferConnector_ms": 0.006998777389526367, "ViewRequirementAgentConnector_ms": 0.18591880798339844}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 31200, "num_env_steps_sampled": 17000, "num_env_steps_trained": 31200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.588429126407272, "num_env_steps_trained_throughput_per_sec": 6.9974367964941795, "timesteps_total": 17000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 17000, "timers": {"training_iteration_time_ms": 11128.945, "sample_time_ms": 11067.166, "load_time_ms": 0.264, "load_throughput": 295667.16, "learn_time_ms": 12.896, "learn_throughput": 6048.269, "synch_weights_time_ms": 11.534}, "counters": {"num_env_steps_sampled": 17000, "num_env_steps_trained": 31200, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 31200, "last_target_update_ts": 16640, "num_target_updates": 31}, "done": false, "episodes_total": 606, "training_iteration": 17, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-16-26", "timestamp": 1713410186, "time_this_iter_s": 278.681312084198, "time_total_s": 3939.0539243221283, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3939.0539243221283, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 10.687405541561711, "ram_util_percent": 15.878589420654915}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0018775324570015073, "cur_lr": 0.01}, "td_error": [2.0996811389923096, 2.1016881465911865, 1.5169501304626465, 2.109426259994507, 2.1025946140289307, 1.553173303604126, 2.101525068283081, 2.100102186203003, 2.0987586975097656, 2.1021735668182373, 2.1027722358703613, 1.9139691591262817, 2.100785732269287, 1.8952707052230835, 1.9145152568817139, 2.0967254638671875, 2.0995662212371826, 1.3285623788833618, 2.096731424331665, 2.099534273147583, 2.096773624420166, 2.1108498573303223, 1.2619893550872803, 2.0991570949554443, 2.13643741607666, 2.0967519283294678, 1.2247885465621948, 2.0967628955841064, 2.099395751953125, 2.10320782661438, 1.2249677181243896, 2.0991692543029785, 3.3312482833862305, 2.0967166423797607, 3.0517256259918213, 2.0993402004241943, 2.097810983657837, 2.099573850631714, 1.5170774459838867, 2.112968683242798, 2.099674701690674, 2.10086989402771, 1.5169436931610107, 2.103367328643799, 2.1002564430236816, 2.0996198654174805, 2.0968313217163086, 2.105602264404297, 1.5526330471038818, 1.3615050315856934, 2.1019959449768066, 2.098094940185547, 2.0981216430664062, 2.1001384258270264, 2.0992374420166016, 1.5526344776153564, 2.0993833541870117, 1.8946679830551147, 2.099651575088501, 2.097618579864502, 1.5130103826522827, 1.916519284248352, 2.1095855236053467, 1.2265948057174683, 2.096717357635498, 1.5528113842010498, 2.099583148956299, 1.51694655418396, 2.096736431121826, 2.099311113357544, 2.0968210697174072, 2.0991787910461426, 2.0991663932800293, 1.910923957824707, 2.1006386280059814, 2.0967772006988525, 1.9015109539031982, 2.096719264984131], "mean_td_error": 1.9820462465286255, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 425.0, "diff_num_grad_updates_vs_sampler_policy": 424.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 33150, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 33150, "last_target_update_ts": 17680, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": 6.736516265019486, "episode_reward_min": -19.99725719670816, "episode_reward_mean": -0.7757398343082086, "episode_len_mean": 25.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.1230797473441448, 0.18629248774889007, 0.07438145920367399, 0.7604126161858157, 2.6382185622935785, 0.7617417988053744, 0.13010532817878942, 0.04514937584062887, -9.949881154590164, 0.02833287492392819, 0.10512725458928883, 0.12081970846133763, 0.09656490568139686, 0.04321782135929947, 6.736516265019486, -8.040982196751905, 0.09629264551838124, -9.883602634208364, 0.13058938658645353, 0.6080332602359008, 0.050123062726570446, 0.05008273806293365, 0.5939260851748782, 0.002873785714686374, -9.388750334431743, 0.11314330812734243, 0.0021991180087633133, 0.6363462593489612, -19.870924900310413, 0.17531935082051298, 0.18399314976330483, 0.002298968181248827, 0.05145516467587903, -9.93614843758367, 0.3293599510250436, 0.8535784948424174, 0.21141653963735973, 0.002210831943946108, 0.0021254674857155965, 0.0020509447610639418, 0.09240359374167967, 0.1262248111149232, 5.582683841139749, 2.3506456392514257, 0.0449945820188049, 0.24153232123102286, 0.06169300487383599, 0.1337281803473617, -4.428147840615794, 0.002044524936460175, 3.3311815937639446, 1.9269196260756565, 0.5231977293625636, 2.325723904891489, 0.11750301219427656, 0.046082653651309195, 0.402911489064364, 0.6537517246184776, -9.87350860030287, -19.99725719670816, 2.005479081628492, -9.65903808760148, 2.776812395005789, 0.7405361308519888, 0.4356744992527259, 0.14741162769223776, 0.4880813825612872, 1.459936304511318, 0.4195711552339725, 0.24061298121401606, 0.17457703059090252, 2.6566850024217965, 0.2388939676601424, -9.855682229357763, 1.1312467942237485, 0.1934779545902809, 0.43119804194241823, 0.3413192303283751, 1.1758559499354961, 0.3645960125776551, 0.0870139795382974, 0.6141827217267228, -9.775241727458873, 0.5307531762907942, 0.1089852347501499, 0.3442210097813731, 0.49451602502948366, 0.31551296494209347, 0.18446726844059216, -9.71397150083842, 2.3602601056244765, 0.14330938538192073, 1.0345726192791005, 0.4683772765386817, 1.244242080814773, 0.200959170031486, 3.1250385502269173, -4.34691247478605, 6.272802811188142, 0.28428501236282067], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 392.1960869363809, "mean_inference_ms": 2.1700939116706275, "mean_action_processing_ms": 0.14971493491816287, "mean_env_wait_ms": 5.139237496981207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011775016784667969, "StateBufferConnector_ms": 0.006991386413574219, "ViewRequirementAgentConnector_ms": 0.19014906883239746}}, "episode_reward_max": 6.736516265019486, "episode_reward_min": -19.99725719670816, "episode_reward_mean": -0.7757398343082086, "episode_len_mean": 25.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.1230797473441448, 0.18629248774889007, 0.07438145920367399, 0.7604126161858157, 2.6382185622935785, 0.7617417988053744, 0.13010532817878942, 0.04514937584062887, -9.949881154590164, 0.02833287492392819, 0.10512725458928883, 0.12081970846133763, 0.09656490568139686, 0.04321782135929947, 6.736516265019486, -8.040982196751905, 0.09629264551838124, -9.883602634208364, 0.13058938658645353, 0.6080332602359008, 0.050123062726570446, 0.05008273806293365, 0.5939260851748782, 0.002873785714686374, -9.388750334431743, 0.11314330812734243, 0.0021991180087633133, 0.6363462593489612, -19.870924900310413, 0.17531935082051298, 0.18399314976330483, 0.002298968181248827, 0.05145516467587903, -9.93614843758367, 0.3293599510250436, 0.8535784948424174, 0.21141653963735973, 0.002210831943946108, 0.0021254674857155965, 0.0020509447610639418, 0.09240359374167967, 0.1262248111149232, 5.582683841139749, 2.3506456392514257, 0.0449945820188049, 0.24153232123102286, 0.06169300487383599, 0.1337281803473617, -4.428147840615794, 0.002044524936460175, 3.3311815937639446, 1.9269196260756565, 0.5231977293625636, 2.325723904891489, 0.11750301219427656, 0.046082653651309195, 0.402911489064364, 0.6537517246184776, -9.87350860030287, -19.99725719670816, 2.005479081628492, -9.65903808760148, 2.776812395005789, 0.7405361308519888, 0.4356744992527259, 0.14741162769223776, 0.4880813825612872, 1.459936304511318, 0.4195711552339725, 0.24061298121401606, 0.17457703059090252, 2.6566850024217965, 0.2388939676601424, -9.855682229357763, 1.1312467942237485, 0.1934779545902809, 0.43119804194241823, 0.3413192303283751, 1.1758559499354961, 0.3645960125776551, 0.0870139795382974, 0.6141827217267228, -9.775241727458873, 0.5307531762907942, 0.1089852347501499, 0.3442210097813731, 0.49451602502948366, 0.31551296494209347, 0.18446726844059216, -9.71397150083842, 2.3602601056244765, 0.14330938538192073, 1.0345726192791005, 0.4683772765386817, 1.244242080814773, 0.200959170031486, 3.1250385502269173, -4.34691247478605, 6.272802811188142, 0.28428501236282067], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 392.1960869363809, "mean_inference_ms": 2.1700939116706275, "mean_action_processing_ms": 0.14971493491816287, "mean_env_wait_ms": 5.139237496981207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011775016784667969, "StateBufferConnector_ms": 0.006991386413574219, "ViewRequirementAgentConnector_ms": 0.19014906883239746}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 33150, "num_env_steps_sampled": 18000, "num_env_steps_trained": 33150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.555588119993463, "num_env_steps_trained_throughput_per_sec": 6.933396833987253, "timesteps_total": 18000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 11266.075, "sample_time_ms": 11203.806, "load_time_ms": 0.247, "load_throughput": 315178.913, "learn_time_ms": 13.39, "learn_throughput": 5825.101, "synch_weights_time_ms": 11.618}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 33150, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 33150, "last_target_update_ts": 17680, "num_target_updates": 33}, "done": false, "episodes_total": 646, "training_iteration": 18, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-21-07", "timestamp": 1713410467, "time_this_iter_s": 281.25680708885193, "time_total_s": 4220.31073141098, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 4220.31073141098, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 10.936999999999998, "ram_util_percent": 16.00425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.003775459248572588, "cur_lr": 0.01}, "td_error": [2.039158582687378, 1.8626171350479126, 1.4752421379089355, 1.880469799041748, 2.054170846939087, 2.0392658710479736, 1.8769923448562622, 0.5255087018013, 2.039048910140991, 2.0391790866851807, 1.9427720308303833, 1.5025962591171265, 1.1389796733856201, 1.880469799041748, 2.044450283050537, 2.0400776863098145, 2.044367790222168, 2.0390682220458984, 2.0399112701416016, 1.4752309322357178, 2.0523974895477295, 2.044407367706299, 1.8205362558364868, 2.0605053901672363, 2.0443899631500244, 2.0446066856384277, 2.045457363128662, 2.042635917663574, 2.044405221939087, 1.475233554840088, 0.5255087018013, 0.5811632871627808, 1.4752438068389893, 1.5212478637695312, 1.1702826023101807, 1.4753776788711548, 2.0390610694885254, 2.0511927604675293, 1.864366888999939, 1.4752349853515625, 2.0774848461151123, 1.4752306938171387, 2.051723003387451, 2.0443918704986572, 2.0390806198120117, 2.0390775203704834, 1.1704758405685425, 2.0390429496765137, 2.039050817489624, 1.1702826023101807, 2.0443906784057617, 2.050858497619629, 2.039057731628418, 1.7264553308486938, 2.039062261581421, 1.884901523590088, 2.0390682220458984, 2.050935983657837, 2.045009136199951, 1.1405225992202759, 2.0398004055023193, 2.044351577758789, 1.8626046180725098, 2.0390625, 2.039050340652466, 1.4752315282821655, 2.0471577644348145, 2.0397698879241943, 2.0510942935943604, 2.0396971702575684, 2.0399837493896484, 2.0396955013275146, 2.0523433685302734, 2.0449931621551514, 2.04440975189209, 2.0410726070404053, 1.9338289499282837, 2.0462348461151123], "mean_td_error": 1.8328118324279785, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 450.0, "diff_num_grad_updates_vs_sampler_policy": 449.0}}, "num_env_steps_sampled": 19000, "num_env_steps_trained": 35100, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 35100, "last_target_update_ts": 18720, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": 6.272802811188142, "episode_reward_min": -19.99725719670816, "episode_reward_mean": -0.5059470733255425, "episode_len_mean": 25.12, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0020509447610639418, 0.09240359374167967, 0.1262248111149232, 5.582683841139749, 2.3506456392514257, 0.0449945820188049, 0.24153232123102286, 0.06169300487383599, 0.1337281803473617, -4.428147840615794, 0.002044524936460175, 3.3311815937639446, 1.9269196260756565, 0.5231977293625636, 2.325723904891489, 0.11750301219427656, 0.046082653651309195, 0.402911489064364, 0.6537517246184776, -9.87350860030287, -19.99725719670816, 2.005479081628492, -9.65903808760148, 2.776812395005789, 0.7405361308519888, 0.4356744992527259, 0.14741162769223776, 0.4880813825612872, 1.459936304511318, 0.4195711552339725, 0.24061298121401606, 0.17457703059090252, 2.6566850024217965, 0.2388939676601424, -9.855682229357763, 1.1312467942237485, 0.1934779545902809, 0.43119804194241823, 0.3413192303283751, 1.1758559499354961, 0.3645960125776551, 0.0870139795382974, 0.6141827217267228, -9.775241727458873, 0.5307531762907942, 0.1089852347501499, 0.3442210097813731, 0.49451602502948366, 0.31551296494209347, 0.18446726844059216, -9.71397150083842, 2.3602601056244765, 0.14330938538192073, 1.0345726192791005, 0.4683772765386817, 1.244242080814773, 0.200959170031486, 3.1250385502269173, -4.34691247478605, 6.272802811188142, 0.28428501236282067, 0.1554440630939879, 1.0196547776988127, 0.053576524723419505, 0.035705307713259034, 0.035865058052584275, 0.29722292068094047, 0.20382746664344736, 0.09413328931607616, 0.0672139483137599, 0.30635143678180254, 0.06621206887362431, 0.06947353483509189, 0.047945143935933146, 0.03195817742102722, 0.02156474281075674, 0.1250259508468005, 0.12490687960747654, 0.061385354370427636, 0.0420277795224608, 0.037165974879709164, 0.06267811431034111, -9.92174513599116, 0.045107208097234085, 0.011825082503523867, 0.2682495075064375, 0.16385640834470422, 0.12995798718110377, 0.07832053943416553, 0.08958022853901257, -9.672733595803368, -9.820543115699556, 0.06901470825580519, 0.06507145886409575, 0.04777280680326132, 0.3637148471540504, 0.2558155568169696, 0.584263270959258, 0.04914691302380888, 0.08830102348518726], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 394.5916736868325, "mean_inference_ms": 2.173095064084709, "mean_action_processing_ms": 0.1498529555101878, "mean_env_wait_ms": 4.864654085181224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012108325958251953, "StateBufferConnector_ms": 0.006904125213623047, "ViewRequirementAgentConnector_ms": 0.18858766555786133}}, "episode_reward_max": 6.272802811188142, "episode_reward_min": -19.99725719670816, "episode_reward_mean": -0.5059470733255425, "episode_len_mean": 25.12, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0020509447610639418, 0.09240359374167967, 0.1262248111149232, 5.582683841139749, 2.3506456392514257, 0.0449945820188049, 0.24153232123102286, 0.06169300487383599, 0.1337281803473617, -4.428147840615794, 0.002044524936460175, 3.3311815937639446, 1.9269196260756565, 0.5231977293625636, 2.325723904891489, 0.11750301219427656, 0.046082653651309195, 0.402911489064364, 0.6537517246184776, -9.87350860030287, -19.99725719670816, 2.005479081628492, -9.65903808760148, 2.776812395005789, 0.7405361308519888, 0.4356744992527259, 0.14741162769223776, 0.4880813825612872, 1.459936304511318, 0.4195711552339725, 0.24061298121401606, 0.17457703059090252, 2.6566850024217965, 0.2388939676601424, -9.855682229357763, 1.1312467942237485, 0.1934779545902809, 0.43119804194241823, 0.3413192303283751, 1.1758559499354961, 0.3645960125776551, 0.0870139795382974, 0.6141827217267228, -9.775241727458873, 0.5307531762907942, 0.1089852347501499, 0.3442210097813731, 0.49451602502948366, 0.31551296494209347, 0.18446726844059216, -9.71397150083842, 2.3602601056244765, 0.14330938538192073, 1.0345726192791005, 0.4683772765386817, 1.244242080814773, 0.200959170031486, 3.1250385502269173, -4.34691247478605, 6.272802811188142, 0.28428501236282067, 0.1554440630939879, 1.0196547776988127, 0.053576524723419505, 0.035705307713259034, 0.035865058052584275, 0.29722292068094047, 0.20382746664344736, 0.09413328931607616, 0.0672139483137599, 0.30635143678180254, 0.06621206887362431, 0.06947353483509189, 0.047945143935933146, 0.03195817742102722, 0.02156474281075674, 0.1250259508468005, 0.12490687960747654, 0.061385354370427636, 0.0420277795224608, 0.037165974879709164, 0.06267811431034111, -9.92174513599116, 0.045107208097234085, 0.011825082503523867, 0.2682495075064375, 0.16385640834470422, 0.12995798718110377, 0.07832053943416553, 0.08958022853901257, -9.672733595803368, -9.820543115699556, 0.06901470825580519, 0.06507145886409575, 0.04777280680326132, 0.3637148471540504, 0.2558155568169696, 0.584263270959258, 0.04914691302380888, 0.08830102348518726], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 394.5916736868325, "mean_inference_ms": 2.173095064084709, "mean_action_processing_ms": 0.1498529555101878, "mean_env_wait_ms": 4.864654085181224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012108325958251953, "StateBufferConnector_ms": 0.006904125213623047, "ViewRequirementAgentConnector_ms": 0.18858766555786133}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 35100, "num_env_steps_sampled": 19000, "num_env_steps_trained": 35100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.571528120042155, "num_env_steps_trained_throughput_per_sec": 6.964479834082202, "timesteps_total": 19000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 19000, "timers": {"training_iteration_time_ms": 11210.89, "sample_time_ms": 11149.342, "load_time_ms": 0.247, "load_throughput": 316367.578, "learn_time_ms": 13.26, "learn_throughput": 5882.276, "synch_weights_time_ms": 10.987}, "counters": {"num_env_steps_sampled": 19000, "num_env_steps_trained": 35100, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 35100, "last_target_update_ts": 18720, "num_target_updates": 35}, "done": false, "episodes_total": 685, "training_iteration": 19, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-25-47", "timestamp": 1713410747, "time_this_iter_s": 280.00125098228455, "time_total_s": 4500.311982393265, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 4500.311982393265, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 10.709547738693466, "ram_util_percent": 16.155025125628136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.001523318118415773, "cur_lr": 0.01}, "td_error": [2.009573221206665, 2.0477800369262695, 1.9995354413986206, 1.9995973110198975, 2.0066428184509277, 1.9888672828674316, 1.9888652563095093, 2.000629425048828, 1.402897834777832, 1.9996192455291748, 2.0194380283355713, 2.0000524520874023, 2.0060832500457764, 1.9996428489685059, 1.9982435703277588, 1.489775538444519, 1.9888710975646973, 1.9995622634887695, 2.124812126159668, 1.0987722873687744, 2.084716558456421, 1.9889055490493774, 1.9888901710510254, 2.1913106441497803, 1.1614556312561035, 2.028778314590454, 0.60904860496521, 1.9888724088668823, 1.1661195755004883, 1.9890129566192627, 1.9890553951263428, 1.9908709526062012, 2.000196933746338, 2.001709461212158, 2.1036376953125, 1.9888641834259033, 1.1586488485336304, 1.9888755083084106, 2.02337646484375, 2.164714813232422, 2.0012025833129883, 2.014855146408081, 1.7896547317504883, 2.00105619430542, 1.9888712167739868, 2.1113576889038086, 3.2587172985076904, 1.9996353387832642, 2.0142972469329834, 2.864468812942505, 1.098260760307312, 1.9167976379394531, 1.9995274543762207, 1.4545583724975586, 1.9995359182357788, 1.9888662099838257, 1.9888675212860107, 1.4025518894195557, 2.023341178894043, 2.9140849113464355, 1.9889081716537476, 1.98886239528656, 1.9999299049377441, 1.9888713359832764, 1.4028911590576172, 1.9888888597488403, 2.0059664249420166, 2.005995273590088, 2.0006070137023926, 2.088167190551758, 1.9888724088668823, 1.879635214805603, 2.00579833984375, 2.0400638580322266, 2.005936861038208, 1.8966847658157349, 1.9966838359832764, 1.9888677597045898], "mean_td_error": 1.9342108964920044, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 475.0, "diff_num_grad_updates_vs_sampler_policy": 474.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 37050, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 37050, "last_target_update_ts": 19760, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": 6.272802811188142, "episode_reward_min": -9.998585172898721, "episode_reward_mean": -0.43378615124032843, "episode_len_mean": 25.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3645960125776551, 0.0870139795382974, 0.6141827217267228, -9.775241727458873, 0.5307531762907942, 0.1089852347501499, 0.3442210097813731, 0.49451602502948366, 0.31551296494209347, 0.18446726844059216, -9.71397150083842, 2.3602601056244765, 0.14330938538192073, 1.0345726192791005, 0.4683772765386817, 1.244242080814773, 0.200959170031486, 3.1250385502269173, -4.34691247478605, 6.272802811188142, 0.28428501236282067, 0.1554440630939879, 1.0196547776988127, 0.053576524723419505, 0.035705307713259034, 0.035865058052584275, 0.29722292068094047, 0.20382746664344736, 0.09413328931607616, 0.0672139483137599, 0.30635143678180254, 0.06621206887362431, 0.06947353483509189, 0.047945143935933146, 0.03195817742102722, 0.02156474281075674, 0.1250259508468005, 0.12490687960747654, 0.061385354370427636, 0.0420277795224608, 0.037165974879709164, 0.06267811431034111, -9.92174513599116, 0.045107208097234085, 0.011825082503523867, 0.2682495075064375, 0.16385640834470422, 0.12995798718110377, 0.07832053943416553, 0.08958022853901257, -9.672733595803368, -9.820543115699556, 0.06901470825580519, 0.06507145886409575, 0.04777280680326132, 0.3637148471540504, 0.2558155568169696, 0.584263270959258, 0.04914691302380888, 0.08830102348518726, 0.02085491788154642, 0.0015971755292390217, 0.001551581562579168, 0.003722902495569905, 0.001466181463973503, 0.09057016573520495, 0.06135210555775629, 1.7248517573441875, 0.0014265216373439092, 0.8160530479562587, 0.002998080670141281, 1.201217388525737, 0.06152312053203971, 0.0014767934718071364, 0.001436514491677206, 0.04304964449557059, 0.0015423629838799738, 0.0014979300094397593, 0.0014576131844258296, 0.09670298672039711, -9.97566347542963, 0.0015802894584105458, 0.08365479952656271, 0.001492142794896625, 0.1661357611826729, 0.02021328770388954, 0.0015356707687457195, 0.9614030968729007, 0.001452780247986411, -9.998585172898721, 0.02489942649149953, 0.0015460673962468985, 0.001501423681656951, 0.34346088338431136, 0.00142213261970009, 0.08582489315779047, 0.18901573047361306, 0.00154535331150953, 0.37485563499195496, 0.0014614426339744449], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 396.9812533451214, "mean_inference_ms": 2.1739872122033854, "mean_action_processing_ms": 0.14984909005898456, "mean_env_wait_ms": 4.615008505888937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011400699615478516, "StateBufferConnector_ms": 0.0070683956146240234, "ViewRequirementAgentConnector_ms": 0.18534255027770996}}, "episode_reward_max": 6.272802811188142, "episode_reward_min": -9.998585172898721, "episode_reward_mean": -0.43378615124032843, "episode_len_mean": 25.08, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.3645960125776551, 0.0870139795382974, 0.6141827217267228, -9.775241727458873, 0.5307531762907942, 0.1089852347501499, 0.3442210097813731, 0.49451602502948366, 0.31551296494209347, 0.18446726844059216, -9.71397150083842, 2.3602601056244765, 0.14330938538192073, 1.0345726192791005, 0.4683772765386817, 1.244242080814773, 0.200959170031486, 3.1250385502269173, -4.34691247478605, 6.272802811188142, 0.28428501236282067, 0.1554440630939879, 1.0196547776988127, 0.053576524723419505, 0.035705307713259034, 0.035865058052584275, 0.29722292068094047, 0.20382746664344736, 0.09413328931607616, 0.0672139483137599, 0.30635143678180254, 0.06621206887362431, 0.06947353483509189, 0.047945143935933146, 0.03195817742102722, 0.02156474281075674, 0.1250259508468005, 0.12490687960747654, 0.061385354370427636, 0.0420277795224608, 0.037165974879709164, 0.06267811431034111, -9.92174513599116, 0.045107208097234085, 0.011825082503523867, 0.2682495075064375, 0.16385640834470422, 0.12995798718110377, 0.07832053943416553, 0.08958022853901257, -9.672733595803368, -9.820543115699556, 0.06901470825580519, 0.06507145886409575, 0.04777280680326132, 0.3637148471540504, 0.2558155568169696, 0.584263270959258, 0.04914691302380888, 0.08830102348518726, 0.02085491788154642, 0.0015971755292390217, 0.001551581562579168, 0.003722902495569905, 0.001466181463973503, 0.09057016573520495, 0.06135210555775629, 1.7248517573441875, 0.0014265216373439092, 0.8160530479562587, 0.002998080670141281, 1.201217388525737, 0.06152312053203971, 0.0014767934718071364, 0.001436514491677206, 0.04304964449557059, 0.0015423629838799738, 0.0014979300094397593, 0.0014576131844258296, 0.09670298672039711, -9.97566347542963, 0.0015802894584105458, 0.08365479952656271, 0.001492142794896625, 0.1661357611826729, 0.02021328770388954, 0.0015356707687457195, 0.9614030968729007, 0.001452780247986411, -9.998585172898721, 0.02489942649149953, 0.0015460673962468985, 0.001501423681656951, 0.34346088338431136, 0.00142213261970009, 0.08582489315779047, 0.18901573047361306, 0.00154535331150953, 0.37485563499195496, 0.0014614426339744449], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 396.9812533451214, "mean_inference_ms": 2.1739872122033854, "mean_action_processing_ms": 0.14984909005898456, "mean_env_wait_ms": 4.615008505888937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011400699615478516, "StateBufferConnector_ms": 0.0070683956146240234, "ViewRequirementAgentConnector_ms": 0.18534255027770996}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 37050, "num_env_steps_sampled": 20000, "num_env_steps_trained": 37050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.581003530599906, "num_env_steps_trained_throughput_per_sec": 6.982956884669816, "timesteps_total": 20000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11288.929, "sample_time_ms": 11224.168, "load_time_ms": 0.256, "load_throughput": 305097.185, "learn_time_ms": 13.482, "learn_throughput": 5785.298, "synch_weights_time_ms": 11.491}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 37050, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 37050, "last_target_update_ts": 19760, "num_target_updates": 37}, "done": false, "episodes_total": 725, "training_iteration": 20, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-30-26", "timestamp": 1713411026, "time_this_iter_s": 279.25956082344055, "time_total_s": 4779.571543216705, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 4779.571543216705, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 10.97286432160804, "ram_util_percent": 16.320351758793976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0028038150630891323, "cur_lr": 0.01}, "td_error": [1.9629664421081543, 1.3517613410949707, 1.9629572629928589, 1.9692699909210205, 1.978559970855713, 1.9793145656585693, 2.058972120285034, 1.4300875663757324, 1.129408597946167, 2.8303768634796143, 1.9629547595977783, 1.8523616790771484, 1.964544415473938, 1.9629664421081543, 1.3517844676971436, 1.9629725217819214, 1.9629708528518677, 1.9629709720611572, 1.978529691696167, 1.9872621297836304, 1.978973627090454, 1.4309359788894653, 1.9629745483398438, 1.8563789129257202, 1.1342107057571411, 1.9785360097885132, 1.97859525680542, 1.1127172708511353, 1.9630167484283447, 1.982879877090454, 2.0162606239318848, 1.9798132181167603, 1.4308433532714844, 1.9892792701721191, 1.9629672765731812, 1.9796491861343384, 1.8492388725280762, 1.9785292148590088, 1.978556752204895, 1.9876203536987305, 1.4308178424835205, 1.9869548082351685, 1.9629544019699097, 0.5496423244476318, 1.9785287380218506, 1.987026333808899, 1.114571452140808, 1.9785362482070923, 1.9651626348495483, 1.9629590511322021, 1.9026254415512085, 1.9636653661727905, 1.978545069694519, 1.978184700012207, 1.3517792224884033, 1.96327543258667, 1.9814422130584717, 1.962958574295044, 1.962984323501587, 1.7322689294815063, 1.9629642963409424, 1.9629557132720947, 1.9629586935043335, 1.978535532951355, 1.963006615638733, 1.9785714149475098, 1.962979793548584, 1.1317983865737915, 1.96297287940979, 1.9790054559707642, 2.1949799060821533, 1.3517839908599854, 1.9632518291473389, 1.9629539251327515, 1.962962031364441, 1.962953805923462, 1.9634336233139038, 1.98905611038208], "mean_td_error": 1.8464995622634888, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 499.0}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 39000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 39000, "last_target_update_ts": 20800, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": 1.8481482886026934, "episode_reward_min": -9.998619141487854, "episode_reward_mean": -0.6540577671795398, "episode_len_mean": 25.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.037165974879709164, 0.06267811431034111, -9.92174513599116, 0.045107208097234085, 0.011825082503523867, 0.2682495075064375, 0.16385640834470422, 0.12995798718110377, 0.07832053943416553, 0.08958022853901257, -9.672733595803368, -9.820543115699556, 0.06901470825580519, 0.06507145886409575, 0.04777280680326132, 0.3637148471540504, 0.2558155568169696, 0.584263270959258, 0.04914691302380888, 0.08830102348518726, 0.02085491788154642, 0.0015971755292390217, 0.001551581562579168, 0.003722902495569905, 0.001466181463973503, 0.09057016573520495, 0.06135210555775629, 1.7248517573441875, 0.0014265216373439092, 0.8160530479562587, 0.002998080670141281, 1.201217388525737, 0.06152312053203971, 0.0014767934718071364, 0.001436514491677206, 0.04304964449557059, 0.0015423629838799738, 0.0014979300094397593, 0.0014576131844258296, 0.09670298672039711, -9.97566347542963, 0.0015802894584105458, 0.08365479952656271, 0.001492142794896625, 0.1661357611826729, 0.02021328770388954, 0.0015356707687457195, 0.9614030968729007, 0.001452780247986411, -9.998585172898721, 0.02489942649149953, 0.0015460673962468985, 0.001501423681656951, 0.34346088338431136, 0.00142213261970009, 0.08582489315779047, 0.18901573047361306, 0.00154535331150953, 0.37485563499195496, 0.0014614426339744449, 0.0014264721653489104, 0.0013849466726667567, 0.0013471546655856614, 0.0013169486861089716, 0.0012881052595466451, 0.0013498018915185398, 0.1616110918856626, 1.3464497472375085, 0.0012587432875988077, 0.3259026513142146, -9.998605585484537, 0.004880939062811808, -9.656669106171291, 0.12042041031573489, 0.0012646073378722528, 0.006504911179693754, 0.0013444653863162687, 0.0013143785957761434, 0.001285646268536316, 0.0012521928842408256, 0.001414305732941312, 0.054729156871258094, 0.0013397015986207836, 0.11162664999686854, 0.0012825835068762067, 0.001377815681519727, 1.8481482886026934, 0.675646827156658, 0.0012790524136039596, 0.0012518259520220767, -9.998619141487854, 0.0013432835650717654, 0.0013132490799624493, 0.0012845655130389712, 0.001251167664821215, 0.0014178891933111877, 0.0013783024377533955, 0.0013466991982037755, 0.1378791066251005, 0.0012826810192799903], "episode_lengths": [25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 399.0674503587125, "mean_inference_ms": 2.1750369320686116, "mean_action_processing_ms": 0.1498376133072516, "mean_env_wait_ms": 4.389770347132531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010491132736206055, "StateBufferConnector_ms": 0.007008790969848633, "ViewRequirementAgentConnector_ms": 0.18154025077819824}}, "episode_reward_max": 1.8481482886026934, "episode_reward_min": -9.998619141487854, "episode_reward_mean": -0.6540577671795398, "episode_len_mean": 25.08, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.037165974879709164, 0.06267811431034111, -9.92174513599116, 0.045107208097234085, 0.011825082503523867, 0.2682495075064375, 0.16385640834470422, 0.12995798718110377, 0.07832053943416553, 0.08958022853901257, -9.672733595803368, -9.820543115699556, 0.06901470825580519, 0.06507145886409575, 0.04777280680326132, 0.3637148471540504, 0.2558155568169696, 0.584263270959258, 0.04914691302380888, 0.08830102348518726, 0.02085491788154642, 0.0015971755292390217, 0.001551581562579168, 0.003722902495569905, 0.001466181463973503, 0.09057016573520495, 0.06135210555775629, 1.7248517573441875, 0.0014265216373439092, 0.8160530479562587, 0.002998080670141281, 1.201217388525737, 0.06152312053203971, 0.0014767934718071364, 0.001436514491677206, 0.04304964449557059, 0.0015423629838799738, 0.0014979300094397593, 0.0014576131844258296, 0.09670298672039711, -9.97566347542963, 0.0015802894584105458, 0.08365479952656271, 0.001492142794896625, 0.1661357611826729, 0.02021328770388954, 0.0015356707687457195, 0.9614030968729007, 0.001452780247986411, -9.998585172898721, 0.02489942649149953, 0.0015460673962468985, 0.001501423681656951, 0.34346088338431136, 0.00142213261970009, 0.08582489315779047, 0.18901573047361306, 0.00154535331150953, 0.37485563499195496, 0.0014614426339744449, 0.0014264721653489104, 0.0013849466726667567, 0.0013471546655856614, 0.0013169486861089716, 0.0012881052595466451, 0.0013498018915185398, 0.1616110918856626, 1.3464497472375085, 0.0012587432875988077, 0.3259026513142146, -9.998605585484537, 0.004880939062811808, -9.656669106171291, 0.12042041031573489, 0.0012646073378722528, 0.006504911179693754, 0.0013444653863162687, 0.0013143785957761434, 0.001285646268536316, 0.0012521928842408256, 0.001414305732941312, 0.054729156871258094, 0.0013397015986207836, 0.11162664999686854, 0.0012825835068762067, 0.001377815681519727, 1.8481482886026934, 0.675646827156658, 0.0012790524136039596, 0.0012518259520220767, -9.998619141487854, 0.0013432835650717654, 0.0013132490799624493, 0.0012845655130389712, 0.001251167664821215, 0.0014178891933111877, 0.0013783024377533955, 0.0013466991982037755, 0.1378791066251005, 0.0012826810192799903], "episode_lengths": [25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 399.0674503587125, "mean_inference_ms": 2.1750369320686116, "mean_action_processing_ms": 0.1498376133072516, "mean_env_wait_ms": 4.389770347132531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010491132736206055, "StateBufferConnector_ms": 0.007008790969848633, "ViewRequirementAgentConnector_ms": 0.18154025077819824}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 39000, "num_env_steps_sampled": 21000, "num_env_steps_trained": 39000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5841617387986213, "num_env_steps_trained_throughput_per_sec": 6.989115390657312, "timesteps_total": 21000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 11155.012, "sample_time_ms": 11092.477, "load_time_ms": 0.242, "load_throughput": 322957.268, "learn_time_ms": 13.116, "learn_throughput": 5947.161, "synch_weights_time_ms": 11.039}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 39000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 39000, "last_target_update_ts": 20800, "num_target_updates": 39}, "done": false, "episodes_total": 765, "training_iteration": 21, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-35-05", "timestamp": 1713411305, "time_this_iter_s": 279.0151689052582, "time_total_s": 5058.5867121219635, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5058.5867121219635, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 10.933249370277078, "ram_util_percent": 16.460201511335015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.001648632576689124, "cur_lr": 0.01}, "td_error": [1.9595370292663574, 0.5641816258430481, 2.0738537311553955, 1.9584903717041016, 0.5009585618972778, 1.9445558786392212, 1.1145457029342651, 2.044724941253662, 1.9733598232269287, 1.9445561170578003, 1.971398949623108, 1.9445613622665405, 1.9445558786392212, 1.9445624351501465, 1.6695785522460938, 1.9445527791976929, 1.377040147781372, 1.944563627243042, 1.972228765487671, 1.944556474685669, 2.1015822887420654, 1.970524549484253, 1.9537227153778076, 1.9445616006851196, 1.944563627243042, 1.9450019598007202, 0.5009585618972778, 1.9530524015426636, 1.9455198049545288, 1.3045709133148193, 1.944804310798645, 1.9583930969238281, 1.9716659784317017, 1.4571189880371094, 1.944990873336792, 1.9584269523620605, 1.9445571899414062, 1.9460042715072632, 1.906919240951538, 1.9445592164993286, 1.9583932161331177, 1.9445585012435913, 1.9732340574264526, 1.9715074300765991, 1.9447572231292725, 1.9584083557128906, 1.9715992212295532, 2.3074660301208496, 1.3779256343841553, 1.944627285003662, 1.9445550441741943, 1.3047802448272705, 1.958580493927002, 1.304801106452942, 1.971506953239441, 2.02447772026062, 1.9388480186462402, 1.8633337020874023, 1.9453926086425781, 1.1068497896194458, 1.1068497896194458, 1.9445571899414062, 1.9452216625213623, 1.972444772720337, 1.9445520639419556, 1.944810152053833, 1.9445686340332031, 1.9594720602035522, 1.9448765516281128, 1.9445918798446655, 1.971278190612793, 1.9725918769836426, 1.9584118127822876, 1.9445618391036987, 1.9445585012435913, 1.0632048845291138, 1.9583978652954102, 2.031358242034912], "mean_td_error": 1.8139712810516357, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 525.0, "diff_num_grad_updates_vs_sampler_policy": 524.0}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 40950, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 40950, "last_target_update_ts": 21840, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": 1.8481482886026934, "episode_reward_min": -9.998776767483184, "episode_reward_mean": -0.99372797536632, "episode_len_mean": 25.11, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.09670298672039711, -9.97566347542963, 0.0015802894584105458, 0.08365479952656271, 0.001492142794896625, 0.1661357611826729, 0.02021328770388954, 0.0015356707687457195, 0.9614030968729007, 0.001452780247986411, -9.998585172898721, 0.02489942649149953, 0.0015460673962468985, 0.001501423681656951, 0.34346088338431136, 0.00142213261970009, 0.08582489315779047, 0.18901573047361306, 0.00154535331150953, 0.37485563499195496, 0.0014614426339744449, 0.0014264721653489104, 0.0013849466726667567, 0.0013471546655856614, 0.0013169486861089716, 0.0012881052595466451, 0.0013498018915185398, 0.1616110918856626, 1.3464497472375085, 0.0012587432875988077, 0.3259026513142146, -9.998605585484537, 0.004880939062811808, -9.656669106171291, 0.12042041031573489, 0.0012646073378722528, 0.006504911179693754, 0.0013444653863162687, 0.0013143785957761434, 0.001285646268536316, 0.0012521928842408256, 0.001414305732941312, 0.054729156871258094, 0.0013397015986207836, 0.11162664999686854, 0.0012825835068762067, 0.001377815681519727, 1.8481482886026934, 0.675646827156658, 0.0012790524136039596, 0.0012518259520220767, -9.998619141487854, 0.0013432835650717654, 0.0013132490799624493, 0.0012845655130389712, 0.001251167664821215, 0.0014178891933111877, 0.0013783024377533955, 0.0013466991982037755, 0.1378791066251005, 0.0012826810192799903, -9.998745472123233, 0.0012265614865703352, 0.1359775554413124, 0.0011705249719807084, 0.001141201055229419, 0.001201951713793336, 0.0011750378608994677, 0.0011471785078009911, 0.0011189990383705473, 0.0010915291280697386, 0.001236197351618844, 0.565867699475277, 0.0011784313785920138, -9.906884373991891, 0.0012243317408931994, 0.0011964182239098222, -9.326271748424412, 0.0011386376668211572, 0.0011102077805420214, 0.0012492873897573607, 0.001221553942659249, 0.0011937654711639864, 0.0011650218832723186, 0.0011359697308865218, 0.0012200891241942544, 1.1966584616816913, 0.17547720401443379, 0.0011404807043770785, 0.0011126254572885953, -9.998776767483184, 0.0011954822483355868, 0.0011666569273599747, 0.0011375241589051, -9.876168551524355, -9.998746534852566, 0.0012242212690558173, 0.0011940109250662579, 0.001163513310421295, 0.06617989285406306], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 400.85364004332826, "mean_inference_ms": 2.1735803791682007, "mean_action_processing_ms": 0.14974604806427447, "mean_env_wait_ms": 4.19205861737608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01407313346862793, "StateBufferConnector_ms": 0.006693124771118164, "ViewRequirementAgentConnector_ms": 0.18121671676635742}}, "episode_reward_max": 1.8481482886026934, "episode_reward_min": -9.998776767483184, "episode_reward_mean": -0.99372797536632, "episode_len_mean": 25.11, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.09670298672039711, -9.97566347542963, 0.0015802894584105458, 0.08365479952656271, 0.001492142794896625, 0.1661357611826729, 0.02021328770388954, 0.0015356707687457195, 0.9614030968729007, 0.001452780247986411, -9.998585172898721, 0.02489942649149953, 0.0015460673962468985, 0.001501423681656951, 0.34346088338431136, 0.00142213261970009, 0.08582489315779047, 0.18901573047361306, 0.00154535331150953, 0.37485563499195496, 0.0014614426339744449, 0.0014264721653489104, 0.0013849466726667567, 0.0013471546655856614, 0.0013169486861089716, 0.0012881052595466451, 0.0013498018915185398, 0.1616110918856626, 1.3464497472375085, 0.0012587432875988077, 0.3259026513142146, -9.998605585484537, 0.004880939062811808, -9.656669106171291, 0.12042041031573489, 0.0012646073378722528, 0.006504911179693754, 0.0013444653863162687, 0.0013143785957761434, 0.001285646268536316, 0.0012521928842408256, 0.001414305732941312, 0.054729156871258094, 0.0013397015986207836, 0.11162664999686854, 0.0012825835068762067, 0.001377815681519727, 1.8481482886026934, 0.675646827156658, 0.0012790524136039596, 0.0012518259520220767, -9.998619141487854, 0.0013432835650717654, 0.0013132490799624493, 0.0012845655130389712, 0.001251167664821215, 0.0014178891933111877, 0.0013783024377533955, 0.0013466991982037755, 0.1378791066251005, 0.0012826810192799903, -9.998745472123233, 0.0012265614865703352, 0.1359775554413124, 0.0011705249719807084, 0.001141201055229419, 0.001201951713793336, 0.0011750378608994677, 0.0011471785078009911, 0.0011189990383705473, 0.0010915291280697386, 0.001236197351618844, 0.565867699475277, 0.0011784313785920138, -9.906884373991891, 0.0012243317408931994, 0.0011964182239098222, -9.326271748424412, 0.0011386376668211572, 0.0011102077805420214, 0.0012492873897573607, 0.001221553942659249, 0.0011937654711639864, 0.0011650218832723186, 0.0011359697308865218, 0.0012200891241942544, 1.1966584616816913, 0.17547720401443379, 0.0011404807043770785, 0.0011126254572885953, -9.998776767483184, 0.0011954822483355868, 0.0011666569273599747, 0.0011375241589051, -9.876168551524355, -9.998746534852566, 0.0012242212690558173, 0.0011940109250662579, 0.001163513310421295, 0.06617989285406306], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 400.85364004332826, "mean_inference_ms": 2.1735803791682007, "mean_action_processing_ms": 0.14974604806427447, "mean_env_wait_ms": 4.19205861737608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01407313346862793, "StateBufferConnector_ms": 0.006693124771118164, "ViewRequirementAgentConnector_ms": 0.18121671676635742}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 40950, "num_env_steps_sampled": 22000, "num_env_steps_trained": 40950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.897840757007441, "num_env_steps_trained_throughput_per_sec": 7.60078947616451, "timesteps_total": 22000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 8942.472, "sample_time_ms": 8880.996, "load_time_ms": 0.241, "load_throughput": 324012.788, "learn_time_ms": 12.821, "learn_throughput": 6083.822, "synch_weights_time_ms": 11.638}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 40950, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 40950, "last_target_update_ts": 21840, "num_target_updates": 41}, "done": false, "episodes_total": 804, "training_iteration": 22, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-39-22", "timestamp": 1713411562, "time_this_iter_s": 256.5617892742157, "time_total_s": 5315.148501396179, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5315.148501396179, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 11.489315068493152, "ram_util_percent": 16.5972602739726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0023938543163239956, "cur_lr": 0.01}, "td_error": [1.900034785270691, 1.9308750629425049, 1.277398705482483, 1.0586527585983276, 1.900038242340088, 1.9315799474716187, 1.4180092811584473, 1.9233317375183105, 1.9000338315963745, 2.1468546390533447, 1.921868085861206, 1.9002015590667725, 1.920864462852478, 1.9318671226501465, 1.9004998207092285, 1.9310208559036255, 1.9188120365142822, 1.900042176246643, 0.5129770636558533, 1.9201674461364746, 1.919988989830017, 1.9001708030700684, 1.900039792060852, 1.900038242340088, 1.9311985969543457, 2.1454899311065674, 1.900037407875061, 3.1022918224334717, 1.900337815284729, 1.9199358224868774, 1.9308985471725464, 1.7766848802566528, 1.9321632385253906, 1.277388334274292, 1.7016626596450806, 1.955607295036316, 1.9213786125183105, 1.863847017288208, 1.9000619649887085, 1.9000346660614014, 1.4169009923934937, 1.1858389377593994, 1.9222432374954224, 1.920301079750061, 1.932041049003601, 0.5129770636558533, 1.9000437259674072, 1.9000390768051147, 1.9199621677398682, 1.9311096668243408, 1.277362585067749, 1.900044322013855, 1.9158698320388794, 1.9318560361862183, 1.930943250656128, 1.9000351428985596, 1.900033950805664, 1.9000451564788818, 1.8740428686141968, 1.9204076528549194, 1.900033712387085, 1.9205169677734375, 1.9000365734100342, 1.0588458776474, 1.9202405214309692, 1.9000346660614014, 1.9000377655029297, 1.9000577926635742, 1.865859031677246, 1.0597251653671265, 1.9000599384307861, 1.900301456451416, 1.9000755548477173, 1.9000495672225952, 1.920280933380127, 1.3838591575622559, 0.5129770636558533, 1.920392632484436], "mean_td_error": 1.7882033586502075, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 550.0, "diff_num_grad_updates_vs_sampler_policy": 549.0}}, "num_env_steps_sampled": 23000, "num_env_steps_trained": 42900, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 42900, "last_target_update_ts": 22880, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": 1.8481482886026934, "episode_reward_min": -9.998934065683232, "episode_reward_mean": -0.9915439753709009, "episode_len_mean": 25.11, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0012521928842408256, 0.001414305732941312, 0.054729156871258094, 0.0013397015986207836, 0.11162664999686854, 0.0012825835068762067, 0.001377815681519727, 1.8481482886026934, 0.675646827156658, 0.0012790524136039596, 0.0012518259520220767, -9.998619141487854, 0.0013432835650717654, 0.0013132490799624493, 0.0012845655130389712, 0.001251167664821215, 0.0014178891933111877, 0.0013783024377533955, 0.0013466991982037755, 0.1378791066251005, 0.0012826810192799903, -9.998745472123233, 0.0012265614865703352, 0.1359775554413124, 0.0011705249719807084, 0.001141201055229419, 0.001201951713793336, 0.0011750378608994677, 0.0011471785078009911, 0.0011189990383705473, 0.0010915291280697386, 0.001236197351618844, 0.565867699475277, 0.0011784313785920138, -9.906884373991891, 0.0012243317408931994, 0.0011964182239098222, -9.326271748424412, 0.0011386376668211572, 0.0011102077805420214, 0.0012492873897573607, 0.001221553942659249, 0.0011937654711639864, 0.0011650218832723186, 0.0011359697308865218, 0.0012200891241942544, 1.1966584616816913, 0.17547720401443379, 0.0011404807043770785, 0.0011126254572885953, -9.998776767483184, 0.0011954822483355868, 0.0011666569273599747, 0.0011375241589051, -9.876168551524355, -9.998746534852566, 0.0012242212690558173, 0.0011940109250662579, 0.001163513310421295, 0.06617989285406306, -9.998887353377231, 0.0010860597942800936, 0.001062774631403435, 0.0010419950523149028, 0.3585700195498279, -9.998934065683232, 0.40563659538341, 0.4718082054743454, 0.0010047243364449262, 0.0009867230001636038, 0.10783055431922062, 0.0010958483641717875, 0.0010721460577872322, 0.11219957526616806, 0.001031591250353847, -9.998916260235278, 0.0010605511294740535, 0.0010398575602298507, 0.001019889471586849, 0.0010013458809250645, 0.4792686952616085, 0.0010816456239599688, 0.8102860017633268, 0.0010380873350542038, 0.0010181865515116867, 0.0010854636469184219, 0.001060147456988038, 0.06066481720192432, 0.0010203858629613852, 0.001001151965388935, -8.131894174752434, 0.0010605975790316372, 0.0010399022148069334, 0.0010199324269260788, 0.0010013872891161636, 0.0011111243429025312, 0.1208554521660375, 0.001065980314116846, 0.10330893571838469, 0.0010269869940273742], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 402.6180392837542, "mean_inference_ms": 2.173615199628952, "mean_action_processing_ms": 0.14969641426673322, "mean_env_wait_ms": 4.006510861523242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014108657836914062, "StateBufferConnector_ms": 0.006774425506591797, "ViewRequirementAgentConnector_ms": 0.18117928504943848}}, "episode_reward_max": 1.8481482886026934, "episode_reward_min": -9.998934065683232, "episode_reward_mean": -0.9915439753709009, "episode_len_mean": 25.11, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0012521928842408256, 0.001414305732941312, 0.054729156871258094, 0.0013397015986207836, 0.11162664999686854, 0.0012825835068762067, 0.001377815681519727, 1.8481482886026934, 0.675646827156658, 0.0012790524136039596, 0.0012518259520220767, -9.998619141487854, 0.0013432835650717654, 0.0013132490799624493, 0.0012845655130389712, 0.001251167664821215, 0.0014178891933111877, 0.0013783024377533955, 0.0013466991982037755, 0.1378791066251005, 0.0012826810192799903, -9.998745472123233, 0.0012265614865703352, 0.1359775554413124, 0.0011705249719807084, 0.001141201055229419, 0.001201951713793336, 0.0011750378608994677, 0.0011471785078009911, 0.0011189990383705473, 0.0010915291280697386, 0.001236197351618844, 0.565867699475277, 0.0011784313785920138, -9.906884373991891, 0.0012243317408931994, 0.0011964182239098222, -9.326271748424412, 0.0011386376668211572, 0.0011102077805420214, 0.0012492873897573607, 0.001221553942659249, 0.0011937654711639864, 0.0011650218832723186, 0.0011359697308865218, 0.0012200891241942544, 1.1966584616816913, 0.17547720401443379, 0.0011404807043770785, 0.0011126254572885953, -9.998776767483184, 0.0011954822483355868, 0.0011666569273599747, 0.0011375241589051, -9.876168551524355, -9.998746534852566, 0.0012242212690558173, 0.0011940109250662579, 0.001163513310421295, 0.06617989285406306, -9.998887353377231, 0.0010860597942800936, 0.001062774631403435, 0.0010419950523149028, 0.3585700195498279, -9.998934065683232, 0.40563659538341, 0.4718082054743454, 0.0010047243364449262, 0.0009867230001636038, 0.10783055431922062, 0.0010958483641717875, 0.0010721460577872322, 0.11219957526616806, 0.001031591250353847, -9.998916260235278, 0.0010605511294740535, 0.0010398575602298507, 0.001019889471586849, 0.0010013458809250645, 0.4792686952616085, 0.0010816456239599688, 0.8102860017633268, 0.0010380873350542038, 0.0010181865515116867, 0.0010854636469184219, 0.001060147456988038, 0.06066481720192432, 0.0010203858629613852, 0.001001151965388935, -8.131894174752434, 0.0010605975790316372, 0.0010399022148069334, 0.0010199324269260788, 0.0010013872891161636, 0.0011111243429025312, 0.1208554521660375, 0.001065980314116846, 0.10330893571838469, 0.0010269869940273742], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 402.6180392837542, "mean_inference_ms": 2.173615199628952, "mean_action_processing_ms": 0.14969641426673322, "mean_env_wait_ms": 4.006510861523242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014108657836914062, "StateBufferConnector_ms": 0.006774425506591797, "ViewRequirementAgentConnector_ms": 0.18117928504943848}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 42900, "num_env_steps_sampled": 23000, "num_env_steps_trained": 42900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.4160367560129625, "num_env_steps_trained_throughput_per_sec": 8.611271674225277, "timesteps_total": 23000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 23000, "timers": {"training_iteration_time_ms": 9070.215, "sample_time_ms": 9006.27, "load_time_ms": 0.255, "load_throughput": 305695.862, "learn_time_ms": 13.402, "learn_throughput": 5820.158, "synch_weights_time_ms": 11.861}, "counters": {"num_env_steps_sampled": 23000, "num_env_steps_trained": 42900, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 42900, "last_target_update_ts": 22880, "num_target_updates": 43}, "done": false, "episodes_total": 844, "training_iteration": 23, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-43-08", "timestamp": 1713411788, "time_this_iter_s": 226.4585530757904, "time_total_s": 5541.60705447197, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5541.60705447197, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.467391304347826, "ram_util_percent": 16.750931677018635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0017908867448568344, "cur_lr": 0.01}, "td_error": [1.8749741315841675, 1.8477113246917725, 1.866152286529541, 1.8468222618103027, 1.8820322751998901, 1.8468585014343262, 1.8670144081115723, 1.88374662399292, 1.2371013164520264, 1.846826434135437, 2.075760841369629, 1.9305696487426758, 1.865946888923645, 1.8675923347473145, 1.8468228578567505, 1.8468457460403442, 2.053863048553467, 1.8821215629577637, 1.8468207120895386, 2.18576717376709, 1.8846031427383423, 1.8468295335769653, 1.8874155282974243, 1.8468315601348877, 1.8468159437179565, 1.8659018278121948, 1.8468278646469116, 1.8820308446884155, 1.847213864326477, 2.184708595275879, 1.0425567626953125, 1.881960391998291, 1.846831202507019, 1.8468648195266724, 1.0419940948486328, 1.8829277753829956, 1.8468208312988281, 1.8566935062408447, 1.865434169769287, 1.8606313467025757, 1.8986971378326416, 1.8468248844146729, 1.8468170166015625, 1.8468291759490967, 1.8826544284820557, 1.8822559118270874, 1.8468166589736938, 1.847124457359314, 1.88289213180542, 1.846821904182434, 1.865580439567566, 1.8468178510665894, 2.1857240200042725, 1.8468234539031982, 1.0672972202301025, 1.8832331895828247, 1.7123980522155762, 1.8470120429992676, 1.8792656660079956, 1.847221851348877, 1.8468167781829834, 1.8656457662582397, 1.8469035625457764, 1.882110834121704, 1.8655872344970703, 1.2371039390563965, 1.867770791053772, 2.124282121658325, 1.2368640899658203, 1.8655829429626465, 1.8468173742294312, 1.846815586090088, 1.8468855619430542, 1.847409725189209, 1.8483110666275024, 1.237105131149292, 1.387455940246582, 1.237103819847107], "mean_td_error": 1.8033194541931152, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 575.0, "diff_num_grad_updates_vs_sampler_policy": 574.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 44850, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 44850, "last_target_update_ts": 23920, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": 3.3243794769220574, "episode_reward_min": -9.999066692587588, "episode_reward_mean": -0.7722378715008997, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0012492873897573607, 0.001221553942659249, 0.0011937654711639864, 0.0011650218832723186, 0.0011359697308865218, 0.0012200891241942544, 1.1966584616816913, 0.17547720401443379, 0.0011404807043770785, 0.0011126254572885953, -9.998776767483184, 0.0011954822483355868, 0.0011666569273599747, 0.0011375241589051, -9.876168551524355, -9.998746534852566, 0.0012242212690558173, 0.0011940109250662579, 0.001163513310421295, 0.06617989285406306, -9.998887353377231, 0.0010860597942800936, 0.001062774631403435, 0.0010419950523149028, 0.3585700195498279, -9.998934065683232, 0.40563659538341, 0.4718082054743454, 0.0010047243364449262, 0.0009867230001636038, 0.10783055431922062, 0.0010958483641717875, 0.0010721460577872322, 0.11219957526616806, 0.001031591250353847, -9.998916260235278, 0.0010605511294740535, 0.0010398575602298507, 0.001019889471586849, 0.0010013458809250645, 0.4792686952616085, 0.0010816456239599688, 0.8102860017633268, 0.0010380873350542038, 0.0010181865515116867, 0.0010854636469184219, 0.001060147456988038, 0.06066481720192432, 0.0010203858629613852, 0.001001151965388935, -8.131894174752434, 0.0010605975790316372, 0.0010399022148069334, 0.0010199324269260788, 0.0010013872891161636, 0.0011111243429025312, 0.1208554521660375, 0.001065980314116846, 0.10330893571838469, 0.0010269869940273742, 0.0010037900532762311, 0.0009800776624517681, 0.0009612059087201004, 0.0009433927113961521, 0.000925796824608933, 0.0009638004359337762, 3.3243794769220574, 0.9738979587056422, 0.0009135643215651054, 0.0008626248157851364, 0.0010126238499607496, 0.0009884975278063777, 0.000969302962992425, 0.0009511913676183339, -9.999066692587588, 0.0009777474014990885, 0.19192498080749004, 0.08328251482365501, 0.0009249266922119519, 0.052700468803509454, 0.20869973869034, 0.0009778538614980583, 0.0009590669174352529, 0.0009413321418609632, 0.0009238123547677098, 0.34826735217981714, 0.0009626769029056437, 0.000944463753014479, -9.591749797284441, 0.0009104696311528838, 0.0009777868820759765, 0.3006504574114472, 0.0009415569408979051, 0.0009240288595354058, 0.0008723418055196215, 0.0010021801965922085, 0.34563241946089013, 0.0009641546420158225, 0.0009457829542975568, 0.0008925301760587859], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 404.5028468532544, "mean_inference_ms": 2.176806764156015, "mean_action_processing_ms": 0.14979413653560897, "mean_env_wait_ms": 3.837645757832497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01104116439819336, "StateBufferConnector_ms": 0.006879568099975586, "ViewRequirementAgentConnector_ms": 0.18827486038208008}}, "episode_reward_max": 3.3243794769220574, "episode_reward_min": -9.999066692587588, "episode_reward_mean": -0.7722378715008997, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0012492873897573607, 0.001221553942659249, 0.0011937654711639864, 0.0011650218832723186, 0.0011359697308865218, 0.0012200891241942544, 1.1966584616816913, 0.17547720401443379, 0.0011404807043770785, 0.0011126254572885953, -9.998776767483184, 0.0011954822483355868, 0.0011666569273599747, 0.0011375241589051, -9.876168551524355, -9.998746534852566, 0.0012242212690558173, 0.0011940109250662579, 0.001163513310421295, 0.06617989285406306, -9.998887353377231, 0.0010860597942800936, 0.001062774631403435, 0.0010419950523149028, 0.3585700195498279, -9.998934065683232, 0.40563659538341, 0.4718082054743454, 0.0010047243364449262, 0.0009867230001636038, 0.10783055431922062, 0.0010958483641717875, 0.0010721460577872322, 0.11219957526616806, 0.001031591250353847, -9.998916260235278, 0.0010605511294740535, 0.0010398575602298507, 0.001019889471586849, 0.0010013458809250645, 0.4792686952616085, 0.0010816456239599688, 0.8102860017633268, 0.0010380873350542038, 0.0010181865515116867, 0.0010854636469184219, 0.001060147456988038, 0.06066481720192432, 0.0010203858629613852, 0.001001151965388935, -8.131894174752434, 0.0010605975790316372, 0.0010399022148069334, 0.0010199324269260788, 0.0010013872891161636, 0.0011111243429025312, 0.1208554521660375, 0.001065980314116846, 0.10330893571838469, 0.0010269869940273742, 0.0010037900532762311, 0.0009800776624517681, 0.0009612059087201004, 0.0009433927113961521, 0.000925796824608933, 0.0009638004359337762, 3.3243794769220574, 0.9738979587056422, 0.0009135643215651054, 0.0008626248157851364, 0.0010126238499607496, 0.0009884975278063777, 0.000969302962992425, 0.0009511913676183339, -9.999066692587588, 0.0009777474014990885, 0.19192498080749004, 0.08328251482365501, 0.0009249266922119519, 0.052700468803509454, 0.20869973869034, 0.0009778538614980583, 0.0009590669174352529, 0.0009413321418609632, 0.0009238123547677098, 0.34826735217981714, 0.0009626769029056437, 0.000944463753014479, -9.591749797284441, 0.0009104696311528838, 0.0009777868820759765, 0.3006504574114472, 0.0009415569408979051, 0.0009240288595354058, 0.0008723418055196215, 0.0010021801965922085, 0.34563241946089013, 0.0009641546420158225, 0.0009457829542975568, 0.0008925301760587859], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 404.5028468532544, "mean_inference_ms": 2.176806764156015, "mean_action_processing_ms": 0.14979413653560897, "mean_env_wait_ms": 3.837645757832497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01104116439819336, "StateBufferConnector_ms": 0.006879568099975586, "ViewRequirementAgentConnector_ms": 0.18827486038208008}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 44850, "num_env_steps_sampled": 24000, "num_env_steps_trained": 44850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.413663685423825, "num_env_steps_trained_throughput_per_sec": 8.60664418657646, "timesteps_total": 24000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9061.364, "sample_time_ms": 8995.293, "load_time_ms": 0.256, "load_throughput": 305011.852, "learn_time_ms": 14.091, "learn_throughput": 5535.611, "synch_weights_time_ms": 12.076}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 44850, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 44850, "last_target_update_ts": 23920, "num_target_updates": 45}, "done": false, "episodes_total": 884, "training_iteration": 24, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-46-55", "timestamp": 1713412015, "time_this_iter_s": 226.57759404182434, "time_total_s": 5768.184648513794, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5768.184648513794, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.336335403726709, "ram_util_percent": 16.903726708074533}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0019014121498912573, "cur_lr": 0.01}, "td_error": [2.2560322284698486, 1.8369166851043701, 1.8446636199951172, 1.8151121139526367, 1.8155579566955566, 1.815109372138977, 1.173285961151123, 2.0106256008148193, 1.8374569416046143, 1.8151073455810547, 2.774024486541748, 1.8151119947433472, 1.8504867553710938, 1.8151084184646606, 1.8529372215270996, 1.8451099395751953, 1.8369348049163818, 1.1732816696166992, 1.815107822418213, 1.8151122331619263, 1.9416544437408447, 1.8151085376739502, 1.8151136636734009, 1.8151183128356934, 1.173231601715088, 1.815109133720398, 1.8151161670684814, 1.8382829427719116, 1.8495606184005737, 1.8151109218597412, 1.815107822418213, 1.8446929454803467, 1.815123200416565, 1.815107822418213, 1.8153808116912842, 1.815116286277771, 1.8369299173355103, 1.815112590789795, 2.7674477100372314, 1.1732550859451294, 1.8151127099990845, 1.8151099681854248, 1.2584302425384521, 1.8456087112426758, 1.815106987953186, 1.8151100873947144, 1.8151086568832397, 1.8449050188064575, 1.2943191528320312, 2.2564339637756348, 0.5444180965423584, 1.8582308292388916, 2.5604331493377686, 2.2558577060699463, 1.8151384592056274, 1.9935227632522583, 1.8151205778121948, 1.0699825286865234, 1.173278570175171, 1.815109133720398, 1.815110445022583, 1.8151109218597412, 1.9355534315109253, 1.815111517906189, 3.482196807861328, 1.8373305797576904, 1.899820327758789, 1.8151099681854248, 1.8151085376739502, 1.815106749534607, 1.8151079416275024, 1.9975714683532715, 1.0682995319366455, 1.8151079416275024, 1.8369344472885132, 2.098731517791748, 1.8447166681289673, 1.815108060836792], "mean_td_error": 1.8183748722076416, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 600.0, "diff_num_grad_updates_vs_sampler_policy": 599.0}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 46800, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 46800, "last_target_update_ts": 24960, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": 3.3243794769220574, "episode_reward_min": -19.999142021341697, "episode_reward_mean": -1.1569681717184164, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4792686952616085, 0.0010816456239599688, 0.8102860017633268, 0.0010380873350542038, 0.0010181865515116867, 0.0010854636469184219, 0.001060147456988038, 0.06066481720192432, 0.0010203858629613852, 0.001001151965388935, -8.131894174752434, 0.0010605975790316372, 0.0010399022148069334, 0.0010199324269260788, 0.0010013872891161636, 0.0011111243429025312, 0.1208554521660375, 0.001065980314116846, 0.10330893571838469, 0.0010269869940273742, 0.0010037900532762311, 0.0009800776624517681, 0.0009612059087201004, 0.0009433927113961521, 0.000925796824608933, 0.0009638004359337762, 3.3243794769220574, 0.9738979587056422, 0.0009135643215651054, 0.0008626248157851364, 0.0010126238499607496, 0.0009884975278063777, 0.000969302962992425, 0.0009511913676183339, -9.999066692587588, 0.0009777474014990885, 0.19192498080749004, 0.08328251482365501, 0.0009249266922119519, 0.052700468803509454, 0.20869973869034, 0.0009778538614980583, 0.0009590669174352529, 0.0009413321418609632, 0.0009238123547677098, 0.34826735217981714, 0.0009626769029056437, 0.000944463753014479, -9.591749797284441, 0.0009104696311528838, 0.0009777868820759765, 0.3006504574114472, 0.0009415569408979051, 0.0009240288595354058, 0.0008723418055196215, 0.0010021801965922085, 0.34563241946089013, 0.0009641546420158225, 0.0009457829542975568, 0.0008925301760587859, 0.0008739831127687094, 0.0008942879875768579, 0.0008824902226257067, 0.4716580373997794, -19.999142021341697, 0.0008828688916554838, 0.0008713685885333547, 0.0008566071419343416, -9.999152733839454, 0.0008337388875628359, -19.99911903413731, 0.0009012927478339932, -9.999110668842151, 0.0008739405673590703, 0.000864218471611925, 0.0008946461284320661, 0.0008828389734584117, 0.0008676898129621208, 2.0571980983832763, 0.0008446767362243748, 0.0008721408040841138, 0.000892436174369354, 0.0008806869029158616, 0.0008656108614573417, 0.0008560722928715766, -9.999140248210933, 0.0008799783551576876, 0.4153534339878161, 0.0008540618877629233, 0.0008447749112968062, -9.713731584938216, 0.0008811724007547404, 0.0008660798791346818, 0.0008565310227504254, 0.7405316794366216, 0.0009129230390091226, 0.07942322382832444, -9.952316025491458, -9.99912264356966, 0.4539080332404835], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 24, 25, 25, 25, 27, 25, 25, 25, 26, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 406.32127154264623, "mean_inference_ms": 2.1795736347940484, "mean_action_processing_ms": 0.1499149197852815, "mean_env_wait_ms": 3.6839974569599185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010900735855102539, "StateBufferConnector_ms": 0.007027149200439453, "ViewRequirementAgentConnector_ms": 0.18958020210266113}}, "episode_reward_max": 3.3243794769220574, "episode_reward_min": -19.999142021341697, "episode_reward_mean": -1.1569681717184164, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.4792686952616085, 0.0010816456239599688, 0.8102860017633268, 0.0010380873350542038, 0.0010181865515116867, 0.0010854636469184219, 0.001060147456988038, 0.06066481720192432, 0.0010203858629613852, 0.001001151965388935, -8.131894174752434, 0.0010605975790316372, 0.0010399022148069334, 0.0010199324269260788, 0.0010013872891161636, 0.0011111243429025312, 0.1208554521660375, 0.001065980314116846, 0.10330893571838469, 0.0010269869940273742, 0.0010037900532762311, 0.0009800776624517681, 0.0009612059087201004, 0.0009433927113961521, 0.000925796824608933, 0.0009638004359337762, 3.3243794769220574, 0.9738979587056422, 0.0009135643215651054, 0.0008626248157851364, 0.0010126238499607496, 0.0009884975278063777, 0.000969302962992425, 0.0009511913676183339, -9.999066692587588, 0.0009777474014990885, 0.19192498080749004, 0.08328251482365501, 0.0009249266922119519, 0.052700468803509454, 0.20869973869034, 0.0009778538614980583, 0.0009590669174352529, 0.0009413321418609632, 0.0009238123547677098, 0.34826735217981714, 0.0009626769029056437, 0.000944463753014479, -9.591749797284441, 0.0009104696311528838, 0.0009777868820759765, 0.3006504574114472, 0.0009415569408979051, 0.0009240288595354058, 0.0008723418055196215, 0.0010021801965922085, 0.34563241946089013, 0.0009641546420158225, 0.0009457829542975568, 0.0008925301760587859, 0.0008739831127687094, 0.0008942879875768579, 0.0008824902226257067, 0.4716580373997794, -19.999142021341697, 0.0008828688916554838, 0.0008713685885333547, 0.0008566071419343416, -9.999152733839454, 0.0008337388875628359, -19.99911903413731, 0.0009012927478339932, -9.999110668842151, 0.0008739405673590703, 0.000864218471611925, 0.0008946461284320661, 0.0008828389734584117, 0.0008676898129621208, 2.0571980983832763, 0.0008446767362243748, 0.0008721408040841138, 0.000892436174369354, 0.0008806869029158616, 0.0008656108614573417, 0.0008560722928715766, -9.999140248210933, 0.0008799783551576876, 0.4153534339878161, 0.0008540618877629233, 0.0008447749112968062, -9.713731584938216, 0.0008811724007547404, 0.0008660798791346818, 0.0008565310227504254, 0.7405316794366216, 0.0009129230390091226, 0.07942322382832444, -9.952316025491458, -9.99912264356966, 0.4539080332404835], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 24, 25, 25, 25, 27, 25, 25, 25, 26, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 406.32127154264623, "mean_inference_ms": 2.1795736347940484, "mean_action_processing_ms": 0.1499149197852815, "mean_env_wait_ms": 3.6839974569599185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010900735855102539, "StateBufferConnector_ms": 0.007027149200439453, "ViewRequirementAgentConnector_ms": 0.18958020210266113}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 46800, "num_env_steps_sampled": 25000, "num_env_steps_trained": 46800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.4014275529687605, "num_env_steps_trained_throughput_per_sec": 8.582783728289083, "timesteps_total": 25000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 25000, "timers": {"training_iteration_time_ms": 9138.734, "sample_time_ms": 9077.058, "load_time_ms": 0.235, "load_throughput": 331700.002, "learn_time_ms": 13.17, "learn_throughput": 5922.603, "synch_weights_time_ms": 11.28}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 46800, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 46800, "last_target_update_ts": 24960, "num_target_updates": 47}, "done": false, "episodes_total": 924, "training_iteration": 25, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-50-42", "timestamp": 1713412242, "time_this_iter_s": 227.20637130737305, "time_total_s": 5995.391019821167, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5995.391019821167, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.395975232198142, "ram_util_percent": 17.06501547987616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013490940909832716, "cur_lr": 0.01}, "td_error": [1.9962698221206665, 1.7735917568206787, 1.1342313289642334, 2.0185956954956055, 1.048087477684021, 1.8743609189987183, 1.7735925912857056, 1.773589849472046, 1.9521640539169312, 1.7735905647277832, 1.7736287117004395, 1.8005796670913696, 1.7735960483551025, 1.7735892534255981, 1.1342307329177856, 1.8004744052886963, 0.9914631843566895, 1.7735896110534668, 1.8088204860687256, 1.2753589153289795, 1.773589015007019, 1.7996042966842651, 1.233530044555664, 1.8004374504089355, 1.7735908031463623, 1.1331803798675537, 1.7735921144485474, 1.8089046478271484, 1.7735921144485474, 1.7912319898605347, 1.7735909223556519, 1.1342213153839111, 0.9912683963775635, 1.7735941410064697, 1.77359139919281, 1.335433840751648, 1.7735899686813354, 1.7735912799835205, 1.7735915184020996, 1.2597575187683105, 1.773594856262207, 1.799225091934204, 1.0000767707824707, 1.799222469329834, 1.7735891342163086, 1.77359139919281, 1.7992568016052246, 2.020085096359253, 1.8905808925628662, 1.773590087890625, 1.7735896110534668, 1.9970065355300903, 1.9619874954223633, 1.8005008697509766, 1.7738251686096191, 1.7735906839370728, 1.773590326309204, 1.8224378824234009, 1.8003076314926147, 1.7735888957977295, 1.800293207168579, 1.7735897302627563, 1.7993204593658447, 1.7735891342163086, 1.7735897302627563, 1.773600459098816, 1.773997187614441, 1.2596951723098755, 1.7736098766326904, 1.8003439903259277, 1.7735968828201294, 1.7735927104949951, 1.1342334747314453, 1.7992829084396362, 1.8540382385253906, 1.7735885381698608, 2.2771847248077393, 1.8199982643127441], "mean_td_error": 1.694965124130249, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 625.0, "diff_num_grad_updates_vs_sampler_policy": 624.0}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 48750, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 48750, "last_target_update_ts": 26000, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": 6.278479390923791, "episode_reward_min": -19.999142021341697, "episode_reward_mean": -1.2391239837396022, "episode_len_mean": 25.09, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.20869973869034, 0.0009778538614980583, 0.0009590669174352529, 0.0009413321418609632, 0.0009238123547677098, 0.34826735217981714, 0.0009626769029056437, 0.000944463753014479, -9.591749797284441, 0.0009104696311528838, 0.0009777868820759765, 0.3006504574114472, 0.0009415569408979051, 0.0009240288595354058, 0.0008723418055196215, 0.0010021801965922085, 0.34563241946089013, 0.0009641546420158225, 0.0009457829542975568, 0.0008925301760587859, 0.0008739831127687094, 0.0008942879875768579, 0.0008824902226257067, 0.4716580373997794, -19.999142021341697, 0.0008828688916554838, 0.0008713685885333547, 0.0008566071419343416, -9.999152733839454, 0.0008337388875628359, -19.99911903413731, 0.0009012927478339932, -9.999110668842151, 0.0008739405673590703, 0.000864218471611925, 0.0008946461284320661, 0.0008828389734584117, 0.0008676898129621208, 2.0571980983832763, 0.0008446767362243748, 0.0008721408040841138, 0.000892436174369354, 0.0008806869029158616, 0.0008656108614573417, 0.0008560722928715766, -9.999140248210933, 0.0008799783551576876, 0.4153534339878161, 0.0008540618877629233, 0.0008447749112968062, -9.713731584938216, 0.0008811724007547404, 0.0008660798791346818, 0.0008565310227504254, 0.7405316794366216, 0.0009129230390091226, 0.07942322382832444, -9.952316025491458, -9.99912264356966, 0.4539080332404835, 6.278479390923791, 0.0008299897702131485, 0.0008143678000030179, 0.048539558562001546, 0.0007877876891348739, 0.0439155812330108, 0.096746418503477, 0.0007919968057693117, 0.0007789451824021475, 0.0007662802769795355, 5.845542461653088, 0.08587875339758673, 0.0008206651329300578, 0.0008057065565449841, 0.0007922028812476878, -9.876771924597653, 0.0008153386517461733, 0.0008005718699083113, -9.999212733399238, 3.767345031036848, 0.00084226586134703, 0.0008281756750016408, 0.4197572121898758, 0.08985111682773621, 0.0007855937881675991, 2.722778993082679, 0.0008180486520715187, 0.0008028688202815566, 0.0007885462958593814, 0.0007756072532774732, 0.0008295646917869592, 0.0008139585676428274, 0.0007992412813253675, 0.032640924976883694, 0.0007744249070408214, 0.0008482259374445727, -9.99916808213887, -9.99918344990091, 0.305597677045549, 0.0007894511105839344], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 24, 25, 25, 25, 27, 25, 25, 25, 26, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 407.94810647072956, "mean_inference_ms": 2.1800108191208367, "mean_action_processing_ms": 0.14989587815653188, "mean_env_wait_ms": 3.542453949672546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010456085205078125, "StateBufferConnector_ms": 0.006893157958984375, "ViewRequirementAgentConnector_ms": 0.18325281143188477}}, "episode_reward_max": 6.278479390923791, "episode_reward_min": -19.999142021341697, "episode_reward_mean": -1.2391239837396022, "episode_len_mean": 25.09, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.20869973869034, 0.0009778538614980583, 0.0009590669174352529, 0.0009413321418609632, 0.0009238123547677098, 0.34826735217981714, 0.0009626769029056437, 0.000944463753014479, -9.591749797284441, 0.0009104696311528838, 0.0009777868820759765, 0.3006504574114472, 0.0009415569408979051, 0.0009240288595354058, 0.0008723418055196215, 0.0010021801965922085, 0.34563241946089013, 0.0009641546420158225, 0.0009457829542975568, 0.0008925301760587859, 0.0008739831127687094, 0.0008942879875768579, 0.0008824902226257067, 0.4716580373997794, -19.999142021341697, 0.0008828688916554838, 0.0008713685885333547, 0.0008566071419343416, -9.999152733839454, 0.0008337388875628359, -19.99911903413731, 0.0009012927478339932, -9.999110668842151, 0.0008739405673590703, 0.000864218471611925, 0.0008946461284320661, 0.0008828389734584117, 0.0008676898129621208, 2.0571980983832763, 0.0008446767362243748, 0.0008721408040841138, 0.000892436174369354, 0.0008806869029158616, 0.0008656108614573417, 0.0008560722928715766, -9.999140248210933, 0.0008799783551576876, 0.4153534339878161, 0.0008540618877629233, 0.0008447749112968062, -9.713731584938216, 0.0008811724007547404, 0.0008660798791346818, 0.0008565310227504254, 0.7405316794366216, 0.0009129230390091226, 0.07942322382832444, -9.952316025491458, -9.99912264356966, 0.4539080332404835, 6.278479390923791, 0.0008299897702131485, 0.0008143678000030179, 0.048539558562001546, 0.0007877876891348739, 0.0439155812330108, 0.096746418503477, 0.0007919968057693117, 0.0007789451824021475, 0.0007662802769795355, 5.845542461653088, 0.08587875339758673, 0.0008206651329300578, 0.0008057065565449841, 0.0007922028812476878, -9.876771924597653, 0.0008153386517461733, 0.0008005718699083113, -9.999212733399238, 3.767345031036848, 0.00084226586134703, 0.0008281756750016408, 0.4197572121898758, 0.08985111682773621, 0.0007855937881675991, 2.722778993082679, 0.0008180486520715187, 0.0008028688202815566, 0.0007885462958593814, 0.0007756072532774732, 0.0008295646917869592, 0.0008139585676428274, 0.0007992412813253675, 0.032640924976883694, 0.0007744249070408214, 0.0008482259374445727, -9.99916808213887, -9.99918344990091, 0.305597677045549, 0.0007894511105839344], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 24, 25, 25, 25, 27, 25, 25, 25, 26, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 407.94810647072956, "mean_inference_ms": 2.1800108191208367, "mean_action_processing_ms": 0.14989587815653188, "mean_env_wait_ms": 3.542453949672546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010456085205078125, "StateBufferConnector_ms": 0.006893157958984375, "ViewRequirementAgentConnector_ms": 0.18325281143188477}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 48750, "num_env_steps_sampled": 26000, "num_env_steps_trained": 48750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.433272130637559, "num_env_steps_trained_throughput_per_sec": 8.644880654743242, "timesteps_total": 26000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 9036.913, "sample_time_ms": 8972.034, "load_time_ms": 0.253, "load_throughput": 308608.35, "learn_time_ms": 13.273, "learn_throughput": 5876.581, "synch_weights_time_ms": 13.057}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 48750, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 48750, "last_target_update_ts": 26000, "num_target_updates": 49}, "done": false, "episodes_total": 964, "training_iteration": 26, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-54-28", "timestamp": 1713412468, "time_this_iter_s": 225.5769965648651, "time_total_s": 6220.968016386032, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 6220.968016386032, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 13.40031152647975, "ram_util_percent": 17.197507788161992}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0014033333864063025, "cur_lr": 0.01}, "td_error": [1.7462199926376343, 2.8562233448028564, 1.767754077911377, 1.7462139129638672, 1.7462157011032104, 1.0159637928009033, 1.7462148666381836, 2.4411423206329346, 1.7746405601501465, 1.767850637435913, 1.7756508588790894, 1.7462165355682373, 1.219146490097046, 1.746219277381897, 1.7737557888031006, 1.852091670036316, 3.462108612060547, 1.7679076194763184, 1.7740464210510254, 1.768276333808899, 0.9871971011161804, 1.7749614715576172, 1.7462314367294312, 1.2468702793121338, 1.7462146282196045, 1.7462173700332642, 1.7462130784988403, 1.1141836643218994, 1.1141844987869263, 1.7462154626846313, 1.7677922248840332, 1.7879303693771362, 1.746217966079712, 1.7462373971939087, 1.1126129627227783, 1.7462739944458008, 1.2192857265472412, 1.7677662372589111, 1.7739276885986328, 1.217538833618164, 2.646322727203369, 2.082371473312378, 2.3414201736450195, 1.7462158203125, 1.7654311656951904, 0.4528671205043793, 1.2468981742858887, 1.7462164163589478, 1.7462151050567627, 1.7462131977081299, 1.7678265571594238, 1.7462137937545776, 1.7469110488891602, 0.9842288494110107, 1.7462131977081299, 1.746214509010315, 0.9852999448776245, 1.7462153434753418, 1.8933422565460205, 1.773916482925415, 1.93171226978302, 2.05422043800354, 1.7462139129638672, 1.7462135553359985, 1.746732473373413, 0.9849993586540222, 1.8017489910125732, 1.7463221549987793, 1.7462173700332642, 1.7750860452651978, 1.7751399278640747, 1.7462128400802612, 1.7677754163742065, 1.7462129592895508, 2.0457708835601807, 1.8464449644088745, 1.0253773927688599, 1.746216058731079], "mean_td_error": 1.7049115896224976, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 650.0, "diff_num_grad_updates_vs_sampler_policy": 649.0}}, "num_env_steps_sampled": 27000, "num_env_steps_trained": 50700, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 50700, "last_target_update_ts": 26520, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": 6.278479390923791, "episode_reward_min": -9.999264794043897, "episode_reward_mean": -0.9341580097377062, "episode_len_mean": 25.03, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.000892436174369354, 0.0008806869029158616, 0.0008656108614573417, 0.0008560722928715766, -9.999140248210933, 0.0008799783551576876, 0.4153534339878161, 0.0008540618877629233, 0.0008447749112968062, -9.713731584938216, 0.0008811724007547404, 0.0008660798791346818, 0.0008565310227504254, 0.7405316794366216, 0.0009129230390091226, 0.07942322382832444, -9.952316025491458, -9.99912264356966, 0.4539080332404835, 6.278479390923791, 0.0008299897702131485, 0.0008143678000030179, 0.048539558562001546, 0.0007877876891348739, 0.0439155812330108, 0.096746418503477, 0.0007919968057693117, 0.0007789451824021475, 0.0007662802769795355, 5.845542461653088, 0.08587875339758673, 0.0008206651329300578, 0.0008057065565449841, 0.0007922028812476878, -9.876771924597653, 0.0008153386517461733, 0.0008005718699083113, -9.999212733399238, 3.767345031036848, 0.00084226586134703, 0.0008281756750016408, 0.4197572121898758, 0.08985111682773621, 0.0007855937881675991, 2.722778993082679, 0.0008180486520715187, 0.0008028688202815566, 0.0007885462958593814, 0.0007756072532774732, 0.0008295646917869592, 0.0008139585676428274, 0.0007992412813253675, 0.032640924976883694, 0.0007744249070408214, 0.0008482259374445727, -9.99916808213887, -9.99918344990091, 0.305597677045549, 0.0007894511105839344, 0.8154634458243609, -9.99923451877194, 0.6269446365110226, 0.0007463165557350541, 0.1850796184187664, 0.0007570656838871472, 0.0007458286573186096, 0.0007381757897500799, 0.0006997797377308473, 0.000720253644970828, 0.155798506472452, 0.11192941018797425, -9.936424749659205, 0.0007519008439278535, 0.0007126251235271548, 0.0007649169615936345, 0.8154428473450802, 0.000745728167187631, 0.20435739516251977, 0.0007276976932787477, 0.3402083437473828, 0.0007635218949601087, 0.7630777558637798, 0.000744396809368312, 0.000705602778853534, 0.0007261750421348165, 0.000763049805623852, 0.0007539122670196068, 0.0007427679830280632, -9.999264794043897, 0.2642653373005263, 0.19640955190958442, 0.000753865969659889, 0.0007460481313597169, 0.0007071482543869136, 0.10432884626973715, 0.0007796744758364576, 0.000767761434276337, -9.99924033727541, 0.0007198789826983158, 0.000740687413504879], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 409.6258765860619, "mean_inference_ms": 2.1790803115790665, "mean_action_processing_ms": 0.14982566316625665, "mean_env_wait_ms": 3.409204806092298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01059412956237793, "StateBufferConnector_ms": 0.006645679473876953, "ViewRequirementAgentConnector_ms": 0.18489789962768555}}, "episode_reward_max": 6.278479390923791, "episode_reward_min": -9.999264794043897, "episode_reward_mean": -0.9341580097377062, "episode_len_mean": 25.03, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.000892436174369354, 0.0008806869029158616, 0.0008656108614573417, 0.0008560722928715766, -9.999140248210933, 0.0008799783551576876, 0.4153534339878161, 0.0008540618877629233, 0.0008447749112968062, -9.713731584938216, 0.0008811724007547404, 0.0008660798791346818, 0.0008565310227504254, 0.7405316794366216, 0.0009129230390091226, 0.07942322382832444, -9.952316025491458, -9.99912264356966, 0.4539080332404835, 6.278479390923791, 0.0008299897702131485, 0.0008143678000030179, 0.048539558562001546, 0.0007877876891348739, 0.0439155812330108, 0.096746418503477, 0.0007919968057693117, 0.0007789451824021475, 0.0007662802769795355, 5.845542461653088, 0.08587875339758673, 0.0008206651329300578, 0.0008057065565449841, 0.0007922028812476878, -9.876771924597653, 0.0008153386517461733, 0.0008005718699083113, -9.999212733399238, 3.767345031036848, 0.00084226586134703, 0.0008281756750016408, 0.4197572121898758, 0.08985111682773621, 0.0007855937881675991, 2.722778993082679, 0.0008180486520715187, 0.0008028688202815566, 0.0007885462958593814, 0.0007756072532774732, 0.0008295646917869592, 0.0008139585676428274, 0.0007992412813253675, 0.032640924976883694, 0.0007744249070408214, 0.0008482259374445727, -9.99916808213887, -9.99918344990091, 0.305597677045549, 0.0007894511105839344, 0.8154634458243609, -9.99923451877194, 0.6269446365110226, 0.0007463165557350541, 0.1850796184187664, 0.0007570656838871472, 0.0007458286573186096, 0.0007381757897500799, 0.0006997797377308473, 0.000720253644970828, 0.155798506472452, 0.11192941018797425, -9.936424749659205, 0.0007519008439278535, 0.0007126251235271548, 0.0007649169615936345, 0.8154428473450802, 0.000745728167187631, 0.20435739516251977, 0.0007276976932787477, 0.3402083437473828, 0.0007635218949601087, 0.7630777558637798, 0.000744396809368312, 0.000705602778853534, 0.0007261750421348165, 0.000763049805623852, 0.0007539122670196068, 0.0007427679830280632, -9.999264794043897, 0.2642653373005263, 0.19640955190958442, 0.000753865969659889, 0.0007460481313597169, 0.0007071482543869136, 0.10432884626973715, 0.0007796744758364576, 0.000767761434276337, -9.99924033727541, 0.0007198789826983158, 0.000740687413504879], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 409.6258765860619, "mean_inference_ms": 2.1790803115790665, "mean_action_processing_ms": 0.14982566316625665, "mean_env_wait_ms": 3.409204806092298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01059412956237793, "StateBufferConnector_ms": 0.006645679473876953, "ViewRequirementAgentConnector_ms": 0.18489789962768555}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 50700, "num_env_steps_sampled": 27000, "num_env_steps_trained": 50700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.037542383457424, "num_env_steps_trained_throughput_per_sec": 7.873207647741977, "timesteps_total": 27000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 27000, "timers": {"training_iteration_time_ms": 11272.593, "sample_time_ms": 11208.43, "load_time_ms": 0.253, "load_throughput": 307708.533, "learn_time_ms": 13.395, "learn_throughput": 5823.079, "synch_weights_time_ms": 11.337}, "counters": {"num_env_steps_sampled": 27000, "num_env_steps_trained": 50700, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 50700, "last_target_update_ts": 26520, "num_target_updates": 50}, "done": false, "episodes_total": 1005, "training_iteration": 27, "trial_id": "cbb9a_00000", "date": "2024-04-18_03-58-35", "timestamp": 1713412715, "time_this_iter_s": 247.68535685539246, "time_total_s": 6468.653373241425, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 6468.653373241425, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 12.527762039660054, "ram_util_percent": 17.36090651558074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0027334645856171846, "cur_lr": 0.01}, "td_error": [1.711195468902588, 3.437537431716919, 1.1138266324996948, 1.0058727264404297, 1.73872709274292, 2.363290786743164, 1.7111973762512207, 1.7339601516723633, 1.8834329843521118, 1.003200650215149, 1.7111953496932983, 1.7111948728561401, 1.2475448846817017, 1.1138267517089844, 1.711194634437561, 1.7111976146697998, 1.7111949920654297, 1.8205711841583252, 1.711197018623352, 1.7111961841583252, 1.7112061977386475, 1.1138252019882202, 1.7114697694778442, 2.363522529602051, 1.9805961847305298, 1.9621779918670654, 1.7339386940002441, 1.711195707321167, 1.7111964225769043, 2.0019726753234863, 1.711195945739746, 1.7111949920654297, 2.116675615310669, 1.1134920120239258, 1.9231534004211426, 1.7113385200500488, 1.7491008043289185, 1.8590667247772217, 1.1134471893310547, 1.7488234043121338, 1.7338916063308716, 1.7111968994140625, 1.7111973762512207, 2.111860752105713, 1.734169840812683, 1.817960500717163, 1.7487810850143433, 1.7111979722976685, 1.2073591947555542, 1.749341368675232, 1.711194396018982, 1.9816861152648926, 1.7635223865509033, 1.7111988067626953, 1.1138193607330322, 1.1138200759887695, 1.7494405508041382, 0.9905838966369629, 1.7111961841583252, 1.711199164390564, 1.749078631401062, 3.42244815826416, 2.368915557861328, 1.817960500717163, 1.711199402809143, 0.49819493293762207, 0.4543870687484741, 1.7487951517105103, 1.7115894556045532, 1.1138148307800293, 1.7340025901794434, 0.4543870687484741, 1.1138015985488892, 1.7113903760910034, 1.711313247680664, 1.7132235765457153, 1.7487949132919312, 1.7111971378326416], "mean_td_error": 1.6655161380767822, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 675.0, "diff_num_grad_updates_vs_sampler_policy": 674.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 52650, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 52650, "last_target_update_ts": 27560, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": 6.350682237585602, "episode_reward_min": -9.999296994502604, "episode_reward_mean": -0.8010636907419538, "episode_len_mean": 25.02, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0008281756750016408, 0.4197572121898758, 0.08985111682773621, 0.0007855937881675991, 2.722778993082679, 0.0008180486520715187, 0.0008028688202815566, 0.0007885462958593814, 0.0007756072532774732, 0.0008295646917869592, 0.0008139585676428274, 0.0007992412813253675, 0.032640924976883694, 0.0007744249070408214, 0.0008482259374445727, -9.99916808213887, -9.99918344990091, 0.305597677045549, 0.0007894511105839344, 0.8154634458243609, -9.99923451877194, 0.6269446365110226, 0.0007463165557350541, 0.1850796184187664, 0.0007570656838871472, 0.0007458286573186096, 0.0007381757897500799, 0.0006997797377308473, 0.000720253644970828, 0.155798506472452, 0.11192941018797425, -9.936424749659205, 0.0007519008439278535, 0.0007126251235271548, 0.0007649169615936345, 0.8154428473450802, 0.000745728167187631, 0.20435739516251977, 0.0007276976932787477, 0.3402083437473828, 0.0007635218949601087, 0.7630777558637798, 0.000744396809368312, 0.000705602778853534, 0.0007261750421348165, 0.000763049805623852, 0.0007539122670196068, 0.0007427679830280632, -9.999264794043897, 0.2642653373005263, 0.19640955190958442, 0.000753865969659889, 0.0007460481313597169, 0.0007071482543869136, 0.10432884626973715, 0.0007796744758364576, 0.000767761434276337, -9.99924033727541, 0.0007198789826983158, 0.000740687413504879, 0.0007283194593352332, 0.7729744748476297, 0.4817321578281105, 0.0007044107896000068, 0.54860927446193, 0.0007126972293117724, 0.0007047065919091736, 0.0006960850573211267, 0.0006857569283387464, 0.0006786326392082715, -9.999266669524495, 0.0007254829436802563, 0.0007172047285570162, 0.0007082766659518027, 0.09593846079501987, 0.0007199850921234903, 0.0007118311511076065, -9.999296994502604, 0.0006925016645054997, 0.0006852372848056659, 0.0007184945167437928, 0.0007103741087911128, 0.0007016142283259146, 0.00069112259790672, 0.0006838869716835418, 0.0007185119780736753, 0.10241916806785192, 0.0007039046509463639, 0.0006953026041809814, 6.350682237585602, 0.0007205302997932922, 2.8012819615150133, 0.0007035744930479217, 0.07782361961464929, 0.0006864019135004057, -9.999267294556514, 0.000724255760212956, 0.3906747803972712, -9.999294999848932, 0.0006974723473203567], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 411.069129666141, "mean_inference_ms": 2.1791408215552015, "mean_action_processing_ms": 0.1498054970289034, "mean_env_wait_ms": 3.2895597666331766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010685443878173828, "StateBufferConnector_ms": 0.006899118423461914, "ViewRequirementAgentConnector_ms": 0.18710064888000488}}, "episode_reward_max": 6.350682237585602, "episode_reward_min": -9.999296994502604, "episode_reward_mean": -0.8010636907419538, "episode_len_mean": 25.02, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0008281756750016408, 0.4197572121898758, 0.08985111682773621, 0.0007855937881675991, 2.722778993082679, 0.0008180486520715187, 0.0008028688202815566, 0.0007885462958593814, 0.0007756072532774732, 0.0008295646917869592, 0.0008139585676428274, 0.0007992412813253675, 0.032640924976883694, 0.0007744249070408214, 0.0008482259374445727, -9.99916808213887, -9.99918344990091, 0.305597677045549, 0.0007894511105839344, 0.8154634458243609, -9.99923451877194, 0.6269446365110226, 0.0007463165557350541, 0.1850796184187664, 0.0007570656838871472, 0.0007458286573186096, 0.0007381757897500799, 0.0006997797377308473, 0.000720253644970828, 0.155798506472452, 0.11192941018797425, -9.936424749659205, 0.0007519008439278535, 0.0007126251235271548, 0.0007649169615936345, 0.8154428473450802, 0.000745728167187631, 0.20435739516251977, 0.0007276976932787477, 0.3402083437473828, 0.0007635218949601087, 0.7630777558637798, 0.000744396809368312, 0.000705602778853534, 0.0007261750421348165, 0.000763049805623852, 0.0007539122670196068, 0.0007427679830280632, -9.999264794043897, 0.2642653373005263, 0.19640955190958442, 0.000753865969659889, 0.0007460481313597169, 0.0007071482543869136, 0.10432884626973715, 0.0007796744758364576, 0.000767761434276337, -9.99924033727541, 0.0007198789826983158, 0.000740687413504879, 0.0007283194593352332, 0.7729744748476297, 0.4817321578281105, 0.0007044107896000068, 0.54860927446193, 0.0007126972293117724, 0.0007047065919091736, 0.0006960850573211267, 0.0006857569283387464, 0.0006786326392082715, -9.999266669524495, 0.0007254829436802563, 0.0007172047285570162, 0.0007082766659518027, 0.09593846079501987, 0.0007199850921234903, 0.0007118311511076065, -9.999296994502604, 0.0006925016645054997, 0.0006852372848056659, 0.0007184945167437928, 0.0007103741087911128, 0.0007016142283259146, 0.00069112259790672, 0.0006838869716835418, 0.0007185119780736753, 0.10241916806785192, 0.0007039046509463639, 0.0006953026041809814, 6.350682237585602, 0.0007205302997932922, 2.8012819615150133, 0.0007035744930479217, 0.07782361961464929, 0.0006864019135004057, -9.999267294556514, 0.000724255760212956, 0.3906747803972712, -9.999294999848932, 0.0006974723473203567], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 411.069129666141, "mean_inference_ms": 2.1791408215552015, "mean_action_processing_ms": 0.1498054970289034, "mean_env_wait_ms": 3.2895597666331766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010685443878173828, "StateBufferConnector_ms": 0.006899118423461914, "ViewRequirementAgentConnector_ms": 0.18710064888000488}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 52650, "num_env_steps_sampled": 28000, "num_env_steps_trained": 52650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5737389635119046, "num_env_steps_trained_throughput_per_sec": 6.968790978848213, "timesteps_total": 28000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 11179.531, "sample_time_ms": 11115.973, "load_time_ms": 0.238, "load_throughput": 328041.424, "learn_time_ms": 13.599, "learn_throughput": 5735.509, "synch_weights_time_ms": 10.854}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 52650, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 52650, "last_target_update_ts": 27560, "num_target_updates": 52}, "done": false, "episodes_total": 1045, "training_iteration": 28, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-03-15", "timestamp": 1713412995, "time_this_iter_s": 279.8265550136566, "time_total_s": 6748.479928255081, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 6748.479928255081, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 10.996231155778894, "ram_util_percent": 17.48291457286432}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.002503883559256792, "cur_lr": 0.01}, "td_error": [1.7300629615783691, 1.1010165214538574, 1.7751188278198242, 1.7300655841827393, 1.7300753593444824, 1.7748619318008423, 1.774769902229309, 1.7306790351867676, 1.7300636768341064, 1.775571584701538, 1.7300701141357422, 2.391559362411499, 1.730080485343933, 1.7300631999969482, 0.4633522629737854, 1.7567822933197021, 1.730242133140564, 2.0549662113189697, 1.101015329360962, 1.7300633192062378, 2.0124428272247314, 1.7308082580566406, 1.0011855363845825, 1.756780743598938, 1.774667501449585, 0.5219565033912659, 1.732707142829895, 1.7746752500534058, 0.5219565033912659, 1.7300647497177124, 2.054649829864502, 1.7300688028335571, 1.7300639152526855, 1.7300636768341064, 1.7300636768341064, 1.7300658226013184, 1.90891432762146, 1.7746762037277222, 1.7567754983901978, 1.7300684452056885, 1.730062484741211, 1.7300634384155273, 1.7300646305084229, 0.9647487998008728, 1.7300636768341064, 1.756779670715332, 1.7300630807876587, 1.8203665018081665, 1.7300647497177124, 1.730149507522583, 2.358642578125, 1.7622649669647217, 1.0013681650161743, 1.775161623954773, 1.7300623655319214, 1.7703299522399902, 1.1010112762451172, 1.7746670246124268, 1.756792664527893, 1.7746762037277222, 1.7746797800064087, 1.7746776342391968, 1.1010169982910156, 1.730064868927002, 2.1150057315826416, 1.7300641536712646, 1.730064034461975, 1.934352159500122, 1.7746738195419312, 0.9697792530059814, 1.7300633192062378, 1.73006272315979, 2.353759765625, 1.7302579879760742, 1.730065107345581, 3.0996108055114746, 1.7300630807876587, 1.730067253112793], "mean_td_error": 1.6875497102737427, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 700.0, "diff_num_grad_updates_vs_sampler_policy": 699.0}}, "num_env_steps_sampled": 29000, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 54600, "last_target_update_ts": 28600, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": 6.350682237585602, "episode_reward_min": -19.999313318335318, "episode_reward_mean": -1.1385527750473114, "episode_len_mean": 25.09, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3402083437473828, 0.0007635218949601087, 0.7630777558637798, 0.000744396809368312, 0.000705602778853534, 0.0007261750421348165, 0.000763049805623852, 0.0007539122670196068, 0.0007427679830280632, -9.999264794043897, 0.2642653373005263, 0.19640955190958442, 0.000753865969659889, 0.0007460481313597169, 0.0007071482543869136, 0.10432884626973715, 0.0007796744758364576, 0.000767761434276337, -9.99924033727541, 0.0007198789826983158, 0.000740687413504879, 0.0007283194593352332, 0.7729744748476297, 0.4817321578281105, 0.0007044107896000068, 0.54860927446193, 0.0007126972293117724, 0.0007047065919091736, 0.0006960850573211267, 0.0006857569283387464, 0.0006786326392082715, -9.999266669524495, 0.0007254829436802563, 0.0007172047285570162, 0.0007082766659518027, 0.09593846079501987, 0.0007199850921234903, 0.0007118311511076065, -9.999296994502604, 0.0006925016645054997, 0.0006852372848056659, 0.0007184945167437928, 0.0007103741087911128, 0.0007016142283259146, 0.00069112259790672, 0.0006838869716835418, 0.0007185119780736753, 0.10241916806785192, 0.0007039046509463639, 0.0006953026041809814, 6.350682237585602, 0.0007205302997932922, 2.8012819615150133, 0.0007035744930479217, 0.07782361961464929, 0.0006864019135004057, -9.999267294556514, 0.000724255760212956, 0.3906747803972712, -9.999294999848932, 0.0006974723473203567, -19.999313318335318, 0.0006772799174921596, 0.9540358183360393, 0.1485198100445075, 0.0006513116857680807, 0.000669477858099048, 0.0006598661486310883, 0.0006522274348437337, 0.0006437327620776852, 0.0006361294226007901, -9.999309376239536, 0.046100038295075266, 0.0006722990322794555, 0.26840578470405, 0.0006557455175301447, 0.0006759047072255263, 0.000666108892413359, 0.0006583258055805423, 0.0006496725878601816, 0.0006419291247820711, 0.0006745908815180653, 0.000664832842938172, 0.0006570793753393766, 0.3740357434641907, -9.999322034866521, -9.999331171766721, 0.0006592343369062178, 0.0006516101602829197, 0.0006431314547343399, 0.000677037809376198, -9.506133487869178, 0.514316875754366, 0.0006518607674648233, 0.0006440653654416925, 0.0006878059498388463, 0.0006776646637234007, -9.99933037192234, 0.0006606603885358869, 0.0006526543857264727], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 412.1970714846018, "mean_inference_ms": 2.1773585188575937, "mean_action_processing_ms": 0.14969101348620348, "mean_env_wait_ms": 3.1805041509764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010339021682739258, "StateBufferConnector_ms": 0.006819009780883789, "ViewRequirementAgentConnector_ms": 0.18471550941467285}}, "episode_reward_max": 6.350682237585602, "episode_reward_min": -19.999313318335318, "episode_reward_mean": -1.1385527750473114, "episode_len_mean": 25.09, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.3402083437473828, 0.0007635218949601087, 0.7630777558637798, 0.000744396809368312, 0.000705602778853534, 0.0007261750421348165, 0.000763049805623852, 0.0007539122670196068, 0.0007427679830280632, -9.999264794043897, 0.2642653373005263, 0.19640955190958442, 0.000753865969659889, 0.0007460481313597169, 0.0007071482543869136, 0.10432884626973715, 0.0007796744758364576, 0.000767761434276337, -9.99924033727541, 0.0007198789826983158, 0.000740687413504879, 0.0007283194593352332, 0.7729744748476297, 0.4817321578281105, 0.0007044107896000068, 0.54860927446193, 0.0007126972293117724, 0.0007047065919091736, 0.0006960850573211267, 0.0006857569283387464, 0.0006786326392082715, -9.999266669524495, 0.0007254829436802563, 0.0007172047285570162, 0.0007082766659518027, 0.09593846079501987, 0.0007199850921234903, 0.0007118311511076065, -9.999296994502604, 0.0006925016645054997, 0.0006852372848056659, 0.0007184945167437928, 0.0007103741087911128, 0.0007016142283259146, 0.00069112259790672, 0.0006838869716835418, 0.0007185119780736753, 0.10241916806785192, 0.0007039046509463639, 0.0006953026041809814, 6.350682237585602, 0.0007205302997932922, 2.8012819615150133, 0.0007035744930479217, 0.07782361961464929, 0.0006864019135004057, -9.999267294556514, 0.000724255760212956, 0.3906747803972712, -9.999294999848932, 0.0006974723473203567, -19.999313318335318, 0.0006772799174921596, 0.9540358183360393, 0.1485198100445075, 0.0006513116857680807, 0.000669477858099048, 0.0006598661486310883, 0.0006522274348437337, 0.0006437327620776852, 0.0006361294226007901, -9.999309376239536, 0.046100038295075266, 0.0006722990322794555, 0.26840578470405, 0.0006557455175301447, 0.0006759047072255263, 0.000666108892413359, 0.0006583258055805423, 0.0006496725878601816, 0.0006419291247820711, 0.0006745908815180653, 0.000664832842938172, 0.0006570793753393766, 0.3740357434641907, -9.999322034866521, -9.999331171766721, 0.0006592343369062178, 0.0006516101602829197, 0.0006431314547343399, 0.000677037809376198, -9.506133487869178, 0.514316875754366, 0.0006518607674648233, 0.0006440653654416925, 0.0006878059498388463, 0.0006776646637234007, -9.99933037192234, 0.0006606603885358869, 0.0006526543857264727], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 412.1970714846018, "mean_inference_ms": 2.1773585188575937, "mean_action_processing_ms": 0.14969101348620348, "mean_env_wait_ms": 3.1805041509764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010339021682739258, "StateBufferConnector_ms": 0.006819009780883789, "ViewRequirementAgentConnector_ms": 0.18471550941467285}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 54600, "num_env_steps_sampled": 29000, "num_env_steps_trained": 54600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.955472189461253, "num_env_steps_trained_throughput_per_sec": 9.663170769449444, "timesteps_total": 29000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 29000, "timers": {"training_iteration_time_ms": 7884.016, "sample_time_ms": 7823.795, "load_time_ms": 0.231, "load_throughput": 337900.963, "learn_time_ms": 12.697, "learn_throughput": 6143.089, "synch_weights_time_ms": 11.304}, "counters": {"num_env_steps_sampled": 29000, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 54600, "last_target_update_ts": 28600, "num_target_updates": 54}, "done": false, "episodes_total": 1084, "training_iteration": 29, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-06-37", "timestamp": 1713413197, "time_this_iter_s": 201.80618715286255, "time_total_s": 6950.286115407944, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 6950.286115407944, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 14.393728222996515, "ram_util_percent": 17.65017421602787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013382044853642583, "cur_lr": 0.01}, "td_error": [1.6968896389007568, 1.9464142322540283, 1.6968916654586792, 1.6968895196914673, 1.6968896389007568, 1.6968903541564941, 1.696890115737915, 1.0964152812957764, 1.2368073463439941, 1.6974915266036987, 1.6968903541564941, 1.237579584121704, 1.732790231704712, 1.7222187519073486, 1.6974867582321167, 1.7324753999710083, 1.6968903541564941, 1.9561454057693481, 1.6968945264816284, 1.722465991973877, 1.6968951225280762, 1.6969019174575806, 1.2453129291534424, 1.7391775846481323, 1.7324299812316895, 2.3978278636932373, 1.832786202430725, 1.915841817855835, 1.696895956993103, 1.696891188621521, 1.6968905925750732, 1.7226300239562988, 1.6968917846679688, 1.722772240638733, 1.697080135345459, 1.696890950202942, 1.722153902053833, 1.1856887340545654, 2.3998184204101562, 1.696890950202942, 1.7327390909194946, 1.6968894004821777, 1.0964033603668213, 1.7324260473251343, 1.8637135028839111, 2.069486618041992, 1.6968903541564941, 1.1857900619506836, 1.7325632572174072, 1.6968895196914673, 1.696890950202942, 1.7221616506576538, 1.8257734775543213, 1.732761025428772, 1.2454729080200195, 1.0964155197143555, 1.6968916654586792, 2.0538489818573, 0.9557988047599792, 1.7227598428726196, 1.696890115737915, 1.7228920459747314, 1.7227126359939575, 1.696890115737915, 1.7221741676330566, 1.6968945264816284, 1.6968923807144165, 2.0216257572174072, 1.6969058513641357, 1.6968944072723389, 1.0956144332885742, 1.72212815284729, 1.1857905387878418, 1.6968894004821777, 1.6968897581100464, 1.8710472583770752, 1.722622036933899, 1.7364977598190308], "mean_td_error": 1.670382022857666, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 725.0, "diff_num_grad_updates_vs_sampler_policy": 724.0}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 56550, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 56550, "last_target_update_ts": 29640, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": 6.350682237585602, "episode_reward_min": -19.999313318335318, "episode_reward_mean": -1.3612168378424918, "episode_len_mean": 25.08, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0007184945167437928, 0.0007103741087911128, 0.0007016142283259146, 0.00069112259790672, 0.0006838869716835418, 0.0007185119780736753, 0.10241916806785192, 0.0007039046509463639, 0.0006953026041809814, 6.350682237585602, 0.0007205302997932922, 2.8012819615150133, 0.0007035744930479217, 0.07782361961464929, 0.0006864019135004057, -9.999267294556514, 0.000724255760212956, 0.3906747803972712, -9.999294999848932, 0.0006974723473203567, -19.999313318335318, 0.0006772799174921596, 0.9540358183360393, 0.1485198100445075, 0.0006513116857680807, 0.000669477858099048, 0.0006598661486310883, 0.0006522274348437337, 0.0006437327620776852, 0.0006361294226007901, -9.999309376239536, 0.046100038295075266, 0.0006722990322794555, 0.26840578470405, 0.0006557455175301447, 0.0006759047072255263, 0.000666108892413359, 0.0006583258055805423, 0.0006496725878601816, 0.0006419291247820711, 0.0006745908815180653, 0.000664832842938172, 0.0006570793753393766, 0.3740357434641907, -9.999322034866521, -9.999331171766721, 0.0006592343369062178, 0.0006516101602829197, 0.0006431314547343399, 0.000677037809376198, -9.506133487869178, 0.514316875754366, 0.0006518607674648233, 0.0006440653654416925, 0.0006878059498388463, 0.0006776646637234007, -9.99933037192234, 0.0006606603885358869, 0.0006526543857264727, 0.000643529332948849, 0.0006117135761698959, 0.0006319095333162263, 0.10220831776529135, 0.0006172118639081065, 5.845306009746537, 0.0006247814762095781, -9.99938283436159, 0.0006100526259243463, 0.0006036967421244859, 0.5485651805527816, -9.99938412262501, 3.2882693427773524, 0.0006282926115210249, 0.000620922900273962, 0.9747058125092889, 0.0006304212429970801, 0.0006226675789495361, 0.0006154284998135276, 0.0006089606793999813, -9.999359149088495, 0.0006092066681007004, 0.0006293412894048439, 0.0006216139956624981, 0.00061439925583891, 0.0006079529412338089, -9.932092668805435, -9.99939525133424, 0.000624761397785327, 0.0006171454430998423, 0.16093489847752818, 0.0006122180930424626, -9.999367581255841, 0.0006246236300388563, 0.0006173392558153953, 0.0006108314166215636, 0.0006203010013789563, -9.9993593123515, 0.15565795227542373, 0.0006254969952178099, 0.1609433332988719], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 413.2868982275382, "mean_inference_ms": 2.1754085916844095, "mean_action_processing_ms": 0.14952913307923402, "mean_env_wait_ms": 3.072426407464401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009942054748535156, "StateBufferConnector_ms": 0.0064029693603515625, "ViewRequirementAgentConnector_ms": 0.17860627174377441}}, "episode_reward_max": 6.350682237585602, "episode_reward_min": -19.999313318335318, "episode_reward_mean": -1.3612168378424918, "episode_len_mean": 25.08, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0007184945167437928, 0.0007103741087911128, 0.0007016142283259146, 0.00069112259790672, 0.0006838869716835418, 0.0007185119780736753, 0.10241916806785192, 0.0007039046509463639, 0.0006953026041809814, 6.350682237585602, 0.0007205302997932922, 2.8012819615150133, 0.0007035744930479217, 0.07782361961464929, 0.0006864019135004057, -9.999267294556514, 0.000724255760212956, 0.3906747803972712, -9.999294999848932, 0.0006974723473203567, -19.999313318335318, 0.0006772799174921596, 0.9540358183360393, 0.1485198100445075, 0.0006513116857680807, 0.000669477858099048, 0.0006598661486310883, 0.0006522274348437337, 0.0006437327620776852, 0.0006361294226007901, -9.999309376239536, 0.046100038295075266, 0.0006722990322794555, 0.26840578470405, 0.0006557455175301447, 0.0006759047072255263, 0.000666108892413359, 0.0006583258055805423, 0.0006496725878601816, 0.0006419291247820711, 0.0006745908815180653, 0.000664832842938172, 0.0006570793753393766, 0.3740357434641907, -9.999322034866521, -9.999331171766721, 0.0006592343369062178, 0.0006516101602829197, 0.0006431314547343399, 0.000677037809376198, -9.506133487869178, 0.514316875754366, 0.0006518607674648233, 0.0006440653654416925, 0.0006878059498388463, 0.0006776646637234007, -9.99933037192234, 0.0006606603885358869, 0.0006526543857264727, 0.000643529332948849, 0.0006117135761698959, 0.0006319095333162263, 0.10220831776529135, 0.0006172118639081065, 5.845306009746537, 0.0006247814762095781, -9.99938283436159, 0.0006100526259243463, 0.0006036967421244859, 0.5485651805527816, -9.99938412262501, 3.2882693427773524, 0.0006282926115210249, 0.000620922900273962, 0.9747058125092889, 0.0006304212429970801, 0.0006226675789495361, 0.0006154284998135276, 0.0006089606793999813, -9.999359149088495, 0.0006092066681007004, 0.0006293412894048439, 0.0006216139956624981, 0.00061439925583891, 0.0006079529412338089, -9.932092668805435, -9.99939525133424, 0.000624761397785327, 0.0006171454430998423, 0.16093489847752818, 0.0006122180930424626, -9.999367581255841, 0.0006246236300388563, 0.0006173392558153953, 0.0006108314166215636, 0.0006203010013789563, -9.9993593123515, 0.15565795227542373, 0.0006254969952178099, 0.1609433332988719], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 413.2868982275382, "mean_inference_ms": 2.1754085916844095, "mean_action_processing_ms": 0.14952913307923402, "mean_env_wait_ms": 3.072426407464401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009942054748535156, "StateBufferConnector_ms": 0.0064029693603515625, "ViewRequirementAgentConnector_ms": 0.17860627174377441}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 56550, "num_env_steps_sampled": 30000, "num_env_steps_trained": 56550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.44483988477059, "num_env_steps_trained_throughput_per_sec": 8.66743777530265, "timesteps_total": 30000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 9005.029, "sample_time_ms": 8941.537, "load_time_ms": 0.248, "load_throughput": 314512.317, "learn_time_ms": 13.703, "learn_throughput": 5692.357, "synch_weights_time_ms": 11.355}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 56550, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 56550, "last_target_update_ts": 29640, "num_target_updates": 56}, "done": false, "episodes_total": 1125, "training_iteration": 30, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-10-22", "timestamp": 1713413422, "time_this_iter_s": 224.98895621299744, "time_total_s": 7175.275071620941, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7175.275071620941, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 13.819999999999999, "ram_util_percent": 17.797812500000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0008778480114415288, "cur_lr": 0.01}, "td_error": [1.7172393798828125, 1.6937826871871948, 1.0878510475158691, 1.6942850351333618, 1.6938471794128418, 1.6937832832336426, 1.693787932395935, 1.693782925605774, 1.6937837600708008, 1.6937822103500366, 1.693892478942871, 1.6937836408615112, 1.6937824487686157, 1.6937952041625977, 1.6937825679779053, 1.6937892436981201, 1.693782925605774, 1.6937834024429321, 1.693785548210144, 1.7310951948165894, 1.7310878038406372, 1.6937835216522217, 1.693782091140747, 1.7313799858093262, 1.7173051834106445, 2.385209798812866, 1.6937819719314575, 1.693784475326538, 1.6937841176986694, 1.6937851905822754, 1.693782925605774, 1.6966428756713867, 1.6937832832336426, 1.6937823295593262, 1.693782091140747, 1.693782091140747, 2.389326572418213, 1.2223604917526245, 1.7313470840454102, 1.731095790863037, 1.6937825679779053, 1.6937824487686157, 1.693782925605774, 1.0878496170043945, 1.6937819719314575, 1.7431684732437134, 1.7312480211257935, 1.9724295139312744, 1.696376919746399, 1.6937823295593262, 1.6937824487686157, 1.693784236907959, 1.6937823295593262, 1.7317466735839844, 1.7177181243896484, 1.6937838792800903, 1.7172489166259766, 1.731880784034729, 1.7310949563980103, 1.6937826871871948, 1.7313010692596436, 1.0878491401672363, 1.7289574146270752, 1.6937837600708008, 1.6937825679779053, 1.717461109161377, 1.788811206817627, 1.6937841176986694, 1.6937832832336426, 1.8556671142578125, 1.0878362655639648, 1.7176181077957153, 1.6937828063964844, 1.0878260135650635, 1.6937942504882812, 1.6937843561172485, 0.4746217727661133, 1.6937823295593262], "mean_td_error": 1.6657100915908813, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 750.0, "diff_num_grad_updates_vs_sampler_policy": 749.0}}, "num_env_steps_sampled": 31000, "num_env_steps_trained": 58500, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 58500, "last_target_update_ts": 30680, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": 5.845306009746537, "episode_reward_min": -9.999425854369841, "episode_reward_mean": -1.6133124442559341, "episode_len_mean": 25.02, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0006745908815180653, 0.000664832842938172, 0.0006570793753393766, 0.3740357434641907, -9.999322034866521, -9.999331171766721, 0.0006592343369062178, 0.0006516101602829197, 0.0006431314547343399, 0.000677037809376198, -9.506133487869178, 0.514316875754366, 0.0006518607674648233, 0.0006440653654416925, 0.0006878059498388463, 0.0006776646637234007, -9.99933037192234, 0.0006606603885358869, 0.0006526543857264727, 0.000643529332948849, 0.0006117135761698959, 0.0006319095333162263, 0.10220831776529135, 0.0006172118639081065, 5.845306009746537, 0.0006247814762095781, -9.99938283436159, 0.0006100526259243463, 0.0006036967421244859, 0.5485651805527816, -9.99938412262501, 3.2882693427773524, 0.0006282926115210249, 0.000620922900273962, 0.9747058125092889, 0.0006304212429970801, 0.0006226675789495361, 0.0006154284998135276, 0.0006089606793999813, -9.999359149088495, 0.0006092066681007004, 0.0006293412894048439, 0.0006216139956624981, 0.00061439925583891, 0.0006079529412338089, -9.932092668805435, -9.99939525133424, 0.000624761397785327, 0.0006171454430998423, 0.16093489847752818, 0.0006122180930424626, -9.999367581255841, 0.0006246236300388563, 0.0006173392558153953, 0.0006108314166215636, 0.0006203010013789563, -9.9993593123515, 0.15565795227542373, 0.0006254969952178099, 0.1609433332988719, 0.0006107066966049836, 0.0006033417732367455, 0.7741393062893605, 0.0005898604617598844, 0.0005604169867306566, 0.0005964988750174877, 0.09590583477495054, -9.999416292112171, 0.0005546307688353608, 0.0005707730120522903, 0.000614339676012065, 0.0006068874297250299, 0.0005998999067740931, 0.0005931911659635943, -9.815058336692413, 0.0006016375428245239, 0.0005947697257714995, 0.0005881746208751137, 0.0005588317925354279, -9.953012790579356, 0.0006006538690656158, 0.0005938083675864926, 0.0005872344504059739, 0.0005579477107031554, -9.999425854369841, -9.184700866975346, 3.288231445333734, 0.0005899881983131743, -9.999416501319592, 0.0005544340150246246, 0.0006034635038833376, 0.07730160479701126, 0.0005904345397450373, 0.0005609567702235135, -9.999422768777231, 0.0006114802701107191, 0.0006043871843458772, 0.6499877665620662, 0.0005676963446380036, 0.0005840530132448858], "episode_lengths": [25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 26, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 414.27874038612225, "mean_inference_ms": 2.1733687731583298, "mean_action_processing_ms": 0.14933157802969682, "mean_env_wait_ms": 2.9744470458739123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010309696197509766, "StateBufferConnector_ms": 0.0063228607177734375, "ViewRequirementAgentConnector_ms": 0.17700695991516113}}, "episode_reward_max": 5.845306009746537, "episode_reward_min": -9.999425854369841, "episode_reward_mean": -1.6133124442559341, "episode_len_mean": 25.02, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0006745908815180653, 0.000664832842938172, 0.0006570793753393766, 0.3740357434641907, -9.999322034866521, -9.999331171766721, 0.0006592343369062178, 0.0006516101602829197, 0.0006431314547343399, 0.000677037809376198, -9.506133487869178, 0.514316875754366, 0.0006518607674648233, 0.0006440653654416925, 0.0006878059498388463, 0.0006776646637234007, -9.99933037192234, 0.0006606603885358869, 0.0006526543857264727, 0.000643529332948849, 0.0006117135761698959, 0.0006319095333162263, 0.10220831776529135, 0.0006172118639081065, 5.845306009746537, 0.0006247814762095781, -9.99938283436159, 0.0006100526259243463, 0.0006036967421244859, 0.5485651805527816, -9.99938412262501, 3.2882693427773524, 0.0006282926115210249, 0.000620922900273962, 0.9747058125092889, 0.0006304212429970801, 0.0006226675789495361, 0.0006154284998135276, 0.0006089606793999813, -9.999359149088495, 0.0006092066681007004, 0.0006293412894048439, 0.0006216139956624981, 0.00061439925583891, 0.0006079529412338089, -9.932092668805435, -9.99939525133424, 0.000624761397785327, 0.0006171454430998423, 0.16093489847752818, 0.0006122180930424626, -9.999367581255841, 0.0006246236300388563, 0.0006173392558153953, 0.0006108314166215636, 0.0006203010013789563, -9.9993593123515, 0.15565795227542373, 0.0006254969952178099, 0.1609433332988719, 0.0006107066966049836, 0.0006033417732367455, 0.7741393062893605, 0.0005898604617598844, 0.0005604169867306566, 0.0005964988750174877, 0.09590583477495054, -9.999416292112171, 0.0005546307688353608, 0.0005707730120522903, 0.000614339676012065, 0.0006068874297250299, 0.0005998999067740931, 0.0005931911659635943, -9.815058336692413, 0.0006016375428245239, 0.0005947697257714995, 0.0005881746208751137, 0.0005588317925354279, -9.953012790579356, 0.0006006538690656158, 0.0005938083675864926, 0.0005872344504059739, 0.0005579477107031554, -9.999425854369841, -9.184700866975346, 3.288231445333734, 0.0005899881983131743, -9.999416501319592, 0.0005544340150246246, 0.0006034635038833376, 0.07730160479701126, 0.0005904345397450373, 0.0005609567702235135, -9.999422768777231, 0.0006114802701107191, 0.0006043871843458772, 0.6499877665620662, 0.0005676963446380036, 0.0005840530132448858], "episode_lengths": [25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 26, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 414.27874038612225, "mean_inference_ms": 2.1733687731583298, "mean_action_processing_ms": 0.14933157802969682, "mean_env_wait_ms": 2.9744470458739123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010309696197509766, "StateBufferConnector_ms": 0.0063228607177734375, "ViewRequirementAgentConnector_ms": 0.17700695991516113}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 58500, "num_env_steps_sampled": 31000, "num_env_steps_trained": 58500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.9351736211850445, "num_env_steps_trained_throughput_per_sec": 9.623588561310838, "timesteps_total": 31000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 31000, "timers": {"training_iteration_time_ms": 6757.375, "sample_time_ms": 6697.477, "load_time_ms": 0.23, "load_throughput": 338670.509, "learn_time_ms": 12.578, "learn_throughput": 6201.087, "synch_weights_time_ms": 10.659}, "counters": {"num_env_steps_sampled": 31000, "num_env_steps_trained": 58500, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 58500, "last_target_update_ts": 30680, "num_target_updates": 58}, "done": false, "episodes_total": 1165, "training_iteration": 31, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-13-45", "timestamp": 1713413625, "time_this_iter_s": 202.63692665100098, "time_total_s": 7377.911998271942, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7377.911998271942, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 14.711072664359861, "ram_util_percent": 17.95294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.00189125444740057, "cur_lr": 0.01}, "td_error": [1.0696301460266113, 1.0696583986282349, 1.6723847389221191, 1.6890792846679688, 1.2009670734405518, 1.8377467393875122, 1.6723883152008057, 1.0696625709533691, 1.6723829507827759, 1.6723843812942505, 1.716903805732727, 1.7070393562316895, 2.4309499263763428, 1.672407865524292, 1.6723846197128296, 2.0221104621887207, 1.672383189201355, 0.9729723334312439, 1.672383427619934, 1.7015838623046875, 1.6723867654800415, 2.106473207473755, 2.0979154109954834, 1.7070528268814087, 1.6723839044570923, 1.6723839044570923, 1.2066528797149658, 1.7071819305419922, 2.0486764907836914, 1.6723828315734863, 1.6723977327346802, 1.2066919803619385, 1.672384262084961, 1.6723841428756714, 1.672385334968567, 1.6723861694335938, 1.7070587873458862, 1.6723875999450684, 1.6723898649215698, 1.672426462173462, 1.672385811805725, 2.098464250564575, 1.701544165611267, 1.7072888612747192, 0.464202880859375, 1.6723850965499878, 1.6723837852478027, 1.672395944595337, 1.6723828315734863, 1.7070735692977905, 1.6723828315734863, 1.672385573387146, 1.672431468963623, 1.7015457153320312, 1.7367640733718872, 1.6723847389221191, 1.672383427619934, 1.6723827123641968, 0.464202880859375, 1.67238450050354, 1.7071552276611328, 1.7070486545562744, 1.6723963022232056, 1.7015690803527832, 1.672385573387146, 1.7070355415344238, 1.7077360153198242, 1.6723847389221191, 1.7071040868759155, 1.6723906993865967, 1.672385573387146, 1.6723829507827759, 3.709658622741699, 1.7015503644943237, 1.6723906993865967, 1.6723829507827759, 2.0907466411590576, 1.6723841428756714], "mean_td_error": 1.6687772274017334, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 775.0, "diff_num_grad_updates_vs_sampler_policy": 774.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 60450, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 60450, "last_target_update_ts": 31720, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": 3.288231445333734, "episode_reward_min": -29.99944085480251, "episode_reward_mean": -1.7190212447660458, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0006092066681007004, 0.0006293412894048439, 0.0006216139956624981, 0.00061439925583891, 0.0006079529412338089, -9.932092668805435, -9.99939525133424, 0.000624761397785327, 0.0006171454430998423, 0.16093489847752818, 0.0006122180930424626, -9.999367581255841, 0.0006246236300388563, 0.0006173392558153953, 0.0006108314166215636, 0.0006203010013789563, -9.9993593123515, 0.15565795227542373, 0.0006254969952178099, 0.1609433332988719, 0.0006107066966049836, 0.0006033417732367455, 0.7741393062893605, 0.0005898604617598844, 0.0005604169867306566, 0.0005964988750174877, 0.09590583477495054, -9.999416292112171, 0.0005546307688353608, 0.0005707730120522903, 0.000614339676012065, 0.0006068874297250299, 0.0005998999067740931, 0.0005931911659635943, -9.815058336692413, 0.0006016375428245239, 0.0005947697257714995, 0.0005881746208751137, 0.0005588317925354279, -9.953012790579356, 0.0006006538690656158, 0.0005938083675864926, 0.0005872344504059739, 0.0005579477107031554, -9.999425854369841, -9.184700866975346, 3.288231445333734, 0.0005899881983131743, -9.999416501319592, 0.0005544340150246246, 0.0006034635038833376, 0.07730160479701126, 0.0005904345397450373, 0.0005609567702235135, -9.999422768777231, 0.0006114802701107191, 0.0006043871843458772, 0.6499877665620662, 0.0005676963446380036, 0.0005840530132448858, 0.0005766551201524339, 0.7600315435396358, -9.878677779221043, -29.99944085480251, 0.0005511384321251842, 0.0005643766623579445, -9.999441535224081, 0.0005533165031907064, 0.0005454760240569236, 0.2314958319298728, 0.0005800394576734088, 0.0005734348878180063, 0.0005673321991620381, 0.0005620204473095985, 0.0005539331968123594, 0.0005691983570532068, 0.0005631850450331708, 0.0005579502952735174, 0.0005499789093714251, -9.999455366574, 0.0005676733637784516, 0.000561692064308543, 0.000556484899091813, 0.0005485550267784578, 0.0005432299751030434, 0.0005705729716086882, 0.000564181080512275, 0.0005582727722544885, 0.0005531285104734956, 0.0005452933196754397, 0.0005706632728299576, -9.999435380357125, 0.0005593578156992692, 0.0005513464552359765, 0.0005459673114081848, 0.0005773572337857086, 0.0005711712151405745, 0.4579565910697683, 0.0005576728286278784, 0.0005521700899700705], "episode_lengths": [24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 26, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 26, 28, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 415.322728605289, "mean_inference_ms": 2.1717426094774557, "mean_action_processing_ms": 0.1491805863923015, "mean_env_wait_ms": 2.883754523619924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010442495346069336, "StateBufferConnector_ms": 0.006466388702392578, "ViewRequirementAgentConnector_ms": 0.17752909660339355}}, "episode_reward_max": 3.288231445333734, "episode_reward_min": -29.99944085480251, "episode_reward_mean": -1.7190212447660458, "episode_len_mean": 25.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0006092066681007004, 0.0006293412894048439, 0.0006216139956624981, 0.00061439925583891, 0.0006079529412338089, -9.932092668805435, -9.99939525133424, 0.000624761397785327, 0.0006171454430998423, 0.16093489847752818, 0.0006122180930424626, -9.999367581255841, 0.0006246236300388563, 0.0006173392558153953, 0.0006108314166215636, 0.0006203010013789563, -9.9993593123515, 0.15565795227542373, 0.0006254969952178099, 0.1609433332988719, 0.0006107066966049836, 0.0006033417732367455, 0.7741393062893605, 0.0005898604617598844, 0.0005604169867306566, 0.0005964988750174877, 0.09590583477495054, -9.999416292112171, 0.0005546307688353608, 0.0005707730120522903, 0.000614339676012065, 0.0006068874297250299, 0.0005998999067740931, 0.0005931911659635943, -9.815058336692413, 0.0006016375428245239, 0.0005947697257714995, 0.0005881746208751137, 0.0005588317925354279, -9.953012790579356, 0.0006006538690656158, 0.0005938083675864926, 0.0005872344504059739, 0.0005579477107031554, -9.999425854369841, -9.184700866975346, 3.288231445333734, 0.0005899881983131743, -9.999416501319592, 0.0005544340150246246, 0.0006034635038833376, 0.07730160479701126, 0.0005904345397450373, 0.0005609567702235135, -9.999422768777231, 0.0006114802701107191, 0.0006043871843458772, 0.6499877665620662, 0.0005676963446380036, 0.0005840530132448858, 0.0005766551201524339, 0.7600315435396358, -9.878677779221043, -29.99944085480251, 0.0005511384321251842, 0.0005643766623579445, -9.999441535224081, 0.0005533165031907064, 0.0005454760240569236, 0.2314958319298728, 0.0005800394576734088, 0.0005734348878180063, 0.0005673321991620381, 0.0005620204473095985, 0.0005539331968123594, 0.0005691983570532068, 0.0005631850450331708, 0.0005579502952735174, 0.0005499789093714251, -9.999455366574, 0.0005676733637784516, 0.000561692064308543, 0.000556484899091813, 0.0005485550267784578, 0.0005432299751030434, 0.0005705729716086882, 0.000564181080512275, 0.0005582727722544885, 0.0005531285104734956, 0.0005452933196754397, 0.0005706632728299576, -9.999435380357125, 0.0005593578156992692, 0.0005513464552359765, 0.0005459673114081848, 0.0005773572337857086, 0.0005711712151405745, 0.4579565910697683, 0.0005576728286278784, 0.0005521700899700705], "episode_lengths": [24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 26, 26, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 26, 28, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 415.322728605289, "mean_inference_ms": 2.1717426094774557, "mean_action_processing_ms": 0.1491805863923015, "mean_env_wait_ms": 2.883754523619924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010442495346069336, "StateBufferConnector_ms": 0.006466388702392578, "ViewRequirementAgentConnector_ms": 0.17752909660339355}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 60450, "num_env_steps_sampled": 32000, "num_env_steps_trained": 60450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.900541250732047, "num_env_steps_trained_throughput_per_sec": 11.506055438927492, "timesteps_total": 32000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 6805.644, "sample_time_ms": 6742.573, "load_time_ms": 0.247, "load_throughput": 316428.776, "learn_time_ms": 13.297, "learn_throughput": 5865.907, "synch_weights_time_ms": 11.864}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 60450, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 60450, "last_target_update_ts": 31720, "num_target_updates": 60}, "done": false, "episodes_total": 1205, "training_iteration": 32, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-16-34", "timestamp": 1713413794, "time_this_iter_s": 169.48480558395386, "time_total_s": 7547.396803855896, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7547.396803855896, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.46307053941909, "ram_util_percent": 18.11535269709543}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.002858154708519578, "cur_lr": 0.01}, "td_error": [2.019651174545288, 2.0030977725982666, 1.6905437707901, 1.6369746923446655, 1.6369765996932983, 1.6369783878326416, 2.0102500915527344, 0.9500496983528137, 1.6369755268096924, 1.0542070865631104, 1.6369761228561401, 1.6369757652282715, 1.637378215789795, 1.716219425201416, 2.464878797531128, 1.4453766345977783, 1.6369754076004028, 0.47306448221206665, 1.6369757652282715, 1.6369800567626953, 1.6369746923446655, 1.6369781494140625, 1.054208755493164, 1.6369788646697998, 1.6797633171081543, 1.6369757652282715, 1.6371334791183472, 1.6369773149490356, 2.002270221710205, 1.636978030204773, 1.9749497175216675, 1.6369789838790894, 1.6912000179290771, 1.6369755268096924, 1.6369779109954834, 0.9271528720855713, 1.6369761228561401, 1.9750635623931885, 1.636975646018982, 1.6369754076004028, 1.6369794607162476, 1.6369973421096802, 1.690410852432251, 0.9500496983528137, 1.6369757652282715, 1.0542058944702148, 1.6369796991348267, 1.6913398504257202, 1.636997103691101, 1.636976718902588, 1.636976718902588, 1.6369798183441162, 1.6369794607162476, 1.713154673576355, 1.636974811553955, 0.9510117173194885, 1.6369773149490356, 1.6369822025299072, 1.6998810768127441, 1.6369768381118774, 1.126018762588501, 1.706512689590454, 1.6369754076004028, 1.8623502254486084, 2.0111019611358643, 1.6369764804840088, 1.6369775533676147, 1.637518048286438, 1.679422378540039, 1.637003779411316, 1.6380864381790161, 1.6921979188919067, 1.6909574270248413, 1.679412603378296, 1.6369755268096924, 1.6369764804840088, 1.69077467918396, 1.6369779109954834], "mean_td_error": 1.6113717555999756, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 800.0, "diff_num_grad_updates_vs_sampler_policy": 799.0}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 62400, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 62400, "last_target_update_ts": 32760, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": 3.288231445333734, "episode_reward_min": -29.99944085480251, "episode_reward_mean": -2.0101175239556386, "episode_len_mean": 25.09, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.953012790579356, 0.0006006538690656158, 0.0005938083675864926, 0.0005872344504059739, 0.0005579477107031554, -9.999425854369841, -9.184700866975346, 3.288231445333734, 0.0005899881983131743, -9.999416501319592, 0.0005544340150246246, 0.0006034635038833376, 0.07730160479701126, 0.0005904345397450373, 0.0005609567702235135, -9.999422768777231, 0.0006114802701107191, 0.0006043871843458772, 0.6499877665620662, 0.0005676963446380036, 0.0005840530132448858, 0.0005766551201524339, 0.7600315435396358, -9.878677779221043, -29.99944085480251, 0.0005511384321251842, 0.0005643766623579445, -9.999441535224081, 0.0005533165031907064, 0.0005454760240569236, 0.2314958319298728, 0.0005800394576734088, 0.0005734348878180063, 0.0005673321991620381, 0.0005620204473095985, 0.0005539331968123594, 0.0005691983570532068, 0.0005631850450331708, 0.0005579502952735174, 0.0005499789093714251, -9.999455366574, 0.0005676733637784516, 0.000561692064308543, 0.000556484899091813, 0.0005485550267784578, 0.0005432299751030434, 0.0005705729716086882, 0.000564181080512275, 0.0005582727722544885, 0.0005531285104734956, 0.0005452933196754397, 0.0005706632728299576, -9.999435380357125, 0.0005593578156992692, 0.0005513464552359765, 0.0005459673114081848, 0.0005773572337857086, 0.0005711712151405745, 0.4579565910697683, 0.0005576728286278784, 0.0005521700899700705, 0.0005457633287009765, 0.0005411752920116342, 0.0005365731886476948, 0.21941406000576458, 0.0005056041985421505, -9.041874980540104, 0.0005313778776056007, 0.0005265845713040397, 0.0005006916089596022, 0.0005172739556558441, 0.04597296532519741, 0.0005445886487800046, 0.0005399285704740474, 0.0005349804870057936, 0.0005085971938271212, 0.0005400572826923879, -9.999464525452792, 0.0005306069419102446, -9.99949551735639, -9.999478844748038, 0.0005386842617020888, 1.10063672395485, -19.999470536206974, 0.03890944101461642, 0.0005400311299148656, 0.000535538579891813, -9.999468968120821, -9.999473735967793, 0.000500371197323163, 0.000541375858434904, -9.999463232846546, 0.0005318797259571648, 0.0005056778012809981, 0.0005223826050714534, 0.0005474741512805023, 0.0005427647830001036, 0.12965058034717736, 0.0005114486427935542, 0.0005282941322918617], "episode_lengths": [26, 25, 25, 25, 24, 26, 26, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 26, 28, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 26, 25, 25, 27, 24, 25, 25, 26, 26, 24, 25, 26, 25, 24, 25, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 416.0571272516731, "mean_inference_ms": 2.171077054562319, "mean_action_processing_ms": 0.14911123341240007, "mean_env_wait_ms": 2.7991416229144783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010309696197509766, "StateBufferConnector_ms": 0.006671905517578125, "ViewRequirementAgentConnector_ms": 0.18117213249206543}}, "episode_reward_max": 3.288231445333734, "episode_reward_min": -29.99944085480251, "episode_reward_mean": -2.0101175239556386, "episode_len_mean": 25.09, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.953012790579356, 0.0006006538690656158, 0.0005938083675864926, 0.0005872344504059739, 0.0005579477107031554, -9.999425854369841, -9.184700866975346, 3.288231445333734, 0.0005899881983131743, -9.999416501319592, 0.0005544340150246246, 0.0006034635038833376, 0.07730160479701126, 0.0005904345397450373, 0.0005609567702235135, -9.999422768777231, 0.0006114802701107191, 0.0006043871843458772, 0.6499877665620662, 0.0005676963446380036, 0.0005840530132448858, 0.0005766551201524339, 0.7600315435396358, -9.878677779221043, -29.99944085480251, 0.0005511384321251842, 0.0005643766623579445, -9.999441535224081, 0.0005533165031907064, 0.0005454760240569236, 0.2314958319298728, 0.0005800394576734088, 0.0005734348878180063, 0.0005673321991620381, 0.0005620204473095985, 0.0005539331968123594, 0.0005691983570532068, 0.0005631850450331708, 0.0005579502952735174, 0.0005499789093714251, -9.999455366574, 0.0005676733637784516, 0.000561692064308543, 0.000556484899091813, 0.0005485550267784578, 0.0005432299751030434, 0.0005705729716086882, 0.000564181080512275, 0.0005582727722544885, 0.0005531285104734956, 0.0005452933196754397, 0.0005706632728299576, -9.999435380357125, 0.0005593578156992692, 0.0005513464552359765, 0.0005459673114081848, 0.0005773572337857086, 0.0005711712151405745, 0.4579565910697683, 0.0005576728286278784, 0.0005521700899700705, 0.0005457633287009765, 0.0005411752920116342, 0.0005365731886476948, 0.21941406000576458, 0.0005056041985421505, -9.041874980540104, 0.0005313778776056007, 0.0005265845713040397, 0.0005006916089596022, 0.0005172739556558441, 0.04597296532519741, 0.0005445886487800046, 0.0005399285704740474, 0.0005349804870057936, 0.0005085971938271212, 0.0005400572826923879, -9.999464525452792, 0.0005306069419102446, -9.99949551735639, -9.999478844748038, 0.0005386842617020888, 1.10063672395485, -19.999470536206974, 0.03890944101461642, 0.0005400311299148656, 0.000535538579891813, -9.999468968120821, -9.999473735967793, 0.000500371197323163, 0.000541375858434904, -9.999463232846546, 0.0005318797259571648, 0.0005056778012809981, 0.0005223826050714534, 0.0005474741512805023, 0.0005427647830001036, 0.12965058034717736, 0.0005114486427935542, 0.0005282941322918617], "episode_lengths": [26, 25, 25, 25, 24, 26, 26, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 26, 28, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 26, 25, 25, 27, 24, 25, 25, 26, 26, 24, 25, 26, 25, 24, 25, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 416.0571272516731, "mean_inference_ms": 2.171077054562319, "mean_action_processing_ms": 0.14911123341240007, "mean_env_wait_ms": 2.7991416229144783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010309696197509766, "StateBufferConnector_ms": 0.006671905517578125, "ViewRequirementAgentConnector_ms": 0.18117213249206543}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 62400, "num_env_steps_sampled": 33000, "num_env_steps_trained": 62400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.928763691989187, "num_env_steps_trained_throughput_per_sec": 9.611089199378913, "timesteps_total": 33000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 9035.48, "sample_time_ms": 8971.346, "load_time_ms": 0.246, "load_throughput": 317472.792, "learn_time_ms": 13.146, "learn_throughput": 5933.28, "synch_weights_time_ms": 11.929}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 62400, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 62400, "last_target_update_ts": 32760, "num_target_updates": 62}, "done": false, "episodes_total": 1244, "training_iteration": 33, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-19-57", "timestamp": 1713413997, "time_this_iter_s": 202.89875626564026, "time_total_s": 7750.295560121536, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7750.295560121536, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 14.340484429065743, "ram_util_percent": 18.24567474048443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.00352012412622571, "cur_lr": 0.01}, "td_error": [1.6340034008026123, 1.6340031623840332, 1.0563318729400635, 2.299696207046509, 1.634002923965454, 1.6340031623840332, 1.6340030431747437, 3.7145307064056396, 1.6340031623840332, 1.6340031623840332, 1.6340034008026123, 1.6719270944595337, 1.6719322204589844, 3.1783223152160645, 1.6719300746917725, 2.0364155769348145, 1.6340031623840332, 1.694104552268982, 1.6340031623840332, 1.6340030431747437, 1.634002923965454, 1.6340030431747437, 1.6340030431747437, 1.6340044736862183, 1.6340030431747437, 1.0563244819641113, 0.4445584714412689, 1.6340035200119019, 1.6340031623840332, 1.6340030431747437, 1.6340066194534302, 1.6340032815933228, 1.0563316345214844, 3.1659607887268066, 1.6719337701797485, 1.678565502166748, 1.6717555522918701, 1.6340031623840332, 1.6719328165054321, 1.634002923965454, 1.9033993482589722, 0.45045381784439087, 1.0563311576843262, 1.1847655773162842, 1.6340031623840332, 1.634006381034851, 1.7722091674804688, 1.6340041160583496, 1.6784085035324097, 0.4445584714412689, 1.2064341306686401, 1.6340214014053345, 1.6340032815933228, 1.6784999370574951, 1.0563292503356934, 1.6719340085983276, 0.9051149487495422, 1.6340044736862183, 1.6785733699798584, 1.678544044494629, 1.6846486330032349, 1.6340031623840332, 1.6340031623840332, 1.6341091394424438, 1.6340030431747437, 1.2058316469192505, 1.056329369544983, 1.6340352296829224, 1.6719213724136353, 1.6719284057617188, 1.671930193901062, 1.6785612106323242, 1.6784700155258179, 1.6340044736862183, 2.0302820205688477, 1.678526759147644, 1.6340030431747437, 1.6340031623840332], "mean_td_error": 1.6187797784805298, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 825.0, "diff_num_grad_updates_vs_sampler_policy": 824.0}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 64350, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 64350, "last_target_update_ts": 33800, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": 3.0947713150733493, "episode_reward_min": -29.999498220455056, "episode_reward_mean": -2.1148436901492835, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999455366574, 0.0005676733637784516, 0.000561692064308543, 0.000556484899091813, 0.0005485550267784578, 0.0005432299751030434, 0.0005705729716086882, 0.000564181080512275, 0.0005582727722544885, 0.0005531285104734956, 0.0005452933196754397, 0.0005706632728299576, -9.999435380357125, 0.0005593578156992692, 0.0005513464552359765, 0.0005459673114081848, 0.0005773572337857086, 0.0005711712151405745, 0.4579565910697683, 0.0005576728286278784, 0.0005521700899700705, 0.0005457633287009765, 0.0005411752920116342, 0.0005365731886476948, 0.21941406000576458, 0.0005056041985421505, -9.041874980540104, 0.0005313778776056007, 0.0005265845713040397, 0.0005006916089596022, 0.0005172739556558441, 0.04597296532519741, 0.0005445886487800046, 0.0005399285704740474, 0.0005349804870057936, 0.0005085971938271212, 0.0005400572826923879, -9.999464525452792, 0.0005306069419102446, -9.99949551735639, -9.999478844748038, 0.0005386842617020888, 1.10063672395485, -19.999470536206974, 0.03890944101461642, 0.0005400311299148656, 0.000535538579891813, -9.999468968120821, -9.999473735967793, 0.000500371197323163, 0.000541375858434904, -9.999463232846546, 0.0005318797259571648, 0.0005056778012809981, 0.0005223826050714534, 0.0005474741512805023, 0.0005427647830001036, 0.12965058034717736, 0.0005114486427935542, 0.0005282941322918617, 0.0005223072007738785, -9.99948244709503, -9.999487887262912, 0.0005064963921462808, 0.0005016300949240653, 0.0005126199701515544, 0.0005072822713492447, -29.999498220455056, 0.0004969856833822355, 0.0004918174722635365, 3.0947713150733493, 0.0005205842460948524, 0.0005150803242273377, 0.0005093898269338501, 0.0005044680500743677, 0.00051643105567911, 0.0005110141299276297, 0.0005054126460724619, -9.999499432547763, 0.0004953244563458091, 0.0005205487416438994, 0.0005158359113855008, -19.999489567770627, -9.928281437718653, 0.7413611103764867, 0.0005169456464135348, 0.0005122975401058622, 0.0005069665176681783, 0.0005014529509903186, 0.5999359156564475, 0.35472278753735914, 0.0005122642681055105, 0.06619445964337523, 0.0005019922570748795, 0.0004967199181546049, 0.0005234406672127348, -9.999482123060465, 0.0005121244029141136, 0.0005071499062772576, -9.409141859621291], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 26, 25, 25, 27, 24, 25, 25, 26, 26, 24, 25, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 26, 25, 25, 25, 25, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 27, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 416.7626923449643, "mean_inference_ms": 2.170061348161949, "mean_action_processing_ms": 0.14900694617816015, "mean_env_wait_ms": 2.7176387403440234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010408401489257812, "StateBufferConnector_ms": 0.006756305694580078, "ViewRequirementAgentConnector_ms": 0.183180570602417}}, "episode_reward_max": 3.0947713150733493, "episode_reward_min": -29.999498220455056, "episode_reward_mean": -2.1148436901492835, "episode_len_mean": 25.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999455366574, 0.0005676733637784516, 0.000561692064308543, 0.000556484899091813, 0.0005485550267784578, 0.0005432299751030434, 0.0005705729716086882, 0.000564181080512275, 0.0005582727722544885, 0.0005531285104734956, 0.0005452933196754397, 0.0005706632728299576, -9.999435380357125, 0.0005593578156992692, 0.0005513464552359765, 0.0005459673114081848, 0.0005773572337857086, 0.0005711712151405745, 0.4579565910697683, 0.0005576728286278784, 0.0005521700899700705, 0.0005457633287009765, 0.0005411752920116342, 0.0005365731886476948, 0.21941406000576458, 0.0005056041985421505, -9.041874980540104, 0.0005313778776056007, 0.0005265845713040397, 0.0005006916089596022, 0.0005172739556558441, 0.04597296532519741, 0.0005445886487800046, 0.0005399285704740474, 0.0005349804870057936, 0.0005085971938271212, 0.0005400572826923879, -9.999464525452792, 0.0005306069419102446, -9.99949551735639, -9.999478844748038, 0.0005386842617020888, 1.10063672395485, -19.999470536206974, 0.03890944101461642, 0.0005400311299148656, 0.000535538579891813, -9.999468968120821, -9.999473735967793, 0.000500371197323163, 0.000541375858434904, -9.999463232846546, 0.0005318797259571648, 0.0005056778012809981, 0.0005223826050714534, 0.0005474741512805023, 0.0005427647830001036, 0.12965058034717736, 0.0005114486427935542, 0.0005282941322918617, 0.0005223072007738785, -9.99948244709503, -9.999487887262912, 0.0005064963921462808, 0.0005016300949240653, 0.0005126199701515544, 0.0005072822713492447, -29.999498220455056, 0.0004969856833822355, 0.0004918174722635365, 3.0947713150733493, 0.0005205842460948524, 0.0005150803242273377, 0.0005093898269338501, 0.0005044680500743677, 0.00051643105567911, 0.0005110141299276297, 0.0005054126460724619, -9.999499432547763, 0.0004953244563458091, 0.0005205487416438994, 0.0005158359113855008, -19.999489567770627, -9.928281437718653, 0.7413611103764867, 0.0005169456464135348, 0.0005122975401058622, 0.0005069665176681783, 0.0005014529509903186, 0.5999359156564475, 0.35472278753735914, 0.0005122642681055105, 0.06619445964337523, 0.0005019922570748795, 0.0004967199181546049, 0.0005234406672127348, -9.999482123060465, 0.0005121244029141136, 0.0005071499062772576, -9.409141859621291], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 26, 25, 25, 27, 24, 25, 25, 26, 26, 24, 25, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 26, 25, 25, 25, 25, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 27, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 416.7626923449643, "mean_inference_ms": 2.170061348161949, "mean_action_processing_ms": 0.14900694617816015, "mean_env_wait_ms": 2.7176387403440234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010408401489257812, "StateBufferConnector_ms": 0.006756305694580078, "ViewRequirementAgentConnector_ms": 0.183180570602417}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 64350, "num_env_steps_sampled": 34000, "num_env_steps_trained": 64350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.067426708692688, "num_env_steps_trained_throughput_per_sec": 7.931482081950741, "timesteps_total": 34000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 10032.953, "sample_time_ms": 9969.296, "load_time_ms": 0.25, "load_throughput": 312022.615, "learn_time_ms": 13.415, "learn_throughput": 5814.561, "synch_weights_time_ms": 11.373}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 64350, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 64350, "last_target_update_ts": 33800, "num_target_updates": 64}, "done": false, "episodes_total": 1284, "training_iteration": 34, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-24-03", "timestamp": 1713414243, "time_this_iter_s": 245.8646686077118, "time_total_s": 7996.160228729248, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7996.160228729248, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 12.344, "ram_util_percent": 18.384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0021846264135092497, "cur_lr": 0.01}, "td_error": [1.6653534173965454, 1.6660690307617188, 1.6175282001495361, 1.6174830198287964, 1.617590069770813, 1.6174798011779785, 1.617479681968689, 1.6661568880081177, 1.665286898612976, 1.617479681968689, 1.6174795627593994, 1.6174798011779785, 1.6174794435501099, 0.45628824830055237, 0.8991094827651978, 1.6174803972244263, 1.6174836158752441, 1.6661888360977173, 1.6174800395965576, 1.6174802780151367, 1.6174817085266113, 1.6174795627593994, 2.0057125091552734, 1.6174813508987427, 1.6174794435501099, 1.7518951892852783, 1.6174795627593994, 1.6174793243408203, 1.6174805164337158, 1.6174794435501099, 1.617479681968689, 1.617479920387268, 1.6174817085266113, 1.6174801588058472, 1.8682233095169067, 1.6214672327041626, 2.040445327758789, 1.6174800395965576, 1.6174794435501099, 1.0281137228012085, 1.6174806356430054, 1.6667239665985107, 1.6174795627593994, 1.617479920387268, 1.817935585975647, 1.028116226196289, 2.5399391651153564, 1.732832908630371, 1.0281177759170532, 4.060131072998047, 1.6660925149917603, 1.6174805164337158, 2.022667407989502, 1.7053894996643066, 1.6661386489868164, 1.6176172494888306, 1.617479920387268, 1.6174819469451904, 1.6174824237823486, 1.6174800395965576, 1.6174800395965576, 1.1860065460205078, 0.8950749635696411, 1.6174805164337158, 1.6174813508987427, 1.6174802780151367, 1.6174805164337158, 1.9963409900665283, 1.6174793243408203, 1.6174798011779785, 1.6662328243255615, 1.6174821853637695, 1.6652722358703613, 1.617479681968689, 1.6174805164337158, 1.6652803421020508, 1.6174794435501099, 1.6174794435501099], "mean_td_error": 1.6365121603012085, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 850.0, "diff_num_grad_updates_vs_sampler_policy": 849.0}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 66300, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 66300, "last_target_update_ts": 34840, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": 3.447328490805876, "episode_reward_min": -29.999498220455056, "episode_reward_mean": -2.052476519354792, "episode_len_mean": 24.94, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999478844748038, 0.0005386842617020888, 1.10063672395485, -19.999470536206974, 0.03890944101461642, 0.0005400311299148656, 0.000535538579891813, -9.999468968120821, -9.999473735967793, 0.000500371197323163, 0.000541375858434904, -9.999463232846546, 0.0005318797259571648, 0.0005056778012809981, 0.0005223826050714534, 0.0005474741512805023, 0.0005427647830001036, 0.12965058034717736, 0.0005114486427935542, 0.0005282941322918617, 0.0005223072007738785, -9.99948244709503, -9.999487887262912, 0.0005064963921462808, 0.0005016300949240653, 0.0005126199701515544, 0.0005072822713492447, -29.999498220455056, 0.0004969856833822355, 0.0004918174722635365, 3.0947713150733493, 0.0005205842460948524, 0.0005150803242273377, 0.0005093898269338501, 0.0005044680500743677, 0.00051643105567911, 0.0005110141299276297, 0.0005054126460724619, -9.999499432547763, 0.0004953244563458091, 0.0005205487416438994, 0.0005158359113855008, -19.999489567770627, -9.928281437718653, 0.7413611103764867, 0.0005169456464135348, 0.0005122975401058622, 0.0005069665176681783, 0.0005014529509903186, 0.5999359156564475, 0.35472278753735914, 0.0005122642681055105, 0.06619445964337523, 0.0005019922570748795, 0.0004967199181546049, 0.0005234406672127348, -9.999482123060465, 0.0005121244029141136, 0.0005071499062772576, -9.409141859621291, 0.6608976488216578, 0.00047284148600671555, 0.0004886943237825777, 0.00048468723694524617, 0.043487304392796945, 0.0004685041236616093, 0.0004842462502270292, 0.701828327516069, 3.447328490805876, 0.0004357648434241486, -9.999500850666912, 0.00047542857716021086, 0.0004913471469401026, 0.0004872966194767851, 0.0004640448330548438, 0.0004718189184881006, 0.00048764571265279543, 0.0004836557330268982, 0.0004606053302953726, 0.0004387116275628396, 0.10231533101930369, 0.00047184473893030054, 0.4194450485160312, -9.999516260535405, 1.067336064522888, 0.0004915586073002505, 0.06751406592422625, 0.0004842659081280726, -9.999519668875122, 0.0004574639632745403, 0.00047313780496175214, -9.999510989266442, 0.0004849861321889976, 0.0004618621906733561, 0.0004399013955715961, 0.00047794862941763304, -9.999506080136888, 0.000489837947756485, 0.0004664453513884168, 1.4129005414514648], "episode_lengths": [26, 25, 25, 27, 24, 25, 25, 26, 26, 24, 25, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 26, 25, 25, 25, 25, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 27, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 24, 25, 25, 24, 24, 25, 25, 24, 23, 26, 24, 25, 25, 24, 24, 25, 25, 24, 23, 25, 24, 25, 26, 24, 25, 24, 25, 26, 24, 24, 26, 25, 24, 23, 24, 26, 25, 24, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 417.39898379440115, "mean_inference_ms": 2.1684398592736915, "mean_action_processing_ms": 0.14886680995370277, "mean_env_wait_ms": 2.640886014327007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010682106018066406, "StateBufferConnector_ms": 0.006750345230102539, "ViewRequirementAgentConnector_ms": 0.18287253379821777}}, "episode_reward_max": 3.447328490805876, "episode_reward_min": -29.999498220455056, "episode_reward_mean": -2.052476519354792, "episode_len_mean": 24.94, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999478844748038, 0.0005386842617020888, 1.10063672395485, -19.999470536206974, 0.03890944101461642, 0.0005400311299148656, 0.000535538579891813, -9.999468968120821, -9.999473735967793, 0.000500371197323163, 0.000541375858434904, -9.999463232846546, 0.0005318797259571648, 0.0005056778012809981, 0.0005223826050714534, 0.0005474741512805023, 0.0005427647830001036, 0.12965058034717736, 0.0005114486427935542, 0.0005282941322918617, 0.0005223072007738785, -9.99948244709503, -9.999487887262912, 0.0005064963921462808, 0.0005016300949240653, 0.0005126199701515544, 0.0005072822713492447, -29.999498220455056, 0.0004969856833822355, 0.0004918174722635365, 3.0947713150733493, 0.0005205842460948524, 0.0005150803242273377, 0.0005093898269338501, 0.0005044680500743677, 0.00051643105567911, 0.0005110141299276297, 0.0005054126460724619, -9.999499432547763, 0.0004953244563458091, 0.0005205487416438994, 0.0005158359113855008, -19.999489567770627, -9.928281437718653, 0.7413611103764867, 0.0005169456464135348, 0.0005122975401058622, 0.0005069665176681783, 0.0005014529509903186, 0.5999359156564475, 0.35472278753735914, 0.0005122642681055105, 0.06619445964337523, 0.0005019922570748795, 0.0004967199181546049, 0.0005234406672127348, -9.999482123060465, 0.0005121244029141136, 0.0005071499062772576, -9.409141859621291, 0.6608976488216578, 0.00047284148600671555, 0.0004886943237825777, 0.00048468723694524617, 0.043487304392796945, 0.0004685041236616093, 0.0004842462502270292, 0.701828327516069, 3.447328490805876, 0.0004357648434241486, -9.999500850666912, 0.00047542857716021086, 0.0004913471469401026, 0.0004872966194767851, 0.0004640448330548438, 0.0004718189184881006, 0.00048764571265279543, 0.0004836557330268982, 0.0004606053302953726, 0.0004387116275628396, 0.10231533101930369, 0.00047184473893030054, 0.4194450485160312, -9.999516260535405, 1.067336064522888, 0.0004915586073002505, 0.06751406592422625, 0.0004842659081280726, -9.999519668875122, 0.0004574639632745403, 0.00047313780496175214, -9.999510989266442, 0.0004849861321889976, 0.0004618621906733561, 0.0004399013955715961, 0.00047794862941763304, -9.999506080136888, 0.000489837947756485, 0.0004664453513884168, 1.4129005414514648], "episode_lengths": [26, 25, 25, 27, 24, 25, 25, 26, 26, 24, 25, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 26, 25, 25, 25, 25, 28, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 27, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 24, 25, 25, 24, 24, 25, 25, 24, 23, 26, 24, 25, 25, 24, 24, 25, 25, 24, 23, 25, 24, 25, 26, 24, 25, 24, 25, 26, 24, 24, 26, 25, 24, 23, 24, 26, 25, 24, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 417.39898379440115, "mean_inference_ms": 2.1684398592736915, "mean_action_processing_ms": 0.14886680995370277, "mean_env_wait_ms": 2.640886014327007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010682106018066406, "StateBufferConnector_ms": 0.006750345230102539, "ViewRequirementAgentConnector_ms": 0.18287253379821777}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 66300, "num_env_steps_sampled": 35000, "num_env_steps_trained": 66300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.074736857163404, "num_env_steps_trained_throughput_per_sec": 7.945736871468638, "timesteps_total": 35000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 35000, "timers": {"training_iteration_time_ms": 7851.737, "sample_time_ms": 7789.306, "load_time_ms": 0.247, "load_throughput": 315939.847, "learn_time_ms": 12.781, "learn_throughput": 6102.911, "synch_weights_time_ms": 11.434}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 66300, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 66300, "last_target_update_ts": 34840, "num_target_updates": 66}, "done": false, "episodes_total": 1324, "training_iteration": 35, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-28-09", "timestamp": 1713414489, "time_this_iter_s": 245.42306971549988, "time_total_s": 8241.583298444748, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 8241.583298444748, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 12.261031518624643, "ram_util_percent": 18.556733524355298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.003374247346073389, "cur_lr": 0.01}, "td_error": [1.6215059757232666, 1.5732791423797607, 1.6315687894821167, 1.0168808698654175, 1.5732790231704712, 1.573278784751892, 1.573278546333313, 1.5732789039611816, 1.5732780694961548, 1.6317987442016602, 1.5732786655426025, 1.5732790231704712, 1.6217539310455322, 1.573277235031128, 1.5732786655426025, 1.6213914155960083, 1.5732752084732056, 0.9131175875663757, 1.5732779502868652, 2.5520431995391846, 1.0168825387954712, 1.5732791423797607, 1.0168808698654175, 1.5732791423797607, 1.5732784271240234, 1.0168766975402832, 1.6315099000930786, 1.5732790231704712, 1.016876459121704, 1.5732784271240234, 1.5732771158218384, 1.6308141946792603, 1.5732777118682861, 1.5732766389846802, 1.6214531660079956, 1.6313992738723755, 1.631764531135559, 1.621830701828003, 1.5732786655426025, 1.5732786655426025, 1.0168755054473877, 1.573278784751892, 1.1934783458709717, 1.1722344160079956, 1.5732789039611816, 1.5732786655426025, 1.5732789039611816, 2.8857343196868896, 1.5732780694961548, 1.621382713317871, 1.5732790231704712, 1.5732784271240234, 1.57327139377594, 1.5732765197753906, 1.5732771158218384, 1.5732781887054443, 1.573278784751892, 1.6214990615844727, 1.63108229637146, 1.6214349269866943, 1.5732786655426025, 1.0168818235397339, 1.5732783079147339, 1.5732784271240234, 1.6214141845703125, 1.6213843822479248, 3.182258129119873, 1.621488332748413, 1.573278546333313, 1.5732775926589966, 1.5732790231704712, 1.573278784751892, 1.6213818788528442, 1.016879677772522, 1.5732784271240234, 1.5732777118682861, 1.5732077360153198, 2.552037477493286], "mean_td_error": 1.5729225873947144, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 875.0, "diff_num_grad_updates_vs_sampler_policy": 874.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 68250, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 68250, "last_target_update_ts": 35880, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": 3.447328490805876, "episode_reward_min": -29.999541394142867, "episode_reward_mean": -1.3699815586442328, "episode_len_mean": 24.75, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0005158359113855008, -19.999489567770627, -9.928281437718653, 0.7413611103764867, 0.0005169456464135348, 0.0005122975401058622, 0.0005069665176681783, 0.0005014529509903186, 0.5999359156564475, 0.35472278753735914, 0.0005122642681055105, 0.06619445964337523, 0.0005019922570748795, 0.0004967199181546049, 0.0005234406672127348, -9.999482123060465, 0.0005121244029141136, 0.0005071499062772576, -9.409141859621291, 0.6608976488216578, 0.00047284148600671555, 0.0004886943237825777, 0.00048468723694524617, 0.043487304392796945, 0.0004685041236616093, 0.0004842462502270292, 0.701828327516069, 3.447328490805876, 0.0004357648434241486, -9.999500850666912, 0.00047542857716021086, 0.0004913471469401026, 0.0004872966194767851, 0.0004640448330548438, 0.0004718189184881006, 0.00048764571265279543, 0.0004836557330268982, 0.0004606053302953726, 0.0004387116275628396, 0.10231533101930369, 0.00047184473893030054, 0.4194450485160312, -9.999516260535405, 1.067336064522888, 0.0004915586073002505, 0.06751406592422625, 0.0004842659081280726, -9.999519668875122, 0.0004574639632745403, 0.00047313780496175214, -9.999510989266442, 0.0004849861321889976, 0.0004618621906733561, 0.0004399013955715961, 0.00047794862941763304, -9.999506080136888, 0.000489837947756485, 0.0004664453513884168, 1.4129005414514648, 0.0004400114636378359, 0.00047511649726248356, 0.11888648245959095, 0.0004482078039225279, 0.00046236661975122183, 0.4917476053734001, 0.00046666517707770016, 0.0004438770156610326, -9.999542057843286, 0.0004543730408034408, 0.0004419674319629613, 0.0004772145124470039, 0.000473150341851576, 0.00044998793061951873, 0.0894066159095936, 0.438262052527018, 0.0004697585867464221, 0.00044679210411033033, 0.00046092028009651816, 0.00045730510106439554, 0.00043880467535717827, 0.00047382200784242565, 0.5064880113707788, 0.6608493495203556, 0.0004610496817764371, 0.0004574324802245366, 0.07881703771179897, 0.038841273222242165, 0.00046720430239363675, 0.0004443850884305814, 0.036286673089311036, 0.15879379791123155, 0.00047112181113028774, 0.0004480766317127463, -9.999537767046652, -29.999541394142867, 0.00047967873083701524, 0.00047557268020557183, 0.0004522700779450753, 0.00046651632261526766, 0.00046281316597037976], "episode_lengths": [25, 27, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 24, 25, 25, 24, 24, 25, 25, 24, 23, 26, 24, 25, 25, 24, 24, 25, 25, 24, 23, 25, 24, 25, 26, 24, 25, 24, 25, 26, 24, 24, 26, 25, 24, 23, 24, 26, 25, 24, 23, 23, 25, 25, 24, 25, 25, 25, 24, 26, 25, 23, 25, 25, 24, 25, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 25, 24, 26, 28, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 418.2798175729221, "mean_inference_ms": 2.1674340234113756, "mean_action_processing_ms": 0.14876145877760094, "mean_env_wait_ms": 2.568186628292306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010932683944702148, "StateBufferConnector_ms": 0.0068607330322265625, "ViewRequirementAgentConnector_ms": 0.18452143669128418}}, "episode_reward_max": 3.447328490805876, "episode_reward_min": -29.999541394142867, "episode_reward_mean": -1.3699815586442328, "episode_len_mean": 24.75, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0005158359113855008, -19.999489567770627, -9.928281437718653, 0.7413611103764867, 0.0005169456464135348, 0.0005122975401058622, 0.0005069665176681783, 0.0005014529509903186, 0.5999359156564475, 0.35472278753735914, 0.0005122642681055105, 0.06619445964337523, 0.0005019922570748795, 0.0004967199181546049, 0.0005234406672127348, -9.999482123060465, 0.0005121244029141136, 0.0005071499062772576, -9.409141859621291, 0.6608976488216578, 0.00047284148600671555, 0.0004886943237825777, 0.00048468723694524617, 0.043487304392796945, 0.0004685041236616093, 0.0004842462502270292, 0.701828327516069, 3.447328490805876, 0.0004357648434241486, -9.999500850666912, 0.00047542857716021086, 0.0004913471469401026, 0.0004872966194767851, 0.0004640448330548438, 0.0004718189184881006, 0.00048764571265279543, 0.0004836557330268982, 0.0004606053302953726, 0.0004387116275628396, 0.10231533101930369, 0.00047184473893030054, 0.4194450485160312, -9.999516260535405, 1.067336064522888, 0.0004915586073002505, 0.06751406592422625, 0.0004842659081280726, -9.999519668875122, 0.0004574639632745403, 0.00047313780496175214, -9.999510989266442, 0.0004849861321889976, 0.0004618621906733561, 0.0004399013955715961, 0.00047794862941763304, -9.999506080136888, 0.000489837947756485, 0.0004664453513884168, 1.4129005414514648, 0.0004400114636378359, 0.00047511649726248356, 0.11888648245959095, 0.0004482078039225279, 0.00046236661975122183, 0.4917476053734001, 0.00046666517707770016, 0.0004438770156610326, -9.999542057843286, 0.0004543730408034408, 0.0004419674319629613, 0.0004772145124470039, 0.000473150341851576, 0.00044998793061951873, 0.0894066159095936, 0.438262052527018, 0.0004697585867464221, 0.00044679210411033033, 0.00046092028009651816, 0.00045730510106439554, 0.00043880467535717827, 0.00047382200784242565, 0.5064880113707788, 0.6608493495203556, 0.0004610496817764371, 0.0004574324802245366, 0.07881703771179897, 0.038841273222242165, 0.00046720430239363675, 0.0004443850884305814, 0.036286673089311036, 0.15879379791123155, 0.00047112181113028774, 0.0004480766317127463, -9.999537767046652, -29.999541394142867, 0.00047967873083701524, 0.00047557268020557183, 0.0004522700779450753, 0.00046651632261526766, 0.00046281316597037976], "episode_lengths": [25, 27, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 24, 25, 25, 24, 24, 25, 25, 24, 23, 26, 24, 25, 25, 24, 24, 25, 25, 24, 23, 25, 24, 25, 26, 24, 25, 24, 25, 26, 24, 24, 26, 25, 24, 23, 24, 26, 25, 24, 23, 23, 25, 25, 24, 25, 25, 25, 24, 26, 25, 23, 25, 25, 24, 25, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 25, 24, 26, 28, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 418.2798175729221, "mean_inference_ms": 2.1674340234113756, "mean_action_processing_ms": 0.14876145877760094, "mean_env_wait_ms": 2.568186628292306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010932683944702148, "StateBufferConnector_ms": 0.0068607330322265625, "ViewRequirementAgentConnector_ms": 0.18452143669128418}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 68250, "num_env_steps_sampled": 36000, "num_env_steps_trained": 68250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.245766184669531, "num_env_steps_trained_throughput_per_sec": 8.279244060105585, "timesteps_total": 36000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11184.427, "sample_time_ms": 11122.927, "load_time_ms": 0.244, "load_throughput": 319800.305, "learn_time_ms": 12.864, "learn_throughput": 6063.29, "synch_weights_time_ms": 11.889}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 68250, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 68250, "last_target_update_ts": 35880, "num_target_updates": 68}, "done": false, "episodes_total": 1365, "training_iteration": 36, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-32-04", "timestamp": 1713414724, "time_this_iter_s": 235.53698778152466, "time_total_s": 8477.120286226273, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 8477.120286226273, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 13.168059701492538, "ram_util_percent": 18.753731343283583}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0026202495209872723, "cur_lr": 0.01}, "td_error": [1.5447447299957275, 2.5721933841705322, 0.4680544435977936, 1.544744849205017, 1.1314165592193604, 1.544744849205017, 1.1314661502838135, 1.5447447299957275, 1.544744610786438, 0.9336206316947937, 1.544744849205017, 2.953731060028076, 2.1269733905792236, 1.592779517173767, 1.544744610786438, 1.5903819799423218, 1.5447444915771484, 2.114635944366455, 3.1559693813323975, 1.544744849205017, 1.5447462797164917, 1.5447452068328857, 0.9154054522514343, 1.590314507484436, 1.5447447299957275, 1.5902783870697021, 1.5916270017623901, 1.5927956104278564, 1.5905851125717163, 1.5447450876235962, 1.544744849205017, 1.7082380056381226, 1.5447449684143066, 2.6035678386688232, 1.5911250114440918, 1.8790843486785889, 1.5447449684143066, 0.9064224362373352, 1.009527325630188, 1.5447447299957275, 1.544745683670044, 0.9065131545066833, 1.9390171766281128, 1.5447452068328857, 1.5447453260421753, 2.60253643989563, 1.5447447299957275, 1.0095298290252686, 2.1011312007904053, 1.544744849205017, 2.1131880283355713, 1.544744610786438, 1.5447646379470825, 2.4165618419647217, 1.5447452068328857, 0.932610273361206, 1.5447447299957275, 1.0095300674438477, 1.544744610786438, 1.5927237272262573, 1.544744610786438, 1.5447447299957275, 1.5447449684143066, 1.0095268487930298, 2.5776026248931885, 1.5447447299957275, 1.6101080179214478, 1.6020584106445312, 1.5447561740875244, 1.6601035594940186, 1.590309977531433, 1.5447447299957275, 1.5447447299957275, 1.1314408779144287, 1.544744849205017, 1.5928230285644531, 1.544744610786438, 1.5447449684143066], "mean_td_error": 1.6011935472488403, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 900.0, "diff_num_grad_updates_vs_sampler_policy": 899.0}}, "num_env_steps_sampled": 37000, "num_env_steps_trained": 70200, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 70200, "last_target_update_ts": 36920, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": 2.358827695271208, "episode_reward_min": -29.999541394142867, "episode_reward_mean": -1.6615365164352875, "episode_len_mean": 24.82, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00047184473893030054, 0.4194450485160312, -9.999516260535405, 1.067336064522888, 0.0004915586073002505, 0.06751406592422625, 0.0004842659081280726, -9.999519668875122, 0.0004574639632745403, 0.00047313780496175214, -9.999510989266442, 0.0004849861321889976, 0.0004618621906733561, 0.0004399013955715961, 0.00047794862941763304, -9.999506080136888, 0.000489837947756485, 0.0004664453513884168, 1.4129005414514648, 0.0004400114636378359, 0.00047511649726248356, 0.11888648245959095, 0.0004482078039225279, 0.00046236661975122183, 0.4917476053734001, 0.00046666517707770016, 0.0004438770156610326, -9.999542057843286, 0.0004543730408034408, 0.0004419674319629613, 0.0004772145124470039, 0.000473150341851576, 0.00044998793061951873, 0.0894066159095936, 0.438262052527018, 0.0004697585867464221, 0.00044679210411033033, 0.00046092028009651816, 0.00045730510106439554, 0.00043880467535717827, 0.00047382200784242565, 0.5064880113707788, 0.6608493495203556, 0.0004610496817764371, 0.0004574324802245366, 0.07881703771179897, 0.038841273222242165, 0.00046720430239363675, 0.0004443850884305814, 0.036286673089311036, 0.15879379791123155, 0.00047112181113028774, 0.0004480766317127463, -9.999537767046652, -29.999541394142867, 0.00047967873083701524, 0.00047557268020557183, 0.0004522700779450753, 0.00046651632261526766, 0.00046281316597037976, -9.999541268310978, -9.999563502987504, 0.00045095423539939696, 2.358827695271208, 0.0004438083632993165, -19.999567602370938, 0.07789384048397502, 0.00044326482116675256, 0.0004399562561893088, 0.0004366045015069218, -9.99953919076846, 0.0004384584375705229, 0.000452964261443321, 0.00044914250177531014, 0.00044574593474760803, 0.00043515388776981293, 0.00044957831034985276, 0.00044581322945480887, 2.35882322265457, 0.0004390855343951336, 1.8674825427442678, 1.347619499137957, -9.99955396354063, 0.0004426862253557426, 0.00043929290967527075, 0.0004553028421872122, 0.08624095864079032, 0.00044785994460368417, 0.00044412346752571523, 0.000440802118212883, -9.999563627390565, 0.0004508267610020248, 0.08465779464737842, 0.00044390944512587906, 0.0004404974247447255, 0.0004403485382031067, 0.0004549007319673598, -9.999548953306315, 0.04359907232325969, -9.999555357336723], "episode_lengths": [24, 25, 26, 24, 25, 24, 25, 26, 24, 24, 26, 25, 24, 23, 24, 26, 25, 24, 23, 23, 25, 25, 24, 25, 25, 25, 24, 26, 25, 23, 25, 25, 24, 25, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 25, 24, 26, 28, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 419.07627907386444, "mean_inference_ms": 2.1672415275153103, "mean_action_processing_ms": 0.14873579979224055, "mean_env_wait_ms": 2.501218686860293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010628938674926758, "StateBufferConnector_ms": 0.006783246994018555, "ViewRequirementAgentConnector_ms": 0.18364334106445312}}, "episode_reward_max": 2.358827695271208, "episode_reward_min": -29.999541394142867, "episode_reward_mean": -1.6615365164352875, "episode_len_mean": 24.82, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00047184473893030054, 0.4194450485160312, -9.999516260535405, 1.067336064522888, 0.0004915586073002505, 0.06751406592422625, 0.0004842659081280726, -9.999519668875122, 0.0004574639632745403, 0.00047313780496175214, -9.999510989266442, 0.0004849861321889976, 0.0004618621906733561, 0.0004399013955715961, 0.00047794862941763304, -9.999506080136888, 0.000489837947756485, 0.0004664453513884168, 1.4129005414514648, 0.0004400114636378359, 0.00047511649726248356, 0.11888648245959095, 0.0004482078039225279, 0.00046236661975122183, 0.4917476053734001, 0.00046666517707770016, 0.0004438770156610326, -9.999542057843286, 0.0004543730408034408, 0.0004419674319629613, 0.0004772145124470039, 0.000473150341851576, 0.00044998793061951873, 0.0894066159095936, 0.438262052527018, 0.0004697585867464221, 0.00044679210411033033, 0.00046092028009651816, 0.00045730510106439554, 0.00043880467535717827, 0.00047382200784242565, 0.5064880113707788, 0.6608493495203556, 0.0004610496817764371, 0.0004574324802245366, 0.07881703771179897, 0.038841273222242165, 0.00046720430239363675, 0.0004443850884305814, 0.036286673089311036, 0.15879379791123155, 0.00047112181113028774, 0.0004480766317127463, -9.999537767046652, -29.999541394142867, 0.00047967873083701524, 0.00047557268020557183, 0.0004522700779450753, 0.00046651632261526766, 0.00046281316597037976, -9.999541268310978, -9.999563502987504, 0.00045095423539939696, 2.358827695271208, 0.0004438083632993165, -19.999567602370938, 0.07789384048397502, 0.00044326482116675256, 0.0004399562561893088, 0.0004366045015069218, -9.99953919076846, 0.0004384584375705229, 0.000452964261443321, 0.00044914250177531014, 0.00044574593474760803, 0.00043515388776981293, 0.00044957831034985276, 0.00044581322945480887, 2.35882322265457, 0.0004390855343951336, 1.8674825427442678, 1.347619499137957, -9.99955396354063, 0.0004426862253557426, 0.00043929290967527075, 0.0004553028421872122, 0.08624095864079032, 0.00044785994460368417, 0.00044412346752571523, 0.000440802118212883, -9.999563627390565, 0.0004508267610020248, 0.08465779464737842, 0.00044390944512587906, 0.0004404974247447255, 0.0004403485382031067, 0.0004549007319673598, -9.999548953306315, 0.04359907232325969, -9.999555357336723], "episode_lengths": [24, 25, 26, 24, 25, 24, 25, 26, 24, 24, 26, 25, 24, 23, 24, 26, 25, 24, 23, 23, 25, 25, 24, 25, 25, 25, 24, 26, 25, 23, 25, 25, 24, 25, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 25, 24, 26, 28, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 419.07627907386444, "mean_inference_ms": 2.1672415275153103, "mean_action_processing_ms": 0.14873579979224055, "mean_env_wait_ms": 2.501218686860293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010628938674926758, "StateBufferConnector_ms": 0.006783246994018555, "ViewRequirementAgentConnector_ms": 0.18364334106445312}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 70200, "num_env_steps_sampled": 37000, "num_env_steps_trained": 70200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5660372136760325, "num_env_steps_trained_throughput_per_sec": 6.953772566668264, "timesteps_total": 37000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 37000, "timers": {"training_iteration_time_ms": 11191.848, "sample_time_ms": 11130.705, "load_time_ms": 0.249, "load_throughput": 313157.569, "learn_time_ms": 13.131, "learn_throughput": 5940.282, "synch_weights_time_ms": 10.66}, "counters": {"num_env_steps_sampled": 37000, "num_env_steps_trained": 70200, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 70200, "last_target_update_ts": 36920, "num_target_updates": 70}, "done": false, "episodes_total": 1405, "training_iteration": 37, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-36-45", "timestamp": 1713415005, "time_this_iter_s": 280.4320340156555, "time_total_s": 8757.552320241928, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 8757.552320241928, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 11.07593984962406, "ram_util_percent": 18.89774436090226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0017059334786608815, "cur_lr": 0.01}, "td_error": [1.5530214309692383, 1.5530219078063965, 1.553023099899292, 1.553023099899292, 1.5530146360397339, 1.553022027015686, 1.553021788597107, 1.5530102252960205, 0.995628833770752, 2.6549923419952393, 2.6549911499023438, 1.5530227422714233, 1.6139745712280273, 1.119295597076416, 1.5530232191085815, 1.553012728691101, 1.5530226230621338, 1.5530215501785278, 0.9956275224685669, 1.5530203580856323, 1.5524556636810303, 1.5530216693878174, 1.59180748462677, 1.5530229806900024, 1.553019404411316, 1.5515532493591309, 1.5530204772949219, 1.5530232191085815, 0.9956264495849609, 0.9273911118507385, 1.6135603189468384, 1.591806411743164, 1.5530115365982056, 1.5530186891555786, 1.5919235944747925, 1.5530221462249756, 2.935011625289917, 0.9956277012825012, 1.5530191659927368, 1.553018569946289, 1.5530157089233398, 2.1300532817840576, 1.553006887435913, 1.1840391159057617, 1.6140329837799072, 1.5530198812484741, 1.9996265172958374, 1.553023338317871, 1.554002285003662, 1.5530221462249756, 1.553019642829895, 1.5530225038528442, 0.9263954162597656, 1.552677035331726, 1.5530192852020264, 1.5529842376708984, 1.5529839992523193, 1.5530213117599487, 1.5525000095367432, 1.5922062397003174, 0.9956272840499878, 1.5530222654342651, 0.996110737323761, 1.553022861480713, 1.5530236959457397, 1.553022027015686, 1.553019642829895, 1.5530223846435547, 1.5529848337173462, 1.5530208349227905, 1.552997350692749, 1.5523759126663208, 1.5520554780960083, 1.5530234575271606, 1.6140282154083252, 2.660360097885132, 1.5530163049697876, 1.5530238151550293], "mean_td_error": 1.5621689558029175, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 925.0, "diff_num_grad_updates_vs_sampler_policy": 924.0}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 72150, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 72150, "last_target_update_ts": 37960, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": 9.097993197881044, "episode_reward_min": -29.999541394142867, "episode_reward_mean": -1.5899843686400836, "episode_len_mean": 24.89, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5064880113707788, 0.6608493495203556, 0.0004610496817764371, 0.0004574324802245366, 0.07881703771179897, 0.038841273222242165, 0.00046720430239363675, 0.0004443850884305814, 0.036286673089311036, 0.15879379791123155, 0.00047112181113028774, 0.0004480766317127463, -9.999537767046652, -29.999541394142867, 0.00047967873083701524, 0.00047557268020557183, 0.0004522700779450753, 0.00046651632261526766, 0.00046281316597037976, -9.999541268310978, -9.999563502987504, 0.00045095423539939696, 2.358827695271208, 0.0004438083632993165, -19.999567602370938, 0.07789384048397502, 0.00044326482116675256, 0.0004399562561893088, 0.0004366045015069218, -9.99953919076846, 0.0004384584375705229, 0.000452964261443321, 0.00044914250177531014, 0.00044574593474760803, 0.00043515388776981293, 0.00044957831034985276, 0.00044581322945480887, 2.35882322265457, 0.0004390855343951336, 1.8674825427442678, 1.347619499137957, -9.99955396354063, 0.0004426862253557426, 0.00043929290967527075, 0.0004553028421872122, 0.08624095864079032, 0.00044785994460368417, 0.00044412346752571523, 0.000440802118212883, -9.999563627390565, 0.0004508267610020248, 0.08465779464737842, 0.00044390944512587906, 0.0004404974247447255, 0.0004403485382031067, 0.0004549007319673598, -9.999548953306315, 0.04359907232325969, -9.999555357336723, 0.0004403978905306477, 0.0004363227018397908, 0.00039844429415632557, 0.5199434539945609, 0.06934718161971043, 9.097993197881044, 0.42310970168572243, -9.999574163637334, 0.08876153140023788, -9.999580445595887, 0.00044230573616026197, 0.00043819533272213706, 0.11587138919626519, 0.5199453557114432, 0.0004281888346614736, -9.999575225555045, 0.0004350344818815405, 0.8702923753344205, 0.0004282681018337185, 0.00042510777376677345, 0.00042174409048135824, 0.000435238047945982, 0.00039746112152214656, 0.0004283301772552604, 0.00042516893638143985, 0.00042180428888561054, -9.99956256236483, 7.515064553089994, 0.0003958129510555805, 0.0004265691197506403, -9.897984426420626, 0.00043642040257515325, 0.00039853285213867174, 0.548355470785491, 0.000426338410156034, 0.00042295529988176594, -9.999559511083035, 0.0004022200983209343, 0.07803538123310037, 1.3154766977663888, 0.00042697682167237025], "episode_lengths": [25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 25, 24, 26, 28, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 26, 25, 25, 23, 25, 25, 25, 23, 26, 25, 26, 25, 25, 23, 25, 25, 26, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 26, 25, 23, 25, 26, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 419.9330971527839, "mean_inference_ms": 2.16779708117673, "mean_action_processing_ms": 0.14872518924793007, "mean_env_wait_ms": 2.436566396545195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010703802108764648, "StateBufferConnector_ms": 0.007027387619018555, "ViewRequirementAgentConnector_ms": 0.18076825141906738}}, "episode_reward_max": 9.097993197881044, "episode_reward_min": -29.999541394142867, "episode_reward_mean": -1.5899843686400836, "episode_len_mean": 24.89, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5064880113707788, 0.6608493495203556, 0.0004610496817764371, 0.0004574324802245366, 0.07881703771179897, 0.038841273222242165, 0.00046720430239363675, 0.0004443850884305814, 0.036286673089311036, 0.15879379791123155, 0.00047112181113028774, 0.0004480766317127463, -9.999537767046652, -29.999541394142867, 0.00047967873083701524, 0.00047557268020557183, 0.0004522700779450753, 0.00046651632261526766, 0.00046281316597037976, -9.999541268310978, -9.999563502987504, 0.00045095423539939696, 2.358827695271208, 0.0004438083632993165, -19.999567602370938, 0.07789384048397502, 0.00044326482116675256, 0.0004399562561893088, 0.0004366045015069218, -9.99953919076846, 0.0004384584375705229, 0.000452964261443321, 0.00044914250177531014, 0.00044574593474760803, 0.00043515388776981293, 0.00044957831034985276, 0.00044581322945480887, 2.35882322265457, 0.0004390855343951336, 1.8674825427442678, 1.347619499137957, -9.99955396354063, 0.0004426862253557426, 0.00043929290967527075, 0.0004553028421872122, 0.08624095864079032, 0.00044785994460368417, 0.00044412346752571523, 0.000440802118212883, -9.999563627390565, 0.0004508267610020248, 0.08465779464737842, 0.00044390944512587906, 0.0004404974247447255, 0.0004403485382031067, 0.0004549007319673598, -9.999548953306315, 0.04359907232325969, -9.999555357336723, 0.0004403978905306477, 0.0004363227018397908, 0.00039844429415632557, 0.5199434539945609, 0.06934718161971043, 9.097993197881044, 0.42310970168572243, -9.999574163637334, 0.08876153140023788, -9.999580445595887, 0.00044230573616026197, 0.00043819533272213706, 0.11587138919626519, 0.5199453557114432, 0.0004281888346614736, -9.999575225555045, 0.0004350344818815405, 0.8702923753344205, 0.0004282681018337185, 0.00042510777376677345, 0.00042174409048135824, 0.000435238047945982, 0.00039746112152214656, 0.0004283301772552604, 0.00042516893638143985, 0.00042180428888561054, -9.99956256236483, 7.515064553089994, 0.0003958129510555805, 0.0004265691197506403, -9.897984426420626, 0.00043642040257515325, 0.00039853285213867174, 0.548355470785491, 0.000426338410156034, 0.00042295529988176594, -9.999559511083035, 0.0004022200983209343, 0.07803538123310037, 1.3154766977663888, 0.00042697682167237025], "episode_lengths": [25, 24, 25, 25, 23, 25, 25, 24, 25, 25, 25, 24, 26, 28, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 26, 25, 25, 23, 25, 25, 25, 23, 26, 25, 26, 25, 25, 23, 25, 25, 26, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 26, 25, 23, 25, 26, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 419.9330971527839, "mean_inference_ms": 2.16779708117673, "mean_action_processing_ms": 0.14872518924793007, "mean_env_wait_ms": 2.436566396545195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010703802108764648, "StateBufferConnector_ms": 0.007027387619018555, "ViewRequirementAgentConnector_ms": 0.18076825141906738}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 72150, "num_env_steps_sampled": 38000, "num_env_steps_trained": 72150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.578421576239665, "num_env_steps_trained_throughput_per_sec": 6.977922073667347, "timesteps_total": 38000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 11134.762, "sample_time_ms": 11072.106, "load_time_ms": 0.239, "load_throughput": 325754.966, "learn_time_ms": 13.065, "learn_throughput": 5970.256, "synch_weights_time_ms": 11.82}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 72150, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 72150, "last_target_update_ts": 37960, "num_target_updates": 72}, "done": false, "episodes_total": 1446, "training_iteration": 38, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-41-24", "timestamp": 1713415284, "time_this_iter_s": 279.46340799331665, "time_total_s": 9037.015728235245, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 9037.015728235245, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 11.179093198992444, "ram_util_percent": 19.03073047858942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013108542189002037, "cur_lr": 0.01}, "td_error": [1.5242629051208496, 1.5242631435394287, 1.5242629051208496, 0.9739802479743958, 1.5242630243301392, 1.5242626667022705, 1.583330512046814, 1.5242633819580078, 1.5830178260803223, 2.7333803176879883, 1.5242633819580078, 1.5242631435394287, 2.7337639331817627, 1.5242573022842407, 1.583262324333191, 1.5242632627487183, 1.7178767919540405, 1.5242626667022705, 1.5745086669921875, 1.5833684206008911, 1.5745112895965576, 1.5242629051208496, 1.5242630243301392, 1.5240494012832642, 1.5242626667022705, 1.5833076238632202, 1.5242633819580078, 0.4746271073818207, 0.9739685654640198, 1.662030816078186, 1.1096127033233643, 2.066077947616577, 1.5829577445983887, 1.5242632627487183, 1.5242626667022705, 1.1559969186782837, 1.5242633819580078, 1.5909281969070435, 1.5242619514465332, 1.5242626667022705, 1.1366217136383057, 1.524262547492981, 0.9739789962768555, 1.7628618478775024, 1.5242629051208496, 0.9739788174629211, 0.9112685918807983, 0.9273790717124939, 1.5242620706558228, 1.583081841468811, 1.5826101303100586, 1.5242478847503662, 1.5242633819580078, 1.5828880071640015, 1.524262547492981, 1.5242611169815063, 1.9181203842163086, 1.5830174684524536, 1.5242626667022705, 1.6142642498016357, 1.5242626667022705, 2.7212255001068115, 1.574511170387268, 1.5242600440979004, 1.5242633819580078, 1.5242619514465332, 1.5833230018615723, 2.1148133277893066, 0.9739817380905151, 1.5242632627487183, 1.5242626667022705, 1.5824836492538452, 1.5242629051208496, 1.52426278591156, 1.52426278591156, 1.52426016330719, 2.0641705989837646, 0.9739696979522705], "mean_td_error": 1.5310906171798706, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 950.0, "diff_num_grad_updates_vs_sampler_policy": 949.0}}, "num_env_steps_sampled": 39000, "num_env_steps_trained": 74100, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 74100, "last_target_update_ts": 39000, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": 9.097993197881044, "episode_reward_min": -9.999595963559132, "episode_reward_mean": -1.4009869948062883, "episode_len_mean": 24.97, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.8674825427442678, 1.347619499137957, -9.99955396354063, 0.0004426862253557426, 0.00043929290967527075, 0.0004553028421872122, 0.08624095864079032, 0.00044785994460368417, 0.00044412346752571523, 0.000440802118212883, -9.999563627390565, 0.0004508267610020248, 0.08465779464737842, 0.00044390944512587906, 0.0004404974247447255, 0.0004403485382031067, 0.0004549007319673598, -9.999548953306315, 0.04359907232325969, -9.999555357336723, 0.0004403978905306477, 0.0004363227018397908, 0.00039844429415632557, 0.5199434539945609, 0.06934718161971043, 9.097993197881044, 0.42310970168572243, -9.999574163637334, 0.08876153140023788, -9.999580445595887, 0.00044230573616026197, 0.00043819533272213706, 0.11587138919626519, 0.5199453557114432, 0.0004281888346614736, -9.999575225555045, 0.0004350344818815405, 0.8702923753344205, 0.0004282681018337185, 0.00042510777376677345, 0.00042174409048135824, 0.000435238047945982, 0.00039746112152214656, 0.0004283301772552604, 0.00042516893638143985, 0.00042180428888561054, -9.99956256236483, 7.515064553089994, 0.0003958129510555805, 0.0004265691197506403, -9.897984426420626, 0.00043642040257515325, 0.00039853285213867174, 0.548355470785491, 0.000426338410156034, 0.00042295529988176594, -9.999559511083035, 0.0004022200983209343, 0.07803538123310037, 1.3154766977663888, 0.00042697682167237025, 0.0004231552799296964, 0.0004192185891924485, -9.999583777157996, 0.00041333413878471, -9.999589212417686, 0.0004156838403779962, 0.00041275073414395746, 2.997689209643918, -9.999592600992889, -9.999595963559132, 0.0004208096396162997, 0.00041780401183314495, 0.8151177099896636, 0.1188300670705795, 0.33544066702318015, 0.6188907024009211, 0.00041488047138651767, 0.00041199784274049815, 0.00040946779465421987, 0.0004060711373139932, 0.00041789257788589116, -9.999585084314845, 0.08640260386147977, 0.0004097547639762278, 0.00042026568100641154, 0.0004163823228378223, 0.0004134393859884448, 0.0004105766824813401, -9.939941424739848, 0.00041902231172898156, 0.00041604207152122084, 0.00041314333206854734, 0.0004105992402308782, 0.00040718386630381014, 0.0004229690444276148, 0.14365629881440162, 0.00041707829620064385, -9.999585514057472, 0.00041100561507288725], "episode_lengths": [24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 26, 25, 25, 23, 25, 25, 25, 23, 26, 25, 26, 25, 25, 23, 25, 25, 26, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 26, 25, 23, 25, 26, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 420.544396674399, "mean_inference_ms": 2.168337553350541, "mean_action_processing_ms": 0.14873746130678073, "mean_env_wait_ms": 2.377758073119918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010694265365600586, "StateBufferConnector_ms": 0.007021188735961914, "ViewRequirementAgentConnector_ms": 0.18147015571594238}}, "episode_reward_max": 9.097993197881044, "episode_reward_min": -9.999595963559132, "episode_reward_mean": -1.4009869948062883, "episode_len_mean": 24.97, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.8674825427442678, 1.347619499137957, -9.99955396354063, 0.0004426862253557426, 0.00043929290967527075, 0.0004553028421872122, 0.08624095864079032, 0.00044785994460368417, 0.00044412346752571523, 0.000440802118212883, -9.999563627390565, 0.0004508267610020248, 0.08465779464737842, 0.00044390944512587906, 0.0004404974247447255, 0.0004403485382031067, 0.0004549007319673598, -9.999548953306315, 0.04359907232325969, -9.999555357336723, 0.0004403978905306477, 0.0004363227018397908, 0.00039844429415632557, 0.5199434539945609, 0.06934718161971043, 9.097993197881044, 0.42310970168572243, -9.999574163637334, 0.08876153140023788, -9.999580445595887, 0.00044230573616026197, 0.00043819533272213706, 0.11587138919626519, 0.5199453557114432, 0.0004281888346614736, -9.999575225555045, 0.0004350344818815405, 0.8702923753344205, 0.0004282681018337185, 0.00042510777376677345, 0.00042174409048135824, 0.000435238047945982, 0.00039746112152214656, 0.0004283301772552604, 0.00042516893638143985, 0.00042180428888561054, -9.99956256236483, 7.515064553089994, 0.0003958129510555805, 0.0004265691197506403, -9.897984426420626, 0.00043642040257515325, 0.00039853285213867174, 0.548355470785491, 0.000426338410156034, 0.00042295529988176594, -9.999559511083035, 0.0004022200983209343, 0.07803538123310037, 1.3154766977663888, 0.00042697682167237025, 0.0004231552799296964, 0.0004192185891924485, -9.999583777157996, 0.00041333413878471, -9.999589212417686, 0.0004156838403779962, 0.00041275073414395746, 2.997689209643918, -9.999592600992889, -9.999595963559132, 0.0004208096396162997, 0.00041780401183314495, 0.8151177099896636, 0.1188300670705795, 0.33544066702318015, 0.6188907024009211, 0.00041488047138651767, 0.00041199784274049815, 0.00040946779465421987, 0.0004060711373139932, 0.00041789257788589116, -9.999585084314845, 0.08640260386147977, 0.0004097547639762278, 0.00042026568100641154, 0.0004163823228378223, 0.0004134393859884448, 0.0004105766824813401, -9.939941424739848, 0.00041902231172898156, 0.00041604207152122084, 0.00041314333206854734, 0.0004105992402308782, 0.00040718386630381014, 0.0004229690444276148, 0.14365629881440162, 0.00041707829620064385, -9.999585514057472, 0.00041100561507288725], "episode_lengths": [24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 26, 25, 25, 23, 25, 25, 25, 23, 26, 25, 26, 25, 25, 23, 25, 25, 26, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 26, 25, 23, 25, 26, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 420.544396674399, "mean_inference_ms": 2.168337553350541, "mean_action_processing_ms": 0.14873746130678073, "mean_env_wait_ms": 2.377758073119918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010694265365600586, "StateBufferConnector_ms": 0.007021188735961914, "ViewRequirementAgentConnector_ms": 0.18147015571594238}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 74100, "num_env_steps_sampled": 39000, "num_env_steps_trained": 74100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.581192404171362, "num_env_steps_trained_throughput_per_sec": 6.983325188134156, "timesteps_total": 39000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 39000, "timers": {"training_iteration_time_ms": 11144.67, "sample_time_ms": 11083.507, "load_time_ms": 0.252, "load_throughput": 309045.638, "learn_time_ms": 12.718, "learn_throughput": 6133.023, "synch_weights_time_ms": 11.586}, "counters": {"num_env_steps_sampled": 39000, "num_env_steps_trained": 74100, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 74100, "last_target_update_ts": 39000, "num_target_updates": 74}, "done": false, "episodes_total": 1485, "training_iteration": 39, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-46-03", "timestamp": 1713415563, "time_this_iter_s": 279.24645805358887, "time_total_s": 9316.262186288834, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 9316.262186288834, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 10.685175879396986, "ram_util_percent": 19.241457286432166}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0020334869623184204, "cur_lr": 0.01}, "td_error": [1.5107358694076538, 1.5107370615005493, 0.9154341816902161, 1.5496258735656738, 0.9684454202651978, 1.5705691576004028, 1.5107372999191284, 1.510908603668213, 1.5107359886169434, 1.5107356309890747, 1.5107351541519165, 0.8928048014640808, 1.5496822595596313, 1.5107357501983643, 0.9684435725212097, 1.510735034942627, 1.7699390649795532, 1.5107349157333374, 1.5107475519180298, 1.5107358694076538, 1.5497428178787231, 1.510735034942627, 1.510736346244812, 1.5107351541519165, 1.549743890762329, 1.5497264862060547, 1.5108228921890259, 1.510735273361206, 1.5107357501983643, 0.475175142288208, 1.510735034942627, 3.057058572769165, 1.570504069328308, 1.810666561126709, 1.5107383728027344, 0.9684450626373291, 1.5495402812957764, 1.5497441291809082, 1.5705206394195557, 1.510735273361206, 2.3079562187194824, 1.5107351541519165, 1.5496907234191895, 1.510735034942627, 1.5705307722091675, 1.5107356309890747, 1.510745644569397, 1.5107356309890747, 1.1463955640792847, 1.510735034942627, 1.5107357501983643, 1.5576043128967285, 0.9684454202651978, 0.9684435129165649, 1.510735034942627, 1.9059584140777588, 1.5497446060180664, 1.510807991027832, 1.5107358694076538, 1.5107353925704956, 1.5108041763305664, 1.5704600811004639, 1.5497416257858276, 0.9684453010559082, 1.510735034942627, 1.510735273361206, 1.5107349157333374, 1.510735034942627, 1.5107386112213135, 1.5107367038726807, 0.9684454202651978, 1.5705530643463135, 2.7252135276794434, 1.5107355117797852, 1.510735034942627, 1.5107358694076538, 1.5107367038726807, 1.510735273361206], "mean_td_error": 1.496618390083313, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 975.0, "diff_num_grad_updates_vs_sampler_policy": 974.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 76050, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 76050, "last_target_update_ts": 39520, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": 7.515064553089994, "episode_reward_min": -19.99959362542595, "episode_reward_mean": -1.6275587034312107, "episode_len_mean": 25.1, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00042510777376677345, 0.00042174409048135824, 0.000435238047945982, 0.00039746112152214656, 0.0004283301772552604, 0.00042516893638143985, 0.00042180428888561054, -9.99956256236483, 7.515064553089994, 0.0003958129510555805, 0.0004265691197506403, -9.897984426420626, 0.00043642040257515325, 0.00039853285213867174, 0.548355470785491, 0.000426338410156034, 0.00042295529988176594, -9.999559511083035, 0.0004022200983209343, 0.07803538123310037, 1.3154766977663888, 0.00042697682167237025, 0.0004231552799296964, 0.0004192185891924485, -9.999583777157996, 0.00041333413878471, -9.999589212417686, 0.0004156838403779962, 0.00041275073414395746, 2.997689209643918, -9.999592600992889, -9.999595963559132, 0.0004208096396162997, 0.00041780401183314495, 0.8151177099896636, 0.1188300670705795, 0.33544066702318015, 0.6188907024009211, 0.00041488047138651767, 0.00041199784274049815, 0.00040946779465421987, 0.0004060711373139932, 0.00041789257788589116, -9.999585084314845, 0.08640260386147977, 0.0004097547639762278, 0.00042026568100641154, 0.0004163823228378223, 0.0004134393859884448, 0.0004105766824813401, -9.939941424739848, 0.00041902231172898156, 0.00041604207152122084, 0.00041314333206854734, 0.0004105992402308782, 0.00040718386630381014, 0.0004229690444276148, 0.14365629881440162, 0.00041707829620064385, -9.999585514057472, 0.00041100561507288725, -9.999592630527264, 0.00040457950783021816, 0.000401976315917001, 0.00039924643785787097, 0.00039639128611908286, 0.00040129179714615834, 0.00039873060930490067, 0.00039604448971524125, 0.0003932347828053694, 0.0003898040505343166, -9.99959373453861, 0.07162133093606071, 0.00040109257194768916, 0.00039821105381510134, 0.00040329913063882867, 0.0004007123372933524, 0.5823245758876431, 0.053902623436611466, 0.0003919685776067187, -19.99959362542595, 0.5570280546195333, -9.999598991607625, 0.0003982913466787189, 0.0003954497882939803, 0.00040504803224701113, 0.00040228993125401147, -9.999600285298543, 0.10540773503670497, 0.5781330799520823, 0.0004043966963725083, 0.0004017958489872414, 0.0003990684131943598, -9.511519931434922, 0.00039299930152183365, 0.0004081660529288025, 0.00040551665187848346, 0.0004027386427938181, 0.0003998335141338001, -9.960221214959898], "episode_lengths": [25, 25, 25, 23, 25, 25, 25, 26, 25, 23, 25, 26, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 420.8603952298061, "mean_inference_ms": 2.1672569189488433, "mean_action_processing_ms": 0.14871146885727898, "mean_env_wait_ms": 2.320707663987934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010333061218261719, "StateBufferConnector_ms": 0.0065402984619140625, "ViewRequirementAgentConnector_ms": 0.18236279487609863}}, "episode_reward_max": 7.515064553089994, "episode_reward_min": -19.99959362542595, "episode_reward_mean": -1.6275587034312107, "episode_len_mean": 25.1, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00042510777376677345, 0.00042174409048135824, 0.000435238047945982, 0.00039746112152214656, 0.0004283301772552604, 0.00042516893638143985, 0.00042180428888561054, -9.99956256236483, 7.515064553089994, 0.0003958129510555805, 0.0004265691197506403, -9.897984426420626, 0.00043642040257515325, 0.00039853285213867174, 0.548355470785491, 0.000426338410156034, 0.00042295529988176594, -9.999559511083035, 0.0004022200983209343, 0.07803538123310037, 1.3154766977663888, 0.00042697682167237025, 0.0004231552799296964, 0.0004192185891924485, -9.999583777157996, 0.00041333413878471, -9.999589212417686, 0.0004156838403779962, 0.00041275073414395746, 2.997689209643918, -9.999592600992889, -9.999595963559132, 0.0004208096396162997, 0.00041780401183314495, 0.8151177099896636, 0.1188300670705795, 0.33544066702318015, 0.6188907024009211, 0.00041488047138651767, 0.00041199784274049815, 0.00040946779465421987, 0.0004060711373139932, 0.00041789257788589116, -9.999585084314845, 0.08640260386147977, 0.0004097547639762278, 0.00042026568100641154, 0.0004163823228378223, 0.0004134393859884448, 0.0004105766824813401, -9.939941424739848, 0.00041902231172898156, 0.00041604207152122084, 0.00041314333206854734, 0.0004105992402308782, 0.00040718386630381014, 0.0004229690444276148, 0.14365629881440162, 0.00041707829620064385, -9.999585514057472, 0.00041100561507288725, -9.999592630527264, 0.00040457950783021816, 0.000401976315917001, 0.00039924643785787097, 0.00039639128611908286, 0.00040129179714615834, 0.00039873060930490067, 0.00039604448971524125, 0.0003932347828053694, 0.0003898040505343166, -9.99959373453861, 0.07162133093606071, 0.00040109257194768916, 0.00039821105381510134, 0.00040329913063882867, 0.0004007123372933524, 0.5823245758876431, 0.053902623436611466, 0.0003919685776067187, -19.99959362542595, 0.5570280546195333, -9.999598991607625, 0.0003982913466787189, 0.0003954497882939803, 0.00040504803224701113, 0.00040228993125401147, -9.999600285298543, 0.10540773503670497, 0.5781330799520823, 0.0004043966963725083, 0.0004017958489872414, 0.0003990684131943598, -9.511519931434922, 0.00039299930152183365, 0.0004081660529288025, 0.00040551665187848346, 0.0004027386427938181, 0.0003998335141338001, -9.960221214959898], "episode_lengths": [25, 25, 25, 23, 25, 25, 25, 26, 25, 23, 25, 26, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 420.8603952298061, "mean_inference_ms": 2.1672569189488433, "mean_action_processing_ms": 0.14871146885727898, "mean_env_wait_ms": 2.320707663987934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010333061218261719, "StateBufferConnector_ms": 0.0065402984619140625, "ViewRequirementAgentConnector_ms": 0.18236279487609863}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 76050, "num_env_steps_sampled": 40000, "num_env_steps_trained": 76050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.058898323899456, "num_env_steps_trained_throughput_per_sec": 7.91485173160394, "timesteps_total": 40000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8984.257, "sample_time_ms": 8924.505, "load_time_ms": 0.236, "load_throughput": 330126.854, "learn_time_ms": 12.381, "learn_throughput": 6299.9, "synch_weights_time_ms": 11.346}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 76050, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 76050, "last_target_update_ts": 39520, "num_target_updates": 75}, "done": false, "episodes_total": 1524, "training_iteration": 40, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-50-10", "timestamp": 1713415810, "time_this_iter_s": 246.38047432899475, "time_total_s": 9562.642660617828, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 9562.642660617828, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 11.958571428571428, "ram_util_percent": 19.34942857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0013913739239796996, "cur_lr": 0.01}, "td_error": [1.941548228263855, 0.9578601717948914, 1.484286904335022, 1.5135952234268188, 0.9578619003295898, 1.4754126071929932, 1.5311940908432007, 1.4754133224487305, 1.4754133224487305, 0.907432496547699, 1.5304776430130005, 1.475425124168396, 1.4754126071929932, 2.161860704421997, 1.4754124879837036, 1.475412368774414, 0.4478967487812042, 1.531209111213684, 1.475412130355835, 1.475413203239441, 1.475412368774414, 2.878483772277832, 1.475412130355835, 1.4754127264022827, 1.5361310243606567, 1.5436140298843384, 1.475413203239441, 1.4754143953323364, 1.4754122495651245, 0.452649861574173, 1.475412368774414, 1.475412368774414, 1.5303505659103394, 2.1307671070098877, 1.4754135608673096, 1.4754127264022827, 0.9578555822372437, 1.121067762374878, 1.4754124879837036, 1.4754209518432617, 1.4754810333251953, 1.4754122495651245, 1.5304851531982422, 1.532645583152771, 1.4754129648208618, 1.4754133224487305, 1.4754198789596558, 1.4754124879837036, 1.475412130355835, 1.4754130840301514, 1.475412130355835, 1.4754233360290527, 0.9572944045066833, 2.1548380851745605, 0.4478967487812042, 1.4754129648208618, 1.4754126071929932, 1.4754126071929932, 1.4754126071929932, 1.5313231945037842, 1.530610203742981, 1.0928256511688232, 1.531200885772705, 1.5312068462371826, 1.5312833786010742, 2.739199161529541, 1.475563883781433, 1.4754126071929932, 1.475412368774414, 1.4754128456115723, 0.9578612446784973, 4.281418323516846, 1.518615484237671, 1.5186188220977783, 1.4754127264022827, 1.5308804512023926, 1.4754124879837036, 1.5186115503311157], "mean_td_error": 1.5005786418914795, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 999.0}}, "num_env_steps_sampled": 41000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 78000, "last_target_update_ts": 40560, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": 2.4635848944419787, "episode_reward_min": -19.999632226295216, "episode_reward_mean": -2.202954748290829, "episode_len_mean": 25.15, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00040946779465421987, 0.0004060711373139932, 0.00041789257788589116, -9.999585084314845, 0.08640260386147977, 0.0004097547639762278, 0.00042026568100641154, 0.0004163823228378223, 0.0004134393859884448, 0.0004105766824813401, -9.939941424739848, 0.00041902231172898156, 0.00041604207152122084, 0.00041314333206854734, 0.0004105992402308782, 0.00040718386630381014, 0.0004229690444276148, 0.14365629881440162, 0.00041707829620064385, -9.999585514057472, 0.00041100561507288725, -9.999592630527264, 0.00040457950783021816, 0.000401976315917001, 0.00039924643785787097, 0.00039639128611908286, 0.00040129179714615834, 0.00039873060930490067, 0.00039604448971524125, 0.0003932347828053694, 0.0003898040505343166, -9.99959373453861, 0.07162133093606071, 0.00040109257194768916, 0.00039821105381510134, 0.00040329913063882867, 0.0004007123372933524, 0.5823245758876431, 0.053902623436611466, 0.0003919685776067187, -19.99959362542595, 0.5570280546195333, -9.999598991607625, 0.0003982913466787189, 0.0003954497882939803, 0.00040504803224701113, 0.00040228993125401147, -9.999600285298543, 0.10540773503670497, 0.5781330799520823, 0.0004043966963725083, 0.0004017958489872414, 0.0003990684131943598, -9.511519931434922, 0.00039299930152183365, 0.0004081660529288025, 0.00040551665187848346, 0.0004027386427938181, 0.0003998335141338001, -9.960221214959898, -9.999607094223862, 1.1958855851895982, -9.999613937941662, -19.999632226295216, 0.00037975899643596147, -9.99961414742794, 0.0003830518234716035, 0.0003649276712102852, -9.999623153669615, -9.34570726584, 0.4113361974076008, 0.00039068882792689543, 0.00038781792349761734, 0.0854301843060713, -9.385513879667378, 0.00038797305942283737, -19.999614857736756, -9.99963309661903, 0.000378868723983108, 0.0003766996521313323, -9.9996080192632, 0.00038798472923539675, 0.0003851532884796093, 0.0003669143710215244, 0.00037887985252709573, 0.8311876490514273, 0.00038804753564486595, 0.0003852151813670877, 0.10710471934828861, 0.17347071465247949, 0.00038898284080810756, 0.046805670302877474, 0.0003681259460491552, 0.00038012002695697573, 0.00037793663934994126, 0.10198591800880126, 0.0003898152638105515, 0.08543199422694098, 2.4635848944419787, 0.13656542338032893], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 26, 25, 24, 26, 26, 25, 25, 25, 24, 26, 25, 27, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 421.1945370453036, "mean_inference_ms": 2.1662795512087754, "mean_action_processing_ms": 0.14862986603935893, "mean_env_wait_ms": 2.264827361212902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010835409164428711, "StateBufferConnector_ms": 0.006539344787597656, "ViewRequirementAgentConnector_ms": 0.18192076683044434}}, "episode_reward_max": 2.4635848944419787, "episode_reward_min": -19.999632226295216, "episode_reward_mean": -2.202954748290829, "episode_len_mean": 25.15, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00040946779465421987, 0.0004060711373139932, 0.00041789257788589116, -9.999585084314845, 0.08640260386147977, 0.0004097547639762278, 0.00042026568100641154, 0.0004163823228378223, 0.0004134393859884448, 0.0004105766824813401, -9.939941424739848, 0.00041902231172898156, 0.00041604207152122084, 0.00041314333206854734, 0.0004105992402308782, 0.00040718386630381014, 0.0004229690444276148, 0.14365629881440162, 0.00041707829620064385, -9.999585514057472, 0.00041100561507288725, -9.999592630527264, 0.00040457950783021816, 0.000401976315917001, 0.00039924643785787097, 0.00039639128611908286, 0.00040129179714615834, 0.00039873060930490067, 0.00039604448971524125, 0.0003932347828053694, 0.0003898040505343166, -9.99959373453861, 0.07162133093606071, 0.00040109257194768916, 0.00039821105381510134, 0.00040329913063882867, 0.0004007123372933524, 0.5823245758876431, 0.053902623436611466, 0.0003919685776067187, -19.99959362542595, 0.5570280546195333, -9.999598991607625, 0.0003982913466787189, 0.0003954497882939803, 0.00040504803224701113, 0.00040228993125401147, -9.999600285298543, 0.10540773503670497, 0.5781330799520823, 0.0004043966963725083, 0.0004017958489872414, 0.0003990684131943598, -9.511519931434922, 0.00039299930152183365, 0.0004081660529288025, 0.00040551665187848346, 0.0004027386427938181, 0.0003998335141338001, -9.960221214959898, -9.999607094223862, 1.1958855851895982, -9.999613937941662, -19.999632226295216, 0.00037975899643596147, -9.99961414742794, 0.0003830518234716035, 0.0003649276712102852, -9.999623153669615, -9.34570726584, 0.4113361974076008, 0.00039068882792689543, 0.00038781792349761734, 0.0854301843060713, -9.385513879667378, 0.00038797305942283737, -19.999614857736756, -9.99963309661903, 0.000378868723983108, 0.0003766996521313323, -9.9996080192632, 0.00038798472923539675, 0.0003851532884796093, 0.0003669143710215244, 0.00037887985252709573, 0.8311876490514273, 0.00038804753564486595, 0.0003852151813670877, 0.10710471934828861, 0.17347071465247949, 0.00038898284080810756, 0.046805670302877474, 0.0003681259460491552, 0.00038012002695697573, 0.00037793663934994126, 0.10198591800880126, 0.0003898152638105515, 0.08543199422694098, 2.4635848944419787, 0.13656542338032893], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 26, 25, 24, 26, 26, 25, 25, 25, 24, 26, 25, 27, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 421.1945370453036, "mean_inference_ms": 2.1662795512087754, "mean_action_processing_ms": 0.14862986603935893, "mean_env_wait_ms": 2.264827361212902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010835409164428711, "StateBufferConnector_ms": 0.006539344787597656, "ViewRequirementAgentConnector_ms": 0.18192076683044434}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 78000, "num_env_steps_sampled": 41000, "num_env_steps_trained": 78000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.0615115792332634, "num_env_steps_trained_throughput_per_sec": 7.919947579504863, "timesteps_total": 41000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 41000, "timers": {"training_iteration_time_ms": 11189.014, "sample_time_ms": 11127.249, "load_time_ms": 0.239, "load_throughput": 325754.966, "learn_time_ms": 13.12, "learn_throughput": 5944.902, "synch_weights_time_ms": 10.699}, "counters": {"num_env_steps_sampled": 41000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 78000, "last_target_update_ts": 40560, "num_target_updates": 77}, "done": false, "episodes_total": 1564, "training_iteration": 41, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-54-16", "timestamp": 1713416056, "time_this_iter_s": 246.22278213500977, "time_total_s": 9808.865442752838, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 9808.865442752838, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 12.313142857142859, "ram_util_percent": 19.51628571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0018970384262502193, "cur_lr": 0.01}, "td_error": [1.1045904159545898, 1.5137248039245605, 1.5137245655059814, 0.9713622331619263, 1.4791980981826782, 0.4386054277420044, 1.4792029857635498, 1.4792028665542603, 1.479203462600708, 1.4792035818099976, 1.535522222518921, 1.4792025089263916, 1.5137239694595337, 1.4792015552520752, 1.479203224182129, 1.4792029857635498, 1.4792029857635498, 1.4792029857635498, 1.4792026281356812, 1.5603605508804321, 2.7071151733398438, 1.5354831218719482, 1.4791966676712036, 1.5137405395507812, 1.4792025089263916, 1.6927021741867065, 1.479203224182129, 1.4792029857635498, 1.4792019128799438, 1.5137243270874023, 1.4792028665542603, 1.4792033433914185, 1.535503625869751, 1.4792028665542603, 1.479203462600708, 3.433455467224121, 0.9713972806930542, 0.8879925608634949, 2.663317918777466, 1.4792022705078125, 0.9713979959487915, 1.4792035818099976, 1.068322777748108, 1.5137314796447754, 1.4792031049728394, 1.4792031049728394, 3.159217596054077, 1.4792003631591797, 1.5137242078781128, 0.9713969230651855, 1.479201316833496, 1.4972877502441406, 1.4792031049728394, 1.069035530090332, 1.479203224182129, 4.134542465209961, 2.118286609649658, 1.5572638511657715, 0.9043936133384705, 1.5137248039245605, 1.5355085134506226, 2.126450300216675, 1.4792015552520752, 1.4792029857635498, 1.4792028665542603, 1.4791972637176514, 1.479203462600708, 1.5355137586593628, 1.479203224182129, 4.265855312347412, 1.479203462600708, 1.4792027473449707, 1.4792031049728394, 1.478886365890503, 1.4792025089263916, 1.4792029857635498, 1.5137238502502441, 1.4792029857635498], "mean_td_error": 1.5859180688858032, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1025.0, "diff_num_grad_updates_vs_sampler_policy": 1024.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 79950, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 79950, "last_target_update_ts": 41600, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": 7.515005818004606, "episode_reward_min": -19.999632226295216, "episode_reward_mean": -1.6734693521150155, "episode_len_mean": 24.95, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999598991607625, 0.0003982913466787189, 0.0003954497882939803, 0.00040504803224701113, 0.00040228993125401147, -9.999600285298543, 0.10540773503670497, 0.5781330799520823, 0.0004043966963725083, 0.0004017958489872414, 0.0003990684131943598, -9.511519931434922, 0.00039299930152183365, 0.0004081660529288025, 0.00040551665187848346, 0.0004027386427938181, 0.0003998335141338001, -9.960221214959898, -9.999607094223862, 1.1958855851895982, -9.999613937941662, -19.999632226295216, 0.00037975899643596147, -9.99961414742794, 0.0003830518234716035, 0.0003649276712102852, -9.999623153669615, -9.34570726584, 0.4113361974076008, 0.00039068882792689543, 0.00038781792349761734, 0.0854301843060713, -9.385513879667378, 0.00038797305942283737, -19.999614857736756, -9.99963309661903, 0.000378868723983108, 0.0003766996521313323, -9.9996080192632, 0.00038798472923539675, 0.0003851532884796093, 0.0003669143710215244, 0.00037887985252709573, 0.8311876490514273, 0.00038804753564486595, 0.0003852151813670877, 0.10710471934828861, 0.17347071465247949, 0.00038898284080810756, 0.046805670302877474, 0.0003681259460491552, 0.00038012002695697573, 0.00037793663934994126, 0.10198591800880126, 0.0003898152638105515, 0.08543199422694098, 2.4635848944419787, 0.13656542338032893, 0.00037757974407203815, 0.0003750796495040393, 0.0003417273206720914, 0.07224472415964776, 0.04270390653003977, 7.515005818004606, 0.16335731886813606, 0.0003659403693581574, 0.00036253324831841136, 0.0003601282706341411, 0.0003794234179318322, 0.00037689893829734734, 0.00034336869350424083, 0.00037027549729921026, 0.00036678756674906227, 0.0003643259862183447, 0.0003742111565364186, 0.0003409437069034707, -9.999632321834069, 0.0003642415765752742, 0.00036181394855803626, 3.83620565669532, 0.0003744423546013527, 0.0003411523130483113, 0.10710624105168305, 0.0003645732695367022, 1.7124392530205161, 0.0003772054894443113, 0.00037471033055243405, -9.999658605677553, 0.000368162924459026, 0.0003647144907714281, 0.0003754318335316278, 0.0003420450751738573, 0.07938346616384831, 0.00036563291155974616, 0.00036318675818395956, -9.795956384222833, 0.0003452313366177404, 0.0524494690863375, 0.12413750042601837, 0.5978127581549916], "episode_lengths": [26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 26, 25, 24, 26, 26, 25, 25, 25, 24, 26, 25, 27, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.01915855322363, "mean_inference_ms": 2.1655848965037556, "mean_action_processing_ms": 0.14853235954930008, "mean_env_wait_ms": 2.2107125070014373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010957717895507812, "StateBufferConnector_ms": 0.0065860748291015625, "ViewRequirementAgentConnector_ms": 0.17884039878845215}}, "episode_reward_max": 7.515005818004606, "episode_reward_min": -19.999632226295216, "episode_reward_mean": -1.6734693521150155, "episode_len_mean": 24.95, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999598991607625, 0.0003982913466787189, 0.0003954497882939803, 0.00040504803224701113, 0.00040228993125401147, -9.999600285298543, 0.10540773503670497, 0.5781330799520823, 0.0004043966963725083, 0.0004017958489872414, 0.0003990684131943598, -9.511519931434922, 0.00039299930152183365, 0.0004081660529288025, 0.00040551665187848346, 0.0004027386427938181, 0.0003998335141338001, -9.960221214959898, -9.999607094223862, 1.1958855851895982, -9.999613937941662, -19.999632226295216, 0.00037975899643596147, -9.99961414742794, 0.0003830518234716035, 0.0003649276712102852, -9.999623153669615, -9.34570726584, 0.4113361974076008, 0.00039068882792689543, 0.00038781792349761734, 0.0854301843060713, -9.385513879667378, 0.00038797305942283737, -19.999614857736756, -9.99963309661903, 0.000378868723983108, 0.0003766996521313323, -9.9996080192632, 0.00038798472923539675, 0.0003851532884796093, 0.0003669143710215244, 0.00037887985252709573, 0.8311876490514273, 0.00038804753564486595, 0.0003852151813670877, 0.10710471934828861, 0.17347071465247949, 0.00038898284080810756, 0.046805670302877474, 0.0003681259460491552, 0.00038012002695697573, 0.00037793663934994126, 0.10198591800880126, 0.0003898152638105515, 0.08543199422694098, 2.4635848944419787, 0.13656542338032893, 0.00037757974407203815, 0.0003750796495040393, 0.0003417273206720914, 0.07224472415964776, 0.04270390653003977, 7.515005818004606, 0.16335731886813606, 0.0003659403693581574, 0.00036253324831841136, 0.0003601282706341411, 0.0003794234179318322, 0.00037689893829734734, 0.00034336869350424083, 0.00037027549729921026, 0.00036678756674906227, 0.0003643259862183447, 0.0003742111565364186, 0.0003409437069034707, -9.999632321834069, 0.0003642415765752742, 0.00036181394855803626, 3.83620565669532, 0.0003744423546013527, 0.0003411523130483113, 0.10710624105168305, 0.0003645732695367022, 1.7124392530205161, 0.0003772054894443113, 0.00037471033055243405, -9.999658605677553, 0.000368162924459026, 0.0003647144907714281, 0.0003754318335316278, 0.0003420450751738573, 0.07938346616384831, 0.00036563291155974616, 0.00036318675818395956, -9.795956384222833, 0.0003452313366177404, 0.0524494690863375, 0.12413750042601837, 0.5978127581549916], "episode_lengths": [26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 26, 25, 24, 26, 26, 25, 25, 25, 24, 26, 25, 27, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.01915855322363, "mean_inference_ms": 2.1655848965037556, "mean_action_processing_ms": 0.14853235954930008, "mean_env_wait_ms": 2.2107125070014373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010957717895507812, "StateBufferConnector_ms": 0.0065860748291015625, "ViewRequirementAgentConnector_ms": 0.17884039878845215}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 79950, "num_env_steps_sampled": 42000, "num_env_steps_trained": 79950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.918917475725183, "num_env_steps_trained_throughput_per_sec": 9.591889077664108, "timesteps_total": 42000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 6822.816, "sample_time_ms": 6759.675, "load_time_ms": 0.245, "load_throughput": 317781.168, "learn_time_ms": 13.242, "learn_throughput": 5890.442, "synch_weights_time_ms": 11.391}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 79950, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 79950, "last_target_update_ts": 41600, "num_target_updates": 79}, "done": false, "episodes_total": 1606, "training_iteration": 42, "trial_id": "cbb9a_00000", "date": "2024-04-18_04-57-39", "timestamp": 1713416259, "time_this_iter_s": 203.30700254440308, "time_total_s": 10012.172445297241, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 10012.172445297241, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 15.363793103448275, "ram_util_percent": 19.651034482758618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.001543132122606039, "cur_lr": 0.01}, "td_error": [0.9781998991966248, 1.5296210050582886, 1.5296214818954468, 0.9781978130340576, 1.5663094520568848, 2.554378032684326, 1.5296220779418945, 1.5296224355697632, 1.5296214818954468, 0.9781997203826904, 1.534043788909912, 1.1052474975585938, 0.8992007374763489, 1.5296211242675781, 1.529622197151184, 1.5296211242675781, 1.1052873134613037, 1.5811008214950562, 1.5296216011047363, 1.5811183452606201, 1.5296225547790527, 2.107063055038452, 1.5296212434768677, 1.5296213626861572, 1.5296223163604736, 1.5296374559402466, 1.5296220779418945, 1.5667105913162231, 1.7349952459335327, 2.679532289505005, 1.529621958732605, 1.529624581336975, 0.9781818389892578, 1.5810842514038086, 1.1304817199707031, 1.5296220779418945, 2.168111562728882, 1.533176064491272, 1.5296218395233154, 1.5296237468719482, 1.5296227931976318, 1.529632568359375, 1.5296229124069214, 1.5296212434768677, 1.5296235084533691, 1.5659319162368774, 1.5296216011047363, 1.529621958732605, 0.9781995415687561, 1.5296217203140259, 1.5296223163604736, 1.5296225547790527, 0.9781994819641113, 1.5296218395233154, 1.5296226739883423, 2.086596965789795, 1.5296211242675781, 1.5296213626861572, 1.5810842514038086, 1.5296218395233154, 1.529623031616211, 2.6800484657287598, 1.5296212434768677, 1.5668182373046875, 1.5296213626861572, 1.1301935911178589, 1.5296261310577393, 1.5328810214996338, 0.8773434162139893, 1.529621958732605, 1.5296227931976318, 1.5660492181777954, 1.581088900566101, 1.5296210050582886, 2.0730082988739014, 1.5296213626861572, 2.663400411605835, 1.5296858549118042], "mean_td_error": 1.5449349880218506, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1050.0, "diff_num_grad_updates_vs_sampler_policy": 1049.0}}, "num_env_steps_sampled": 43000, "num_env_steps_trained": 81900, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 81900, "last_target_update_ts": 42640, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": 7.515005818004606, "episode_reward_min": -19.94964292756946, "episode_reward_mean": -0.7934537117317945, "episode_len_mean": 24.84, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0003851532884796093, 0.0003669143710215244, 0.00037887985252709573, 0.8311876490514273, 0.00038804753564486595, 0.0003852151813670877, 0.10710471934828861, 0.17347071465247949, 0.00038898284080810756, 0.046805670302877474, 0.0003681259460491552, 0.00038012002695697573, 0.00037793663934994126, 0.10198591800880126, 0.0003898152638105515, 0.08543199422694098, 2.4635848944419787, 0.13656542338032893, 0.00037757974407203815, 0.0003750796495040393, 0.0003417273206720914, 0.07224472415964776, 0.04270390653003977, 7.515005818004606, 0.16335731886813606, 0.0003659403693581574, 0.00036253324831841136, 0.0003601282706341411, 0.0003794234179318322, 0.00037689893829734734, 0.00034336869350424083, 0.00037027549729921026, 0.00036678756674906227, 0.0003643259862183447, 0.0003742111565364186, 0.0003409437069034707, -9.999632321834069, 0.0003642415765752742, 0.00036181394855803626, 3.83620565669532, 0.0003744423546013527, 0.0003411523130483113, 0.10710624105168305, 0.0003645732695367022, 1.7124392530205161, 0.0003772054894443113, 0.00037471033055243405, -9.999658605677553, 0.000368162924459026, 0.0003647144907714281, 0.0003754318335316278, 0.0003420450751738573, 0.07938346616384831, 0.00036563291155974616, 0.00036318675818395956, -9.795956384222833, 0.0003452313366177404, 0.0524494690863375, 0.12413750042601837, 0.5978127581549916, 0.0003630888393790508, 0.0003606137704747861, -9.999641212145558, 0.00035645652712330063, 0.548283125410041, 0.00035769326033638604, 0.0003558965281069365, 0.11230745220018995, -9.999648557953659, 0.00033509351715658574, 0.0003618340816984911, 0.0003599956082323405, 0.0003576488184664518, 0.0003553319290641415, 0.00033877831617465116, 0.00035935616962112625, 0.0003575427318833278, 0.0003552277050369526, -9.71783997506578, 0.0003365625435962966, 0.00035968901948486246, -9.999642117546887, 0.1052128996665257, 0.0003536583675028079, 0.0003371936228337649, 0.00036228057384418716, 0.0003598164735544617, 0.06605173698716374, 0.0003557908900743105, 0.00035349792929555005, -19.94964292756946, 0.00035913075831560284, 0.0003567951922422193, 0.0003544893121789795, 0.00033798045612267824, -9.999636022125026, 0.3024007193292186, 0.0003597874554996421, 0.00035744286944374624, 0.7087782894026198], "episode_lengths": [25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 27, 25, 25, 25, 24, 26, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.73242004839557, "mean_inference_ms": 2.164278206958827, "mean_action_processing_ms": 0.1484434551275843, "mean_env_wait_ms": 2.1621307882493905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010751724243164062, "StateBufferConnector_ms": 0.006631374359130859, "ViewRequirementAgentConnector_ms": 0.18062329292297363}}, "episode_reward_max": 7.515005818004606, "episode_reward_min": -19.94964292756946, "episode_reward_mean": -0.7934537117317945, "episode_len_mean": 24.84, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0003851532884796093, 0.0003669143710215244, 0.00037887985252709573, 0.8311876490514273, 0.00038804753564486595, 0.0003852151813670877, 0.10710471934828861, 0.17347071465247949, 0.00038898284080810756, 0.046805670302877474, 0.0003681259460491552, 0.00038012002695697573, 0.00037793663934994126, 0.10198591800880126, 0.0003898152638105515, 0.08543199422694098, 2.4635848944419787, 0.13656542338032893, 0.00037757974407203815, 0.0003750796495040393, 0.0003417273206720914, 0.07224472415964776, 0.04270390653003977, 7.515005818004606, 0.16335731886813606, 0.0003659403693581574, 0.00036253324831841136, 0.0003601282706341411, 0.0003794234179318322, 0.00037689893829734734, 0.00034336869350424083, 0.00037027549729921026, 0.00036678756674906227, 0.0003643259862183447, 0.0003742111565364186, 0.0003409437069034707, -9.999632321834069, 0.0003642415765752742, 0.00036181394855803626, 3.83620565669532, 0.0003744423546013527, 0.0003411523130483113, 0.10710624105168305, 0.0003645732695367022, 1.7124392530205161, 0.0003772054894443113, 0.00037471033055243405, -9.999658605677553, 0.000368162924459026, 0.0003647144907714281, 0.0003754318335316278, 0.0003420450751738573, 0.07938346616384831, 0.00036563291155974616, 0.00036318675818395956, -9.795956384222833, 0.0003452313366177404, 0.0524494690863375, 0.12413750042601837, 0.5978127581549916, 0.0003630888393790508, 0.0003606137704747861, -9.999641212145558, 0.00035645652712330063, 0.548283125410041, 0.00035769326033638604, 0.0003558965281069365, 0.11230745220018995, -9.999648557953659, 0.00033509351715658574, 0.0003618340816984911, 0.0003599956082323405, 0.0003576488184664518, 0.0003553319290641415, 0.00033877831617465116, 0.00035935616962112625, 0.0003575427318833278, 0.0003552277050369526, -9.71783997506578, 0.0003365625435962966, 0.00035968901948486246, -9.999642117546887, 0.1052128996665257, 0.0003536583675028079, 0.0003371936228337649, 0.00036228057384418716, 0.0003598164735544617, 0.06605173698716374, 0.0003557908900743105, 0.00035349792929555005, -19.94964292756946, 0.00035913075831560284, 0.0003567951922422193, 0.0003544893121789795, 0.00033798045612267824, -9.999636022125026, 0.3024007193292186, 0.0003597874554996421, 0.00035744286944374624, 0.7087782894026198], "episode_lengths": [25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 27, 25, 25, 25, 24, 26, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.73242004839557, "mean_inference_ms": 2.164278206958827, "mean_action_processing_ms": 0.1484434551275843, "mean_env_wait_ms": 2.1621307882493905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010751724243164062, "StateBufferConnector_ms": 0.006631374359130859, "ViewRequirementAgentConnector_ms": 0.18062329292297363}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 81900, "num_env_steps_sampled": 43000, "num_env_steps_trained": 81900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.8855350030407063, "num_env_steps_trained_throughput_per_sec": 7.576793255929378, "timesteps_total": 43000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 43000, "timers": {"training_iteration_time_ms": 11098.724, "sample_time_ms": 11034.547, "load_time_ms": 0.25, "load_throughput": 311428.569, "learn_time_ms": 13.532, "learn_throughput": 5764.076, "synch_weights_time_ms": 11.332}, "counters": {"num_env_steps_sampled": 43000, "num_env_steps_trained": 81900, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 81900, "last_target_update_ts": 42640, "num_target_updates": 81}, "done": false, "episodes_total": 1646, "training_iteration": 43, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-01-57", "timestamp": 1713416517, "time_this_iter_s": 257.3782374858856, "time_total_s": 10269.550682783127, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 10269.550682783127, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 11.877322404371586, "ram_util_percent": 19.856284153005472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0016163998516276479, "cur_lr": 0.01}, "td_error": [1.5138126611709595, 0.9715620279312134, 1.5138123035430908, 1.5138131380081177, 1.5138121843338013, 1.5138128995895386, 0.4283137917518616, 1.513816475868225, 1.5138128995895386, 1.5138121843338013, 1.5138128995895386, 1.5607608556747437, 1.5605970621109009, 2.17914080619812, 0.45018595457077026, 1.5138119459152222, 0.971561074256897, 1.5605521202087402, 1.5138123035430908, 1.5526655912399292, 1.5607482194900513, 2.1360013484954834, 1.5138119459152222, 1.5404528379440308, 0.4442392587661743, 0.864061713218689, 1.5138121843338013, 0.9715617895126343, 1.5138130187988281, 1.513812780380249, 1.1058154106140137, 1.5138128995895386, 1.5605661869049072, 1.5138128995895386, 1.5138118267059326, 1.5138123035430908, 1.513812780380249, 1.5138201713562012, 3.7765297889709473, 2.173625946044922, 1.513817548751831, 1.5138132572174072, 2.6907505989074707, 0.8630980253219604, 1.513814091682434, 1.5526795387268066, 1.5138121843338013, 2.1248278617858887, 1.5138123035430908, 1.5138130187988281, 1.6394226551055908, 1.5138121843338013, 1.5528573989868164, 1.091820240020752, 1.5138126611709595, 1.553954839706421, 1.51381254196167, 1.8270236253738403, 1.5526694059371948, 1.5138118267059326, 1.5142055749893188, 1.5138118267059326, 0.45018595457077026, 1.5138260126113892, 1.5138120651245117, 1.1020749807357788, 1.5138131380081177, 1.5138126611709595, 1.5138121843338013, 1.5138142108917236, 1.0252113342285156, 0.9715578556060791, 1.5138121843338013, 1.5138252973556519, 1.5138121843338013, 1.5138136148452759, 1.7579009532928467, 0.9715570211410522], "mean_td_error": 1.4768065214157104, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1075.0, "diff_num_grad_updates_vs_sampler_policy": 1074.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 83850, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 83850, "last_target_update_ts": 43680, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": 1.7124392530205161, "episode_reward_min": -19.99965377645247, "episode_reward_mean": -1.521956444777611, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0003744423546013527, 0.0003411523130483113, 0.10710624105168305, 0.0003645732695367022, 1.7124392530205161, 0.0003772054894443113, 0.00037471033055243405, -9.999658605677553, 0.000368162924459026, 0.0003647144907714281, 0.0003754318335316278, 0.0003420450751738573, 0.07938346616384831, 0.00036563291155974616, 0.00036318675818395956, -9.795956384222833, 0.0003452313366177404, 0.0524494690863375, 0.12413750042601837, 0.5978127581549916, 0.0003630888393790508, 0.0003606137704747861, -9.999641212145558, 0.00035645652712330063, 0.548283125410041, 0.00035769326033638604, 0.0003558965281069365, 0.11230745220018995, -9.999648557953659, 0.00033509351715658574, 0.0003618340816984911, 0.0003599956082323405, 0.0003576488184664518, 0.0003553319290641415, 0.00033877831617465116, 0.00035935616962112625, 0.0003575427318833278, 0.0003552277050369526, -9.71783997506578, 0.0003365625435962966, 0.00035968901948486246, -9.999642117546887, 0.1052128996665257, 0.0003536583675028079, 0.0003371936228337649, 0.00036228057384418716, 0.0003598164735544617, 0.06605173698716374, 0.0003557908900743105, 0.00035349792929555005, -19.94964292756946, 0.00035913075831560284, 0.0003567951922422193, 0.0003544893121789795, 0.00033798045612267824, -9.999636022125026, 0.3024007193292186, 0.0003597874554996421, 0.00035744286944374624, 0.7087782894026198, 0.00033769087014032164, 0.0003495633756077905, 0.00034751727241934445, -9.999654894958587, 0.7355152178171233, 0.00034689137303857355, 0.0003448763429356141, 0.00034250031298084716, 0.0003406597853901732, -9.99966127075854, 1.7101689507441118, 0.0003486512958306964, -19.99965377645247, 0.00034434250388980714, 0.0003423699303767456, 0.0003484026517761334, 0.0003463700758469925, 0.00034397349676841955, -9.999657882674473, 0.00034016990603075853, 0.00034905185696523447, 0.000347011720593771, 0.00034460628751571465, 0.00034274310988593857, 0.00034078876509268356, 0.0003370416987097531, 0.00034889557063902225, 0.00034685725560503746, 0.0003444539554565098, 0.0003425924208039295, 0.00034986126856964886, 0.0003478116864960288, 0.00034539519206720976, -9.99965647631628, 0.0003415602656366064, 0.0003527493072249148, 0.0003506658454367348, 0.27693659681234783, 0.0003463563915537456, -9.999655634712232], "episode_lengths": [25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 27, 25, 25, 25, 24, 26, 25, 25, 25, 24, 24, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.29851288661877, "mean_inference_ms": 2.1621669099136023, "mean_action_processing_ms": 0.14831455548742703, "mean_env_wait_ms": 2.115798710961093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010604619979858398, "StateBufferConnector_ms": 0.0066149234771728516, "ViewRequirementAgentConnector_ms": 0.17965102195739746}}, "episode_reward_max": 1.7124392530205161, "episode_reward_min": -19.99965377645247, "episode_reward_mean": -1.521956444777611, "episode_len_mean": 25.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0003744423546013527, 0.0003411523130483113, 0.10710624105168305, 0.0003645732695367022, 1.7124392530205161, 0.0003772054894443113, 0.00037471033055243405, -9.999658605677553, 0.000368162924459026, 0.0003647144907714281, 0.0003754318335316278, 0.0003420450751738573, 0.07938346616384831, 0.00036563291155974616, 0.00036318675818395956, -9.795956384222833, 0.0003452313366177404, 0.0524494690863375, 0.12413750042601837, 0.5978127581549916, 0.0003630888393790508, 0.0003606137704747861, -9.999641212145558, 0.00035645652712330063, 0.548283125410041, 0.00035769326033638604, 0.0003558965281069365, 0.11230745220018995, -9.999648557953659, 0.00033509351715658574, 0.0003618340816984911, 0.0003599956082323405, 0.0003576488184664518, 0.0003553319290641415, 0.00033877831617465116, 0.00035935616962112625, 0.0003575427318833278, 0.0003552277050369526, -9.71783997506578, 0.0003365625435962966, 0.00035968901948486246, -9.999642117546887, 0.1052128996665257, 0.0003536583675028079, 0.0003371936228337649, 0.00036228057384418716, 0.0003598164735544617, 0.06605173698716374, 0.0003557908900743105, 0.00035349792929555005, -19.94964292756946, 0.00035913075831560284, 0.0003567951922422193, 0.0003544893121789795, 0.00033798045612267824, -9.999636022125026, 0.3024007193292186, 0.0003597874554996421, 0.00035744286944374624, 0.7087782894026198, 0.00033769087014032164, 0.0003495633756077905, 0.00034751727241934445, -9.999654894958587, 0.7355152178171233, 0.00034689137303857355, 0.0003448763429356141, 0.00034250031298084716, 0.0003406597853901732, -9.99966127075854, 1.7101689507441118, 0.0003486512958306964, -19.99965377645247, 0.00034434250388980714, 0.0003423699303767456, 0.0003484026517761334, 0.0003463700758469925, 0.00034397349676841955, -9.999657882674473, 0.00034016990603075853, 0.00034905185696523447, 0.000347011720593771, 0.00034460628751571465, 0.00034274310988593857, 0.00034078876509268356, 0.0003370416987097531, 0.00034889557063902225, 0.00034685725560503746, 0.0003444539554565098, 0.0003425924208039295, 0.00034986126856964886, 0.0003478116864960288, 0.00034539519206720976, -9.99965647631628, 0.0003415602656366064, 0.0003527493072249148, 0.0003506658454367348, 0.27693659681234783, 0.0003463563915537456, -9.999655634712232], "episode_lengths": [25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 27, 25, 25, 25, 24, 26, 25, 25, 25, 24, 24, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.29851288661877, "mean_inference_ms": 2.1621669099136023, "mean_action_processing_ms": 0.14831455548742703, "mean_env_wait_ms": 2.115798710961093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010604619979858398, "StateBufferConnector_ms": 0.0066149234771728516, "ViewRequirementAgentConnector_ms": 0.17965102195739746}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 83850, "num_env_steps_sampled": 44000, "num_env_steps_trained": 83850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.423338001328669, "num_env_steps_trained_throughput_per_sec": 8.625509102590904, "timesteps_total": 44000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 9059.537, "sample_time_ms": 8996.227, "load_time_ms": 0.241, "load_throughput": 323308.343, "learn_time_ms": 12.651, "learn_throughput": 6165.479, "synch_weights_time_ms": 11.319}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 83850, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 83850, "last_target_update_ts": 43680, "num_target_updates": 83}, "done": false, "episodes_total": 1686, "training_iteration": 44, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-05-43", "timestamp": 1713416743, "time_this_iter_s": 226.08483386039734, "time_total_s": 10495.635516643524, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 10495.635516643524, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 13.496583850931676, "ram_util_percent": 19.94658385093168}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0034984329249709845, "cur_lr": 0.01}, "td_error": [0.4362705647945404, 1.5018165111541748, 1.501814842224121, 1.5018140077590942, 1.5018430948257446, 1.5018138885498047, 1.5018246173858643, 1.546811819076538, 1.5018177032470703, 1.501814842224121, 1.5468236207962036, 1.5270323753356934, 1.5018175840377808, 1.1040799617767334, 0.9668434858322144, 1.5468984842300415, 1.8531066179275513, 0.966843843460083, 1.1119599342346191, 1.501814842224121, 3.025662899017334, 1.501814365386963, 1.559328556060791, 1.5018153190612793, 1.501814842224121, 1.5018155574798584, 2.0536210536956787, 1.5018177032470703, 1.104317307472229, 1.5018179416656494, 1.5018149614334106, 0.9668437838554382, 1.501814603805542, 0.96684330701828, 1.5415500402450562, 1.5018149614334106, 1.5468113422393799, 1.501815915107727, 1.5018151998519897, 1.5468249320983887, 1.546866774559021, 0.9668376445770264, 1.6458557844161987, 2.3534414768218994, 0.9668439030647278, 1.501816749572754, 2.700300931930542, 2.1695218086242676, 2.700314521789551, 1.1113803386688232, 2.1284537315368652, 1.546815037727356, 1.5412824153900146, 1.5018140077590942, 1.5468158721923828, 1.501814365386963, 1.5018848180770874, 1.5018140077590942, 1.5018165111541748, 1.5018149614334106, 1.501817226409912, 0.9668330550193787, 0.9665716886520386, 1.9795202016830444, 1.1417579650878906, 1.5018162727355957, 1.5018137693405151, 0.9668440818786621, 1.5018142461776733, 1.541266918182373, 1.5468391180038452, 2.127671957015991, 1.561410903930664, 1.5018138885498047, 1.5018138885498047, 0.4285277724266052, 2.1397337913513184, 2.137664556503296], "mean_td_error": 1.5180727243423462, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1100.0, "diff_num_grad_updates_vs_sampler_policy": 1099.0}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 85800, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 85800, "last_target_update_ts": 44720, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": 6.575638712046885, "episode_reward_min": -19.999661503308516, "episode_reward_mean": -2.356606915812271, "episode_len_mean": 25.19, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0003365625435962966, 0.00035968901948486246, -9.999642117546887, 0.1052128996665257, 0.0003536583675028079, 0.0003371936228337649, 0.00036228057384418716, 0.0003598164735544617, 0.06605173698716374, 0.0003557908900743105, 0.00035349792929555005, -19.94964292756946, 0.00035913075831560284, 0.0003567951922422193, 0.0003544893121789795, 0.00033798045612267824, -9.999636022125026, 0.3024007193292186, 0.0003597874554996421, 0.00035744286944374624, 0.7087782894026198, 0.00033769087014032164, 0.0003495633756077905, 0.00034751727241934445, -9.999654894958587, 0.7355152178171233, 0.00034689137303857355, 0.0003448763429356141, 0.00034250031298084716, 0.0003406597853901732, -9.99966127075854, 1.7101689507441118, 0.0003486512958306964, -19.99965377645247, 0.00034434250388980714, 0.0003423699303767456, 0.0003484026517761334, 0.0003463700758469925, 0.00034397349676841955, -9.999657882674473, 0.00034016990603075853, 0.00034905185696523447, 0.000347011720593771, 0.00034460628751571465, 0.00034274310988593857, 0.00034078876509268356, 0.0003370416987097531, 0.00034889557063902225, 0.00034685725560503746, 0.0003444539554565098, 0.0003425924208039295, 0.00034986126856964886, 0.0003478116864960288, 0.00034539519206720976, -9.99965647631628, 0.0003415602656366064, 0.0003527493072249148, 0.0003506658454367348, 0.27693659681234783, 0.0003463563915537456, -9.999655634712232, 0.0003412901207705277, -19.999661503308516, 0.0003357604727469667, 0.00033408748844512045, -9.940408940684657, 0.6650169555119924, -9.999666696680986, 0.0003316534562897007, 0.00032994614080994065, 0.00032780877349715604, 0.00033955850251935453, -9.999663191811774, 0.00033512213092341673, 0.0003333790266936519, -9.999662605475057, 6.575638712046885, 0.0003330171993397213, 0.0003312958571797731, 0.00032914102050618266, 0.0003380031360871206, 0.0003352752187563305, 0.00033360705688882615, 0.03698775541206252, 0.00032996528984467527, 0.00034063978911792937, -9.999662126126257, 0.0811616915951425, -9.99966643585047, -9.999668162834583, 0.00033876206328534386, -9.999663977887423, 0.0003343463464404114, 0.12834668806715327, 0.0003305359070016544, 0.00034151666720289606, -19.999661262899316, -9.432466684043893, -9.99966471335553, 2.2407982605333103], "episode_lengths": [24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 27, 25, 25, 25, 24, 26, 25, 25, 25, 24, 24, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 26, 25, 25, 25, 25, 27, 26, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.6779912224006, "mean_inference_ms": 2.161051690553032, "mean_action_processing_ms": 0.14824937609085467, "mean_env_wait_ms": 2.071228802951194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010497570037841797, "StateBufferConnector_ms": 0.0068035125732421875, "ViewRequirementAgentConnector_ms": 0.17780089378356934}}, "episode_reward_max": 6.575638712046885, "episode_reward_min": -19.999661503308516, "episode_reward_mean": -2.356606915812271, "episode_len_mean": 25.19, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0003365625435962966, 0.00035968901948486246, -9.999642117546887, 0.1052128996665257, 0.0003536583675028079, 0.0003371936228337649, 0.00036228057384418716, 0.0003598164735544617, 0.06605173698716374, 0.0003557908900743105, 0.00035349792929555005, -19.94964292756946, 0.00035913075831560284, 0.0003567951922422193, 0.0003544893121789795, 0.00033798045612267824, -9.999636022125026, 0.3024007193292186, 0.0003597874554996421, 0.00035744286944374624, 0.7087782894026198, 0.00033769087014032164, 0.0003495633756077905, 0.00034751727241934445, -9.999654894958587, 0.7355152178171233, 0.00034689137303857355, 0.0003448763429356141, 0.00034250031298084716, 0.0003406597853901732, -9.99966127075854, 1.7101689507441118, 0.0003486512958306964, -19.99965377645247, 0.00034434250388980714, 0.0003423699303767456, 0.0003484026517761334, 0.0003463700758469925, 0.00034397349676841955, -9.999657882674473, 0.00034016990603075853, 0.00034905185696523447, 0.000347011720593771, 0.00034460628751571465, 0.00034274310988593857, 0.00034078876509268356, 0.0003370416987097531, 0.00034889557063902225, 0.00034685725560503746, 0.0003444539554565098, 0.0003425924208039295, 0.00034986126856964886, 0.0003478116864960288, 0.00034539519206720976, -9.99965647631628, 0.0003415602656366064, 0.0003527493072249148, 0.0003506658454367348, 0.27693659681234783, 0.0003463563915537456, -9.999655634712232, 0.0003412901207705277, -19.999661503308516, 0.0003357604727469667, 0.00033408748844512045, -9.940408940684657, 0.6650169555119924, -9.999666696680986, 0.0003316534562897007, 0.00032994614080994065, 0.00032780877349715604, 0.00033955850251935453, -9.999663191811774, 0.00033512213092341673, 0.0003333790266936519, -9.999662605475057, 6.575638712046885, 0.0003330171993397213, 0.0003312958571797731, 0.00032914102050618266, 0.0003380031360871206, 0.0003352752187563305, 0.00033360705688882615, 0.03698775541206252, 0.00032996528984467527, 0.00034063978911792937, -9.999662126126257, 0.0811616915951425, -9.99966643585047, -9.999668162834583, 0.00033876206328534386, -9.999663977887423, 0.0003343463464404114, 0.12834668806715327, 0.0003305359070016544, 0.00034151666720289606, -19.999661262899316, -9.432466684043893, -9.99966471335553, 2.2407982605333103], "episode_lengths": [24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 27, 25, 25, 25, 24, 26, 25, 25, 25, 24, 24, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 26, 25, 25, 25, 25, 27, 26, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.6779912224006, "mean_inference_ms": 2.161051690553032, "mean_action_processing_ms": 0.14824937609085467, "mean_env_wait_ms": 2.071228802951194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010497570037841797, "StateBufferConnector_ms": 0.0068035125732421875, "ViewRequirementAgentConnector_ms": 0.17780089378356934}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 85800, "num_env_steps_sampled": 45000, "num_env_steps_trained": 85800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.8702995973426004, "num_env_steps_trained_throughput_per_sec": 7.547084214818071, "timesteps_total": 45000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 11248.018, "sample_time_ms": 11181.02, "load_time_ms": 0.237, "load_throughput": 328469.59, "learn_time_ms": 13.277, "learn_throughput": 5874.882, "synch_weights_time_ms": 12.75}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 85800, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 85800, "last_target_update_ts": 44720, "num_target_updates": 85}, "done": false, "episodes_total": 1725, "training_iteration": 45, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-10-01", "timestamp": 1713417001, "time_this_iter_s": 258.3883135318756, "time_total_s": 10754.0238301754, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 10754.0238301754, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 11.47901907356948, "ram_util_percent": 20.14359673024523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.001572262728586793, "cur_lr": 0.01}, "td_error": [1.4872163534164429, 2.407738208770752, 1.4872163534164429, 0.963019073009491, 1.4872163534164429, 1.4872257709503174, 1.4872163534164429, 1.4872167110443115, 1.4872171878814697, 1.4872239828109741, 1.4872208833694458, 1.4872167110443115, 1.4872183799743652, 1.5704400539398193, 1.487216830253601, 1.5436363220214844, 1.6204644441604614, 1.4872268438339233, 0.9630187749862671, 1.4872174263000488, 1.4872162342071533, 1.4872163534164429, 1.4872167110443115, 1.487216830253601, 1.4872163534164429, 1.5381102561950684, 1.4872161149978638, 1.4872163534164429, 0.4275098145008087, 1.5381132364273071, 0.8692008256912231, 0.8837627172470093, 1.4872159957885742, 0.8692008256912231, 1.4872161149978638, 1.4872162342071533, 1.4872163534164429, 0.8771786689758301, 1.4872164726257324, 1.487216591835022, 1.4872167110443115, 0.9630190134048462, 1.4872171878814697, 1.4872162342071533, 1.487465739250183, 1.487216591835022, 1.7147741317749023, 1.4872297048568726, 1.4872174263000488, 1.4872169494628906, 1.4872169494628906, 1.539032220840454, 1.4872163534164429, 0.9630192518234253, 1.4872163534164429, 1.4872167110443115, 2.7478995323181152, 1.5379301309585571, 1.487216830253601, 1.4872164726257324, 1.487216591835022, 2.145447015762329, 1.5438950061798096, 1.487216591835022, 1.487216591835022, 2.747905731201172, 1.4872193336486816, 1.5440617799758911, 2.1388301849365234, 1.4872167110443115, 0.8837627172470093, 1.4872186183929443, 1.4874509572982788, 1.537927508354187, 0.9630208015441895, 1.5382407903671265, 0.9630210399627686, 2.1162924766540527], "mean_td_error": 1.4749540090560913, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1125.0, "diff_num_grad_updates_vs_sampler_policy": 1124.0}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 87750, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 87750, "last_target_update_ts": 45760, "num_target_updates": 87}, "sampler_results": {"episode_reward_max": 6.575638712046885, "episode_reward_min": -19.999661503308516, "episode_reward_mean": -1.9695655956333393, "episode_len_mean": 25.2, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999657882674473, 0.00034016990603075853, 0.00034905185696523447, 0.000347011720593771, 0.00034460628751571465, 0.00034274310988593857, 0.00034078876509268356, 0.0003370416987097531, 0.00034889557063902225, 0.00034685725560503746, 0.0003444539554565098, 0.0003425924208039295, 0.00034986126856964886, 0.0003478116864960288, 0.00034539519206720976, -9.99965647631628, 0.0003415602656366064, 0.0003527493072249148, 0.0003506658454367348, 0.27693659681234783, 0.0003463563915537456, -9.999655634712232, 0.0003412901207705277, -19.999661503308516, 0.0003357604727469667, 0.00033408748844512045, -9.940408940684657, 0.6650169555119924, -9.999666696680986, 0.0003316534562897007, 0.00032994614080994065, 0.00032780877349715604, 0.00033955850251935453, -9.999663191811774, 0.00033512213092341673, 0.0003333790266936519, -9.999662605475057, 6.575638712046885, 0.0003330171993397213, 0.0003312958571797731, 0.00032914102050618266, 0.0003380031360871206, 0.0003352752187563305, 0.00033360705688882615, 0.03698775541206252, 0.00032996528984467527, 0.00034063978911792937, -9.999662126126257, 0.0811616915951425, -9.99966643585047, -9.999668162834583, 0.00033876206328534386, -9.999663977887423, 0.0003343463464404114, 0.12834668806715327, 0.0003305359070016544, 0.00034151666720289606, -19.999661262899316, -9.432466684043893, -9.99966471335553, 2.2407982605333103, 0.0003303574987250205, 0.000328498402649357, 0.0003270098568125728, 0.0003255728798379054, 0.0003237438209317038, 0.00032597817673282026, 0.00032451233234728516, 0.00032309717238481573, 0.0003212957465763309, 0.07777164756280094, 0.14847328330536183, 0.0003294006152690562, 0.00032790390035892397, -9.939740587826455, 0.0003247886626530358, 0.0003272955541473175, 0.0003258178648762872, 0.0003243913212174644, 0.0003225754765989388, 0.0003207297149511072, -9.999671889234149, 0.0003266255523574069, 0.00032519194327204414, 0.07762170012434594, 0.0003296751287488072, 0.00032782368425367746, 0.7597975357212201, 0.11823190396350558, 0.0003232655718497225, 0.34767654069138065, 0.00032721776727238065, -9.999674220863845, -9.999676052234136, 0.12307518467039924, 0.0003311950872839502, 0.0003296820582046465, 0.00032822155437329305, 0.223246526230623, 0.44818330772424136], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 26, 25, 25, 25, 25, 27, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.91035644063174, "mean_inference_ms": 2.1607234287160155, "mean_action_processing_ms": 0.1482155041249517, "mean_env_wait_ms": 2.0281512851895824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010207653045654297, "StateBufferConnector_ms": 0.006750583648681641, "ViewRequirementAgentConnector_ms": 0.1802506446838379}}, "episode_reward_max": 6.575638712046885, "episode_reward_min": -19.999661503308516, "episode_reward_mean": -1.9695655956333393, "episode_len_mean": 25.2, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999657882674473, 0.00034016990603075853, 0.00034905185696523447, 0.000347011720593771, 0.00034460628751571465, 0.00034274310988593857, 0.00034078876509268356, 0.0003370416987097531, 0.00034889557063902225, 0.00034685725560503746, 0.0003444539554565098, 0.0003425924208039295, 0.00034986126856964886, 0.0003478116864960288, 0.00034539519206720976, -9.99965647631628, 0.0003415602656366064, 0.0003527493072249148, 0.0003506658454367348, 0.27693659681234783, 0.0003463563915537456, -9.999655634712232, 0.0003412901207705277, -19.999661503308516, 0.0003357604727469667, 0.00033408748844512045, -9.940408940684657, 0.6650169555119924, -9.999666696680986, 0.0003316534562897007, 0.00032994614080994065, 0.00032780877349715604, 0.00033955850251935453, -9.999663191811774, 0.00033512213092341673, 0.0003333790266936519, -9.999662605475057, 6.575638712046885, 0.0003330171993397213, 0.0003312958571797731, 0.00032914102050618266, 0.0003380031360871206, 0.0003352752187563305, 0.00033360705688882615, 0.03698775541206252, 0.00032996528984467527, 0.00034063978911792937, -9.999662126126257, 0.0811616915951425, -9.99966643585047, -9.999668162834583, 0.00033876206328534386, -9.999663977887423, 0.0003343463464404114, 0.12834668806715327, 0.0003305359070016544, 0.00034151666720289606, -19.999661262899316, -9.432466684043893, -9.99966471335553, 2.2407982605333103, 0.0003303574987250205, 0.000328498402649357, 0.0003270098568125728, 0.0003255728798379054, 0.0003237438209317038, 0.00032597817673282026, 0.00032451233234728516, 0.00032309717238481573, 0.0003212957465763309, 0.07777164756280094, 0.14847328330536183, 0.0003294006152690562, 0.00032790390035892397, -9.939740587826455, 0.0003247886626530358, 0.0003272955541473175, 0.0003258178648762872, 0.0003243913212174644, 0.0003225754765989388, 0.0003207297149511072, -9.999671889234149, 0.0003266255523574069, 0.00032519194327204414, 0.07762170012434594, 0.0003296751287488072, 0.00032782368425367746, 0.7597975357212201, 0.11823190396350558, 0.0003232655718497225, 0.34767654069138065, 0.00032721776727238065, -9.999674220863845, -9.999676052234136, 0.12307518467039924, 0.0003311950872839502, 0.0003296820582046465, 0.00032822155437329305, 0.223246526230623, 0.44818330772424136], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 26, 25, 25, 25, 25, 27, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.91035644063174, "mean_inference_ms": 2.1607234287160155, "mean_action_processing_ms": 0.1482155041249517, "mean_env_wait_ms": 2.0281512851895824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010207653045654297, "StateBufferConnector_ms": 0.006750583648681641, "ViewRequirementAgentConnector_ms": 0.1802506446838379}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 87750, "num_env_steps_sampled": 46000, "num_env_steps_trained": 87750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5920520538554377, "num_env_steps_trained_throughput_per_sec": 7.004501505018104, "timesteps_total": 46000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 11175.092, "sample_time_ms": 11111.909, "load_time_ms": 0.25, "load_throughput": 311665.916, "learn_time_ms": 12.94, "learn_throughput": 6027.998, "synch_weights_time_ms": 12.232}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 87750, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 87750, "last_target_update_ts": 45760, "num_target_updates": 87}, "done": false, "episodes_total": 1764, "training_iteration": 46, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-14-40", "timestamp": 1713417280, "time_this_iter_s": 278.4009783267975, "time_total_s": 11032.424808502197, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 11032.424808502197, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 10.729040404040404, "ram_util_percent": 20.270202020202024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0011852827155962586, "cur_lr": 0.01}, "td_error": [1.463937520980835, 1.4639368057250977, 3.4380292892456055, 1.463937520980835, 1.5205963850021362, 1.463936686515808, 1.4639369249343872, 1.4639393091201782, 1.4639371633529663, 1.4639376401901245, 1.5071874856948853, 0.8686881065368652, 1.4639374017715454, 1.4639378786087036, 1.4639371633529663, 1.6399508714675903, 1.46393883228302, 1.46393883228302, 1.4639368057250977, 1.4639371633529663, 1.4639369249343872, 0.9499286413192749, 1.4639368057250977, 1.463937520980835, 1.5071481466293335, 1.5230141878128052, 1.464258074760437, 1.4639368057250977, 1.4639371633529663, 1.463936686515808, 2.7778613567352295, 1.4639695882797241, 1.50716233253479, 1.4639387130737305, 1.4639368057250977, 1.463937520980835, 0.9499319791793823, 1.5391778945922852, 1.4639419317245483, 1.4639397859573364, 1.4639394283294678, 1.4639402627944946, 1.4639370441436768, 1.4639370441436768, 1.4639381170272827, 1.4639374017715454, 1.4639531373977661, 1.4639390707015991, 1.4639376401901245, 1.463936686515808, 1.4639369249343872, 1.463937520980835, 2.7652194499969482, 1.4639400243759155, 1.4639372825622559, 0.9499300718307495, 1.1156511306762695, 1.4639368057250977, 1.463937520980835, 0.9499317407608032, 1.4639374017715454, 1.4639371633529663, 1.4639374017715454, 2.1775906085968018, 2.1667840480804443, 1.4639371633529663, 1.4639371633529663, 3.2340807914733887, 0.9495277404785156, 1.520592451095581, 1.4639381170272827, 2.045987606048584, 1.4639370441436768, 1.5071722269058228, 1.4639489650726318, 1.4639368057250977, 1.4639376401901245, 1.4639371633529663], "mean_td_error": 1.533693552017212, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1150.0, "diff_num_grad_updates_vs_sampler_policy": 1149.0}}, "num_env_steps_sampled": 47000, "num_env_steps_trained": 89700, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 89700, "last_target_update_ts": 46800, "num_target_updates": 89}, "sampler_results": {"episode_reward_max": 2.2407982605333103, "episode_reward_min": -19.999661262899316, "episode_reward_mean": -1.6084147357238097, "episode_len_mean": 25.17, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00032914102050618266, 0.0003380031360871206, 0.0003352752187563305, 0.00033360705688882615, 0.03698775541206252, 0.00032996528984467527, 0.00034063978911792937, -9.999662126126257, 0.0811616915951425, -9.99966643585047, -9.999668162834583, 0.00033876206328534386, -9.999663977887423, 0.0003343463464404114, 0.12834668806715327, 0.0003305359070016544, 0.00034151666720289606, -19.999661262899316, -9.432466684043893, -9.99966471335553, 2.2407982605333103, 0.0003303574987250205, 0.000328498402649357, 0.0003270098568125728, 0.0003255728798379054, 0.0003237438209317038, 0.00032597817673282026, 0.00032451233234728516, 0.00032309717238481573, 0.0003212957465763309, 0.07777164756280094, 0.14847328330536183, 0.0003294006152690562, 0.00032790390035892397, -9.939740587826455, 0.0003247886626530358, 0.0003272955541473175, 0.0003258178648762872, 0.0003243913212174644, 0.0003225754765989388, 0.0003207297149511072, -9.999671889234149, 0.0003266255523574069, 0.00032519194327204414, 0.07762170012434594, 0.0003296751287488072, 0.00032782368425367746, 0.7597975357212201, 0.11823190396350558, 0.0003232655718497225, 0.34767654069138065, 0.00032721776727238065, -9.999674220863845, -9.999676052234136, 0.12307518467039924, 0.0003311950872839502, 0.0003296820582046465, 0.00032822155437329305, 0.223246526230623, 0.44818330772424136, 0.00032188470369792316, 0.0003202438144584811, 0.00031817727216138913, 0.00031686730445062126, 0.00031531699058727985, 0.0003179709842980935, 0.00031593357483044075, 0.0003146419837959328, 0.0003131133158197098, 0.0003116343153890326, 0.00032291756107528144, 0.00032126615077272786, 0.0003191864373248495, 0.0003178681620258697, 0.00031630806336697834, 0.4916021860941993, 0.00031707467071401745, 0.00031577374986221755, 0.0003142340920221655, 0.0003127445097063013, -9.999678362707384, 0.00031999292587832985, 0.47113040701638104, -9.999683348375651, -9.999684894711832, 0.00032141192736664606, 0.0003197758428383667, 0.1847065668697174, 0.0003164691255777113, 0.32773800276741805, 0.0003205091970019006, 0.0003184392396737255, 0.000317127117924244, -8.512880635318806, 0.0003140822276707463, 0.6191633531472689, 0.11259862896096587, 0.00031955489675769837, -9.999682021599076, 0.0003164530334709042], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 26, 25, 25, 25, 25, 27, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.252964920319, "mean_inference_ms": 2.1601475420688057, "mean_action_processing_ms": 0.14815141064055581, "mean_env_wait_ms": 1.9862253398172691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010140180587768555, "StateBufferConnector_ms": 0.006882190704345703, "ViewRequirementAgentConnector_ms": 0.18041539192199707}}, "episode_reward_max": 2.2407982605333103, "episode_reward_min": -19.999661262899316, "episode_reward_mean": -1.6084147357238097, "episode_len_mean": 25.17, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00032914102050618266, 0.0003380031360871206, 0.0003352752187563305, 0.00033360705688882615, 0.03698775541206252, 0.00032996528984467527, 0.00034063978911792937, -9.999662126126257, 0.0811616915951425, -9.99966643585047, -9.999668162834583, 0.00033876206328534386, -9.999663977887423, 0.0003343463464404114, 0.12834668806715327, 0.0003305359070016544, 0.00034151666720289606, -19.999661262899316, -9.432466684043893, -9.99966471335553, 2.2407982605333103, 0.0003303574987250205, 0.000328498402649357, 0.0003270098568125728, 0.0003255728798379054, 0.0003237438209317038, 0.00032597817673282026, 0.00032451233234728516, 0.00032309717238481573, 0.0003212957465763309, 0.07777164756280094, 0.14847328330536183, 0.0003294006152690562, 0.00032790390035892397, -9.939740587826455, 0.0003247886626530358, 0.0003272955541473175, 0.0003258178648762872, 0.0003243913212174644, 0.0003225754765989388, 0.0003207297149511072, -9.999671889234149, 0.0003266255523574069, 0.00032519194327204414, 0.07762170012434594, 0.0003296751287488072, 0.00032782368425367746, 0.7597975357212201, 0.11823190396350558, 0.0003232655718497225, 0.34767654069138065, 0.00032721776727238065, -9.999674220863845, -9.999676052234136, 0.12307518467039924, 0.0003311950872839502, 0.0003296820582046465, 0.00032822155437329305, 0.223246526230623, 0.44818330772424136, 0.00032188470369792316, 0.0003202438144584811, 0.00031817727216138913, 0.00031686730445062126, 0.00031531699058727985, 0.0003179709842980935, 0.00031593357483044075, 0.0003146419837959328, 0.0003131133158197098, 0.0003116343153890326, 0.00032291756107528144, 0.00032126615077272786, 0.0003191864373248495, 0.0003178681620258697, 0.00031630806336697834, 0.4916021860941993, 0.00031707467071401745, 0.00031577374986221755, 0.0003142340920221655, 0.0003127445097063013, -9.999678362707384, 0.00031999292587832985, 0.47113040701638104, -9.999683348375651, -9.999684894711832, 0.00032141192736664606, 0.0003197758428383667, 0.1847065668697174, 0.0003164691255777113, 0.32773800276741805, 0.0003205091970019006, 0.0003184392396737255, 0.000317127117924244, -8.512880635318806, 0.0003140822276707463, 0.6191633531472689, 0.11259862896096587, 0.00031955489675769837, -9.999682021599076, 0.0003164530334709042], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 26, 25, 25, 25, 25, 27, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.252964920319, "mean_inference_ms": 2.1601475420688057, "mean_action_processing_ms": 0.14815141064055581, "mean_env_wait_ms": 1.9862253398172691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010140180587768555, "StateBufferConnector_ms": 0.006882190704345703, "ViewRequirementAgentConnector_ms": 0.18041539192199707}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 89700, "num_env_steps_sampled": 47000, "num_env_steps_trained": 89700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5539916549766057, "num_env_steps_trained_throughput_per_sec": 6.930283727204381, "timesteps_total": 47000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 47000, "timers": {"training_iteration_time_ms": 11280.699, "sample_time_ms": 11218.377, "load_time_ms": 0.251, "load_throughput": 310453.323, "learn_time_ms": 12.868, "learn_throughput": 6061.683, "synch_weights_time_ms": 11.724}, "counters": {"num_env_steps_sampled": 47000, "num_env_steps_trained": 89700, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 89700, "last_target_update_ts": 46800, "num_target_updates": 89}, "done": false, "episodes_total": 1804, "training_iteration": 47, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-19-21", "timestamp": 1713417561, "time_this_iter_s": 281.38370728492737, "time_total_s": 11313.808515787125, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 11313.808515787125, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 10.894250000000001, "ram_util_percent": 20.418000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0025246497243642807, "cur_lr": 0.01}, "td_error": [1.460712194442749, 1.462925672531128, 1.460712194442749, 1.4607115983963013, 1.5452064275741577, 0.9538390040397644, 1.4607120752334595, 1.5144060850143433, 1.4606852531433105, 3.0651865005493164, 1.5031330585479736, 0.8620336055755615, 1.460712194442749, 2.767887830734253, 1.4607038497924805, 1.4607075452804565, 0.9538422226905823, 1.460712194442749, 1.5144275426864624, 1.4973134994506836, 1.5142335891723633, 1.4607120752334595, 1.460712194442749, 1.4607120752334595, 0.9538394212722778, 1.460712194442749, 1.6561574935913086, 1.4607124328613281, 2.2209813594818115, 1.4607115983963013, 1.460712194442749, 2.049933433532715, 2.21819806098938, 1.4607115983963013, 1.5031328201293945, 1.4607117176055908, 1.460712194442749, 1.5031330585479736, 1.4607120752334595, 1.4607113599777222, 1.460712194442749, 1.460712194442749, 1.5031331777572632, 2.2469828128814697, 1.46071195602417, 1.4607120752334595, 1.4607117176055908, 1.4607118368148804, 1.460712194442749, 1.460708737373352, 1.5031335353851318, 1.4935969114303589, 1.4607120752334595, 1.4607113599777222, 1.4607118368148804, 2.7812089920043945, 2.7822248935699463, 1.46071195602417, 1.5031429529190063, 1.460712194442749, 1.514337420463562, 1.991607427597046, 1.4607123136520386, 1.098827600479126, 1.460712194442749, 1.4607110023498535, 1.460712194442749, 0.9538383483886719, 1.1025447845458984, 1.4607120752334595, 1.5031330585479736, 1.4606704711914062, 1.460712194442749, 1.460712194442749, 1.4607115983963013, 1.4607117176055908, 0.8620466589927673, 1.4605340957641602], "mean_td_error": 1.5362993478775024, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1175.0, "diff_num_grad_updates_vs_sampler_policy": 1174.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 91650, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 91650, "last_target_update_ts": 47840, "num_target_updates": 91}, "sampler_results": {"episode_reward_max": 0.8550343385217691, "episode_reward_min": -9.999692085217928, "episode_reward_mean": -1.2749508718343534, "episode_len_mean": 25.02, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0003207297149511072, -9.999671889234149, 0.0003266255523574069, 0.00032519194327204414, 0.07762170012434594, 0.0003296751287488072, 0.00032782368425367746, 0.7597975357212201, 0.11823190396350558, 0.0003232655718497225, 0.34767654069138065, 0.00032721776727238065, -9.999674220863845, -9.999676052234136, 0.12307518467039924, 0.0003311950872839502, 0.0003296820582046465, 0.00032822155437329305, 0.223246526230623, 0.44818330772424136, 0.00032188470369792316, 0.0003202438144584811, 0.00031817727216138913, 0.00031686730445062126, 0.00031531699058727985, 0.0003179709842980935, 0.00031593357483044075, 0.0003146419837959328, 0.0003131133158197098, 0.0003116343153890326, 0.00032291756107528144, 0.00032126615077272786, 0.0003191864373248495, 0.0003178681620258697, 0.00031630806336697834, 0.4916021860941993, 0.00031707467071401745, 0.00031577374986221755, 0.0003142340920221655, 0.0003127445097063013, -9.999678362707384, 0.00031999292587832985, 0.47113040701638104, -9.999683348375651, -9.999684894711832, 0.00032141192736664606, 0.0003197758428383667, 0.1847065668697174, 0.0003164691255777113, 0.32773800276741805, 0.0003205091970019006, 0.0003184392396737255, 0.000317127117924244, -8.512880635318806, 0.0003140822276707463, 0.6191633531472689, 0.11259862896096587, 0.00031955489675769837, -9.999682021599076, 0.0003164530334709042, 0.6191546540335876, 0.0003120203777269906, 0.00029779143519199176, 0.00030860742029278633, 0.0003069603569499706, 0.0003098445218580435, 0.37858284711942874, 0.000306499846590338, 0.0003048751436499144, 0.06022497103737331, -6.9054307699708435, 0.0003129766087855263, 0.0002986987152777695, 0.411254529222348, -9.999692085217928, -9.999689060685668, 0.0002967682036976954, -9.809632314722597, 0.8550343385217691, 0.00029221659155765614, 0.00031360544141270804, 0.00031179300479128254, 0.0002975756970551407, 0.00030838499285116357, 0.0003067402965372243, 0.00031345412102906374, -9.999688356417678, 0.0002974337729017766, 0.19036833768004818, 0.000306645941625911, 0.04807133170594237, 0.19414077303315616, 0.00030911790735817213, 0.00030746540511149804, 0.00029356454621174945, 0.00031460763567332605, 0.0003002461723910307, 0.0003111381540864643, -9.54662334405909, 0.19458091278431433], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 24, 26, 25, 24, 25, 26, 26, 24, 26, 25, 24, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 24, 25, 24, 25, 26, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.5675228185099, "mean_inference_ms": 2.1584021355169716, "mean_action_processing_ms": 0.1480292831461729, "mean_env_wait_ms": 1.9462036206267834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009979724884033203, "StateBufferConnector_ms": 0.006632328033447266, "ViewRequirementAgentConnector_ms": 0.177001953125}}, "episode_reward_max": 0.8550343385217691, "episode_reward_min": -9.999692085217928, "episode_reward_mean": -1.2749508718343534, "episode_len_mean": 25.02, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0003207297149511072, -9.999671889234149, 0.0003266255523574069, 0.00032519194327204414, 0.07762170012434594, 0.0003296751287488072, 0.00032782368425367746, 0.7597975357212201, 0.11823190396350558, 0.0003232655718497225, 0.34767654069138065, 0.00032721776727238065, -9.999674220863845, -9.999676052234136, 0.12307518467039924, 0.0003311950872839502, 0.0003296820582046465, 0.00032822155437329305, 0.223246526230623, 0.44818330772424136, 0.00032188470369792316, 0.0003202438144584811, 0.00031817727216138913, 0.00031686730445062126, 0.00031531699058727985, 0.0003179709842980935, 0.00031593357483044075, 0.0003146419837959328, 0.0003131133158197098, 0.0003116343153890326, 0.00032291756107528144, 0.00032126615077272786, 0.0003191864373248495, 0.0003178681620258697, 0.00031630806336697834, 0.4916021860941993, 0.00031707467071401745, 0.00031577374986221755, 0.0003142340920221655, 0.0003127445097063013, -9.999678362707384, 0.00031999292587832985, 0.47113040701638104, -9.999683348375651, -9.999684894711832, 0.00032141192736664606, 0.0003197758428383667, 0.1847065668697174, 0.0003164691255777113, 0.32773800276741805, 0.0003205091970019006, 0.0003184392396737255, 0.000317127117924244, -8.512880635318806, 0.0003140822276707463, 0.6191633531472689, 0.11259862896096587, 0.00031955489675769837, -9.999682021599076, 0.0003164530334709042, 0.6191546540335876, 0.0003120203777269906, 0.00029779143519199176, 0.00030860742029278633, 0.0003069603569499706, 0.0003098445218580435, 0.37858284711942874, 0.000306499846590338, 0.0003048751436499144, 0.06022497103737331, -6.9054307699708435, 0.0003129766087855263, 0.0002986987152777695, 0.411254529222348, -9.999692085217928, -9.999689060685668, 0.0002967682036976954, -9.809632314722597, 0.8550343385217691, 0.00029221659155765614, 0.00031360544141270804, 0.00031179300479128254, 0.0002975756970551407, 0.00030838499285116357, 0.0003067402965372243, 0.00031345412102906374, -9.999688356417678, 0.0002974337729017766, 0.19036833768004818, 0.000306645941625911, 0.04807133170594237, 0.19414077303315616, 0.00030911790735817213, 0.00030746540511149804, 0.00029356454621174945, 0.00031460763567332605, 0.0003002461723910307, 0.0003111381540864643, -9.54662334405909, 0.19458091278431433], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 24, 26, 25, 24, 25, 26, 26, 24, 26, 25, 24, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 24, 25, 24, 25, 26, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.5675228185099, "mean_inference_ms": 2.1584021355169716, "mean_action_processing_ms": 0.1480292831461729, "mean_env_wait_ms": 1.9462036206267834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009979724884033203, "StateBufferConnector_ms": 0.006632328033447266, "ViewRequirementAgentConnector_ms": 0.177001953125}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 91650, "num_env_steps_sampled": 48000, "num_env_steps_trained": 91650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.584722608663511, "num_env_steps_trained_throughput_per_sec": 6.990209086893846, "timesteps_total": 48000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11137.088, "sample_time_ms": 11076.469, "load_time_ms": 0.226, "load_throughput": 344592.071, "learn_time_ms": 12.436, "learn_throughput": 6272.193, "synch_weights_time_ms": 11.313}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 91650, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 91650, "last_target_update_ts": 47840, "num_target_updates": 91}, "done": false, "episodes_total": 1844, "training_iteration": 48, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-24-00", "timestamp": 1713417840, "time_this_iter_s": 278.971568107605, "time_total_s": 11592.78008389473, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 11592.78008389473, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 10.981108312342569, "ram_util_percent": 20.57808564231738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0018904188182204962, "cur_lr": 0.01}, "td_error": [1.4583736658096313, 1.4583740234375, 1.5165883302688599, 3.3412747383117676, 1.505000352859497, 1.4583740234375, 1.5050150156021118, 1.458373785018921, 1.4583779573440552, 1.458373785018921, 1.4583736658096313, 1.4583741426467896, 1.5166133642196655, 1.5166542530059814, 1.4583739042282104, 1.4583765268325806, 1.4583745002746582, 1.505009412765503, 1.4583754539489746, 0.9562355279922485, 1.5050212144851685, 1.4583743810653687, 1.4583736658096313, 1.4583741426467896, 1.4583740234375, 1.516690969467163, 1.5050350427627563, 1.4583739042282104, 1.4583736658096313, 0.9357110857963562, 1.4584511518478394, 1.458373785018921, 1.4583739042282104, 1.458373785018921, 1.073368787765503, 1.516687035560608, 1.4583740234375, 1.458373785018921, 1.4583752155303955, 1.516653060913086, 1.0396227836608887, 1.458373785018921, 1.4583740234375, 1.4583739042282104, 1.4586760997772217, 1.4583741426467896, 1.5174579620361328, 1.45844304561615, 1.4583741426467896, 1.458373785018921, 1.458374261856079, 0.8621568083763123, 1.4583740234375, 1.4583752155303955, 1.5050030946731567, 1.4583741426467896, 0.9562389850616455, 1.5167218446731567, 1.458375334739685, 1.4583743810653687, 1.458374261856079, 2.0511701107025146, 1.4583740234375, 1.5164422988891602, 1.4583739042282104, 1.4583741426467896, 1.458373785018921, 0.9562386274337769, 1.4583740234375, 1.458374261856079, 1.458374261856079, 1.458423376083374, 1.458376407623291, 1.4583741426467896, 1.5050052404403687, 1.4583741426467896, 0.9562398791313171, 2.1940174102783203], "mean_td_error": 1.4600701332092285, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1200.0, "diff_num_grad_updates_vs_sampler_policy": 1199.0}}, "num_env_steps_sampled": 49000, "num_env_steps_trained": 93600, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 93600, "last_target_update_ts": 48880, "num_target_updates": 93}, "sampler_results": {"episode_reward_max": 1.412762520306049, "episode_reward_min": -9.999711362761843, "episode_reward_mean": -1.8669013689786365, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999678362707384, 0.00031999292587832985, 0.47113040701638104, -9.999683348375651, -9.999684894711832, 0.00032141192736664606, 0.0003197758428383667, 0.1847065668697174, 0.0003164691255777113, 0.32773800276741805, 0.0003205091970019006, 0.0003184392396737255, 0.000317127117924244, -8.512880635318806, 0.0003140822276707463, 0.6191633531472689, 0.11259862896096587, 0.00031955489675769837, -9.999682021599076, 0.0003164530334709042, 0.6191546540335876, 0.0003120203777269906, 0.00029779143519199176, 0.00030860742029278633, 0.0003069603569499706, 0.0003098445218580435, 0.37858284711942874, 0.000306499846590338, 0.0003048751436499144, 0.06022497103737331, -6.9054307699708435, 0.0003129766087855263, 0.0002986987152777695, 0.411254529222348, -9.999692085217928, -9.999689060685668, 0.0002967682036976954, -9.809632314722597, 0.8550343385217691, 0.00029221659155765614, 0.00031360544141270804, 0.00031179300479128254, 0.0002975756970551407, 0.00030838499285116357, 0.0003067402965372243, 0.00031345412102906374, -9.999688356417678, 0.0002974337729017766, 0.19036833768004818, 0.000306645941625911, 0.04807133170594237, 0.19414077303315616, 0.00030911790735817213, 0.00030746540511149804, 0.00029356454621174945, 0.00031460763567332605, 0.0003002461723910307, 0.0003111381540864643, -9.54662334405909, 0.19458091278431433, 0.058437395781268386, 0.00027971506078692897, 0.10571271788122344, 0.0003007363654348261, 0.08180379551804266, 0.1712947059940525, -9.999711362761843, 0.0002987397538112824, 0.00029732932834920437, 0.08884033686038521, -9.999706004323462, -9.96130478438562, -9.999708559487791, 0.00030162436433364757, 0.323655002132149, 0.0002787909240417798, -9.999710462177726, -9.909533601993164, 0.0002984675339637299, 0.00029678671517402157, -9.99970712639618, 0.00027941719368812637, 0.00029018500882838685, 0.00030033154065543045, 1.412762520306049, 0.1364799248094118, 0.00027939827600820786, 0.00029016545512554294, 0.0003003114334300976, -9.82852880292587, 0.0002800711805633048, 0.6264994357686529, 0.09063094416310186, 0.0002997223335877697, 0.00029802739209438883, 0.0002820838424589411, 0.0002929411864512317, -9.999696834287436, 0.000301713141428457, 0.00029999567295221186], "episode_lengths": [26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 24, 26, 25, 24, 25, 26, 26, 24, 26, 25, 24, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 24, 25, 24, 25, 26, 24, 24, 23, 24, 25, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 26, 25, 25, 25, 23, 24, 25, 25, 24, 23, 24, 25, 26, 23, 24, 25, 25, 25, 23, 24, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.9437616952157, "mean_inference_ms": 2.1562506465843962, "mean_action_processing_ms": 0.14785020074166316, "mean_env_wait_ms": 1.9084702403482305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009844064712524414, "StateBufferConnector_ms": 0.006681203842163086, "ViewRequirementAgentConnector_ms": 0.17594170570373535}}, "episode_reward_max": 1.412762520306049, "episode_reward_min": -9.999711362761843, "episode_reward_mean": -1.8669013689786365, "episode_len_mean": 24.8, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999678362707384, 0.00031999292587832985, 0.47113040701638104, -9.999683348375651, -9.999684894711832, 0.00032141192736664606, 0.0003197758428383667, 0.1847065668697174, 0.0003164691255777113, 0.32773800276741805, 0.0003205091970019006, 0.0003184392396737255, 0.000317127117924244, -8.512880635318806, 0.0003140822276707463, 0.6191633531472689, 0.11259862896096587, 0.00031955489675769837, -9.999682021599076, 0.0003164530334709042, 0.6191546540335876, 0.0003120203777269906, 0.00029779143519199176, 0.00030860742029278633, 0.0003069603569499706, 0.0003098445218580435, 0.37858284711942874, 0.000306499846590338, 0.0003048751436499144, 0.06022497103737331, -6.9054307699708435, 0.0003129766087855263, 0.0002986987152777695, 0.411254529222348, -9.999692085217928, -9.999689060685668, 0.0002967682036976954, -9.809632314722597, 0.8550343385217691, 0.00029221659155765614, 0.00031360544141270804, 0.00031179300479128254, 0.0002975756970551407, 0.00030838499285116357, 0.0003067402965372243, 0.00031345412102906374, -9.999688356417678, 0.0002974337729017766, 0.19036833768004818, 0.000306645941625911, 0.04807133170594237, 0.19414077303315616, 0.00030911790735817213, 0.00030746540511149804, 0.00029356454621174945, 0.00031460763567332605, 0.0003002461723910307, 0.0003111381540864643, -9.54662334405909, 0.19458091278431433, 0.058437395781268386, 0.00027971506078692897, 0.10571271788122344, 0.0003007363654348261, 0.08180379551804266, 0.1712947059940525, -9.999711362761843, 0.0002987397538112824, 0.00029732932834920437, 0.08884033686038521, -9.999706004323462, -9.96130478438562, -9.999708559487791, 0.00030162436433364757, 0.323655002132149, 0.0002787909240417798, -9.999710462177726, -9.909533601993164, 0.0002984675339637299, 0.00029678671517402157, -9.99970712639618, 0.00027941719368812637, 0.00029018500882838685, 0.00030033154065543045, 1.412762520306049, 0.1364799248094118, 0.00027939827600820786, 0.00029016545512554294, 0.0003003114334300976, -9.82852880292587, 0.0002800711805633048, 0.6264994357686529, 0.09063094416310186, 0.0002997223335877697, 0.00029802739209438883, 0.0002820838424589411, 0.0002929411864512317, -9.999696834287436, 0.000301713141428457, 0.00029999567295221186], "episode_lengths": [26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 24, 26, 25, 24, 25, 26, 26, 24, 26, 25, 24, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 24, 25, 24, 25, 26, 24, 24, 23, 24, 25, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 26, 25, 25, 25, 23, 24, 25, 25, 24, 23, 24, 25, 26, 23, 24, 25, 25, 25, 23, 24, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.9437616952157, "mean_inference_ms": 2.1562506465843962, "mean_action_processing_ms": 0.14785020074166316, "mean_env_wait_ms": 1.9084702403482305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009844064712524414, "StateBufferConnector_ms": 0.006681203842163086, "ViewRequirementAgentConnector_ms": 0.17594170570373535}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 93600, "num_env_steps_sampled": 49000, "num_env_steps_trained": 93600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.8995127491739017, "num_env_steps_trained_throughput_per_sec": 7.604049860889108, "timesteps_total": 49000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 49000, "timers": {"training_iteration_time_ms": 10008.444, "sample_time_ms": 9946.078, "load_time_ms": 0.243, "load_throughput": 320395.37, "learn_time_ms": 13.249, "learn_throughput": 5887.357, "synch_weights_time_ms": 11.259}, "counters": {"num_env_steps_sampled": 49000, "num_env_steps_trained": 93600, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 93600, "last_target_update_ts": 48880, "num_target_updates": 93}, "done": false, "episodes_total": 1884, "training_iteration": 49, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-28-17", "timestamp": 1713418097, "time_this_iter_s": 256.451402425766, "time_total_s": 11849.231486320496, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 11849.231486320496, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 11.699178082191782, "ram_util_percent": 20.707123287671234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.001589633640833199, "cur_lr": 0.01}, "td_error": [1.5952225923538208, 3.0798351764678955, 1.508744239807129, 1.5086537599563599, 1.4464424848556519, 1.4464426040649414, 1.50116765499115, 2.8400609493255615, 0.869355320930481, 1.4464504718780518, 1.4464430809020996, 1.500624179840088, 1.4464432001113892, 1.4464434385299683, 1.4651687145233154, 1.4464421272277832, 1.4464430809020996, 1.4464421272277832, 1.4464454650878906, 1.4464514255523682, 0.9303714036941528, 0.8491374850273132, 1.4464597702026367, 0.8608031868934631, 1.4464421272277832, 1.4464428424835205, 1.5053688287734985, 1.4464424848556519, 1.4464459419250488, 0.8491374850273132, 1.4464421272277832, 3.851492404937744, 0.9358376264572144, 1.4465246200561523, 1.4464421272277832, 1.4464423656463623, 1.4464446306228638, 1.1074179410934448, 1.44644296169281, 1.4464428424835205, 1.4464432001113892, 1.501220464706421, 1.4464423656463623, 1.500550389289856, 1.446442723274231, 1.4464422464370728, 2.840273380279541, 1.5008597373962402, 1.446445107460022, 0.9359298944473267, 1.4464448690414429, 1.446442723274231, 1.508732795715332, 1.4464421272277832, 1.4464432001113892, 1.4464517831802368, 3.10579776763916, 1.44644296169281, 1.4464426040649414, 1.4464421272277832, 1.4464436769485474, 1.3509166240692139, 2.139915943145752, 1.4464430809020996, 3.0818238258361816, 0.8798436522483826, 1.5005526542663574, 1.4464421272277832, 2.840176582336426, 1.446442723274231, 1.4464424848556519, 1.4464430809020996, 1.4464421272277832, 1.4464433193206787, 1.44644296169281, 1.44644296169281, 2.1469807624816895, 0.9359294772148132], "mean_td_error": 1.5521076917648315, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1225.0, "diff_num_grad_updates_vs_sampler_policy": 1224.0}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 95550, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 95550, "last_target_update_ts": 49920, "num_target_updates": 95}, "sampler_results": {"episode_reward_max": 1.412762520306049, "episode_reward_min": -19.93242489155409, "episode_reward_mean": -1.6216932220287026, "episode_len_mean": 24.83, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00031360544141270804, 0.00031179300479128254, 0.0002975756970551407, 0.00030838499285116357, 0.0003067402965372243, 0.00031345412102906374, -9.999688356417678, 0.0002974337729017766, 0.19036833768004818, 0.000306645941625911, 0.04807133170594237, 0.19414077303315616, 0.00030911790735817213, 0.00030746540511149804, 0.00029356454621174945, 0.00031460763567332605, 0.0003002461723910307, 0.0003111381540864643, -9.54662334405909, 0.19458091278431433, 0.058437395781268386, 0.00027971506078692897, 0.10571271788122344, 0.0003007363654348261, 0.08180379551804266, 0.1712947059940525, -9.999711362761843, 0.0002987397538112824, 0.00029732932834920437, 0.08884033686038521, -9.999706004323462, -9.96130478438562, -9.999708559487791, 0.00030162436433364757, 0.323655002132149, 0.0002787909240417798, -9.999710462177726, -9.909533601993164, 0.0002984675339637299, 0.00029678671517402157, -9.99970712639618, 0.00027941719368812637, 0.00029018500882838685, 0.00030033154065543045, 1.412762520306049, 0.1364799248094118, 0.00027939827600820786, 0.00029016545512554294, 0.0003003114334300976, -9.82852880292587, 0.0002800711805633048, 0.6264994357686529, 0.09063094416310186, 0.0002997223335877697, 0.00029802739209438883, 0.0002820838424589411, 0.0002929411864512317, -9.999696834287436, 0.000301713141428457, 0.00029999567295221186, 0.00029771397341465505, 0.4192613287611114, 0.00029449085626177894, 0.0002929355516580292, 0.00029174185625612605, 0.00029440053603857567, 0.00029254110629239037, 0.0002910062791388955, -19.93242489155409, 0.0002882224879917902, 0.0002985981853133311, 0.242303024721818, 0.00029537011857490503, 0.0002938055352465015, 0.00029260475346278453, 0.000295436461339071, 0.00029356396589671563, 0.00029201841289475377, 0.00029083216535704163, 0.00028909636453052927, -18.501066807591414, 0.0002958819985448616, 0.0002940038697514638, 0.00029245369242662203, 0.0002912639129823106, 0.0002973998316348692, -9.99970395585361, 0.00029416382679785697, 0.00029261196628077026, 0.00029142090128846023, 0.0002966658517554611, 0.00029477779155728676, -9.999706780400166, 0.16088815919918156, 0.0002903318736895849, 0.000298616131130512, 0.00029670324804430986, 0.00029512454401536744, 0.941932548345983, 0.00029215145720466686], "episode_lengths": [25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 24, 25, 24, 25, 26, 24, 24, 23, 24, 25, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 26, 25, 25, 25, 23, 24, 25, 25, 24, 23, 24, 25, 26, 23, 24, 25, 25, 25, 23, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.29271043387155, "mean_inference_ms": 2.1539400911996602, "mean_action_processing_ms": 0.14767863837716264, "mean_env_wait_ms": 1.8720030345717378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009724855422973633, "StateBufferConnector_ms": 0.00648045539855957, "ViewRequirementAgentConnector_ms": 0.17394089698791504}}, "episode_reward_max": 1.412762520306049, "episode_reward_min": -19.93242489155409, "episode_reward_mean": -1.6216932220287026, "episode_len_mean": 24.83, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00031360544141270804, 0.00031179300479128254, 0.0002975756970551407, 0.00030838499285116357, 0.0003067402965372243, 0.00031345412102906374, -9.999688356417678, 0.0002974337729017766, 0.19036833768004818, 0.000306645941625911, 0.04807133170594237, 0.19414077303315616, 0.00030911790735817213, 0.00030746540511149804, 0.00029356454621174945, 0.00031460763567332605, 0.0003002461723910307, 0.0003111381540864643, -9.54662334405909, 0.19458091278431433, 0.058437395781268386, 0.00027971506078692897, 0.10571271788122344, 0.0003007363654348261, 0.08180379551804266, 0.1712947059940525, -9.999711362761843, 0.0002987397538112824, 0.00029732932834920437, 0.08884033686038521, -9.999706004323462, -9.96130478438562, -9.999708559487791, 0.00030162436433364757, 0.323655002132149, 0.0002787909240417798, -9.999710462177726, -9.909533601993164, 0.0002984675339637299, 0.00029678671517402157, -9.99970712639618, 0.00027941719368812637, 0.00029018500882838685, 0.00030033154065543045, 1.412762520306049, 0.1364799248094118, 0.00027939827600820786, 0.00029016545512554294, 0.0003003114334300976, -9.82852880292587, 0.0002800711805633048, 0.6264994357686529, 0.09063094416310186, 0.0002997223335877697, 0.00029802739209438883, 0.0002820838424589411, 0.0002929411864512317, -9.999696834287436, 0.000301713141428457, 0.00029999567295221186, 0.00029771397341465505, 0.4192613287611114, 0.00029449085626177894, 0.0002929355516580292, 0.00029174185625612605, 0.00029440053603857567, 0.00029254110629239037, 0.0002910062791388955, -19.93242489155409, 0.0002882224879917902, 0.0002985981853133311, 0.242303024721818, 0.00029537011857490503, 0.0002938055352465015, 0.00029260475346278453, 0.000295436461339071, 0.00029356396589671563, 0.00029201841289475377, 0.00029083216535704163, 0.00028909636453052927, -18.501066807591414, 0.0002958819985448616, 0.0002940038697514638, 0.00029245369242662203, 0.0002912639129823106, 0.0002973998316348692, -9.99970395585361, 0.00029416382679785697, 0.00029261196628077026, 0.00029142090128846023, 0.0002966658517554611, 0.00029477779155728676, -9.999706780400166, 0.16088815919918156, 0.0002903318736895849, 0.000298616131130512, 0.00029670324804430986, 0.00029512454401536744, 0.941932548345983, 0.00029215145720466686], "episode_lengths": [25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 24, 25, 24, 25, 26, 24, 24, 23, 24, 25, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 23, 25, 26, 25, 25, 25, 23, 24, 25, 25, 24, 23, 24, 25, 26, 23, 24, 25, 25, 25, 23, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.29271043387155, "mean_inference_ms": 2.1539400911996602, "mean_action_processing_ms": 0.14767863837716264, "mean_env_wait_ms": 1.8720030345717378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009724855422973633, "StateBufferConnector_ms": 0.00648045539855957, "ViewRequirementAgentConnector_ms": 0.17394089698791504}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 95550, "num_env_steps_sampled": 50000, "num_env_steps_trained": 95550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.051672800342627, "num_env_steps_trained_throughput_per_sec": 7.900761960668122, "timesteps_total": 50000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 11106.83, "sample_time_ms": 11044.311, "load_time_ms": 0.234, "load_throughput": 333356.136, "learn_time_ms": 12.995, "learn_throughput": 6002.361, "synch_weights_time_ms": 11.416}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 95550, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 95550, "last_target_update_ts": 49920, "num_target_updates": 95}, "done": false, "episodes_total": 1924, "training_iteration": 50, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-32-24", "timestamp": 1713418344, "time_this_iter_s": 246.8205440044403, "time_total_s": 12096.052030324936, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 12096.052030324936, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 12.256410256410257, "ram_util_percent": 20.881766381766386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0019034766592085361, "cur_lr": 0.01}, "td_error": [1.4558652639389038, 1.4558665752410889, 1.455866813659668, 1.4557576179504395, 1.4558637142181396, 1.5246719121932983, 1.4558664560317993, 1.4558665752410889, 1.4558662176132202, 0.9507707953453064, 1.4558666944503784, 1.4558671712875366, 1.4558647871017456, 0.9507696628570557, 2.1852848529815674, 2.7961931228637695, 1.4558669328689575, 1.5273445844650269, 3.651031732559204, 2.7962076663970947, 1.4558665752410889, 1.502264380455017, 1.4558664560317993, 1.528135061264038, 1.4558664560317993, 1.455864667892456, 1.4558582305908203, 1.4558669328689575, 1.502262830734253, 1.8210880756378174, 1.4558669328689575, 1.4557543992996216, 1.502264380455017, 1.455866813659668, 0.9507710337638855, 1.4558669328689575, 1.4558663368225098, 1.4558632373809814, 1.4554784297943115, 1.4558659791946411, 1.4558665752410889, 1.4556608200073242, 1.50247323513031, 1.4558660984039307, 1.0769538879394531, 2.025416374206543, 1.4558664560317993, 1.455866813659668, 2.79111909866333, 0.9507664442062378, 1.4558664560317993, 1.4558666944503784, 1.4558669328689575, 0.9038248062133789, 0.9507710933685303, 1.4558658599853516, 1.4932326078414917, 1.4558665752410889, 1.4558666944503784, 1.502258062362671, 0.9507687091827393, 1.4558669328689575, 1.4558671712875366, 1.4558669328689575, 2.206897497177124, 0.9507592916488647, 1.5022637844085693, 1.5023431777954102, 0.9507710933685303, 2.0836989879608154, 1.4558666944503784, 0.950766921043396, 1.4558669328689575, 1.4558470249176025, 0.9507685899734497, 1.4558664560317993, 1.455867052078247, 2.796205520629883], "mean_td_error": 1.5223623514175415, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1250.0, "diff_num_grad_updates_vs_sampler_policy": 1249.0}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 97500, "last_target_update_ts": 50960, "num_target_updates": 97}, "sampler_results": {"episode_reward_max": 1.412762520306049, "episode_reward_min": -19.999710321643835, "episode_reward_mean": -2.6005299222247076, "episode_len_mean": 24.97, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.99970712639618, 0.00027941719368812637, 0.00029018500882838685, 0.00030033154065543045, 1.412762520306049, 0.1364799248094118, 0.00027939827600820786, 0.00029016545512554294, 0.0003003114334300976, -9.82852880292587, 0.0002800711805633048, 0.6264994357686529, 0.09063094416310186, 0.0002997223335877697, 0.00029802739209438883, 0.0002820838424589411, 0.0002929411864512317, -9.999696834287436, 0.000301713141428457, 0.00029999567295221186, 0.00029771397341465505, 0.4192613287611114, 0.00029449085626177894, 0.0002929355516580292, 0.00029174185625612605, 0.00029440053603857567, 0.00029254110629239037, 0.0002910062791388955, -19.93242489155409, 0.0002882224879917902, 0.0002985981853133311, 0.242303024721818, 0.00029537011857490503, 0.0002938055352465015, 0.00029260475346278453, 0.000295436461339071, 0.00029356396589671563, 0.00029201841289475377, 0.00029083216535704163, 0.00028909636453052927, -18.501066807591414, 0.0002958819985448616, 0.0002940038697514638, 0.00029245369242662203, 0.0002912639129823106, 0.0002973998316348692, -9.99970395585361, 0.00029416382679785697, 0.00029261196628077026, 0.00029142090128846023, 0.0002966658517554611, 0.00029477779155728676, -9.999706780400166, 0.16088815919918156, 0.0002903318736895849, 0.000298616131130512, 0.00029670324804430986, 0.00029512454401536744, 0.941932548345983, 0.00029215145720466686, -19.999710005190426, -9.645497170630101, -9.999735826851367, -9.999714510457727, -9.999715984605604, 0.000286763127289983, 1.4127267142288575, 0.0002837572829162233, 0.07699978812567458, 1.0671643624256946, -9.999709152069483, 0.0002893617968769903, 0.000264922306871276, -9.999713708047468, 0.0002848088391727928, 1.067170673850224, -9.99973664929326, -9.902799259848607, 0.0002832421050547766, 0.00028189807514099796, -9.999710477565563, 0.00028805044439138484, 0.00026372750632166255, 0.00028500808245835493, 0.0002835383390785099, -19.999710321643835, 0.0002882039870668548, 0.0002638674049644926, 0.07883194195172427, -9.999716214591315, 0.00028885112862960536, 0.0002644570326437966, 0.00028579192076782736, -9.99971568576977, 0.00028295990184460025, -9.999709347723957, -9.999733902128455, -9.999712442933726, 0.00028605880890941043, 0.0002846879767607005], "episode_lengths": [25, 23, 24, 25, 25, 24, 23, 24, 25, 26, 23, 24, 25, 25, 25, 23, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 26, 26, 25, 23, 25, 25, 25, 26, 25, 23, 26, 25, 25, 24, 26, 25, 25, 26, 25, 23, 25, 25, 27, 25, 23, 25, 26, 25, 23, 25, 26, 25, 26, 24, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.62976573671347, "mean_inference_ms": 2.151331869968353, "mean_action_processing_ms": 0.14750228756526634, "mean_env_wait_ms": 1.836996421092204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010261297225952148, "StateBufferConnector_ms": 0.006528139114379883, "ViewRequirementAgentConnector_ms": 0.17408037185668945}}, "episode_reward_max": 1.412762520306049, "episode_reward_min": -19.999710321643835, "episode_reward_mean": -2.6005299222247076, "episode_len_mean": 24.97, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.99970712639618, 0.00027941719368812637, 0.00029018500882838685, 0.00030033154065543045, 1.412762520306049, 0.1364799248094118, 0.00027939827600820786, 0.00029016545512554294, 0.0003003114334300976, -9.82852880292587, 0.0002800711805633048, 0.6264994357686529, 0.09063094416310186, 0.0002997223335877697, 0.00029802739209438883, 0.0002820838424589411, 0.0002929411864512317, -9.999696834287436, 0.000301713141428457, 0.00029999567295221186, 0.00029771397341465505, 0.4192613287611114, 0.00029449085626177894, 0.0002929355516580292, 0.00029174185625612605, 0.00029440053603857567, 0.00029254110629239037, 0.0002910062791388955, -19.93242489155409, 0.0002882224879917902, 0.0002985981853133311, 0.242303024721818, 0.00029537011857490503, 0.0002938055352465015, 0.00029260475346278453, 0.000295436461339071, 0.00029356396589671563, 0.00029201841289475377, 0.00029083216535704163, 0.00028909636453052927, -18.501066807591414, 0.0002958819985448616, 0.0002940038697514638, 0.00029245369242662203, 0.0002912639129823106, 0.0002973998316348692, -9.99970395585361, 0.00029416382679785697, 0.00029261196628077026, 0.00029142090128846023, 0.0002966658517554611, 0.00029477779155728676, -9.999706780400166, 0.16088815919918156, 0.0002903318736895849, 0.000298616131130512, 0.00029670324804430986, 0.00029512454401536744, 0.941932548345983, 0.00029215145720466686, -19.999710005190426, -9.645497170630101, -9.999735826851367, -9.999714510457727, -9.999715984605604, 0.000286763127289983, 1.4127267142288575, 0.0002837572829162233, 0.07699978812567458, 1.0671643624256946, -9.999709152069483, 0.0002893617968769903, 0.000264922306871276, -9.999713708047468, 0.0002848088391727928, 1.067170673850224, -9.99973664929326, -9.902799259848607, 0.0002832421050547766, 0.00028189807514099796, -9.999710477565563, 0.00028805044439138484, 0.00026372750632166255, 0.00028500808245835493, 0.0002835383390785099, -19.999710321643835, 0.0002882039870668548, 0.0002638674049644926, 0.07883194195172427, -9.999716214591315, 0.00028885112862960536, 0.0002644570326437966, 0.00028579192076782736, -9.99971568576977, 0.00028295990184460025, -9.999709347723957, -9.999733902128455, -9.999712442933726, 0.00028605880890941043, 0.0002846879767607005], "episode_lengths": [25, 23, 24, 25, 25, 24, 23, 24, 25, 26, 23, 24, 25, 25, 25, 23, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 26, 26, 25, 23, 25, 25, 25, 26, 25, 23, 26, 25, 25, 24, 26, 25, 25, 26, 25, 23, 25, 25, 27, 25, 23, 25, 26, 25, 23, 25, 26, 25, 26, 24, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.62976573671347, "mean_inference_ms": 2.151331869968353, "mean_action_processing_ms": 0.14750228756526634, "mean_env_wait_ms": 1.836996421092204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010261297225952148, "StateBufferConnector_ms": 0.006528139114379883, "ViewRequirementAgentConnector_ms": 0.17408037185668945}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 97500, "num_env_steps_sampled": 51000, "num_env_steps_trained": 97500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.25828769378447, "num_env_steps_trained_throughput_per_sec": 8.303661002879716, "timesteps_total": 51000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 9001.276, "sample_time_ms": 8935.623, "load_time_ms": 0.252, "load_throughput": 309367.104, "learn_time_ms": 13.748, "learn_throughput": 5673.699, "synch_weights_time_ms": 12.701}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 97500, "last_target_update_ts": 50960, "num_target_updates": 97}, "done": false, "episodes_total": 1964, "training_iteration": 51, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-36-18", "timestamp": 1713418578, "time_this_iter_s": 234.84482049942017, "time_total_s": 12330.896850824356, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 12330.896850824356, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 12.802095808383232, "ram_util_percent": 20.97754491017964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.002511685946956277, "cur_lr": 0.01}, "td_error": [1.4357832670211792, 1.4357837438583374, 1.4357826709747314, 1.435782551765442, 1.4357836246490479, 1.4357829093933105, 0.9468024969100952, 1.4357826709747314, 1.435782790184021, 1.4967968463897705, 1.4357830286026, 1.4359478950500488, 1.435782551765442, 1.4357826709747314, 1.4357830286026, 1.498090147972107, 1.435782790184021, 1.501858115196228, 1.4965888261795044, 1.4357826709747314, 1.4357826709747314, 1.435782790184021, 1.4357829093933105, 1.4357826709747314, 1.779649257659912, 1.4978337287902832, 1.4357830286026, 1.4607617855072021, 0.9468012452125549, 2.233851671218872, 1.4357826709747314, 1.4357826709747314, 1.4357826709747314, 1.435782551765442, 1.435782790184021, 1.1033324003219604, 1.4965146780014038, 1.4980112314224243, 1.4357868432998657, 1.4357826709747314, 1.6008509397506714, 1.4357831478118896, 1.4357826709747314, 2.139708995819092, 1.435782551765442, 1.4357826709747314, 1.497697353363037, 1.435782790184021, 1.4807392358779907, 1.435782790184021, 1.435782790184021, 2.171292781829834, 1.435782551765442, 1.4357829093933105, 2.161668539047241, 1.4357831478118896, 1.4357831478118896, 1.435782551765442, 0.9468010663986206, 1.4357826709747314, 1.435782551765442, 1.435782790184021, 1.4831894636154175, 1.435782790184021, 1.4357826709747314, 1.435782551765442, 2.1018271446228027, 1.4357826709747314, 0.9468016028404236, 1.435782790184021, 1.4654961824417114, 1.435782790184021, 1.4357829093933105, 1.4965620040893555, 1.981921672821045, 0.9356117248535156, 1.4357826709747314, 1.4357826709747314], "mean_td_error": 1.4691301584243774, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1275.0, "diff_num_grad_updates_vs_sampler_policy": 1274.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 99450, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 99450, "last_target_update_ts": 52000, "num_target_updates": 99}, "sampler_results": {"episode_reward_max": 1.4127267142288575, "episode_reward_min": -19.999710321643835, "episode_reward_mean": -2.817773983256329, "episode_len_mean": 25.13, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.501066807591414, 0.0002958819985448616, 0.0002940038697514638, 0.00029245369242662203, 0.0002912639129823106, 0.0002973998316348692, -9.99970395585361, 0.00029416382679785697, 0.00029261196628077026, 0.00029142090128846023, 0.0002966658517554611, 0.00029477779155728676, -9.999706780400166, 0.16088815919918156, 0.0002903318736895849, 0.000298616131130512, 0.00029670324804430986, 0.00029512454401536744, 0.941932548345983, 0.00029215145720466686, -19.999710005190426, -9.645497170630101, -9.999735826851367, -9.999714510457727, -9.999715984605604, 0.000286763127289983, 1.4127267142288575, 0.0002837572829162233, 0.07699978812567458, 1.0671643624256946, -9.999709152069483, 0.0002893617968769903, 0.000264922306871276, -9.999713708047468, 0.0002848088391727928, 1.067170673850224, -9.99973664929326, -9.902799259848607, 0.0002832421050547766, 0.00028189807514099796, -9.999710477565563, 0.00028805044439138484, 0.00026372750632166255, 0.00028500808245835493, 0.0002835383390785099, -19.999710321643835, 0.0002882039870668548, 0.0002638674049644926, 0.07883194195172427, -9.999716214591315, 0.00028885112862960536, 0.0002644570326437966, 0.00028579192076782736, -9.99971568576977, 0.00028295990184460025, -9.999709347723957, -9.999733902128455, -9.999712442933726, 0.00028605880890941043, 0.0002846879767607005, 0.00028266076063414135, 0.0002813389633653012, 0.00027976127504107293, 0.00027851421418818796, 0.00027731403256264867, 0.0002797828295579367, 0.00027822249815677327, 0.000276989087410508, 0.0002758019878257576, 0.0002741407494561888, 0.000283449933570096, 0.10390077742859118, 0.00028060980733123634, 0.07563543570511931, 0.00027825114157389836, 0.00028058338364050743, -9.999720985740035, 0.0002777737110639815, 0.0002765798901506242, -9.999725090581382, -9.339308005421286, 0.0002808855135371272, -9.999720686981853, 0.0002780698171474631, 0.0002768734547863011, 0.5052435494496814, 0.00028124781926210487, -9.9997203287248, 0.00027842489086400235, 0.0002772254773932458, 0.00028163531234193473, 0.00028005430775591614, 0.0002788046390068422, 0.00027760195811909875, -9.99972408084062, -9.99971665295792, 0.00028174697069415194, 0.0002804821847234592, 0.0967157564000907, 0.0002776481245365127], "episode_lengths": [27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 26, 26, 25, 23, 25, 25, 25, 26, 25, 23, 26, 25, 25, 24, 26, 25, 25, 26, 25, 23, 25, 25, 27, 25, 23, 25, 26, 25, 23, 25, 26, 25, 26, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.97298605533507, "mean_inference_ms": 2.149285901487671, "mean_action_processing_ms": 0.14734776739418082, "mean_env_wait_ms": 1.8033626834621606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010447263717651367, "StateBufferConnector_ms": 0.006288766860961914, "ViewRequirementAgentConnector_ms": 0.1754608154296875}}, "episode_reward_max": 1.4127267142288575, "episode_reward_min": -19.999710321643835, "episode_reward_mean": -2.817773983256329, "episode_len_mean": 25.13, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-18.501066807591414, 0.0002958819985448616, 0.0002940038697514638, 0.00029245369242662203, 0.0002912639129823106, 0.0002973998316348692, -9.99970395585361, 0.00029416382679785697, 0.00029261196628077026, 0.00029142090128846023, 0.0002966658517554611, 0.00029477779155728676, -9.999706780400166, 0.16088815919918156, 0.0002903318736895849, 0.000298616131130512, 0.00029670324804430986, 0.00029512454401536744, 0.941932548345983, 0.00029215145720466686, -19.999710005190426, -9.645497170630101, -9.999735826851367, -9.999714510457727, -9.999715984605604, 0.000286763127289983, 1.4127267142288575, 0.0002837572829162233, 0.07699978812567458, 1.0671643624256946, -9.999709152069483, 0.0002893617968769903, 0.000264922306871276, -9.999713708047468, 0.0002848088391727928, 1.067170673850224, -9.99973664929326, -9.902799259848607, 0.0002832421050547766, 0.00028189807514099796, -9.999710477565563, 0.00028805044439138484, 0.00026372750632166255, 0.00028500808245835493, 0.0002835383390785099, -19.999710321643835, 0.0002882039870668548, 0.0002638674049644926, 0.07883194195172427, -9.999716214591315, 0.00028885112862960536, 0.0002644570326437966, 0.00028579192076782736, -9.99971568576977, 0.00028295990184460025, -9.999709347723957, -9.999733902128455, -9.999712442933726, 0.00028605880890941043, 0.0002846879767607005, 0.00028266076063414135, 0.0002813389633653012, 0.00027976127504107293, 0.00027851421418818796, 0.00027731403256264867, 0.0002797828295579367, 0.00027822249815677327, 0.000276989087410508, 0.0002758019878257576, 0.0002741407494561888, 0.000283449933570096, 0.10390077742859118, 0.00028060980733123634, 0.07563543570511931, 0.00027825114157389836, 0.00028058338364050743, -9.999720985740035, 0.0002777737110639815, 0.0002765798901506242, -9.999725090581382, -9.339308005421286, 0.0002808855135371272, -9.999720686981853, 0.0002780698171474631, 0.0002768734547863011, 0.5052435494496814, 0.00028124781926210487, -9.9997203287248, 0.00027842489086400235, 0.0002772254773932458, 0.00028163531234193473, 0.00028005430775591614, 0.0002788046390068422, 0.00027760195811909875, -9.99972408084062, -9.99971665295792, 0.00028174697069415194, 0.0002804821847234592, 0.0967157564000907, 0.0002776481245365127], "episode_lengths": [27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 26, 26, 25, 23, 25, 25, 25, 26, 25, 23, 26, 25, 25, 24, 26, 25, 25, 26, 25, 23, 25, 25, 27, 25, 23, 25, 26, 25, 23, 25, 26, 25, 26, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.97298605533507, "mean_inference_ms": 2.149285901487671, "mean_action_processing_ms": 0.14734776739418082, "mean_env_wait_ms": 1.8033626834621606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010447263717651367, "StateBufferConnector_ms": 0.006288766860961914, "ViewRequirementAgentConnector_ms": 0.1754608154296875}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 99450, "num_env_steps_sampled": 52000, "num_env_steps_trained": 99450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.444518234159356, "num_env_steps_trained_throughput_per_sec": 8.666810556610745, "timesteps_total": 52000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 9063.522, "sample_time_ms": 8998.858, "load_time_ms": 0.251, "load_throughput": 311339.657, "learn_time_ms": 12.892, "learn_throughput": 6050.26, "synch_weights_time_ms": 11.588}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 99450, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 99450, "last_target_update_ts": 52000, "num_target_updates": 99}, "done": false, "episodes_total": 2004, "training_iteration": 52, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-40-03", "timestamp": 1713418803, "time_this_iter_s": 225.00460481643677, "time_total_s": 12555.901455640793, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 12555.901455640793, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 13.369375000000002, "ram_util_percent": 21.154999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0012390267802402377, "cur_lr": 0.01}, "td_error": [1.4313905239105225, 1.431391716003418, 1.4313912391662598, 1.4313859939575195, 1.4313856363296509, 1.4972846508026123, 1.4313853979110718, 1.4313868284225464, 1.4313853979110718, 1.4313867092132568, 1.5038005113601685, 1.4313859939575195, 1.4313857555389404, 1.4313855171203613, 1.4313853979110718, 1.4313868284225464, 1.4313952922821045, 1.4313856363296509, 1.4313857555389404, 1.127345085144043, 1.4313859939575195, 1.6097769737243652, 1.4975870847702026, 2.814927101135254, 1.431386113166809, 1.431389570236206, 1.4314053058624268, 1.497623085975647, 1.4313867092132568, 0.4901854395866394, 1.4313857555389404, 1.4313863515853882, 1.5041022300720215, 1.4313856363296509, 1.43138587474823, 1.4313855171203613, 1.4313863515853882, 1.4972879886627197, 1.4313857555389404, 1.1252927780151367, 1.5034756660461426, 1.4313874244689941, 1.4972913265228271, 1.4313862323760986, 1.4972913265228271, 2.104799509048462, 1.4976483583450317, 1.4313865900039673, 1.431388258934021, 3.1480872631073, 2.101803779602051, 2.1001367568969727, 1.4313855171203613, 1.4321759939193726, 1.4313864707946777, 5.873236179351807, 1.4313870668411255, 1.4313874244689941, 1.431386113166809, 1.5041533708572388, 0.4230533242225647, 0.9357962012290955, 1.4313875436782837, 1.4313870668411255, 1.585085153579712, 1.4313855171203613, 1.4313865900039673, 1.4313868284225464, 1.431386113166809, 1.431386113166809, 0.9358010292053223, 1.4313877820968628, 2.8150126934051514, 1.4313914775848389, 0.9357979893684387, 1.1259760856628418, 1.4316781759262085, 0.9358011484146118], "mean_td_error": 1.5233913660049438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1300.0, "diff_num_grad_updates_vs_sampler_policy": 1299.0}}, "num_env_steps_sampled": 53000, "num_env_steps_trained": 101400, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 101400, "last_target_update_ts": 52520, "num_target_updates": 100}, "sampler_results": {"episode_reward_max": 0.5997225439458885, "episode_reward_min": -19.999710321643835, "episode_reward_mean": -1.7653453881584245, "episode_len_mean": 25.1, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999710477565563, 0.00028805044439138484, 0.00026372750632166255, 0.00028500808245835493, 0.0002835383390785099, -19.999710321643835, 0.0002882039870668548, 0.0002638674049644926, 0.07883194195172427, -9.999716214591315, 0.00028885112862960536, 0.0002644570326437966, 0.00028579192076782736, -9.99971568576977, 0.00028295990184460025, -9.999709347723957, -9.999733902128455, -9.999712442933726, 0.00028605880890941043, 0.0002846879767607005, 0.00028266076063414135, 0.0002813389633653012, 0.00027976127504107293, 0.00027851421418818796, 0.00027731403256264867, 0.0002797828295579367, 0.00027822249815677327, 0.000276989087410508, 0.0002758019878257576, 0.0002741407494561888, 0.000283449933570096, 0.10390077742859118, 0.00028060980733123634, 0.07563543570511931, 0.00027825114157389836, 0.00028058338364050743, -9.999720985740035, 0.0002777737110639815, 0.0002765798901506242, -9.999725090581382, -9.339308005421286, 0.0002808855135371272, -9.999720686981853, 0.0002780698171474631, 0.0002768734547863011, 0.5052435494496814, 0.00028124781926210487, -9.9997203287248, 0.00027842489086400235, 0.0002772254773932458, 0.00028163531234193473, 0.00028005430775591614, 0.0002788046390068422, 0.00027760195811909875, -9.99972408084062, -9.99971665295792, 0.00028174697069415194, 0.0002804821847234592, 0.0967157564000907, 0.0002776481245365127, 0.05356814171142812, 0.00027418371743398754, 0.00027249602369312385, 0.00027091717823835915, 0.00026937900304732095, 0.00027259042595311514, 0.00027092223071266554, 0.00026936151664092245, 0.0002678409083207849, 0.00026658352880461395, 0.0002765603663524258, 0.00027498263044679677, -9.999726709126435, 0.07253440886996879, 0.00027026881146619604, 0.0002733502936026266, -9.999728327068112, 0.00027010346483067357, 0.0002685744907853912, 0.0002673102307173656, -8.981336474521184, 0.00027364391230610654, 0.0002719628372446966, 0.0002703901461934713, 0.0002688579336022008, 0.0002755471031735093, 0.0002739808758394073, 0.00027229567070357247, 0.000270719139261632, 0.12792104228669748, 0.5997225439458885, 0.0002726637210470238, 0.0002710829374446158, 0.00026954288454906025, 0.0002682695129313673, 0.00027605798731982953, 0.0002743472123678412, 0.047679475809452976, 0.00027133564004701353, 0.0002700453145897244], "episode_lengths": [26, 25, 23, 25, 25, 27, 25, 23, 25, 26, 25, 23, 25, 26, 25, 26, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.2839524429895, "mean_inference_ms": 2.1477489901425595, "mean_action_processing_ms": 0.14723961067228497, "mean_env_wait_ms": 1.7710268225398074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010171175003051758, "StateBufferConnector_ms": 0.006310939788818359, "ViewRequirementAgentConnector_ms": 0.17595839500427246}}, "episode_reward_max": 0.5997225439458885, "episode_reward_min": -19.999710321643835, "episode_reward_mean": -1.7653453881584245, "episode_len_mean": 25.1, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999710477565563, 0.00028805044439138484, 0.00026372750632166255, 0.00028500808245835493, 0.0002835383390785099, -19.999710321643835, 0.0002882039870668548, 0.0002638674049644926, 0.07883194195172427, -9.999716214591315, 0.00028885112862960536, 0.0002644570326437966, 0.00028579192076782736, -9.99971568576977, 0.00028295990184460025, -9.999709347723957, -9.999733902128455, -9.999712442933726, 0.00028605880890941043, 0.0002846879767607005, 0.00028266076063414135, 0.0002813389633653012, 0.00027976127504107293, 0.00027851421418818796, 0.00027731403256264867, 0.0002797828295579367, 0.00027822249815677327, 0.000276989087410508, 0.0002758019878257576, 0.0002741407494561888, 0.000283449933570096, 0.10390077742859118, 0.00028060980733123634, 0.07563543570511931, 0.00027825114157389836, 0.00028058338364050743, -9.999720985740035, 0.0002777737110639815, 0.0002765798901506242, -9.999725090581382, -9.339308005421286, 0.0002808855135371272, -9.999720686981853, 0.0002780698171474631, 0.0002768734547863011, 0.5052435494496814, 0.00028124781926210487, -9.9997203287248, 0.00027842489086400235, 0.0002772254773932458, 0.00028163531234193473, 0.00028005430775591614, 0.0002788046390068422, 0.00027760195811909875, -9.99972408084062, -9.99971665295792, 0.00028174697069415194, 0.0002804821847234592, 0.0967157564000907, 0.0002776481245365127, 0.05356814171142812, 0.00027418371743398754, 0.00027249602369312385, 0.00027091717823835915, 0.00026937900304732095, 0.00027259042595311514, 0.00027092223071266554, 0.00026936151664092245, 0.0002678409083207849, 0.00026658352880461395, 0.0002765603663524258, 0.00027498263044679677, -9.999726709126435, 0.07253440886996879, 0.00027026881146619604, 0.0002733502936026266, -9.999728327068112, 0.00027010346483067357, 0.0002685744907853912, 0.0002673102307173656, -8.981336474521184, 0.00027364391230610654, 0.0002719628372446966, 0.0002703901461934713, 0.0002688579336022008, 0.0002755471031735093, 0.0002739808758394073, 0.00027229567070357247, 0.000270719139261632, 0.12792104228669748, 0.5997225439458885, 0.0002726637210470238, 0.0002710829374446158, 0.00026954288454906025, 0.0002682695129313673, 0.00027605798731982953, 0.0002743472123678412, 0.047679475809452976, 0.00027133564004701353, 0.0002700453145897244], "episode_lengths": [26, 25, 23, 25, 25, 27, 25, 23, 25, 26, 25, 23, 25, 26, 25, 26, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.2839524429895, "mean_inference_ms": 2.1477489901425595, "mean_action_processing_ms": 0.14723961067228497, "mean_env_wait_ms": 1.7710268225398074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010171175003051758, "StateBufferConnector_ms": 0.006310939788818359, "ViewRequirementAgentConnector_ms": 0.17595839500427246}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 101400, "num_env_steps_sampled": 53000, "num_env_steps_trained": 101400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.476511752533928, "num_env_steps_trained_throughput_per_sec": 8.729197917441159, "timesteps_total": 53000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 53000, "timers": {"training_iteration_time_ms": 8932.666, "sample_time_ms": 8873.31, "load_time_ms": 0.227, "load_throughput": 344084.678, "learn_time_ms": 12.479, "learn_throughput": 6250.599, "synch_weights_time_ms": 11.092}, "counters": {"num_env_steps_sampled": 53000, "num_env_steps_trained": 101400, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 101400, "last_target_update_ts": 52520, "num_target_updates": 100}, "done": false, "episodes_total": 2044, "training_iteration": 53, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-43-47", "timestamp": 1713419027, "time_this_iter_s": 223.3961799144745, "time_total_s": 12779.297635555267, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 12779.297635555267, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 13.472955974842765, "ram_util_percent": 21.267295597484278}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.002092069946229458, "cur_lr": 0.01}, "td_error": [1.450689673423767, 1.4506921768188477, 1.5586912631988525, 1.4506902694702148, 1.4509731531143188, 0.9406810998916626, 1.5113089084625244, 1.4506916999816895, 1.4506902694702148, 0.9406812191009521, 1.5098659992218018, 0.9406809210777283, 1.4506916999816895, 0.8497491478919983, 1.4506914615631104, 1.450690507888794, 1.4506908655166626, 2.0841078758239746, 1.450689673423767, 0.9406790137290955, 1.4506911039352417, 1.4506901502609253, 1.4506911039352417, 0.9406810998916626, 0.9404507875442505, 1.450689673423767, 1.4506899118423462, 1.4506902694702148, 1.450689673423767, 1.5158159732818604, 1.5098395347595215, 1.4506902694702148, 1.4506899118423462, 1.450690507888794, 1.4506899118423462, 1.450689673423767, 1.4506964683532715, 1.5102300643920898, 1.450690746307373, 2.7810752391815186, 1.450690507888794, 1.450692057609558, 1.515817403793335, 1.450689673423767, 0.9406797885894775, 1.5109056234359741, 1.4506925344467163, 0.9406799674034119, 1.450690507888794, 1.4506906270980835, 1.4506895542144775, 0.8593103885650635, 1.450690746307373, 1.5157967805862427, 1.5157604217529297, 1.4515342712402344, 1.4506897926330566, 1.4506934881210327, 1.4506971836090088, 1.515824794769287, 1.4506903886795044, 1.4506897926330566, 1.450689673423767, 1.4506930112838745, 1.515838861465454, 1.0968847274780273, 1.4506922960281372, 0.9406799674034119, 0.9406802654266357, 1.450690507888794, 1.5158212184906006, 1.4506900310516357, 1.4512476921081543, 1.450689435005188, 1.4507004022598267, 1.5186491012573242, 1.4506908655166626, 1.4506914615631104], "mean_td_error": 1.402607798576355, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1325.0, "diff_num_grad_updates_vs_sampler_policy": 1324.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 103350, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 103350, "last_target_update_ts": 53560, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": 2.6361107807856716, "episode_reward_min": -9.999757208368058, "episode_reward_mean": -1.1962027383725293, "episode_len_mean": 24.97, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.339308005421286, 0.0002808855135371272, -9.999720686981853, 0.0002780698171474631, 0.0002768734547863011, 0.5052435494496814, 0.00028124781926210487, -9.9997203287248, 0.00027842489086400235, 0.0002772254773932458, 0.00028163531234193473, 0.00028005430775591614, 0.0002788046390068422, 0.00027760195811909875, -9.99972408084062, -9.99971665295792, 0.00028174697069415194, 0.0002804821847234592, 0.0967157564000907, 0.0002776481245365127, 0.05356814171142812, 0.00027418371743398754, 0.00027249602369312385, 0.00027091717823835915, 0.00026937900304732095, 0.00027259042595311514, 0.00027092223071266554, 0.00026936151664092245, 0.0002678409083207849, 0.00026658352880461395, 0.0002765603663524258, 0.00027498263044679677, -9.999726709126435, 0.07253440886996879, 0.00027026881146619604, 0.0002733502936026266, -9.999728327068112, 0.00027010346483067357, 0.0002685744907853912, 0.0002673102307173656, -8.981336474521184, 0.00027364391230610654, 0.0002719628372446966, 0.0002703901461934713, 0.0002688579336022008, 0.0002755471031735093, 0.0002739808758394073, 0.00027229567070357247, 0.000270719139261632, 0.12792104228669748, 0.5997225439458885, 0.0002726637210470238, 0.0002710829374446158, 0.00026954288454906025, 0.0002682695129313673, 0.00027605798731982953, 0.0002743472123678412, 0.047679475809452976, 0.00027133564004701353, 0.0002700453145897244, -9.99973189270904, 0.00026658307864364615, 0.0002441651572531748, 0.8806176442349892, 0.0002629341210303311, 0.00026507665430852305, -9.999757208368058, 0.00026263270560754646, -9.999738577742935, 0.00026007777145262866, 0.0002689885883015371, 0.00026745448382417325, 0.00024495971837438504, 0.0002649666925022909, 0.0002637345761865389, 0.0002657951540870328, 0.00024344669517773588, 0.0002633379983493939, 0.9927523686117852, -9.999739222450934, 0.0002675910100106763, 0.0002660727583555555, 1.011820388368642, 0.17656459970054442, 0.00026243466858771826, 0.00026797079530066996, 0.00026644824381446, 0.00024404221064181094, 0.0002639790527711376, 0.0002627560820608813, 0.00026674357519480835, 0.0002443115023026049, 2.6361107807856716, 0.7769681625108552, 0.0002618540250225913, -9.999731500715296, 0.00024591224870283576, 0.0002659919938277668, 0.6995764183016622, 0.0002634197066486757], "episode_lengths": [26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 24, 25, 26, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.5995432596164, "mean_inference_ms": 2.1467054656103257, "mean_action_processing_ms": 0.14716326561369034, "mean_env_wait_ms": 1.739915812240357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009700775146484375, "StateBufferConnector_ms": 0.0062906742095947266, "ViewRequirementAgentConnector_ms": 0.1768348217010498}}, "episode_reward_max": 2.6361107807856716, "episode_reward_min": -9.999757208368058, "episode_reward_mean": -1.1962027383725293, "episode_len_mean": 24.97, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.339308005421286, 0.0002808855135371272, -9.999720686981853, 0.0002780698171474631, 0.0002768734547863011, 0.5052435494496814, 0.00028124781926210487, -9.9997203287248, 0.00027842489086400235, 0.0002772254773932458, 0.00028163531234193473, 0.00028005430775591614, 0.0002788046390068422, 0.00027760195811909875, -9.99972408084062, -9.99971665295792, 0.00028174697069415194, 0.0002804821847234592, 0.0967157564000907, 0.0002776481245365127, 0.05356814171142812, 0.00027418371743398754, 0.00027249602369312385, 0.00027091717823835915, 0.00026937900304732095, 0.00027259042595311514, 0.00027092223071266554, 0.00026936151664092245, 0.0002678409083207849, 0.00026658352880461395, 0.0002765603663524258, 0.00027498263044679677, -9.999726709126435, 0.07253440886996879, 0.00027026881146619604, 0.0002733502936026266, -9.999728327068112, 0.00027010346483067357, 0.0002685744907853912, 0.0002673102307173656, -8.981336474521184, 0.00027364391230610654, 0.0002719628372446966, 0.0002703901461934713, 0.0002688579336022008, 0.0002755471031735093, 0.0002739808758394073, 0.00027229567070357247, 0.000270719139261632, 0.12792104228669748, 0.5997225439458885, 0.0002726637210470238, 0.0002710829374446158, 0.00026954288454906025, 0.0002682695129313673, 0.00027605798731982953, 0.0002743472123678412, 0.047679475809452976, 0.00027133564004701353, 0.0002700453145897244, -9.99973189270904, 0.00026658307864364615, 0.0002441651572531748, 0.8806176442349892, 0.0002629341210303311, 0.00026507665430852305, -9.999757208368058, 0.00026263270560754646, -9.999738577742935, 0.00026007777145262866, 0.0002689885883015371, 0.00026745448382417325, 0.00024495971837438504, 0.0002649666925022909, 0.0002637345761865389, 0.0002657951540870328, 0.00024344669517773588, 0.0002633379983493939, 0.9927523686117852, -9.999739222450934, 0.0002675910100106763, 0.0002660727583555555, 1.011820388368642, 0.17656459970054442, 0.00026243466858771826, 0.00026797079530066996, 0.00026644824381446, 0.00024404221064181094, 0.0002639790527711376, 0.0002627560820608813, 0.00026674357519480835, 0.0002443115023026049, 2.6361107807856716, 0.7769681625108552, 0.0002618540250225913, -9.999731500715296, 0.00024591224870283576, 0.0002659919938277668, 0.6995764183016622, 0.0002634197066486757], "episode_lengths": [26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 24, 25, 26, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.5995432596164, "mean_inference_ms": 2.1467054656103257, "mean_action_processing_ms": 0.14716326561369034, "mean_env_wait_ms": 1.739915812240357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009700775146484375, "StateBufferConnector_ms": 0.0062906742095947266, "ViewRequirementAgentConnector_ms": 0.1768348217010498}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 103350, "num_env_steps_sampled": 54000, "num_env_steps_trained": 103350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.4443762424715425, "num_env_steps_trained_throughput_per_sec": 8.666533672819508, "timesteps_total": 54000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 9019.327, "sample_time_ms": 8955.901, "load_time_ms": 0.243, "load_throughput": 321276.355, "learn_time_ms": 13.548, "learn_throughput": 5757.179, "synch_weights_time_ms": 10.987}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 103350, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 103350, "last_target_update_ts": 53560, "num_target_updates": 102}, "done": false, "episodes_total": 2084, "training_iteration": 54, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-47-32", "timestamp": 1713419252, "time_this_iter_s": 225.01211524009705, "time_total_s": 13004.309750795364, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 13004.309750795364, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 13.3475, "ram_util_percent": 21.4278125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0028953501023352146, "cur_lr": 0.01}, "td_error": [1.4255410432815552, 1.4936946630477905, 2.3420677185058594, 1.4255415201187134, 1.4998606443405151, 1.42537522315979, 1.4255410432815552, 1.4255411624908447, 0.9342092275619507, 3.204869270324707, 1.4935534000396729, 1.4255414009094238, 1.5081313848495483, 1.4255415201187134, 1.4255414009094238, 1.425540566444397, 1.4255378246307373, 1.4998393058776855, 0.9342167377471924, 1.4255409240722656, 1.4937611818313599, 1.4937503337860107, 1.4255414009094238, 1.4255412817001343, 1.425540804862976, 1.425541639328003, 1.4255412817001343, 1.4255409240722656, 1.4998342990875244, 0.41920629143714905, 1.4998342990875244, 1.4255410432815552, 1.425540804862976, 0.9342157244682312, 0.9342172741889954, 1.4255393743515015, 1.6585931777954102, 1.425540566444397, 1.4255402088165283, 1.493151068687439, 1.4938113689422607, 1.4255410432815552, 2.839104413986206, 1.500802993774414, 1.4255411624908447, 1.4936182498931885, 1.493741512298584, 0.9342172741889954, 1.4255410432815552, 1.4255415201187134, 1.4701379537582397, 1.4255412817001343, 1.4255415201187134, 1.4255403280258179, 1.4255411624908447, 1.4255414009094238, 1.425540804862976, 1.4255415201187134, 1.5170577764511108, 1.4255415201187134, 1.4255386590957642, 1.4255411624908447, 0.9342167377471924, 1.4255414009094238, 1.4255414009094238, 1.4255414009094238, 1.425540566444397, 1.4255398511886597, 1.4255412817001343, 0.9342163801193237, 0.9342145323753357, 1.1218974590301514, 2.1144285202026367, 1.425540804862976, 1.5060646533966064, 1.493761658668518, 1.4255410432815552, 0.9342125654220581], "mean_td_error": 1.4330273866653442, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1350.0, "diff_num_grad_updates_vs_sampler_policy": 1349.0}}, "num_env_steps_sampled": 55000, "num_env_steps_trained": 105300, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 105300, "last_target_update_ts": 54600, "num_target_updates": 104}, "sampler_results": {"episode_reward_max": 2.6361107807856716, "episode_reward_min": -9.999757208368058, "episode_reward_mean": -0.9338032457758366, "episode_len_mean": 24.95, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.981336474521184, 0.00027364391230610654, 0.0002719628372446966, 0.0002703901461934713, 0.0002688579336022008, 0.0002755471031735093, 0.0002739808758394073, 0.00027229567070357247, 0.000270719139261632, 0.12792104228669748, 0.5997225439458885, 0.0002726637210470238, 0.0002710829374446158, 0.00026954288454906025, 0.0002682695129313673, 0.00027605798731982953, 0.0002743472123678412, 0.047679475809452976, 0.00027133564004701353, 0.0002700453145897244, -9.99973189270904, 0.00026658307864364615, 0.0002441651572531748, 0.8806176442349892, 0.0002629341210303311, 0.00026507665430852305, -9.999757208368058, 0.00026263270560754646, -9.999738577742935, 0.00026007777145262866, 0.0002689885883015371, 0.00026745448382417325, 0.00024495971837438504, 0.0002649666925022909, 0.0002637345761865389, 0.0002657951540870328, 0.00024344669517773588, 0.0002633379983493939, 0.9927523686117852, -9.999739222450934, 0.0002675910100106763, 0.0002660727583555555, 1.011820388368642, 0.17656459970054442, 0.00026243466858771826, 0.00026797079530066996, 0.00026644824381446, 0.00024404221064181094, 0.0002639790527711376, 0.0002627560820608813, 0.00026674357519480835, 0.0002443115023026049, 2.6361107807856716, 0.7769681625108552, 0.0002618540250225913, -9.999731500715296, 0.00024591224870283576, 0.0002659919938277668, 0.6995764183016622, 0.0002634197066486757, 0.5906275422423227, 0.04534813452252987, 0.0002593160116244181, -9.327144756506359, 0.0002571367929265683, 0.00025878557758061456, -9.999742262837865, 0.2785666405881338, 0.00025559617798124505, 0.0002547643531372063, 0.00026236637298085366, 0.0002610513922810991, 0.0002599844683779882, 0.00025881304648883453, -7.002456843078396, 0.5534536809227912, 0.00025843707527896967, 0.0893316567325816, 0.00025633887048501886, 0.0002555022128186085, -9.904409817942245, 0.0002598659539660776, 0.5720151842461231, 0.0002576638389625269, 0.00025664032870989886, 0.1399099006730326, 0.5649576180694852, 0.00025909207553524456, 0.0002579286635073736, 0.00025690305217920416, 0.000260544162816817, -9.8369745419353, 0.7323533151905011, 0.00025754524165483197, 0.13603303125967117, 0.00026209417165940245, 0.0002610187251163166, 0.00025983798581476837, 0.0002587971627096348, 0.0002579444090263973], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 24, 25, 26, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.9017798898804, "mean_inference_ms": 2.145746004822415, "mean_action_processing_ms": 0.14709028942050514, "mean_env_wait_ms": 1.7099375364825584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996175765991211, "StateBufferConnector_ms": 0.006314992904663086, "ViewRequirementAgentConnector_ms": 0.17415380477905273}}, "episode_reward_max": 2.6361107807856716, "episode_reward_min": -9.999757208368058, "episode_reward_mean": -0.9338032457758366, "episode_len_mean": 24.95, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.981336474521184, 0.00027364391230610654, 0.0002719628372446966, 0.0002703901461934713, 0.0002688579336022008, 0.0002755471031735093, 0.0002739808758394073, 0.00027229567070357247, 0.000270719139261632, 0.12792104228669748, 0.5997225439458885, 0.0002726637210470238, 0.0002710829374446158, 0.00026954288454906025, 0.0002682695129313673, 0.00027605798731982953, 0.0002743472123678412, 0.047679475809452976, 0.00027133564004701353, 0.0002700453145897244, -9.99973189270904, 0.00026658307864364615, 0.0002441651572531748, 0.8806176442349892, 0.0002629341210303311, 0.00026507665430852305, -9.999757208368058, 0.00026263270560754646, -9.999738577742935, 0.00026007777145262866, 0.0002689885883015371, 0.00026745448382417325, 0.00024495971837438504, 0.0002649666925022909, 0.0002637345761865389, 0.0002657951540870328, 0.00024344669517773588, 0.0002633379983493939, 0.9927523686117852, -9.999739222450934, 0.0002675910100106763, 0.0002660727583555555, 1.011820388368642, 0.17656459970054442, 0.00026243466858771826, 0.00026797079530066996, 0.00026644824381446, 0.00024404221064181094, 0.0002639790527711376, 0.0002627560820608813, 0.00026674357519480835, 0.0002443115023026049, 2.6361107807856716, 0.7769681625108552, 0.0002618540250225913, -9.999731500715296, 0.00024591224870283576, 0.0002659919938277668, 0.6995764183016622, 0.0002634197066486757, 0.5906275422423227, 0.04534813452252987, 0.0002593160116244181, -9.327144756506359, 0.0002571367929265683, 0.00025878557758061456, -9.999742262837865, 0.2785666405881338, 0.00025559617798124505, 0.0002547643531372063, 0.00026236637298085366, 0.0002610513922810991, 0.0002599844683779882, 0.00025881304648883453, -7.002456843078396, 0.5534536809227912, 0.00025843707527896967, 0.0893316567325816, 0.00025633887048501886, 0.0002555022128186085, -9.904409817942245, 0.0002598659539660776, 0.5720151842461231, 0.0002576638389625269, 0.00025664032870989886, 0.1399099006730326, 0.5649576180694852, 0.00025909207553524456, 0.0002579286635073736, 0.00025690305217920416, 0.000260544162816817, -9.8369745419353, 0.7323533151905011, 0.00025754524165483197, 0.13603303125967117, 0.00026209417165940245, 0.0002610187251163166, 0.00025983798581476837, 0.0002587971627096348, 0.0002579444090263973], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 24, 25, 26, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.9017798898804, "mean_inference_ms": 2.145746004822415, "mean_action_processing_ms": 0.14709028942050514, "mean_env_wait_ms": 1.7099375364825584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996175765991211, "StateBufferConnector_ms": 0.006314992904663086, "ViewRequirementAgentConnector_ms": 0.17415380477905273}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 105300, "num_env_steps_sampled": 55000, "num_env_steps_trained": 105300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.478176494676489, "num_env_steps_trained_throughput_per_sec": 8.732444164619153, "timesteps_total": 55000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 55000, "timers": {"training_iteration_time_ms": 8848.457, "sample_time_ms": 8787.266, "load_time_ms": 0.247, "load_throughput": 316153.568, "learn_time_ms": 12.702, "learn_throughput": 6140.633, "synch_weights_time_ms": 11.463}, "counters": {"num_env_steps_sampled": 55000, "num_env_steps_trained": 105300, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 105300, "last_target_update_ts": 54600, "num_target_updates": 104}, "done": false, "episodes_total": 2124, "training_iteration": 55, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-51-15", "timestamp": 1713419475, "time_this_iter_s": 223.31394362449646, "time_total_s": 13227.62369441986, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 13227.62369441986, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 13.583018867924528, "ram_util_percent": 21.564150943396225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0020628266502171755, "cur_lr": 0.01}, "td_error": [1.4007207155227661, 3.020883798599243, 3.1122381687164307, 1.400720477104187, 1.400708794593811, 1.4007208347320557, 1.4007127285003662, 1.4007207155227661, 2.15769624710083, 1.400720238685608, 1.4007198810577393, 1.4002649784088135, 1.4007208347320557, 2.154064416885376, 1.4007205963134766, 1.4920884370803833, 1.400720477104187, 0.9192501306533813, 1.465904951095581, 1.4007201194763184, 1.4006091356277466, 0.9192208647727966, 0.9192482233047485, 1.4007209539413452, 1.400720477104187, 1.4007201194763184, 1.4007208347320557, 0.919249951839447, 1.4007197618484497, 1.4007189273834229, 1.4007203578948975, 1.400720238685608, 1.4007177352905273, 1.4007203578948975, 1.400713324546814, 1.4007203578948975, 1.4007203578948975, 1.4007203578948975, 1.4007207155227661, 1.4007207155227661, 1.4007203578948975, 1.470123529434204, 1.4007207155227661, 1.4007203578948975, 1.4007209539413452, 1.4007205963134766, 1.400720477104187, 1.4007177352905273, 1.4007207155227661, 1.400720238685608, 1.4007201194763184, 1.4007196426391602, 0.919227123260498, 1.4007207155227661, 1.400720238685608, 1.400720238685608, 1.4007142782211304, 1.4007208347320557, 1.4007200002670288, 1.4674022197723389, 0.9192485809326172, 1.7090516090393066, 1.4007207155227661, 1.400720238685608, 1.400720238685608, 1.460096001625061, 1.5004308223724365, 1.4007201194763184, 1.4007208347320557, 0.919249415397644, 1.4031100273132324, 1.4007205963134766, 1.4600961208343506, 1.6151964664459229, 1.4007192850112915, 1.4007197618484497, 0.9192497730255127, 1.4007205963134766], "mean_td_error": 1.426693081855774, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1375.0, "diff_num_grad_updates_vs_sampler_policy": 1374.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 107250, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 107250, "last_target_update_ts": 55640, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": 2.6361107807856716, "episode_reward_min": -9.99975868577282, "episode_reward_mean": -1.239710458615829, "episode_len_mean": 24.98, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0002675910100106763, 0.0002660727583555555, 1.011820388368642, 0.17656459970054442, 0.00026243466858771826, 0.00026797079530066996, 0.00026644824381446, 0.00024404221064181094, 0.0002639790527711376, 0.0002627560820608813, 0.00026674357519480835, 0.0002443115023026049, 2.6361107807856716, 0.7769681625108552, 0.0002618540250225913, -9.999731500715296, 0.00024591224870283576, 0.0002659919938277668, 0.6995764183016622, 0.0002634197066486757, 0.5906275422423227, 0.04534813452252987, 0.0002593160116244181, -9.327144756506359, 0.0002571367929265683, 0.00025878557758061456, -9.999742262837865, 0.2785666405881338, 0.00025559617798124505, 0.0002547643531372063, 0.00026236637298085366, 0.0002610513922810991, 0.0002599844683779882, 0.00025881304648883453, -7.002456843078396, 0.5534536809227912, 0.00025843707527896967, 0.0893316567325816, 0.00025633887048501886, 0.0002555022128186085, -9.904409817942245, 0.0002598659539660776, 0.5720151842461231, 0.0002576638389625269, 0.00025664032870989886, 0.1399099006730326, 0.5649576180694852, 0.00025909207553524456, 0.0002579286635073736, 0.00025690305217920416, 0.000260544162816817, -9.8369745419353, 0.7323533151905011, 0.00025754524165483197, 0.13603303125967117, 0.00026209417165940245, 0.0002610187251163166, 0.00025983798581476837, 0.0002587971627096348, 0.0002579444090263973, 0.00025629492750248715, 0.1673804573610898, 0.00025415154712875586, 0.00024289280277877158, 0.00025185213195522745, 0.00025353192789064966, -9.999747504936767, -9.99975868577282, -9.999749777216595, 0.24115095876803389, 0.00025693639823896967, 0.00025568292025354375, -9.999745374276172, 0.2820544140301858, 0.0002523419565345817, 0.0002542626557017801, -9.999746782852545, 0.061530948656403794, 0.0002510319642396307, 0.09893956166963697, 0.00025580170542477523, 0.0002545592476842317, 0.00025351120098112735, 0.00024228355723148213, -9.390933125268884, 0.33317329296534676, 0.00025484752873741685, 0.00025379711186121695, 0.00024255558357076518, 0.0002515040768534736, 0.00025550154418324306, 0.00025444574027472174, 0.00024317270281977408, -9.999747858875622, 0.00025114669194235286, -9.999743318794287, 1.2843141185861717, 0.0002442921025812123, 0.00025329634817768213, 0.00025229290342785904], "episode_lengths": [25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 25, 25, 25, 26, 24, 25, 25, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.2160072473391, "mean_inference_ms": 2.144729804317481, "mean_action_processing_ms": 0.1470185831828651, "mean_env_wait_ms": 1.6810483259891285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010058879852294922, "StateBufferConnector_ms": 0.006339311599731445, "ViewRequirementAgentConnector_ms": 0.17352771759033203}}, "episode_reward_max": 2.6361107807856716, "episode_reward_min": -9.99975868577282, "episode_reward_mean": -1.239710458615829, "episode_len_mean": 24.98, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0002675910100106763, 0.0002660727583555555, 1.011820388368642, 0.17656459970054442, 0.00026243466858771826, 0.00026797079530066996, 0.00026644824381446, 0.00024404221064181094, 0.0002639790527711376, 0.0002627560820608813, 0.00026674357519480835, 0.0002443115023026049, 2.6361107807856716, 0.7769681625108552, 0.0002618540250225913, -9.999731500715296, 0.00024591224870283576, 0.0002659919938277668, 0.6995764183016622, 0.0002634197066486757, 0.5906275422423227, 0.04534813452252987, 0.0002593160116244181, -9.327144756506359, 0.0002571367929265683, 0.00025878557758061456, -9.999742262837865, 0.2785666405881338, 0.00025559617798124505, 0.0002547643531372063, 0.00026236637298085366, 0.0002610513922810991, 0.0002599844683779882, 0.00025881304648883453, -7.002456843078396, 0.5534536809227912, 0.00025843707527896967, 0.0893316567325816, 0.00025633887048501886, 0.0002555022128186085, -9.904409817942245, 0.0002598659539660776, 0.5720151842461231, 0.0002576638389625269, 0.00025664032870989886, 0.1399099006730326, 0.5649576180694852, 0.00025909207553524456, 0.0002579286635073736, 0.00025690305217920416, 0.000260544162816817, -9.8369745419353, 0.7323533151905011, 0.00025754524165483197, 0.13603303125967117, 0.00026209417165940245, 0.0002610187251163166, 0.00025983798581476837, 0.0002587971627096348, 0.0002579444090263973, 0.00025629492750248715, 0.1673804573610898, 0.00025415154712875586, 0.00024289280277877158, 0.00025185213195522745, 0.00025353192789064966, -9.999747504936767, -9.99975868577282, -9.999749777216595, 0.24115095876803389, 0.00025693639823896967, 0.00025568292025354375, -9.999745374276172, 0.2820544140301858, 0.0002523419565345817, 0.0002542626557017801, -9.999746782852545, 0.061530948656403794, 0.0002510319642396307, 0.09893956166963697, 0.00025580170542477523, 0.0002545592476842317, 0.00025351120098112735, 0.00024228355723148213, -9.390933125268884, 0.33317329296534676, 0.00025484752873741685, 0.00025379711186121695, 0.00024255558357076518, 0.0002515040768534736, 0.00025550154418324306, 0.00025444574027472174, 0.00024317270281977408, -9.999747858875622, 0.00025114669194235286, -9.999743318794287, 1.2843141185861717, 0.0002442921025812123, 0.00025329634817768213, 0.00025229290342785904], "episode_lengths": [25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 25, 25, 25, 26, 24, 25, 25, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.2160072473391, "mean_inference_ms": 2.144729804317481, "mean_action_processing_ms": 0.1470185831828651, "mean_env_wait_ms": 1.6810483259891285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010058879852294922, "StateBufferConnector_ms": 0.006339311599731445, "ViewRequirementAgentConnector_ms": 0.17352771759033203}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 107250, "num_env_steps_sampled": 56000, "num_env_steps_trained": 107250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.8684710722943985, "num_env_steps_trained_throughput_per_sec": 7.543518590974077, "timesteps_total": 56000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 11255.833, "sample_time_ms": 11192.985, "load_time_ms": 0.241, "load_throughput": 324141.199, "learn_time_ms": 13.016, "learn_throughput": 5992.785, "synch_weights_time_ms": 11.834}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 107250, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 107250, "last_target_update_ts": 55640, "num_target_updates": 106}, "done": false, "episodes_total": 2164, "training_iteration": 56, "trial_id": "cbb9a_00000", "date": "2024-04-18_05-55-34", "timestamp": 1713419734, "time_this_iter_s": 258.50855445861816, "time_total_s": 13486.132248878479, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 13486.132248878479, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 11.866847826086957, "ram_util_percent": 21.75244565217391}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0019205723656341434, "cur_lr": 0.01}, "td_error": [1.3962782621383667, 0.9256109595298767, 1.4480589628219604, 1.4482123851776123, 1.3962783813476562, 0.854330837726593, 2.882398843765259, 1.3962786197662354, 1.95859694480896, 1.3962750434875488, 0.9256088137626648, 1.3962785005569458, 1.4843406677246094, 1.3962786197662354, 1.3962783813476562, 2.6143734455108643, 1.3961726427078247, 1.3962780237197876, 1.3962783813476562, 1.47245454788208, 1.3962688446044922, 1.4479233026504517, 1.3962786197662354, 0.9255842566490173, 0.4228944778442383, 2.8812081813812256, 2.191206932067871, 1.3962786197662354, 1.3962769508361816, 1.3962785005569458, 1.3962783813476562, 1.3962754011154175, 1.3962783813476562, 1.3962782621383667, 1.4479585886001587, 1.3962785005569458, 1.5605628490447998, 1.3962781429290771, 1.4477978944778442, 1.3962785005569458, 1.472711205482483, 0.9256083965301514, 0.9256096482276917, 1.4727613925933838, 1.396277904510498, 0.9131420850753784, 0.9246097207069397, 2.191628932952881, 1.3962782621383667, 1.3962424993515015, 1.3962763547897339, 1.3962786197662354, 0.9256086349487305, 1.3962783813476562, 1.3962780237197876, 1.3962785005569458, 1.3962777853012085, 1.3962783813476562, 1.3962782621383667, 1.4481542110443115, 1.3962785005569458, 1.3962785005569458, 1.3962780237197876, 1.396257996559143, 0.8816719651222229, 1.3962785005569458, 1.3962786197662354, 1.3962785005569458, 1.448211669921875, 1.3962783813476562, 1.3962782621383667, 0.9256096482276917, 1.3962783813476562, 1.3962783813476562, 1.3962782621383667, 2.2058022022247314, 1.3962782621383667, 1.3962785005569458], "mean_td_error": 1.4182711839675903, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1400.0, "diff_num_grad_updates_vs_sampler_policy": 1399.0}}, "num_env_steps_sampled": 57000, "num_env_steps_trained": 109200, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 109200, "last_target_update_ts": 56680, "num_target_updates": 108}, "sampler_results": {"episode_reward_max": 2.0234110183265024, "episode_reward_min": -9.999761796246105, "episode_reward_mean": -1.5809010904318797, "episode_len_mean": 24.93, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.904409817942245, 0.0002598659539660776, 0.5720151842461231, 0.0002576638389625269, 0.00025664032870989886, 0.1399099006730326, 0.5649576180694852, 0.00025909207553524456, 0.0002579286635073736, 0.00025690305217920416, 0.000260544162816817, -9.8369745419353, 0.7323533151905011, 0.00025754524165483197, 0.13603303125967117, 0.00026209417165940245, 0.0002610187251163166, 0.00025983798581476837, 0.0002587971627096348, 0.0002579444090263973, 0.00025629492750248715, 0.1673804573610898, 0.00025415154712875586, 0.00024289280277877158, 0.00025185213195522745, 0.00025353192789064966, -9.999747504936767, -9.99975868577282, -9.999749777216595, 0.24115095876803389, 0.00025693639823896967, 0.00025568292025354375, -9.999745374276172, 0.2820544140301858, 0.0002523419565345817, 0.0002542626557017801, -9.999746782852545, 0.061530948656403794, 0.0002510319642396307, 0.09893956166963697, 0.00025580170542477523, 0.0002545592476842317, 0.00025351120098112735, 0.00024228355723148213, -9.390933125268884, 0.33317329296534676, 0.00025484752873741685, 0.00025379711186121695, 0.00024255558357076518, 0.0002515040768534736, 0.00025550154418324306, 0.00025444574027472174, 0.00024317270281977408, -9.999747858875622, 0.00025114669194235286, -9.999743318794287, 1.2843141185861717, 0.0002442921025812123, 0.00025329634817768213, 0.00025229290342785904, 0.00025086007371898783, 0.00023971655954161972, 0.00023881690835466274, 0.6496519834339879, 0.0002467133702552945, -9.999761796246105, 0.00023731595994816185, 2.0234110183265024, 0.000245170580488977, 0.40759421183925215, 0.00025134604366630283, 0.11722651388578514, -8.6651181348497, -9.999751549001322, 0.0002473140720179611, 0.00023900692036254632, 0.059500153450497, 0.0002472007033084777, 0.0002460778622127298, 0.00024515132511686576, 0.6998856240825049, -9.6167829780083, 0.06452686209934397, 0.0002474031005316839, 0.0002462784242103381, 0.0002505147530831422, 0.09914680651757102, 0.0002385289776678069, 0.0002475354496339937, 0.0002464095724378489, -9.999760010717418, -9.99976091241255, 0.0002481128689299723, 0.00024698174503515603, 0.4699017434290938, -9.999758918506728, 0.00024016950858959357, 0.10118447559329109, 0.0002481523294930387, 0.0002472101336014997], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 25, 25, 25, 26, 24, 25, 25, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.50837326252724, "mean_inference_ms": 2.1440689195476152, "mean_action_processing_ms": 0.14698385530949193, "mean_env_wait_ms": 1.6532329604230225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011022806167602539, "StateBufferConnector_ms": 0.0067064762115478516, "ViewRequirementAgentConnector_ms": 0.18048548698425293}}, "episode_reward_max": 2.0234110183265024, "episode_reward_min": -9.999761796246105, "episode_reward_mean": -1.5809010904318797, "episode_len_mean": 24.93, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.904409817942245, 0.0002598659539660776, 0.5720151842461231, 0.0002576638389625269, 0.00025664032870989886, 0.1399099006730326, 0.5649576180694852, 0.00025909207553524456, 0.0002579286635073736, 0.00025690305217920416, 0.000260544162816817, -9.8369745419353, 0.7323533151905011, 0.00025754524165483197, 0.13603303125967117, 0.00026209417165940245, 0.0002610187251163166, 0.00025983798581476837, 0.0002587971627096348, 0.0002579444090263973, 0.00025629492750248715, 0.1673804573610898, 0.00025415154712875586, 0.00024289280277877158, 0.00025185213195522745, 0.00025353192789064966, -9.999747504936767, -9.99975868577282, -9.999749777216595, 0.24115095876803389, 0.00025693639823896967, 0.00025568292025354375, -9.999745374276172, 0.2820544140301858, 0.0002523419565345817, 0.0002542626557017801, -9.999746782852545, 0.061530948656403794, 0.0002510319642396307, 0.09893956166963697, 0.00025580170542477523, 0.0002545592476842317, 0.00025351120098112735, 0.00024228355723148213, -9.390933125268884, 0.33317329296534676, 0.00025484752873741685, 0.00025379711186121695, 0.00024255558357076518, 0.0002515040768534736, 0.00025550154418324306, 0.00025444574027472174, 0.00024317270281977408, -9.999747858875622, 0.00025114669194235286, -9.999743318794287, 1.2843141185861717, 0.0002442921025812123, 0.00025329634817768213, 0.00025229290342785904, 0.00025086007371898783, 0.00023971655954161972, 0.00023881690835466274, 0.6496519834339879, 0.0002467133702552945, -9.999761796246105, 0.00023731595994816185, 2.0234110183265024, 0.000245170580488977, 0.40759421183925215, 0.00025134604366630283, 0.11722651388578514, -8.6651181348497, -9.999751549001322, 0.0002473140720179611, 0.00023900692036254632, 0.059500153450497, 0.0002472007033084777, 0.0002460778622127298, 0.00024515132511686576, 0.6998856240825049, -9.6167829780083, 0.06452686209934397, 0.0002474031005316839, 0.0002462784242103381, 0.0002505147530831422, 0.09914680651757102, 0.0002385289776678069, 0.0002475354496339937, 0.0002464095724378489, -9.999760010717418, -9.99976091241255, 0.0002481128689299723, 0.00024698174503515603, 0.4699017434290938, -9.999758918506728, 0.00024016950858959357, 0.10118447559329109, 0.0002481523294930387, 0.0002472101336014997], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 25, 25, 25, 26, 24, 25, 25, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.50837326252724, "mean_inference_ms": 2.1440689195476152, "mean_action_processing_ms": 0.14698385530949193, "mean_env_wait_ms": 1.6532329604230225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011022806167602539, "StateBufferConnector_ms": 0.0067064762115478516, "ViewRequirementAgentConnector_ms": 0.18048548698425293}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 109200, "num_env_steps_sampled": 57000, "num_env_steps_trained": 109200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.582672491701805, "num_env_steps_trained_throughput_per_sec": 6.98621135881852, "timesteps_total": 57000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 57000, "timers": {"training_iteration_time_ms": 11194.378, "sample_time_ms": 11132.068, "load_time_ms": 0.263, "load_throughput": 296928.401, "learn_time_ms": 12.951, "learn_throughput": 6022.749, "synch_weights_time_ms": 10.814}, "counters": {"num_env_steps_sampled": 57000, "num_env_steps_trained": 109200, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 109200, "last_target_update_ts": 56680, "num_target_updates": 108}, "done": false, "episodes_total": 2204, "training_iteration": 57, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-00-13", "timestamp": 1713420013, "time_this_iter_s": 279.1303415298462, "time_total_s": 13765.262590408325, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 13765.262590408325, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 10.87632241813602, "ram_util_percent": 21.89168765743073}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0011552597861737013, "cur_lr": 0.01}, "td_error": [1.4097107648849487, 1.4097346067428589, 1.4097349643707275, 2.852397918701172, 1.4096527099609375, 1.409733533859253, 2.152487277984619, 1.4097344875335693, 1.409734845161438, 1.409722089767456, 1.4097349643707275, 1.4097347259521484, 1.4647194147109985, 1.4097349643707275, 1.4097347259521484, 1.4097342491149902, 1.4097344875335693, 1.409735083580017, 1.4097349643707275, 1.4097344875335693, 1.409734845161438, 1.4097344875335693, 1.4097342491149902, 0.45162051916122437, 1.409734845161438, 1.4097346067428589, 0.9246745109558105, 1.409734845161438, 1.4097347259521484, 1.4097349643707275, 0.9246509075164795, 0.9246905446052551, 2.8515162467956543, 1.4097352027893066, 1.4097349643707275, 1.4097344875335693, 1.409735083580017, 1.409735083580017, 1.409734845161438, 1.4097332954406738, 0.4329654276371002, 2.7728822231292725, 1.409734845161438, 1.4097341299057007, 1.4097346067428589, 1.464720606803894, 1.4759763479232788, 1.4097346067428589, 1.4097349643707275, 1.4097349643707275, 1.4097343683242798, 1.4097349643707275, 1.464692234992981, 1.4097334146499634, 1.409735083580017, 1.409734845161438, 1.4097349643707275, 1.4759708642959595, 1.409734845161438, 1.4646952152252197, 1.409735083580017, 1.4751931428909302, 1.4097349643707275, 2.152028799057007, 1.409735083580017, 0.9246893525123596, 1.4097329378128052, 1.409734845161438, 1.4647163152694702, 1.4780468940734863, 1.4097349643707275, 1.4804984331130981, 1.47532057762146, 1.409734845161438, 1.409734845161438, 0.9246729612350464, 1.4097349643707275, 1.4754009246826172], "mean_td_error": 1.4368561506271362, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1425.0, "diff_num_grad_updates_vs_sampler_policy": 1424.0}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 111150, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 111150, "last_target_update_ts": 57720, "num_target_updates": 110}, "sampler_results": {"episode_reward_max": 3.7085280322004994, "episode_reward_min": -9.999776208135069, "episode_reward_mean": -1.18683558212428, "episode_len_mean": 24.62, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00025351120098112735, 0.00024228355723148213, -9.390933125268884, 0.33317329296534676, 0.00025484752873741685, 0.00025379711186121695, 0.00024255558357076518, 0.0002515040768534736, 0.00025550154418324306, 0.00025444574027472174, 0.00024317270281977408, -9.999747858875622, 0.00025114669194235286, -9.999743318794287, 1.2843141185861717, 0.0002442921025812123, 0.00025329634817768213, 0.00025229290342785904, 0.00025086007371898783, 0.00023971655954161972, 0.00023881690835466274, 0.6496519834339879, 0.0002467133702552945, -9.999761796246105, 0.00023731595994816185, 2.0234110183265024, 0.000245170580488977, 0.40759421183925215, 0.00025134604366630283, 0.11722651388578514, -8.6651181348497, -9.999751549001322, 0.0002473140720179611, 0.00023900692036254632, 0.059500153450497, 0.0002472007033084777, 0.0002460778622127298, 0.00024515132511686576, 0.6998856240825049, -9.6167829780083, 0.06452686209934397, 0.0002474031005316839, 0.0002462784242103381, 0.0002505147530831422, 0.09914680651757102, 0.0002385289776678069, 0.0002475354496339937, 0.0002464095724378489, -9.999760010717418, -9.99976091241255, 0.0002481128689299723, 0.00024698174503515603, 0.4699017434290938, -9.999758918506728, 0.00024016950858959357, 0.10118447559329109, 0.0002481523294930387, 0.0002472101336014997, 3.7085280322004994, 2.987520118721134, 0.00023420199772555844, 0.00023338141661472236, 0.4696882161034375, -9.999776208135069, 0.00023273596952975336, -9.999768074294922, 0.0002404410856212612, 0.0002394122245442152, 1.6598502464420823, 0.0002257230058234307, 0.09038510619087298, 0.08184460588585195, 0.00024264076128729497, 0.00024159302993687672, 0.00022459926036646878, 0.00023357289532279448, 0.0002327567089903252, 0.0002412985893680117, 0.24075440110298899, 0.07940440620440371, 0.00022485464748426938, -9.999766162316746, 0.00023301955404175358, -8.144299325526351, 0.00024053419195891118, 0.0002454805402598257, 0.10252010126243988, 0.00023396212376958968, 0.0776883730239085, 0.0002417683674487466, 0.090557551285027, 0.0002345063464859894, 0.00023368363503778464, 0.0002422549320375552, 1.2178829229046357, 0.0002264775443751023, 0.00023551957120271353, 0.0002346897476963509, 0.00024329293325763682, 0.00024223957432936794], "episode_lengths": [25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 24, 24, 25, 24, 24, 25, 25, 25, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.98458547946825, "mean_inference_ms": 2.1444408099368903, "mean_action_processing_ms": 0.14699050553181875, "mean_env_wait_ms": 1.6254001969020524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011955022811889648, "StateBufferConnector_ms": 0.006947994232177734, "ViewRequirementAgentConnector_ms": 0.183823823928833}}, "episode_reward_max": 3.7085280322004994, "episode_reward_min": -9.999776208135069, "episode_reward_mean": -1.18683558212428, "episode_len_mean": 24.62, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00025351120098112735, 0.00024228355723148213, -9.390933125268884, 0.33317329296534676, 0.00025484752873741685, 0.00025379711186121695, 0.00024255558357076518, 0.0002515040768534736, 0.00025550154418324306, 0.00025444574027472174, 0.00024317270281977408, -9.999747858875622, 0.00025114669194235286, -9.999743318794287, 1.2843141185861717, 0.0002442921025812123, 0.00025329634817768213, 0.00025229290342785904, 0.00025086007371898783, 0.00023971655954161972, 0.00023881690835466274, 0.6496519834339879, 0.0002467133702552945, -9.999761796246105, 0.00023731595994816185, 2.0234110183265024, 0.000245170580488977, 0.40759421183925215, 0.00025134604366630283, 0.11722651388578514, -8.6651181348497, -9.999751549001322, 0.0002473140720179611, 0.00023900692036254632, 0.059500153450497, 0.0002472007033084777, 0.0002460778622127298, 0.00024515132511686576, 0.6998856240825049, -9.6167829780083, 0.06452686209934397, 0.0002474031005316839, 0.0002462784242103381, 0.0002505147530831422, 0.09914680651757102, 0.0002385289776678069, 0.0002475354496339937, 0.0002464095724378489, -9.999760010717418, -9.99976091241255, 0.0002481128689299723, 0.00024698174503515603, 0.4699017434290938, -9.999758918506728, 0.00024016950858959357, 0.10118447559329109, 0.0002481523294930387, 0.0002472101336014997, 3.7085280322004994, 2.987520118721134, 0.00023420199772555844, 0.00023338141661472236, 0.4696882161034375, -9.999776208135069, 0.00023273596952975336, -9.999768074294922, 0.0002404410856212612, 0.0002394122245442152, 1.6598502464420823, 0.0002257230058234307, 0.09038510619087298, 0.08184460588585195, 0.00024264076128729497, 0.00024159302993687672, 0.00022459926036646878, 0.00023357289532279448, 0.0002327567089903252, 0.0002412985893680117, 0.24075440110298899, 0.07940440620440371, 0.00022485464748426938, -9.999766162316746, 0.00023301955404175358, -8.144299325526351, 0.00024053419195891118, 0.0002454805402598257, 0.10252010126243988, 0.00023396212376958968, 0.0776883730239085, 0.0002417683674487466, 0.090557551285027, 0.0002345063464859894, 0.00023368363503778464, 0.0002422549320375552, 1.2178829229046357, 0.0002264775443751023, 0.00023551957120271353, 0.0002346897476963509, 0.00024329293325763682, 0.00024223957432936794], "episode_lengths": [25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 24, 24, 25, 24, 24, 25, 25, 25, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.98458547946825, "mean_inference_ms": 2.1444408099368903, "mean_action_processing_ms": 0.14699050553181875, "mean_env_wait_ms": 1.6254001969020524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011955022811889648, "StateBufferConnector_ms": 0.006947994232177734, "ViewRequirementAgentConnector_ms": 0.183823823928833}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 111150, "num_env_steps_sampled": 58000, "num_env_steps_trained": 111150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5736684673137096, "num_env_steps_trained_throughput_per_sec": 6.968653511261734, "timesteps_total": 58000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 11249.65, "sample_time_ms": 11183.995, "load_time_ms": 0.252, "load_throughput": 309162.457, "learn_time_ms": 13.656, "learn_throughput": 5711.836, "synch_weights_time_ms": 11.062}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 111150, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 111150, "last_target_update_ts": 57720, "num_target_updates": 110}, "done": false, "episodes_total": 2246, "training_iteration": 58, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-04-53", "timestamp": 1713420293, "time_this_iter_s": 279.8338875770569, "time_total_s": 14045.096477985382, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14045.096477985382, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 11.448743718592965, "ram_util_percent": 22.037437185929644}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0018716476624831557, "cur_lr": 0.01}, "td_error": [1.3908072710037231, 1.3912947177886963, 0.9202573299407959, 1.3908076286315918, 0.8466885089874268, 0.9202572107315063, 1.390807032585144, 2.857257127761841, 2.86448073387146, 0.9202573895454407, 1.3908079862594604, 1.4609771966934204, 0.9202569723129272, 0.9202574491500854, 2.864015579223633, 2.8640189170837402, 1.3908069133758545, 1.3911049365997314, 1.3908069133758545, 1.3908073902130127, 1.3908103704452515, 0.8466885089874268, 1.3908076286315918, 1.3908075094223022, 1.3908119201660156, 1.4611812829971313, 1.390810251235962, 1.3908154964447021, 1.3908125162124634, 1.39080810546875, 1.3911972045898438, 1.3908071517944336, 2.205153703689575, 1.3908090591430664, 1.444033145904541, 1.3908069133758545, 1.390811800956726, 1.3908103704452515, 1.3908071517944336, 0.8631060123443604, 3.90969181060791, 1.3908164501190186, 1.39080810546875, 2.37963604927063, 1.3908069133758545, 1.3908077478408813, 1.390807867050171, 1.3908072710037231, 0.9202574491500854, 0.9202567338943481, 0.9202567338943481, 0.9196425676345825, 1.390807032585144, 1.391316533088684, 1.3908098936080933, 1.4090639352798462, 1.3908084630966187, 1.4443190097808838, 1.390809178352356, 1.3908100128173828, 1.0490143299102783, 1.3908082246780396, 1.3908087015151978, 0.920257031917572, 1.3908087015151978, 1.39080810546875, 0.42775532603263855, 0.4388710558414459, 1.390810489654541, 1.46096670627594, 1.390807867050171, 1.4611402750015259, 1.9037243127822876, 0.9202572107315063, 1.3908075094223022, 1.3908073902130127, 1.390808343887329, 1.390809178352356], "mean_td_error": 1.4174728393554688, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1450.0, "diff_num_grad_updates_vs_sampler_policy": 1449.0}}, "num_env_steps_sampled": 59000, "num_env_steps_trained": 113100, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 113100, "last_target_update_ts": 58760, "num_target_updates": 112}, "sampler_results": {"episode_reward_max": 3.7085280322004994, "episode_reward_min": -9.999776208135069, "episode_reward_mean": -1.7465276146739919, "episode_len_mean": 24.79, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.6167829780083, 0.06452686209934397, 0.0002474031005316839, 0.0002462784242103381, 0.0002505147530831422, 0.09914680651757102, 0.0002385289776678069, 0.0002475354496339937, 0.0002464095724378489, -9.999760010717418, -9.99976091241255, 0.0002481128689299723, 0.00024698174503515603, 0.4699017434290938, -9.999758918506728, 0.00024016950858959357, 0.10118447559329109, 0.0002481523294930387, 0.0002472101336014997, 3.7085280322004994, 2.987520118721134, 0.00023420199772555844, 0.00023338141661472236, 0.4696882161034375, -9.999776208135069, 0.00023273596952975336, -9.999768074294922, 0.0002404410856212612, 0.0002394122245442152, 1.6598502464420823, 0.0002257230058234307, 0.09038510619087298, 0.08184460588585195, 0.00024264076128729497, 0.00024159302993687672, 0.00022459926036646878, 0.00023357289532279448, 0.0002327567089903252, 0.0002412985893680117, 0.24075440110298899, 0.07940440620440371, 0.00022485464748426938, -9.999766162316746, 0.00023301955404175358, -8.144299325526351, 0.00024053419195891118, 0.0002454805402598257, 0.10252010126243988, 0.00023396212376958968, 0.0776883730239085, 0.0002417683674487466, 0.090557551285027, 0.0002345063464859894, 0.00023368363503778464, 0.0002422549320375552, 1.2178829229046357, 0.0002264775443751023, 0.00023551957120271353, 0.0002346897476963509, 0.00024329293325763682, 0.00024223957432936794, 0.6190846870805373, 0.33773633105004824, 0.11846002865467743, -9.999762639061096, 0.00023637770668166486, 0.00023822917715278925, 0.00023692211515304506, 0.0002357500553397077, 0.27682767889089877, -9.9997662876127, 0.00024038838699155508, 0.00023905759015832101, 0.00023786435822244857, -9.99976312383977, -9.99976423255232, 0.0002390942828514663, 0.00023777773679089408, 0.0002365972165799032, -9.999764380502397, -9.999765477511694, 0.0002393400584905662, 0.00023802081179882312, 0.00023683788253621086, -9.999764139142034, 0.00024072814050017107, 0.00023953208542619206, 0.00023821072678967153, -9.999762974976386, -9.999763955344301, 0.05267304329994453, 0.00023879526610673745, 0.046662976918888745, 0.00023673040418936022, -9.90236166423619, -9.99975897141524, 0.00023969061768025057, 0.00023849107336631695, 0.00023749758226281056, 0.00023638305866230478], "episode_lengths": [25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 24, 24, 25, 24, 24, 25, 25, 25, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.3228297080059, "mean_inference_ms": 2.1446636237691497, "mean_action_processing_ms": 0.14700012898911471, "mean_env_wait_ms": 1.6006362703879808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01180124282836914, "StateBufferConnector_ms": 0.007058858871459961, "ViewRequirementAgentConnector_ms": 0.1874394416809082}}, "episode_reward_max": 3.7085280322004994, "episode_reward_min": -9.999776208135069, "episode_reward_mean": -1.7465276146739919, "episode_len_mean": 24.79, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.6167829780083, 0.06452686209934397, 0.0002474031005316839, 0.0002462784242103381, 0.0002505147530831422, 0.09914680651757102, 0.0002385289776678069, 0.0002475354496339937, 0.0002464095724378489, -9.999760010717418, -9.99976091241255, 0.0002481128689299723, 0.00024698174503515603, 0.4699017434290938, -9.999758918506728, 0.00024016950858959357, 0.10118447559329109, 0.0002481523294930387, 0.0002472101336014997, 3.7085280322004994, 2.987520118721134, 0.00023420199772555844, 0.00023338141661472236, 0.4696882161034375, -9.999776208135069, 0.00023273596952975336, -9.999768074294922, 0.0002404410856212612, 0.0002394122245442152, 1.6598502464420823, 0.0002257230058234307, 0.09038510619087298, 0.08184460588585195, 0.00024264076128729497, 0.00024159302993687672, 0.00022459926036646878, 0.00023357289532279448, 0.0002327567089903252, 0.0002412985893680117, 0.24075440110298899, 0.07940440620440371, 0.00022485464748426938, -9.999766162316746, 0.00023301955404175358, -8.144299325526351, 0.00024053419195891118, 0.0002454805402598257, 0.10252010126243988, 0.00023396212376958968, 0.0776883730239085, 0.0002417683674487466, 0.090557551285027, 0.0002345063464859894, 0.00023368363503778464, 0.0002422549320375552, 1.2178829229046357, 0.0002264775443751023, 0.00023551957120271353, 0.0002346897476963509, 0.00024329293325763682, 0.00024223957432936794, 0.6190846870805373, 0.33773633105004824, 0.11846002865467743, -9.999762639061096, 0.00023637770668166486, 0.00023822917715278925, 0.00023692211515304506, 0.0002357500553397077, 0.27682767889089877, -9.9997662876127, 0.00024038838699155508, 0.00023905759015832101, 0.00023786435822244857, -9.99976312383977, -9.99976423255232, 0.0002390942828514663, 0.00023777773679089408, 0.0002365972165799032, -9.999764380502397, -9.999765477511694, 0.0002393400584905662, 0.00023802081179882312, 0.00023683788253621086, -9.999764139142034, 0.00024072814050017107, 0.00023953208542619206, 0.00023821072678967153, -9.999762974976386, -9.999763955344301, 0.05267304329994453, 0.00023879526610673745, 0.046662976918888745, 0.00023673040418936022, -9.90236166423619, -9.99975897141524, 0.00023969061768025057, 0.00023849107336631695, 0.00023749758226281056, 0.00023638305866230478], "episode_lengths": [25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 24, 24, 25, 24, 24, 25, 25, 25, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.3228297080059, "mean_inference_ms": 2.1446636237691497, "mean_action_processing_ms": 0.14700012898911471, "mean_env_wait_ms": 1.6006362703879808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01180124282836914, "StateBufferConnector_ms": 0.007058858871459961, "ViewRequirementAgentConnector_ms": 0.1874394416809082}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 113100, "num_env_steps_sampled": 59000, "num_env_steps_trained": 113100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5659255530760094, "num_env_steps_trained_throughput_per_sec": 6.953554828498218, "timesteps_total": 59000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 59000, "timers": {"training_iteration_time_ms": 11186.643, "sample_time_ms": 11121.948, "load_time_ms": 0.238, "load_throughput": 327712.824, "learn_time_ms": 13.255, "learn_throughput": 5884.656, "synch_weights_time_ms": 11.635}, "counters": {"num_env_steps_sampled": 59000, "num_env_steps_trained": 113100, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 113100, "last_target_update_ts": 58760, "num_target_updates": 112}, "done": false, "episodes_total": 2285, "training_iteration": 59, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-09-33", "timestamp": 1713420573, "time_this_iter_s": 280.4428358078003, "time_total_s": 14325.539313793182, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14325.539313793182, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 10.630827067669172, "ram_util_percent": 22.18696741854636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.000662998587358743, "cur_lr": 0.01}, "td_error": [1.3979967832565308, 1.4812535047531128, 1.3980015516281128, 1.4726356267929077, 1.3979967832565308, 1.3981255292892456, 1.3979969024658203, 0.9227379560470581, 1.4639286994934082, 1.397997498512268, 1.3979969024658203, 1.3979970216751099, 1.3979969024658203, 1.3979969024658203, 1.3979970216751099, 1.3979967832565308, 1.3979969024658203, 0.9227379560470581, 1.3979970216751099, 1.3979969024658203, 1.4631953239440918, 1.3979971408843994, 1.3979969024658203, 2.890896797180176, 1.3979967832565308, 1.3979969024658203, 1.3979969024658203, 1.3979970216751099, 1.4191783666610718, 0.8666238188743591, 1.3979967832565308, 1.3979969024658203, 1.3979969024658203, 1.3979967832565308, 0.9227384328842163, 1.3979967832565308, 1.3979966640472412, 1.5424511432647705, 1.3979967832565308, 1.3979970216751099, 1.3979977369308472, 1.3979976177215576, 0.922737717628479, 1.3979969024658203, 1.3980293273925781, 1.3979970216751099, 1.3979970216751099, 1.463596224784851, 1.3979969024658203, 1.3979967832565308, 2.8899919986724854, 0.9227350950241089, 1.3979967832565308, 1.3979969024658203, 1.3979966640472412, 1.3979994058609009, 0.9227384328842163, 1.3979967832565308, 1.3979969024658203, 1.3979969024658203, 1.3979969024658203, 0.9227374792098999, 1.3979969024658203, 1.6351888179779053, 0.9227371215820312, 1.3979967832565308, 1.3979967832565308, 1.4815040826797485, 2.2335197925567627, 1.3979970216751099, 1.4117369651794434, 1.3979979753494263, 1.397997260093689, 1.4635686874389648, 1.3979966640472412, 2.1148126125335693, 2.1259560585021973, 1.4636443853378296], "mean_td_error": 1.4225845336914062, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1475.0, "diff_num_grad_updates_vs_sampler_policy": 1474.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 115050, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 115050, "last_target_update_ts": 59800, "num_target_updates": 114}, "sampler_results": {"episode_reward_max": 2.287292676282676, "episode_reward_min": -9.999768895030801, "episode_reward_mean": -2.3027954313173087, "episode_len_mean": 25.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.07940440620440371, 0.00022485464748426938, -9.999766162316746, 0.00023301955404175358, -8.144299325526351, 0.00024053419195891118, 0.0002454805402598257, 0.10252010126243988, 0.00023396212376958968, 0.0776883730239085, 0.0002417683674487466, 0.090557551285027, 0.0002345063464859894, 0.00023368363503778464, 0.0002422549320375552, 1.2178829229046357, 0.0002264775443751023, 0.00023551957120271353, 0.0002346897476963509, 0.00024329293325763682, 0.00024223957432936794, 0.6190846870805373, 0.33773633105004824, 0.11846002865467743, -9.999762639061096, 0.00023637770668166486, 0.00023822917715278925, 0.00023692211515304506, 0.0002357500553397077, 0.27682767889089877, -9.9997662876127, 0.00024038838699155508, 0.00023905759015832101, 0.00023786435822244857, -9.99976312383977, -9.99976423255232, 0.0002390942828514663, 0.00023777773679089408, 0.0002365972165799032, -9.999764380502397, -9.999765477511694, 0.0002393400584905662, 0.00023802081179882312, 0.00023683788253621086, -9.999764139142034, 0.00024072814050017107, 0.00023953208542619206, 0.00023821072678967153, -9.999762974976386, -9.999763955344301, 0.05267304329994453, 0.00023879526610673745, 0.046662976918888745, 0.00023673040418936022, -9.90236166423619, -9.99975897141524, 0.00023969061768025057, 0.00023849107336631695, 0.00023749758226281056, 0.00023638305866230478, 0.00023527364329771787, 0.95783528804904, 0.00023295575965368752, 0.00023165643377647324, 0.0002308155401902603, 0.0002325399449682315, -9.99976858274555, 0.00023013490121990486, 0.00022930500009990176, 0.00022854839346206165, 0.04553323039379487, 0.0002335750446557896, 0.00023226882111779124, 0.00023142348293034095, 0.00023065285744916533, 0.0002333419242078329, -9.836409005993247, -9.888767217491072, -9.428012229119883, 0.00022950304146859683, 0.00023475886203641998, 0.0002335760101200949, -9.999767556682885, -9.999768850315423, 0.0002303123755538966, -9.999765056306263, 0.4192012456261034, 0.0002326368945121386, 0.17237243594042498, 0.00023059969509821193, -9.99976551397576, -9.999766655577583, 0.00023204068335571504, -9.99976880291204, 0.00023042788166936488, 2.287292676282676, 0.00023403860848174687, 0.0002327272098398011, 0.00023187853710437915, -9.999768895030801], "episode_lengths": [25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.5817320628534, "mean_inference_ms": 2.1438820855917773, "mean_action_processing_ms": 0.1469588512913331, "mean_env_wait_ms": 1.5759055480623334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010494232177734375, "StateBufferConnector_ms": 0.0065801143646240234, "ViewRequirementAgentConnector_ms": 0.18119502067565918}}, "episode_reward_max": 2.287292676282676, "episode_reward_min": -9.999768895030801, "episode_reward_mean": -2.3027954313173087, "episode_len_mean": 25.08, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.07940440620440371, 0.00022485464748426938, -9.999766162316746, 0.00023301955404175358, -8.144299325526351, 0.00024053419195891118, 0.0002454805402598257, 0.10252010126243988, 0.00023396212376958968, 0.0776883730239085, 0.0002417683674487466, 0.090557551285027, 0.0002345063464859894, 0.00023368363503778464, 0.0002422549320375552, 1.2178829229046357, 0.0002264775443751023, 0.00023551957120271353, 0.0002346897476963509, 0.00024329293325763682, 0.00024223957432936794, 0.6190846870805373, 0.33773633105004824, 0.11846002865467743, -9.999762639061096, 0.00023637770668166486, 0.00023822917715278925, 0.00023692211515304506, 0.0002357500553397077, 0.27682767889089877, -9.9997662876127, 0.00024038838699155508, 0.00023905759015832101, 0.00023786435822244857, -9.99976312383977, -9.99976423255232, 0.0002390942828514663, 0.00023777773679089408, 0.0002365972165799032, -9.999764380502397, -9.999765477511694, 0.0002393400584905662, 0.00023802081179882312, 0.00023683788253621086, -9.999764139142034, 0.00024072814050017107, 0.00023953208542619206, 0.00023821072678967153, -9.999762974976386, -9.999763955344301, 0.05267304329994453, 0.00023879526610673745, 0.046662976918888745, 0.00023673040418936022, -9.90236166423619, -9.99975897141524, 0.00023969061768025057, 0.00023849107336631695, 0.00023749758226281056, 0.00023638305866230478, 0.00023527364329771787, 0.95783528804904, 0.00023295575965368752, 0.00023165643377647324, 0.0002308155401902603, 0.0002325399449682315, -9.99976858274555, 0.00023013490121990486, 0.00022930500009990176, 0.00022854839346206165, 0.04553323039379487, 0.0002335750446557896, 0.00023226882111779124, 0.00023142348293034095, 0.00023065285744916533, 0.0002333419242078329, -9.836409005993247, -9.888767217491072, -9.428012229119883, 0.00022950304146859683, 0.00023475886203641998, 0.0002335760101200949, -9.999767556682885, -9.999768850315423, 0.0002303123755538966, -9.999765056306263, 0.4192012456261034, 0.0002326368945121386, 0.17237243594042498, 0.00023059969509821193, -9.99976551397576, -9.999766655577583, 0.00023204068335571504, -9.99976880291204, 0.00023042788166936488, 2.287292676282676, 0.00023403860848174687, 0.0002327272098398011, 0.00023187853710437915, -9.999768895030801], "episode_lengths": [25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 23, 24, 24, 25, 25, 23, 24, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.5817320628534, "mean_inference_ms": 2.1438820855917773, "mean_action_processing_ms": 0.1469588512913331, "mean_env_wait_ms": 1.5759055480623334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010494232177734375, "StateBufferConnector_ms": 0.0065801143646240234, "ViewRequirementAgentConnector_ms": 0.18119502067565918}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 115050, "num_env_steps_sampled": 60000, "num_env_steps_trained": 115050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.249962529274384, "num_env_steps_trained_throughput_per_sec": 8.287426932085049, "timesteps_total": 60000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 9021.361, "sample_time_ms": 8960.395, "load_time_ms": 0.24, "load_throughput": 325269.151, "learn_time_ms": 12.599, "learn_throughput": 6191.183, "synch_weights_time_ms": 10.663}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 115050, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 115050, "last_target_update_ts": 59800, "num_target_updates": 114}, "done": false, "episodes_total": 2325, "training_iteration": 60, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-13-29", "timestamp": 1713420809, "time_this_iter_s": 235.3043065071106, "time_total_s": 14560.843620300293, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14560.843620300293, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 12.862686567164179, "ram_util_percent": 22.31373134328359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0030166637152433395, "cur_lr": 0.01}, "td_error": [0.9258735179901123, 1.4030402898788452, 1.4690117835998535, 1.4030423164367676, 0.9258735179901123, 1.4030427932739258, 0.9258735179901123, 1.4030410051345825, 1.4030418395996094, 1.4030407667160034, 1.4030402898788452, 1.4030486345291138, 1.4030410051345825, 1.4030418395996094, 1.468714952468872, 1.403041958808899, 0.9258735179901123, 1.4030416011810303, 1.4030412435531616, 1.4030427932739258, 1.403040885925293, 0.9258735179901123, 1.4030404090881348, 0.9258735775947571, 3.8995823860168457, 1.4032516479492188, 1.4030401706695557, 1.4030401706695557, 1.4030402898788452, 1.4030426740646362, 1.4030460119247437, 1.4030407667160034, 1.4030405282974243, 1.4030410051345825, 1.4030563831329346, 0.9258735179901123, 1.527445912361145, 1.4030407667160034, 0.9258735179901123, 1.4030427932739258, 3.1084208488464355, 1.4719570875167847, 1.4030401706695557, 1.4731110334396362, 1.403045892715454, 1.4030425548553467, 1.4030423164367676, 1.4030425548553467, 1.403041124343872, 1.4030407667160034, 1.403040885925293, 2.925250291824341, 1.4030401706695557, 1.6556203365325928, 1.4030470848083496, 1.4630285501480103, 1.468841791152954, 1.0690516233444214, 1.4030429124832153, 1.4030423164367676, 1.4030438661575317, 0.9258742332458496, 1.4030400514602661, 0.833004355430603, 2.13269305229187, 1.4030417203903198, 1.4030416011810303, 1.4030405282974243, 2.962494373321533, 1.4030410051345825, 1.4030448198318481, 1.403041124343872, 1.4630415439605713, 1.403527855873108, 1.539063811302185, 1.4030464887619019, 1.403040885925293, 1.463036298751831], "mean_td_error": 1.4523345232009888, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1500.0, "diff_num_grad_updates_vs_sampler_policy": 1499.0}}, "num_env_steps_sampled": 61000, "num_env_steps_trained": 117000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 117000, "last_target_update_ts": 60840, "num_target_updates": 116}, "sampler_results": {"episode_reward_max": 2.7834228067996705, "episode_reward_min": -9.999772731618785, "episode_reward_mean": -2.4768965939951535, "episode_len_mean": 25.26, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999764380502397, -9.999765477511694, 0.0002393400584905662, 0.00023802081179882312, 0.00023683788253621086, -9.999764139142034, 0.00024072814050017107, 0.00023953208542619206, 0.00023821072678967153, -9.999762974976386, -9.999763955344301, 0.05267304329994453, 0.00023879526610673745, 0.046662976918888745, 0.00023673040418936022, -9.90236166423619, -9.99975897141524, 0.00023969061768025057, 0.00023849107336631695, 0.00023749758226281056, 0.00023638305866230478, 0.00023527364329771787, 0.95783528804904, 0.00023295575965368752, 0.00023165643377647324, 0.0002308155401902603, 0.0002325399449682315, -9.99976858274555, 0.00023013490121990486, 0.00022930500009990176, 0.00022854839346206165, 0.04553323039379487, 0.0002335750446557896, 0.00023226882111779124, 0.00023142348293034095, 0.00023065285744916533, 0.0002333419242078329, -9.836409005993247, -9.888767217491072, -9.428012229119883, 0.00022950304146859683, 0.00023475886203641998, 0.0002335760101200949, -9.999767556682885, -9.999768850315423, 0.0002303123755538966, -9.999765056306263, 0.4192012456261034, 0.0002326368945121386, 0.17237243594042498, 0.00023059969509821193, -9.99976551397576, -9.999766655577583, 0.00023204068335571504, -9.99976880291204, 0.00023042788166936488, 2.287292676282676, 0.00023403860848174687, 0.0002327272098398011, 0.00023187853710437915, -9.999768895030801, 0.7781461068689163, 0.03772219596763742, 0.00022820902696893733, -9.999772731618785, 0.00022649903522943839, -9.99977243132032, 0.00022660360642665287, 0.00022567609983325534, 2.6360729902143505, 0.00022388308956356037, 0.11845154015192065, -9.999771254011558, 0.00022780081423214894, 0.0002270278882659656, 0.110587790870018, 0.00022758282009220805, 0.04257075926242169, -9.808626548972457, 0.00022500079253463568, -9.999770450796769, 0.00022855444127430194, 0.0002275873359674561, 0.00022665177531334867, 0.1355114642438966, 0.47842553707539903, 2.7834228067996705, 0.0002278825676826956, 0.00022694458312129984, 0.053961790035806645, 0.00022942559035823819, 0.00022845111411750766, -9.999772491464517, 0.0002267375061404935, 0.00022568423663784422, 0.00023009670683505075, -9.999770883383063, 0.00022816838371237234, -9.999772606951135, 0.00022633361272572392], "episode_lengths": [26, 26, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.66869856321705, "mean_inference_ms": 2.1429589187824702, "mean_action_processing_ms": 0.1469291748803068, "mean_env_wait_ms": 1.5515176777613988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010513782501220703, "StateBufferConnector_ms": 0.006558656692504883, "ViewRequirementAgentConnector_ms": 0.1764979362487793}}, "episode_reward_max": 2.7834228067996705, "episode_reward_min": -9.999772731618785, "episode_reward_mean": -2.4768965939951535, "episode_len_mean": 25.26, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999764380502397, -9.999765477511694, 0.0002393400584905662, 0.00023802081179882312, 0.00023683788253621086, -9.999764139142034, 0.00024072814050017107, 0.00023953208542619206, 0.00023821072678967153, -9.999762974976386, -9.999763955344301, 0.05267304329994453, 0.00023879526610673745, 0.046662976918888745, 0.00023673040418936022, -9.90236166423619, -9.99975897141524, 0.00023969061768025057, 0.00023849107336631695, 0.00023749758226281056, 0.00023638305866230478, 0.00023527364329771787, 0.95783528804904, 0.00023295575965368752, 0.00023165643377647324, 0.0002308155401902603, 0.0002325399449682315, -9.99976858274555, 0.00023013490121990486, 0.00022930500009990176, 0.00022854839346206165, 0.04553323039379487, 0.0002335750446557896, 0.00023226882111779124, 0.00023142348293034095, 0.00023065285744916533, 0.0002333419242078329, -9.836409005993247, -9.888767217491072, -9.428012229119883, 0.00022950304146859683, 0.00023475886203641998, 0.0002335760101200949, -9.999767556682885, -9.999768850315423, 0.0002303123755538966, -9.999765056306263, 0.4192012456261034, 0.0002326368945121386, 0.17237243594042498, 0.00023059969509821193, -9.99976551397576, -9.999766655577583, 0.00023204068335571504, -9.99976880291204, 0.00023042788166936488, 2.287292676282676, 0.00023403860848174687, 0.0002327272098398011, 0.00023187853710437915, -9.999768895030801, 0.7781461068689163, 0.03772219596763742, 0.00022820902696893733, -9.999772731618785, 0.00022649903522943839, -9.99977243132032, 0.00022660360642665287, 0.00022567609983325534, 2.6360729902143505, 0.00022388308956356037, 0.11845154015192065, -9.999771254011558, 0.00022780081423214894, 0.0002270278882659656, 0.110587790870018, 0.00022758282009220805, 0.04257075926242169, -9.808626548972457, 0.00022500079253463568, -9.999770450796769, 0.00022855444127430194, 0.0002275873359674561, 0.00022665177531334867, 0.1355114642438966, 0.47842553707539903, 2.7834228067996705, 0.0002278825676826956, 0.00022694458312129984, 0.053961790035806645, 0.00022942559035823819, 0.00022845111411750766, -9.999772491464517, 0.0002267375061404935, 0.00022568423663784422, 0.00023009670683505075, -9.999770883383063, 0.00022816838371237234, -9.999772606951135, 0.00022633361272572392], "episode_lengths": [26, 26, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.66869856321705, "mean_inference_ms": 2.1429589187824702, "mean_action_processing_ms": 0.1469291748803068, "mean_env_wait_ms": 1.5515176777613988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010513782501220703, "StateBufferConnector_ms": 0.006558656692504883, "ViewRequirementAgentConnector_ms": 0.1764979362487793}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 117000, "num_env_steps_sampled": 61000, "num_env_steps_trained": 117000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.4296502923538945, "num_env_steps_trained_throughput_per_sec": 8.637818070090095, "timesteps_total": 61000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 61000, "timers": {"training_iteration_time_ms": 9075.966, "sample_time_ms": 9011.19, "load_time_ms": 0.258, "load_throughput": 302389.973, "learn_time_ms": 13.445, "learn_throughput": 5801.364, "synch_weights_time_ms": 10.731}, "counters": {"num_env_steps_sampled": 61000, "num_env_steps_trained": 117000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 117000, "last_target_update_ts": 60840, "num_target_updates": 116}, "done": false, "episodes_total": 2364, "training_iteration": 61, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-17-14", "timestamp": 1713421034, "time_this_iter_s": 225.76281929016113, "time_total_s": 14786.606439590454, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14786.606439590454, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 13.052024922118383, "ram_util_percent": 22.43582554517134}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.049104537814855576, "cur_lr": 0.01}, "td_error": [1.3516051769256592, 1.5658994913101196, 1.3516013622283936, 1.3516018390655518, 1.351601481437683, 1.3516062498092651, 1.4261573553085327, 1.3516020774841309, 1.3516041040420532, 0.8851410150527954, 1.3516063690185547, 1.3516135215759277, 0.8851478099822998, 1.3516263961791992, 1.3516063690185547, 1.351602554321289, 1.351611852645874, 1.3516041040420532, 1.351601243019104, 1.6927344799041748, 1.351605772972107, 1.351630449295044, 1.5681849718093872, 2.1660025119781494, 1.3522024154663086, 1.351605772972107, 1.3516218662261963, 1.3516037464141846, 1.3520570993423462, 1.351602554321289, 1.351606845855713, 1.4262062311172485, 1.3516031503677368, 1.3516030311584473, 1.3516038656234741, 1.3516016006469727, 1.3516048192977905, 1.3516041040420532, 1.3516037464141846, 1.3516168594360352, 1.3516011238098145, 1.4614033699035645, 1.3516087532043457, 1.3516168594360352, 1.3516054153442383, 0.8851792812347412, 1.3516026735305786, 1.4267760515213013, 1.3516043424606323, 1.3516093492507935, 1.445067286491394, 1.3516052961349487, 1.351607322692871, 1.3516041040420532, 1.35160493850708, 1.351609706878662, 0.8851405382156372, 1.3516126871109009, 0.8852183222770691, 1.3516054153442383, 1.3516019582748413, 3.008760690689087, 1.3516077995300293, 0.8157362341880798, 1.4444968700408936, 1.3516069650650024, 1.351604700088501, 1.0741639137268066, 1.4531080722808838, 1.3516031503677368, 1.35160493850708, 0.885144054889679, 1.35160231590271, 1.351728081703186, 1.3516089916229248, 1.089077115058899, 1.3516016006469727, 0.8851404190063477], "mean_td_error": 1.3455259799957275, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1525.0, "diff_num_grad_updates_vs_sampler_policy": 1524.0}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 118950, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 118950, "last_target_update_ts": 61880, "num_target_updates": 118}, "sampler_results": {"episode_reward_max": 2.7834228067996705, "episode_reward_min": -19.99977725867921, "episode_reward_mean": -2.366088738844191, "episode_len_mean": 25.17, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00022950304146859683, 0.00023475886203641998, 0.0002335760101200949, -9.999767556682885, -9.999768850315423, 0.0002303123755538966, -9.999765056306263, 0.4192012456261034, 0.0002326368945121386, 0.17237243594042498, 0.00023059969509821193, -9.99976551397576, -9.999766655577583, 0.00023204068335571504, -9.99976880291204, 0.00023042788166936488, 2.287292676282676, 0.00023403860848174687, 0.0002327272098398011, 0.00023187853710437915, -9.999768895030801, 0.7781461068689163, 0.03772219596763742, 0.00022820902696893733, -9.999772731618785, 0.00022649903522943839, -9.99977243132032, 0.00022660360642665287, 0.00022567609983325534, 2.6360729902143505, 0.00022388308956356037, 0.11845154015192065, -9.999771254011558, 0.00022780081423214894, 0.0002270278882659656, 0.110587790870018, 0.00022758282009220805, 0.04257075926242169, -9.808626548972457, 0.00022500079253463568, -9.999770450796769, 0.00022855444127430194, 0.0002275873359674561, 0.00022665177531334867, 0.1355114642438966, 0.47842553707539903, 2.7834228067996705, 0.0002278825676826956, 0.00022694458312129984, 0.053961790035806645, 0.00022942559035823819, 0.00022845111411750766, -9.999772491464517, 0.0002267375061404935, 0.00022568423663784422, 0.00023009670683505075, -9.999770883383063, 0.00022816838371237234, -9.999772606951135, 0.00022633361272572392, 0.5152689643792532, 0.00022435809585158402, 0.0002234973545317836, -19.99977725867921, -9.999786931123706, 0.00022279710237615665, 0.08688538463898914, 0.5060060754657574, -9.999788324380923, 0.00021974881360507272, -9.999774027992153, 0.13551048453678602, 0.0002240331173390185, -9.999776726618983, 0.045650555657298454, 0.00022390396063613592, 0.0002230466938792742, 0.00022229354295035198, 0.0002126421399520142, 0.053620301313136505, 0.00022487357926065412, -9.897246091296278, 0.00022296502080740736, 0.1579935169697453, -9.457228321001644, 0.00022523016065389607, 0.0002241310966390899, 0.00022327209295259048, 0.00022251742160153253, 0.3009393715057543, 0.046273376351710714, 0.2239580636721931, -9.890192102863045, 0.3022577536245509, 0.00022174204813932757, 0.00022522377880478724, 0.00022435639480151664, -9.999776405532263, 0.0002138820508023889, 0.00022203164218704375], "episode_lengths": [25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.85877890117376, "mean_inference_ms": 2.141834437247886, "mean_action_processing_ms": 0.14684002945773428, "mean_env_wait_ms": 1.5280412080375505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010563373565673828, "StateBufferConnector_ms": 0.006546974182128906, "ViewRequirementAgentConnector_ms": 0.17866063117980957}}, "episode_reward_max": 2.7834228067996705, "episode_reward_min": -19.99977725867921, "episode_reward_mean": -2.366088738844191, "episode_len_mean": 25.17, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00022950304146859683, 0.00023475886203641998, 0.0002335760101200949, -9.999767556682885, -9.999768850315423, 0.0002303123755538966, -9.999765056306263, 0.4192012456261034, 0.0002326368945121386, 0.17237243594042498, 0.00023059969509821193, -9.99976551397576, -9.999766655577583, 0.00023204068335571504, -9.99976880291204, 0.00023042788166936488, 2.287292676282676, 0.00023403860848174687, 0.0002327272098398011, 0.00023187853710437915, -9.999768895030801, 0.7781461068689163, 0.03772219596763742, 0.00022820902696893733, -9.999772731618785, 0.00022649903522943839, -9.99977243132032, 0.00022660360642665287, 0.00022567609983325534, 2.6360729902143505, 0.00022388308956356037, 0.11845154015192065, -9.999771254011558, 0.00022780081423214894, 0.0002270278882659656, 0.110587790870018, 0.00022758282009220805, 0.04257075926242169, -9.808626548972457, 0.00022500079253463568, -9.999770450796769, 0.00022855444127430194, 0.0002275873359674561, 0.00022665177531334867, 0.1355114642438966, 0.47842553707539903, 2.7834228067996705, 0.0002278825676826956, 0.00022694458312129984, 0.053961790035806645, 0.00022942559035823819, 0.00022845111411750766, -9.999772491464517, 0.0002267375061404935, 0.00022568423663784422, 0.00023009670683505075, -9.999770883383063, 0.00022816838371237234, -9.999772606951135, 0.00022633361272572392, 0.5152689643792532, 0.00022435809585158402, 0.0002234973545317836, -19.99977725867921, -9.999786931123706, 0.00022279710237615665, 0.08688538463898914, 0.5060060754657574, -9.999788324380923, 0.00021974881360507272, -9.999774027992153, 0.13551048453678602, 0.0002240331173390185, -9.999776726618983, 0.045650555657298454, 0.00022390396063613592, 0.0002230466938792742, 0.00022229354295035198, 0.0002126421399520142, 0.053620301313136505, 0.00022487357926065412, -9.897246091296278, 0.00022296502080740736, 0.1579935169697453, -9.457228321001644, 0.00022523016065389607, 0.0002241310966390899, 0.00022327209295259048, 0.00022251742160153253, 0.3009393715057543, 0.046273376351710714, 0.2239580636721931, -9.890192102863045, 0.3022577536245509, 0.00022174204813932757, 0.00022522377880478724, 0.00022435639480151664, -9.999776405532263, 0.0002138820508023889, 0.00022203164218704375], "episode_lengths": [25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.85877890117376, "mean_inference_ms": 2.141834437247886, "mean_action_processing_ms": 0.14684002945773428, "mean_env_wait_ms": 1.5280412080375505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010563373565673828, "StateBufferConnector_ms": 0.006546974182128906, "ViewRequirementAgentConnector_ms": 0.17866063117980957}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 118950, "num_env_steps_sampled": 62000, "num_env_steps_trained": 118950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.236189702706393, "num_env_steps_trained_throughput_per_sec": 8.260569920277467, "timesteps_total": 62000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 8945.188, "sample_time_ms": 8882.711, "load_time_ms": 0.234, "load_throughput": 333696.157, "learn_time_ms": 12.715, "learn_throughput": 6134.484, "synch_weights_time_ms": 12.234}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 118950, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 118950, "last_target_update_ts": 61880, "num_target_updates": 118}, "done": false, "episodes_total": 2404, "training_iteration": 62, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-21-11", "timestamp": 1713421271, "time_this_iter_s": 236.0691192150116, "time_total_s": 15022.675558805466, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15022.675558805466, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 12.832738095238096, "ram_util_percent": 22.591666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.07473533600568771, "cur_lr": 0.01}, "td_error": [1.3793022632598877, 0.927065908908844, 0.9270603656768799, 0.9270584583282471, 0.9270583391189575, 1.379299521446228, 1.3792972564697266, 1.3793153762817383, 0.819383978843689, 1.3792988061904907, 1.3793045282363892, 1.3792977333068848, 1.3793022632598877, 1.3793004751205444, 0.8236109018325806, 1.3792978525161743, 1.3792965412139893, 1.379298210144043, 1.379300594329834, 1.3795057535171509, 0.927067756652832, 1.3793363571166992, 0.9270713925361633, 1.3792974948883057, 1.3792983293533325, 1.3792967796325684, 1.3793030977249146, 1.3793050050735474, 1.3793013095855713, 1.3793452978134155, 1.3793001174926758, 1.379299521446228, 1.3793238401412964, 1.3792972564697266, 1.3793007135391235, 1.3793009519577026, 0.9270577430725098, 1.3793128728866577, 1.3793147802352905, 1.3793023824691772, 1.379296898841858, 1.379300594329834, 1.379298448562622, 1.3793004751205444, 1.3793085813522339, 1.3793081045150757, 1.4345276355743408, 1.3793007135391235, 1.3792970180511475, 1.37930166721344, 1.3792997598648071, 1.379298210144043, 1.433409571647644, 0.927058219909668, 1.3792978525161743, 1.3792973756790161, 1.379299283027649, 1.3792965412139893, 1.4247596263885498, 1.3792965412139893, 1.379360318183899, 1.4178333282470703, 0.8873208165168762, 1.3793070316314697, 1.3792986869812012, 1.4360859394073486, 1.3793010711669922, 1.3793023824691772, 1.3793030977249146, 1.3792978525161743, 1.3793045282363892, 1.3793013095855713, 1.3793035745620728, 1.379306435585022, 2.7759664058685303, 1.3793013095855713, 1.3792979717254639, 1.379296898841858], "mean_td_error": 1.3334248065948486, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1550.0, "diff_num_grad_updates_vs_sampler_policy": 1549.0}}, "num_env_steps_sampled": 63000, "num_env_steps_trained": 120900, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 120900, "last_target_update_ts": 62920, "num_target_updates": 120}, "sampler_results": {"episode_reward_max": 2.7834228067996705, "episode_reward_min": -19.99977725867921, "episode_reward_mean": -1.79448359978407, "episode_len_mean": 25.07, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999770450796769, 0.00022855444127430194, 0.0002275873359674561, 0.00022665177531334867, 0.1355114642438966, 0.47842553707539903, 2.7834228067996705, 0.0002278825676826956, 0.00022694458312129984, 0.053961790035806645, 0.00022942559035823819, 0.00022845111411750766, -9.999772491464517, 0.0002267375061404935, 0.00022568423663784422, 0.00023009670683505075, -9.999770883383063, 0.00022816838371237234, -9.999772606951135, 0.00022633361272572392, 0.5152689643792532, 0.00022435809585158402, 0.0002234973545317836, -19.99977725867921, -9.999786931123706, 0.00022279710237615665, 0.08688538463898914, 0.5060060754657574, -9.999788324380923, 0.00021974881360507272, -9.999774027992153, 0.13551048453678602, 0.0002240331173390185, -9.999776726618983, 0.045650555657298454, 0.00022390396063613592, 0.0002230466938792742, 0.00022229354295035198, 0.0002126421399520142, 0.053620301313136505, 0.00022487357926065412, -9.897246091296278, 0.00022296502080740736, 0.1579935169697453, -9.457228321001644, 0.00022523016065389607, 0.0002241310966390899, 0.00022327209295259048, 0.00022251742160153253, 0.3009393715057543, 0.046273376351710714, 0.2239580636721931, -9.890192102863045, 0.3022577536245509, 0.00022174204813932757, 0.00022522377880478724, 0.00022435639480151664, -9.999776405532263, 0.0002138820508023889, 0.00022203164218704375, 0.0002211902787993599, 0.00022042086186892113, 0.000219495405086022, 0.0002184837659704245, -9.999782194439394, 0.00021898937466297458, 0.00021807587438441007, 0.2407321272054792, 0.0002164261346476224, 0.00020711304353173603, 0.4048478790391472, 0.00022107598781149983, 0.00022014503326502283, 0.07782960934593063, 0.00021850246805147364, 0.00022007454081531032, 0.00021915198377961837, 0.00021814350046806135, 0.0002174666768024651, -9.999791894273132, 0.00022074193178513586, 0.0002199756253170561, 0.0002190538956692507, 0.08311327492215681, -9.999782567421123, 0.00022098933934481513, 0.00022022131723271985, -9.999780702391611, 0.00021828771159299902, 0.00021760999398461874, 2.4355148655756134, -9.999779959310704, 0.0002190239526787171, 0.5400839413364713, 0.0002089436013949214, 0.1718965964552148, 0.00022034934681951853, 0.00021932983929996735, 0.00021864564421313258, 0.00020923027174838906], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.1332272842785, "mean_inference_ms": 2.141933694206451, "mean_action_processing_ms": 0.14679885677378365, "mean_env_wait_ms": 1.5053751270428373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010778665542602539, "StateBufferConnector_ms": 0.006663799285888672, "ViewRequirementAgentConnector_ms": 0.18195605278015137}}, "episode_reward_max": 2.7834228067996705, "episode_reward_min": -19.99977725867921, "episode_reward_mean": -1.79448359978407, "episode_len_mean": 25.07, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999770450796769, 0.00022855444127430194, 0.0002275873359674561, 0.00022665177531334867, 0.1355114642438966, 0.47842553707539903, 2.7834228067996705, 0.0002278825676826956, 0.00022694458312129984, 0.053961790035806645, 0.00022942559035823819, 0.00022845111411750766, -9.999772491464517, 0.0002267375061404935, 0.00022568423663784422, 0.00023009670683505075, -9.999770883383063, 0.00022816838371237234, -9.999772606951135, 0.00022633361272572392, 0.5152689643792532, 0.00022435809585158402, 0.0002234973545317836, -19.99977725867921, -9.999786931123706, 0.00022279710237615665, 0.08688538463898914, 0.5060060754657574, -9.999788324380923, 0.00021974881360507272, -9.999774027992153, 0.13551048453678602, 0.0002240331173390185, -9.999776726618983, 0.045650555657298454, 0.00022390396063613592, 0.0002230466938792742, 0.00022229354295035198, 0.0002126421399520142, 0.053620301313136505, 0.00022487357926065412, -9.897246091296278, 0.00022296502080740736, 0.1579935169697453, -9.457228321001644, 0.00022523016065389607, 0.0002241310966390899, 0.00022327209295259048, 0.00022251742160153253, 0.3009393715057543, 0.046273376351710714, 0.2239580636721931, -9.890192102863045, 0.3022577536245509, 0.00022174204813932757, 0.00022522377880478724, 0.00022435639480151664, -9.999776405532263, 0.0002138820508023889, 0.00022203164218704375, 0.0002211902787993599, 0.00022042086186892113, 0.000219495405086022, 0.0002184837659704245, -9.999782194439394, 0.00021898937466297458, 0.00021807587438441007, 0.2407321272054792, 0.0002164261346476224, 0.00020711304353173603, 0.4048478790391472, 0.00022107598781149983, 0.00022014503326502283, 0.07782960934593063, 0.00021850246805147364, 0.00022007454081531032, 0.00021915198377961837, 0.00021814350046806135, 0.0002174666768024651, -9.999791894273132, 0.00022074193178513586, 0.0002199756253170561, 0.0002190538956692507, 0.08311327492215681, -9.999782567421123, 0.00022098933934481513, 0.00022022131723271985, -9.999780702391611, 0.00021828771159299902, 0.00021760999398461874, 2.4355148655756134, -9.999779959310704, 0.0002190239526787171, 0.5400839413364713, 0.0002089436013949214, 0.1718965964552148, 0.00022034934681951853, 0.00021932983929996735, 0.00021864564421313258, 0.00020923027174838906], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.1332272842785, "mean_inference_ms": 2.141933694206451, "mean_action_processing_ms": 0.14679885677378365, "mean_env_wait_ms": 1.5053751270428373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010778665542602539, "StateBufferConnector_ms": 0.006663799285888672, "ViewRequirementAgentConnector_ms": 0.18195605278015137}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 120900, "num_env_steps_sampled": 63000, "num_env_steps_trained": 120900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.407244954032189, "num_env_steps_trained_throughput_per_sec": 8.59412766036277, "timesteps_total": 63000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 63000, "timers": {"training_iteration_time_ms": 9038.641, "sample_time_ms": 8974.098, "load_time_ms": 0.235, "load_throughput": 332205.232, "learn_time_ms": 13.83, "learn_throughput": 5639.731, "synch_weights_time_ms": 11.527}, "counters": {"num_env_steps_sampled": 63000, "num_env_steps_trained": 120900, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 120900, "last_target_update_ts": 62920, "num_target_updates": 120}, "done": false, "episodes_total": 2444, "training_iteration": 63, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-24-57", "timestamp": 1713421497, "time_this_iter_s": 226.9067509174347, "time_total_s": 15249.5823097229, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15249.5823097229, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 13.360061919504645, "ram_util_percent": 22.71393188854489}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.032485898584127426, "cur_lr": 0.01}, "td_error": [0.7781147956848145, 1.3513426780700684, 1.351343035697937, 1.3513425588607788, 1.351342797279358, 1.3513432741165161, 1.3513526916503906, 0.9027618169784546, 1.351343035697937, 0.9027618765830994, 1.3513425588607788, 1.3513431549072266, 1.3513438701629639, 1.3513445854187012, 1.351342797279358, 1.3513431549072266, 1.4288396835327148, 1.351345181465149, 1.3513431549072266, 1.3513681888580322, 1.3513433933258057, 1.3513424396514893, 1.3513425588607788, 0.3387187421321869, 1.3513424396514893, 1.3513469696044922, 1.3513431549072266, 0.9027618765830994, 1.3513426780700684, 1.3989275693893433, 0.9027619361877441, 1.3949673175811768, 1.3513495922088623, 0.9027618765830994, 1.3513439893722534, 1.3513431549072266, 1.3513425588607788, 1.351343035697937, 1.351344347000122, 1.3513433933258057, 1.3513429164886475, 1.3513431549072266, 1.3513432741165161, 1.351342797279358, 1.3948078155517578, 1.3513431549072266, 1.3513431549072266, 1.3513424396514893, 1.3513437509536743, 1.3944698572158813, 1.3513531684875488, 1.4048229455947876, 1.3513431549072266, 0.9027618169784546, 1.351348876953125, 1.7987143993377686, 1.3513433933258057, 1.3513482809066772, 0.9027618169784546, 1.3513472080230713, 1.3513433933258057, 1.3513426780700684, 1.351342797279358, 1.3942333459854126, 1.3513433933258057, 1.3513449430465698, 2.2649426460266113, 1.3513433933258057, 1.3513433933258057, 1.3513456583023071, 1.3513426780700684, 1.351343035697937, 0.9027618169784546, 1.351345181465149, 1.3513438701629639, 0.9027619361877441, 1.3513432741165161, 1.3513431549072266], "mean_td_error": 1.3012102842330933, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1575.0, "diff_num_grad_updates_vs_sampler_policy": 1574.0}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 122850, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 122850, "last_target_update_ts": 63960, "num_target_updates": 122}, "sampler_results": {"episode_reward_max": 4.046553693930587, "episode_reward_min": -9.999791894273132, "episode_reward_mean": -0.9190626701137026, "episode_len_mean": 24.99, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00022487357926065412, -9.897246091296278, 0.00022296502080740736, 0.1579935169697453, -9.457228321001644, 0.00022523016065389607, 0.0002241310966390899, 0.00022327209295259048, 0.00022251742160153253, 0.3009393715057543, 0.046273376351710714, 0.2239580636721931, -9.890192102863045, 0.3022577536245509, 0.00022174204813932757, 0.00022522377880478724, 0.00022435639480151664, -9.999776405532263, 0.0002138820508023889, 0.00022203164218704375, 0.0002211902787993599, 0.00022042086186892113, 0.000219495405086022, 0.0002184837659704245, -9.999782194439394, 0.00021898937466297458, 0.00021807587438441007, 0.2407321272054792, 0.0002164261346476224, 0.00020711304353173603, 0.4048478790391472, 0.00022107598781149983, 0.00022014503326502283, 0.07782960934593063, 0.00021850246805147364, 0.00022007454081531032, 0.00021915198377961837, 0.00021814350046806135, 0.0002174666768024651, -9.999791894273132, 0.00022074193178513586, 0.0002199756253170561, 0.0002190538956692507, 0.08311327492215681, -9.999782567421123, 0.00022098933934481513, 0.00022022131723271985, -9.999780702391611, 0.00021828771159299902, 0.00021760999398461874, 2.4355148655756134, -9.999779959310704, 0.0002190239526787171, 0.5400839413364713, 0.0002089436013949214, 0.1718965964552148, 0.00022034934681951853, 0.00021932983929996735, 0.00021864564421313258, 0.00020923027174838906, 0.00020842822279158548, 0.09305237120053303, 0.7353926274770654, 0.00021475362104239338, 0.0002141124639723694, 0.00021480888373629124, 0.0002140325016950524, 0.00021327133935171495, 0.649618193973435, 0.0002120039164471587, 2.0225115343225757, 0.1902806548666766, -9.958603365894266, 0.0787650352743778, 0.00021488750416738533, 0.06750403500888226, 0.00021511591625186693, -9.999785651254916, 0.000213708308196101, 4.046553693930587, 0.00020807243236504642, 0.07428484798075602, 1.6237416121294623, 0.00021430367031035304, 0.03972323419581056, 1.855668333721878, 0.00021597743594845465, 0.00021519259871941113, 0.00021442317823062242, 0.00021378399018695638, 0.0002166991703302549, 0.8190337124442252, 0.00021514158839090953, 0.0002144981156654876, 0.00021384870157606852, 0.0002169951812674312, 0.000216202942852309, 0.00021542629406947196, 0.0002147811193765837, 0.00021412999324222913], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.3994431767192, "mean_inference_ms": 2.141804462602974, "mean_action_processing_ms": 0.14675822596859664, "mean_env_wait_ms": 1.4834557230620549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01091766357421875, "StateBufferConnector_ms": 0.006511211395263672, "ViewRequirementAgentConnector_ms": 0.17955422401428223}}, "episode_reward_max": 4.046553693930587, "episode_reward_min": -9.999791894273132, "episode_reward_mean": -0.9190626701137026, "episode_len_mean": 24.99, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00022487357926065412, -9.897246091296278, 0.00022296502080740736, 0.1579935169697453, -9.457228321001644, 0.00022523016065389607, 0.0002241310966390899, 0.00022327209295259048, 0.00022251742160153253, 0.3009393715057543, 0.046273376351710714, 0.2239580636721931, -9.890192102863045, 0.3022577536245509, 0.00022174204813932757, 0.00022522377880478724, 0.00022435639480151664, -9.999776405532263, 0.0002138820508023889, 0.00022203164218704375, 0.0002211902787993599, 0.00022042086186892113, 0.000219495405086022, 0.0002184837659704245, -9.999782194439394, 0.00021898937466297458, 0.00021807587438441007, 0.2407321272054792, 0.0002164261346476224, 0.00020711304353173603, 0.4048478790391472, 0.00022107598781149983, 0.00022014503326502283, 0.07782960934593063, 0.00021850246805147364, 0.00022007454081531032, 0.00021915198377961837, 0.00021814350046806135, 0.0002174666768024651, -9.999791894273132, 0.00022074193178513586, 0.0002199756253170561, 0.0002190538956692507, 0.08311327492215681, -9.999782567421123, 0.00022098933934481513, 0.00022022131723271985, -9.999780702391611, 0.00021828771159299902, 0.00021760999398461874, 2.4355148655756134, -9.999779959310704, 0.0002190239526787171, 0.5400839413364713, 0.0002089436013949214, 0.1718965964552148, 0.00022034934681951853, 0.00021932983929996735, 0.00021864564421313258, 0.00020923027174838906, 0.00020842822279158548, 0.09305237120053303, 0.7353926274770654, 0.00021475362104239338, 0.0002141124639723694, 0.00021480888373629124, 0.0002140325016950524, 0.00021327133935171495, 0.649618193973435, 0.0002120039164471587, 2.0225115343225757, 0.1902806548666766, -9.958603365894266, 0.0787650352743778, 0.00021488750416738533, 0.06750403500888226, 0.00021511591625186693, -9.999785651254916, 0.000213708308196101, 4.046553693930587, 0.00020807243236504642, 0.07428484798075602, 1.6237416121294623, 0.00021430367031035304, 0.03972323419581056, 1.855668333721878, 0.00021597743594845465, 0.00021519259871941113, 0.00021442317823062242, 0.00021378399018695638, 0.0002166991703302549, 0.8190337124442252, 0.00021514158839090953, 0.0002144981156654876, 0.00021384870157606852, 0.0002169951812674312, 0.000216202942852309, 0.00021542629406947196, 0.0002147811193765837, 0.00021412999324222913], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.3994431767192, "mean_inference_ms": 2.141804462602974, "mean_action_processing_ms": 0.14675822596859664, "mean_env_wait_ms": 1.4834557230620549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01091766357421875, "StateBufferConnector_ms": 0.006511211395263672, "ViewRequirementAgentConnector_ms": 0.17955422401428223}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 122850, "num_env_steps_sampled": 64000, "num_env_steps_trained": 122850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.437200138248226, "num_env_steps_trained_throughput_per_sec": 8.652540269584042, "timesteps_total": 64000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 9000.044, "sample_time_ms": 8936.328, "load_time_ms": 0.243, "load_throughput": 320709.452, "learn_time_ms": 12.844, "learn_throughput": 6072.654, "synch_weights_time_ms": 12.83}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 122850, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 122850, "last_target_update_ts": 63960, "num_target_updates": 122}, "done": false, "episodes_total": 2484, "training_iteration": 64, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-28-43", "timestamp": 1713421723, "time_this_iter_s": 225.37805366516113, "time_total_s": 15474.960363388062, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15474.960363388062, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 13.5040625, "ram_util_percent": 22.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.05938303470611572, "cur_lr": 0.01}, "td_error": [1.3151081800460815, 1.3723177909851074, 0.856695294380188, 1.315108060836792, 1.315108060836792, 1.3151049613952637, 1.315108060836792, 0.7628291249275208, 1.3757811784744263, 3.1958603858947754, 1.3151081800460815, 5.471304893493652, 1.315108060836792, 1.3151081800460815, 1.315108299255371, 3.4243030548095703, 0.8531137704849243, 2.329097032546997, 1.3149880170822144, 1.3151084184646606, 1.3151081800460815, 1.315108299255371, 1.3151084184646606, 1.3151084184646606, 1.359755277633667, 1.3151081800460815, 0.8566968441009521, 1.315107822418213, 1.3151084184646606, 1.3151079416275024, 1.3151084184646606, 1.3151081800460815, 1.3151081800460815, 3.195859909057617, 1.3151081800460815, 1.3151084184646606, 1.3151084184646606, 0.8566964864730835, 1.3150116205215454, 1.3151074647903442, 1.315108299255371, 0.8566949367523193, 1.315108299255371, 1.3151073455810547, 1.3151081800460815, 1.3151050806045532, 1.315108299255371, 3.195861339569092, 1.3597725629806519, 1.3151081800460815, 1.3610225915908813, 0.8566954135894775, 1.3151063919067383, 1.315108299255371, 1.3151079416275024, 1.315108299255371, 1.315107822418213, 1.315108299255371, 1.3151079416275024, 0.8566950559616089, 1.3151081800460815, 1.361016869544983, 1.315108299255371, 1.3151081800460815, 1.315108060836792, 1.315108060836792, 0.7892404794692993, 1.4135650396347046, 1.315108060836792, 1.3151085376739502, 1.315108299255371, 1.3151084184646606, 1.3151079416275024, 0.8558636903762817, 1.3151077032089233, 2.1770546436309814, 0.856696605682373, 1.3151081800460815], "mean_td_error": 1.4301409721374512, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1600.0, "diff_num_grad_updates_vs_sampler_policy": 1599.0}}, "num_env_steps_sampled": 65000, "num_env_steps_trained": 124800, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 124800, "last_target_update_ts": 65000, "num_target_updates": 124}, "sampler_results": {"episode_reward_max": 5.136478184089032, "episode_reward_min": -9.999789724636768, "episode_reward_mean": -0.794004034759253, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00022074193178513586, 0.0002199756253170561, 0.0002190538956692507, 0.08311327492215681, -9.999782567421123, 0.00022098933934481513, 0.00022022131723271985, -9.999780702391611, 0.00021828771159299902, 0.00021760999398461874, 2.4355148655756134, -9.999779959310704, 0.0002190239526787171, 0.5400839413364713, 0.0002089436013949214, 0.1718965964552148, 0.00022034934681951853, 0.00021932983929996735, 0.00021864564421313258, 0.00020923027174838906, 0.00020842822279158548, 0.09305237120053303, 0.7353926274770654, 0.00021475362104239338, 0.0002141124639723694, 0.00021480888373629124, 0.0002140325016950524, 0.00021327133935171495, 0.649618193973435, 0.0002120039164471587, 2.0225115343225757, 0.1902806548666766, -9.958603365894266, 0.0787650352743778, 0.00021488750416738533, 0.06750403500888226, 0.00021511591625186693, -9.999785651254916, 0.000213708308196101, 4.046553693930587, 0.00020807243236504642, 0.07428484798075602, 1.6237416121294623, 0.00021430367031035304, 0.03972323419581056, 1.855668333721878, 0.00021597743594845465, 0.00021519259871941113, 0.00021442317823062242, 0.00021378399018695638, 0.0002166991703302549, 0.8190337124442252, 0.00021514158839090953, 0.0002144981156654876, 0.00021384870157606852, 0.0002169951812674312, 0.000216202942852309, 0.00021542629406947196, 0.0002147811193765837, 0.00021412999324222913, 1.466851853447866, 0.4416029984572484, 0.00021226278574687125, 0.00021147539040780881, -9.999789362505782, 0.00021138886814017915, 0.00021075919636179952, 0.00020998289633141913, 0.00020915669229673803, 0.00020841178006713985, 0.8857702993431089, 0.0002136118745059726, 0.07759578731525077, 0.00021224034545150495, 0.0002113963174748745, -9.999787555945128, 5.136478184089032, 1.8672680160172204, -9.580821391173368, 0.0002094509815009139, 1.91122651576487, 0.43438420567091773, 0.00021194226876080214, 0.14451696605826667, 0.000210355668901964, 0.34226241447440714, 0.00021253153605399553, 0.0002118950492950617, 0.00021111037480803495, -9.999789724636768, 0.00021322291802722192, 0.00021258229004514394, 0.00021179252691089107, 0.0002109520497991778, 0.00021019431737851353, 0.4048398846965637, -9.999787124320449, 1.4005026711897341, 0.00021124333565919712, -9.915569393436568], "episode_lengths": [25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.646663946086, "mean_inference_ms": 2.1418427501163895, "mean_action_processing_ms": 0.14673698603911917, "mean_env_wait_ms": 1.4622494510378146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010748863220214844, "StateBufferConnector_ms": 0.006710052490234375, "ViewRequirementAgentConnector_ms": 0.18120384216308594}}, "episode_reward_max": 5.136478184089032, "episode_reward_min": -9.999789724636768, "episode_reward_mean": -0.794004034759253, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00022074193178513586, 0.0002199756253170561, 0.0002190538956692507, 0.08311327492215681, -9.999782567421123, 0.00022098933934481513, 0.00022022131723271985, -9.999780702391611, 0.00021828771159299902, 0.00021760999398461874, 2.4355148655756134, -9.999779959310704, 0.0002190239526787171, 0.5400839413364713, 0.0002089436013949214, 0.1718965964552148, 0.00022034934681951853, 0.00021932983929996735, 0.00021864564421313258, 0.00020923027174838906, 0.00020842822279158548, 0.09305237120053303, 0.7353926274770654, 0.00021475362104239338, 0.0002141124639723694, 0.00021480888373629124, 0.0002140325016950524, 0.00021327133935171495, 0.649618193973435, 0.0002120039164471587, 2.0225115343225757, 0.1902806548666766, -9.958603365894266, 0.0787650352743778, 0.00021488750416738533, 0.06750403500888226, 0.00021511591625186693, -9.999785651254916, 0.000213708308196101, 4.046553693930587, 0.00020807243236504642, 0.07428484798075602, 1.6237416121294623, 0.00021430367031035304, 0.03972323419581056, 1.855668333721878, 0.00021597743594845465, 0.00021519259871941113, 0.00021442317823062242, 0.00021378399018695638, 0.0002166991703302549, 0.8190337124442252, 0.00021514158839090953, 0.0002144981156654876, 0.00021384870157606852, 0.0002169951812674312, 0.000216202942852309, 0.00021542629406947196, 0.0002147811193765837, 0.00021412999324222913, 1.466851853447866, 0.4416029984572484, 0.00021226278574687125, 0.00021147539040780881, -9.999789362505782, 0.00021138886814017915, 0.00021075919636179952, 0.00020998289633141913, 0.00020915669229673803, 0.00020841178006713985, 0.8857702993431089, 0.0002136118745059726, 0.07759578731525077, 0.00021224034545150495, 0.0002113963174748745, -9.999787555945128, 5.136478184089032, 1.8672680160172204, -9.580821391173368, 0.0002094509815009139, 1.91122651576487, 0.43438420567091773, 0.00021194226876080214, 0.14451696605826667, 0.000210355668901964, 0.34226241447440714, 0.00021253153605399553, 0.0002118950492950617, 0.00021111037480803495, -9.999789724636768, 0.00021322291802722192, 0.00021258229004514394, 0.00021179252691089107, 0.0002109520497991778, 0.00021019431737851353, 0.4048398846965637, -9.999787124320449, 1.4005026711897341, 0.00021124333565919712, -9.915569393436568], "episode_lengths": [25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.646663946086, "mean_inference_ms": 2.1418427501163895, "mean_action_processing_ms": 0.14673698603911917, "mean_env_wait_ms": 1.4622494510378146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010748863220214844, "StateBufferConnector_ms": 0.006710052490234375, "ViewRequirementAgentConnector_ms": 0.18120384216308594}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 124800, "num_env_steps_sampled": 65000, "num_env_steps_trained": 124800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.051636871133534, "num_env_steps_trained_throughput_per_sec": 7.900691898710392, "timesteps_total": 65000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 65000, "timers": {"training_iteration_time_ms": 11301.936, "sample_time_ms": 11236.904, "load_time_ms": 0.245, "load_throughput": 318244.856, "learn_time_ms": 13.267, "learn_throughput": 5879.327, "synch_weights_time_ms": 11.517}, "counters": {"num_env_steps_sampled": 65000, "num_env_steps_trained": 124800, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 124800, "last_target_update_ts": 65000, "num_target_updates": 124}, "done": false, "episodes_total": 2524, "training_iteration": 65, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-32-50", "timestamp": 1713421970, "time_this_iter_s": 246.82274913787842, "time_total_s": 15721.78311252594, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15721.78311252594, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 12.284375, "ram_util_percent": 22.99403409090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03370999917387962, "cur_lr": 0.01}, "td_error": [1.2528021335601807, 1.252805471420288, 1.4344987869262695, 1.2528058290481567, 1.2528045177459717, 1.2528042793273926, 1.2527999877929688, 1.2729558944702148, 1.2528038024902344, 0.8536404967308044, 1.2527968883514404, 1.250611662864685, 0.8536431193351746, 1.2528053522109985, 1.2527952194213867, 1.2528016567230225, 1.2736341953277588, 1.2528053522109985, 1.2528055906295776, 1.252803087234497, 1.2528045177459717, 1.2528035640716553, 1.2528045177459717, 0.8536444902420044, 1.2527995109558105, 1.2528042793273926, 1.2528042793273926, 1.2528024911880493, 1.2503021955490112, 1.2528027296066284, 1.2528012990951538, 1.2527974843978882, 1.2527984380722046, 1.2528049945831299, 1.2528018951416016, 1.252803921699524, 1.2528034448623657, 1.2527943849563599, 1.2528038024902344, 1.252803087234497, 1.2528061866760254, 1.272598385810852, 1.2520835399627686, 1.2528059482574463, 1.2528035640716553, 1.252761721611023, 1.2527981996536255, 1.2528021335601807, 1.2892810106277466, 1.2528040409088135, 0.8536438941955566, 1.288822889328003, 1.3543790578842163, 1.2527955770492554, 1.2527860403060913, 2.8425142765045166, 1.2528024911880493, 1.2528027296066284, 1.2528040409088135, 1.2888518571853638, 0.8536419868469238, 1.2528060674667358, 1.2528055906295776, 1.2528045177459717, 1.252804160118103, 0.9540047645568848, 1.273097038269043, 1.2528055906295776, 1.2528036832809448, 1.252801537513733, 0.8536434173583984, 1.252800703048706, 1.2528029680252075, 3.3365471363067627, 1.314060926437378, 1.2528055906295776, 1.2528024911880493, 1.2889683246612549], "mean_td_error": 1.2726047039031982, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1625.0, "diff_num_grad_updates_vs_sampler_policy": 1624.0}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 126750, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 126750, "last_target_update_ts": 65520, "num_target_updates": 125}, "sampler_results": {"episode_reward_max": 5.136478184089032, "episode_reward_min": -9.99979461529266, "episode_reward_mean": -0.9606420083618862, "episode_len_mean": 25.02, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00020807243236504642, 0.07428484798075602, 1.6237416121294623, 0.00021430367031035304, 0.03972323419581056, 1.855668333721878, 0.00021597743594845465, 0.00021519259871941113, 0.00021442317823062242, 0.00021378399018695638, 0.0002166991703302549, 0.8190337124442252, 0.00021514158839090953, 0.0002144981156654876, 0.00021384870157606852, 0.0002169951812674312, 0.000216202942852309, 0.00021542629406947196, 0.0002147811193765837, 0.00021412999324222913, 1.466851853447866, 0.4416029984572484, 0.00021226278574687125, 0.00021147539040780881, -9.999789362505782, 0.00021138886814017915, 0.00021075919636179952, 0.00020998289633141913, 0.00020915669229673803, 0.00020841178006713985, 0.8857702993431089, 0.0002136118745059726, 0.07759578731525077, 0.00021224034545150495, 0.0002113963174748745, -9.999787555945128, 5.136478184089032, 1.8672680160172204, -9.580821391173368, 0.0002094509815009139, 1.91122651576487, 0.43438420567091773, 0.00021194226876080214, 0.14451696605826667, 0.000210355668901964, 0.34226241447440714, 0.00021253153605399553, 0.0002118950492950617, 0.00021111037480803495, -9.999789724636768, 0.00021322291802722192, 0.00021258229004514394, 0.00021179252691089107, 0.0002109520497991778, 0.00021019431737851353, 0.4048398846965637, -9.999787124320449, 1.4005026711897341, 0.00021124333565919712, -9.915569393436568, 0.00020988194556376182, 2.173240148183839, 0.00020829886394110577, -9.999792556485124, 0.08854580018520722, 0.00020769701539740908, 0.00020684802853108687, 0.00020600287967896126, 0.060134756333882884, 0.5339611625466091, 0.07344442421340536, -9.999790039604795, 0.00020909006391954974, 0.00020822653219751774, 0.0001991405712305584, 0.00020872908318699278, -9.999792129011453, 0.19027115343363346, -9.939864295272315, -9.99979461529266, 0.00020960220717458297, 0.00020887926782302437, 0.14555079592652795, 0.00020727508811799135, 0.00019823407331713314, 0.00020952240525384696, 0.00020880001535191907, 0.0002079420066546285, 0.00020708791267801702, 0.00019805573634174405, 0.00020946729474649288, 0.0002086038050831617, 0.00020774427701642466, 0.00019868110167844605, 0.00020601157193846987, 0.0002098066846332802, 0.9279349743525718, 0.06514120569493705, 0.00019907181848405163, -9.826624742497847], "episode_lengths": [24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.88236732544067, "mean_inference_ms": 2.1416585825250367, "mean_action_processing_ms": 0.14670828521285037, "mean_env_wait_ms": 1.4416678870486823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01060175895690918, "StateBufferConnector_ms": 0.0066623687744140625, "ViewRequirementAgentConnector_ms": 0.18074893951416016}}, "episode_reward_max": 5.136478184089032, "episode_reward_min": -9.99979461529266, "episode_reward_mean": -0.9606420083618862, "episode_len_mean": 25.02, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00020807243236504642, 0.07428484798075602, 1.6237416121294623, 0.00021430367031035304, 0.03972323419581056, 1.855668333721878, 0.00021597743594845465, 0.00021519259871941113, 0.00021442317823062242, 0.00021378399018695638, 0.0002166991703302549, 0.8190337124442252, 0.00021514158839090953, 0.0002144981156654876, 0.00021384870157606852, 0.0002169951812674312, 0.000216202942852309, 0.00021542629406947196, 0.0002147811193765837, 0.00021412999324222913, 1.466851853447866, 0.4416029984572484, 0.00021226278574687125, 0.00021147539040780881, -9.999789362505782, 0.00021138886814017915, 0.00021075919636179952, 0.00020998289633141913, 0.00020915669229673803, 0.00020841178006713985, 0.8857702993431089, 0.0002136118745059726, 0.07759578731525077, 0.00021224034545150495, 0.0002113963174748745, -9.999787555945128, 5.136478184089032, 1.8672680160172204, -9.580821391173368, 0.0002094509815009139, 1.91122651576487, 0.43438420567091773, 0.00021194226876080214, 0.14451696605826667, 0.000210355668901964, 0.34226241447440714, 0.00021253153605399553, 0.0002118950492950617, 0.00021111037480803495, -9.999789724636768, 0.00021322291802722192, 0.00021258229004514394, 0.00021179252691089107, 0.0002109520497991778, 0.00021019431737851353, 0.4048398846965637, -9.999787124320449, 1.4005026711897341, 0.00021124333565919712, -9.915569393436568, 0.00020988194556376182, 2.173240148183839, 0.00020829886394110577, -9.999792556485124, 0.08854580018520722, 0.00020769701539740908, 0.00020684802853108687, 0.00020600287967896126, 0.060134756333882884, 0.5339611625466091, 0.07344442421340536, -9.999790039604795, 0.00020909006391954974, 0.00020822653219751774, 0.0001991405712305584, 0.00020872908318699278, -9.999792129011453, 0.19027115343363346, -9.939864295272315, -9.99979461529266, 0.00020960220717458297, 0.00020887926782302437, 0.14555079592652795, 0.00020727508811799135, 0.00019823407331713314, 0.00020952240525384696, 0.00020880001535191907, 0.0002079420066546285, 0.00020708791267801702, 0.00019805573634174405, 0.00020946729474649288, 0.0002086038050831617, 0.00020774427701642466, 0.00019868110167844605, 0.00020601157193846987, 0.0002098066846332802, 0.9279349743525718, 0.06514120569493705, 0.00019907181848405163, -9.826624742497847], "episode_lengths": [24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.88236732544067, "mean_inference_ms": 2.1416585825250367, "mean_action_processing_ms": 0.14670828521285037, "mean_env_wait_ms": 1.4416678870486823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01060175895690918, "StateBufferConnector_ms": 0.0066623687744140625, "ViewRequirementAgentConnector_ms": 0.18074893951416016}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 126750, "num_env_steps_sampled": 66000, "num_env_steps_trained": 126750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.8573404120203247, "num_env_steps_trained_throughput_per_sec": 7.521813803439633, "timesteps_total": 66000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 9015.763, "sample_time_ms": 8950.497, "load_time_ms": 0.247, "load_throughput": 315574.141, "learn_time_ms": 13.084, "learn_throughput": 5961.433, "synch_weights_time_ms": 12.257}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 126750, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 126750, "last_target_update_ts": 65520, "num_target_updates": 125}, "done": false, "episodes_total": 2564, "training_iteration": 66, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-37-09", "timestamp": 1713422229, "time_this_iter_s": 259.25706148147583, "time_total_s": 15981.040174007416, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15981.040174007416, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 11.755555555555553, "ram_util_percent": 23.111653116531162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04126563295722008, "cur_lr": 0.01}, "td_error": [1.2241857051849365, 0.8442841172218323, 1.2241864204406738, 1.224185585975647, 1.224185585975647, 1.224186897277832, 1.2241861820220947, 1.2241857051849365, 1.224185824394226, 1.2243497371673584, 1.224185585975647, 1.2241857051849365, 0.8442840576171875, 1.2241859436035156, 1.2241857051849365, 1.224199652671814, 1.224185585975647, 1.224185585975647, 0.844284176826477, 1.2241854667663574, 1.2241857051849365, 1.224185585975647, 1.2241861820220947, 1.4278188943862915, 1.224185824394226, 1.2241857051849365, 1.2241859436035156, 1.259808897972107, 1.2577528953552246, 1.2241860628128052, 1.2241864204406738, 1.224185824394226, 3.3171701431274414, 1.2595806121826172, 1.2241860628128052, 1.2241861820220947, 1.224185585975647, 1.2241876125335693, 1.2241874933242798, 1.224185824394226, 1.2241857051849365, 1.224185824394226, 0.844284176826477, 0.8442840576171875, 1.2241857051849365, 1.224185585975647, 1.2241857051849365, 1.2241859436035156, 1.224185585975647, 1.2241859436035156, 3.364780902862549, 0.844284176826477, 0.844284176826477, 1.224190354347229, 0.8442841172218323, 1.224185824394226, 1.2241857051849365, 1.224186658859253, 1.2241854667663574, 1.2241864204406738, 1.2241860628128052, 1.2241857051849365, 1.2241860628128052, 1.257300615310669, 1.2241865396499634, 1.2241854667663574, 1.2241863012313843, 1.2241860628128052, 1.224185824394226, 0.8435657620429993, 0.844284176826477, 1.2600420713424683, 1.2241857051849365, 1.2241853475570679, 1.2241857051849365, 0.844284176826477, 0.844284176826477, 1.2241857051849365], "mean_td_error": 1.224845051765442, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1650.0, "diff_num_grad_updates_vs_sampler_policy": 1649.0}}, "num_env_steps_sampled": 67000, "num_env_steps_trained": 128700, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 128700, "last_target_update_ts": 66560, "num_target_updates": 127}, "sampler_results": {"episode_reward_max": 2.9974893367804865, "episode_reward_min": -9.999798017018643, "episode_reward_mean": -1.2720944627441007, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.91122651576487, 0.43438420567091773, 0.00021194226876080214, 0.14451696605826667, 0.000210355668901964, 0.34226241447440714, 0.00021253153605399553, 0.0002118950492950617, 0.00021111037480803495, -9.999789724636768, 0.00021322291802722192, 0.00021258229004514394, 0.00021179252691089107, 0.0002109520497991778, 0.00021019431737851353, 0.4048398846965637, -9.999787124320449, 1.4005026711897341, 0.00021124333565919712, -9.915569393436568, 0.00020988194556376182, 2.173240148183839, 0.00020829886394110577, -9.999792556485124, 0.08854580018520722, 0.00020769701539740908, 0.00020684802853108687, 0.00020600287967896126, 0.060134756333882884, 0.5339611625466091, 0.07344442421340536, -9.999790039604795, 0.00020909006391954974, 0.00020822653219751774, 0.0001991405712305584, 0.00020872908318699278, -9.999792129011453, 0.19027115343363346, -9.939864295272315, -9.99979461529266, 0.00020960220717458297, 0.00020887926782302437, 0.14555079592652795, 0.00020727508811799135, 0.00019823407331713314, 0.00020952240525384696, 0.00020880001535191907, 0.0002079420066546285, 0.00020708791267801702, 0.00019805573634174405, 0.00020946729474649288, 0.0002086038050831617, 0.00020774427701642466, 0.00019868110167844605, 0.00020601157193846987, 0.0002098066846332802, 0.9279349743525718, 0.06514120569493705, 0.00019907181848405163, -9.826624742497847, 0.00020575474557204087, 0.0002048241588951684, -9.999796071814337, 0.000203103504212685, 0.00020234669106493325, 0.00020345025111557217, 0.000202566791772756, 0.00020175250707211292, 0.00020100570953032683, 0.00020015385796028643, 0.00020648580709516377, 0.0002055486105490145, 0.00020464687498112944, 0.0002038158139423365, 0.0002030536933358769, 0.0002044602342623228, 0.0002035680014513595, 0.000202745663040254, 0.00020199150921516547, 0.00020113129903092855, 0.00020555016814564865, 0.00020462142697878018, 0.07246910994159625, 0.0520788135043564, 0.00020230451103293875, 0.00020536609359929524, 0.00020443901142555635, 0.43854991235670715, 0.00020273700542607805, -9.999798017018643, -9.999794921267146, 0.0002041810395564443, -9.999796646183492, -9.99979740294038, 2.9974893367804865, 0.00020550328064245207, 0.00020460194185601473, 0.00020377124501363872, 0.00020300945703447792, 0.00020214057300349568], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.1036211383903, "mean_inference_ms": 2.141114283575057, "mean_action_processing_ms": 0.14666727817326453, "mean_env_wait_ms": 1.4216870539618514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010035276412963867, "StateBufferConnector_ms": 0.006623268127441406, "ViewRequirementAgentConnector_ms": 0.18585777282714844}}, "episode_reward_max": 2.9974893367804865, "episode_reward_min": -9.999798017018643, "episode_reward_mean": -1.2720944627441007, "episode_len_mean": 25.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.91122651576487, 0.43438420567091773, 0.00021194226876080214, 0.14451696605826667, 0.000210355668901964, 0.34226241447440714, 0.00021253153605399553, 0.0002118950492950617, 0.00021111037480803495, -9.999789724636768, 0.00021322291802722192, 0.00021258229004514394, 0.00021179252691089107, 0.0002109520497991778, 0.00021019431737851353, 0.4048398846965637, -9.999787124320449, 1.4005026711897341, 0.00021124333565919712, -9.915569393436568, 0.00020988194556376182, 2.173240148183839, 0.00020829886394110577, -9.999792556485124, 0.08854580018520722, 0.00020769701539740908, 0.00020684802853108687, 0.00020600287967896126, 0.060134756333882884, 0.5339611625466091, 0.07344442421340536, -9.999790039604795, 0.00020909006391954974, 0.00020822653219751774, 0.0001991405712305584, 0.00020872908318699278, -9.999792129011453, 0.19027115343363346, -9.939864295272315, -9.99979461529266, 0.00020960220717458297, 0.00020887926782302437, 0.14555079592652795, 0.00020727508811799135, 0.00019823407331713314, 0.00020952240525384696, 0.00020880001535191907, 0.0002079420066546285, 0.00020708791267801702, 0.00019805573634174405, 0.00020946729474649288, 0.0002086038050831617, 0.00020774427701642466, 0.00019868110167844605, 0.00020601157193846987, 0.0002098066846332802, 0.9279349743525718, 0.06514120569493705, 0.00019907181848405163, -9.826624742497847, 0.00020575474557204087, 0.0002048241588951684, -9.999796071814337, 0.000203103504212685, 0.00020234669106493325, 0.00020345025111557217, 0.000202566791772756, 0.00020175250707211292, 0.00020100570953032683, 0.00020015385796028643, 0.00020648580709516377, 0.0002055486105490145, 0.00020464687498112944, 0.0002038158139423365, 0.0002030536933358769, 0.0002044602342623228, 0.0002035680014513595, 0.000202745663040254, 0.00020199150921516547, 0.00020113129903092855, 0.00020555016814564865, 0.00020462142697878018, 0.07246910994159625, 0.0520788135043564, 0.00020230451103293875, 0.00020536609359929524, 0.00020443901142555635, 0.43854991235670715, 0.00020273700542607805, -9.999798017018643, -9.999794921267146, 0.0002041810395564443, -9.999796646183492, -9.99979740294038, 2.9974893367804865, 0.00020550328064245207, 0.00020460194185601473, 0.00020377124501363872, 0.00020300945703447792, 0.00020214057300349568], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.1036211383903, "mean_inference_ms": 2.141114283575057, "mean_action_processing_ms": 0.14666727817326453, "mean_env_wait_ms": 1.4216870539618514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010035276412963867, "StateBufferConnector_ms": 0.006623268127441406, "ViewRequirementAgentConnector_ms": 0.18585777282714844}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 128700, "num_env_steps_sampled": 67000, "num_env_steps_trained": 128700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.451736994677454, "num_env_steps_trained_throughput_per_sec": 8.680887139621033, "timesteps_total": 67000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 67000, "timers": {"training_iteration_time_ms": 8898.891, "sample_time_ms": 8835.472, "load_time_ms": 0.245, "load_throughput": 318182.953, "learn_time_ms": 12.8, "learn_throughput": 6093.613, "synch_weights_time_ms": 11.367}, "counters": {"num_env_steps_sampled": 67000, "num_env_steps_trained": 128700, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 128700, "last_target_update_ts": 66560, "num_target_updates": 127}, "done": false, "episodes_total": 2604, "training_iteration": 67, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-40-54", "timestamp": 1713422454, "time_this_iter_s": 224.64044094085693, "time_total_s": 16205.680614948273, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 16205.680614948273, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 13.470125786163521, "ram_util_percent": 23.211949685534588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.036728616803884506, "cur_lr": 0.01}, "td_error": [1.2333800792694092, 1.2333803176879883, 1.2333804368972778, 0.830897867679596, 1.2333805561065674, 0.8308982849121094, 1.2333800792694092, 1.233378291130066, 1.2333801984786987, 3.4128341674804688, 1.4861748218536377, 0.966080904006958, 1.233378529548645, 1.233379602432251, 1.233379602432251, 1.2488723993301392, 1.2333800792694092, 1.2323877811431885, 1.2333805561065674, 1.2333790063858032, 1.2333801984786987, 1.233380675315857, 1.233379602432251, 2.860661029815674, 1.2333800792694092, 1.23337984085083, 1.2333805561065674, 1.2333807945251465, 1.2333799600601196, 1.2333799600601196, 1.2333799600601196, 1.2333805561065674, 1.267063021659851, 0.8308961391448975, 1.2488946914672852, 1.2333797216415405, 1.23337984085083, 1.233168363571167, 1.233380675315857, 1.2333792448043823, 1.2488672733306885, 1.3557333946228027, 1.2333786487579346, 1.2333793640136719, 1.2333780527114868, 0.8308984041213989, 1.2333801984786987, 1.2333805561065674, 1.2333776950836182, 0.8308979868888855, 0.8308960199356079, 1.2488707304000854, 1.2333801984786987, 1.233379602432251, 1.2809478044509888, 0.830899178981781, 1.23337984085083, 1.23337984085083, 1.2333754301071167, 0.8814917802810669, 1.2333800792694092, 1.2333805561065674, 1.2333801984786987, 1.2333793640136719, 1.2333791255950928, 1.2333803176879883, 0.8308987021446228, 1.2333797216415405, 1.23337721824646, 1.233376383781433, 1.2803339958190918, 1.2966991662979126, 1.2333800792694092, 1.2333803176879883, 1.2333803176879883, 1.283748984336853, 1.2333805561065674, 1.2333801984786987], "mean_td_error": 1.241655707359314, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1675.0, "diff_num_grad_updates_vs_sampler_policy": 1674.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 130650, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 130650, "last_target_update_ts": 67600, "num_target_updates": 129}, "sampler_results": {"episode_reward_max": 6.277860929890187, "episode_reward_min": -9.999800065512535, "episode_reward_mean": -1.100047168458128, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00020960220717458297, 0.00020887926782302437, 0.14555079592652795, 0.00020727508811799135, 0.00019823407331713314, 0.00020952240525384696, 0.00020880001535191907, 0.0002079420066546285, 0.00020708791267801702, 0.00019805573634174405, 0.00020946729474649288, 0.0002086038050831617, 0.00020774427701642466, 0.00019868110167844605, 0.00020601157193846987, 0.0002098066846332802, 0.9279349743525718, 0.06514120569493705, 0.00019907181848405163, -9.826624742497847, 0.00020575474557204087, 0.0002048241588951684, -9.999796071814337, 0.000203103504212685, 0.00020234669106493325, 0.00020345025111557217, 0.000202566791772756, 0.00020175250707211292, 0.00020100570953032683, 0.00020015385796028643, 0.00020648580709516377, 0.0002055486105490145, 0.00020464687498112944, 0.0002038158139423365, 0.0002030536933358769, 0.0002044602342623228, 0.0002035680014513595, 0.000202745663040254, 0.00020199150921516547, 0.00020113129903092855, 0.00020555016814564865, 0.00020462142697878018, 0.07246910994159625, 0.0520788135043564, 0.00020230451103293875, 0.00020536609359929524, 0.00020443901142555635, 0.43854991235670715, 0.00020273700542607805, -9.999798017018643, -9.999794921267146, 0.0002041810395564443, -9.999796646183492, -9.99979740294038, 2.9974893367804865, 0.00020550328064245207, 0.00020460194185601473, 0.00020377124501363872, 0.00020300945703447792, 0.00020214057300349568, 0.00020148345932822744, 0.00020078832073382565, 0.00019997562084915298, 0.0001993881743205606, 0.11055923036090373, 0.00019946784778136043, -9.892171566452767, 0.00019812950684772355, 0.00019751070985967682, 0.00018908981354348503, 0.23218670211749948, 0.00020165551575933495, -9.99979916414048, 2.1881656412562567, 6.277860929890187, 0.0002004385840561228, 0.10782935822671982, 0.00019908722842802167, 2.292240159135374, 0.00019000000256475614, 0.0002014416384002397, 0.000200746787844381, -9.999800065512535, 0.00019934721862070146, -9.679960342405431, 0.00020112277873728714, 0.00020043012234815518, -9.860648194570995, 0.00019906480909898574, 0.6090161925318218, 0.0002010342575866841, 0.0002002195696225362, 0.08538097238706668, -7.363951833300712, 0.00019055953919999875, 0.0002014409007778603, 0.00020062292032635074, -9.99979996964817, 0.00019940095306958148, 0.00019089445331076912], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 26, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.3149356949571, "mean_inference_ms": 2.140203176726912, "mean_action_processing_ms": 0.14661470681151315, "mean_env_wait_ms": 1.4022913825197196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010268449783325195, "StateBufferConnector_ms": 0.00662994384765625, "ViewRequirementAgentConnector_ms": 0.187713623046875}}, "episode_reward_max": 6.277860929890187, "episode_reward_min": -9.999800065512535, "episode_reward_mean": -1.100047168458128, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00020960220717458297, 0.00020887926782302437, 0.14555079592652795, 0.00020727508811799135, 0.00019823407331713314, 0.00020952240525384696, 0.00020880001535191907, 0.0002079420066546285, 0.00020708791267801702, 0.00019805573634174405, 0.00020946729474649288, 0.0002086038050831617, 0.00020774427701642466, 0.00019868110167844605, 0.00020601157193846987, 0.0002098066846332802, 0.9279349743525718, 0.06514120569493705, 0.00019907181848405163, -9.826624742497847, 0.00020575474557204087, 0.0002048241588951684, -9.999796071814337, 0.000203103504212685, 0.00020234669106493325, 0.00020345025111557217, 0.000202566791772756, 0.00020175250707211292, 0.00020100570953032683, 0.00020015385796028643, 0.00020648580709516377, 0.0002055486105490145, 0.00020464687498112944, 0.0002038158139423365, 0.0002030536933358769, 0.0002044602342623228, 0.0002035680014513595, 0.000202745663040254, 0.00020199150921516547, 0.00020113129903092855, 0.00020555016814564865, 0.00020462142697878018, 0.07246910994159625, 0.0520788135043564, 0.00020230451103293875, 0.00020536609359929524, 0.00020443901142555635, 0.43854991235670715, 0.00020273700542607805, -9.999798017018643, -9.999794921267146, 0.0002041810395564443, -9.999796646183492, -9.99979740294038, 2.9974893367804865, 0.00020550328064245207, 0.00020460194185601473, 0.00020377124501363872, 0.00020300945703447792, 0.00020214057300349568, 0.00020148345932822744, 0.00020078832073382565, 0.00019997562084915298, 0.0001993881743205606, 0.11055923036090373, 0.00019946784778136043, -9.892171566452767, 0.00019812950684772355, 0.00019751070985967682, 0.00018908981354348503, 0.23218670211749948, 0.00020165551575933495, -9.99979916414048, 2.1881656412562567, 6.277860929890187, 0.0002004385840561228, 0.10782935822671982, 0.00019908722842802167, 2.292240159135374, 0.00019000000256475614, 0.0002014416384002397, 0.000200746787844381, -9.999800065512535, 0.00019934721862070146, -9.679960342405431, 0.00020112277873728714, 0.00020043012234815518, -9.860648194570995, 0.00019906480909898574, 0.6090161925318218, 0.0002010342575866841, 0.0002002195696225362, 0.08538097238706668, -7.363951833300712, 0.00019055953919999875, 0.0002014409007778603, 0.00020062292032635074, -9.99979996964817, 0.00019940095306958148, 0.00019089445331076912], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 26, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.3149356949571, "mean_inference_ms": 2.140203176726912, "mean_action_processing_ms": 0.14661470681151315, "mean_env_wait_ms": 1.4022913825197196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010268449783325195, "StateBufferConnector_ms": 0.00662994384765625, "ViewRequirementAgentConnector_ms": 0.187713623046875}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 130650, "num_env_steps_sampled": 68000, "num_env_steps_trained": 130650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.222930251788264, "num_env_steps_trained_throughput_per_sec": 8.234713990987114, "timesteps_total": 68000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 8993.075, "sample_time_ms": 8928.667, "load_time_ms": 0.235, "load_throughput": 332171.502, "learn_time_ms": 13.238, "learn_throughput": 5892.213, "synch_weights_time_ms": 11.834}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 130650, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 130650, "last_target_update_ts": 67600, "num_target_updates": 129}, "done": false, "episodes_total": 2644, "training_iteration": 68, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-44-50", "timestamp": 1713422690, "time_this_iter_s": 236.812166929245, "time_total_s": 16442.492781877518, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 16442.492781877518, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 12.794362017804154, "ram_util_percent": 23.37477744807122}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01754121296107769, "cur_lr": 0.01}, "td_error": [1.1756380796432495, 1.175638198852539, 1.17563796043396, 1.64753258228302, 1.175638198852539, 1.175638198852539, 1.17563796043396, 1.1756380796432495, 1.17563796043396, 1.1756380796432495, 1.1756383180618286, 1.175638198852539, 1.1756380796432495, 1.1756383180618286, 1.1756380796432495, 1.3420032262802124, 1.9149123430252075, 1.17563796043396, 1.1756380796432495, 1.17563796043396, 1.1756380796432495, 1.17563796043396, 1.17563796043396, 0.8621142506599426, 0.8286177515983582, 0.8286179304122925, 1.1756380796432495, 0.8285833597183228, 1.175639033317566, 1.175638198852539, 3.4599661827087402, 1.1756407022476196, 1.17563796043396, 1.1756385564804077, 1.175638198852539, 1.1756393909454346, 1.1756467819213867, 0.8286179304122925, 1.1756378412246704, 1.175639271736145, 0.8286179900169373, 1.1756380796432495, 0.828618049621582, 0.8286179900169373, 1.1756380796432495, 1.1756380796432495, 0.828618049621582, 1.1756380796432495, 1.17563796043396, 1.1756401062011719, 1.1756418943405151, 1.1756383180618286, 1.1756380796432495, 1.175639271736145, 1.1756384372711182, 1.1756380796432495, 1.1756380796432495, 1.1756378412246704, 1.175638198852539, 1.175638198852539, 1.175638198852539, 1.175638198852539, 1.1756380796432495, 1.1756380796432495, 1.175638198852539, 0.8286179900169373, 1.175638198852539, 1.1756380796432495, 1.1756383180618286, 0.828618049621582, 1.1756383180618286, 1.203819990158081, 1.175638198852539, 1.175638198852539, 1.1756378412246704, 1.17563796043396, 1.1756391525268555, 1.1756384372711182], "mean_td_error": 1.1744370460510254, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1700.0, "diff_num_grad_updates_vs_sampler_policy": 1699.0}}, "num_env_steps_sampled": 69000, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 132600, "last_target_update_ts": 68640, "num_target_updates": 131}, "sampler_results": {"episode_reward_max": 6.277860929890187, "episode_reward_min": -19.851670408221626, "episode_reward_mean": -1.7413621762738416, "episode_len_mean": 24.75, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00020462142697878018, 0.07246910994159625, 0.0520788135043564, 0.00020230451103293875, 0.00020536609359929524, 0.00020443901142555635, 0.43854991235670715, 0.00020273700542607805, -9.999798017018643, -9.999794921267146, 0.0002041810395564443, -9.999796646183492, -9.99979740294038, 2.9974893367804865, 0.00020550328064245207, 0.00020460194185601473, 0.00020377124501363872, 0.00020300945703447792, 0.00020214057300349568, 0.00020148345932822744, 0.00020078832073382565, 0.00019997562084915298, 0.0001993881743205606, 0.11055923036090373, 0.00019946784778136043, -9.892171566452767, 0.00019812950684772355, 0.00019751070985967682, 0.00018908981354348503, 0.23218670211749948, 0.00020165551575933495, -9.99979916414048, 2.1881656412562567, 6.277860929890187, 0.0002004385840561228, 0.10782935822671982, 0.00019908722842802167, 2.292240159135374, 0.00019000000256475614, 0.0002014416384002397, 0.000200746787844381, -9.999800065512535, 0.00019934721862070146, -9.679960342405431, 0.00020112277873728714, 0.00020043012234815518, -9.860648194570995, 0.00019906480909898574, 0.6090161925318218, 0.0002010342575866841, 0.0002002195696225362, 0.08538097238706668, -7.363951833300712, 0.00019055953919999875, 0.0002014409007778603, 0.00020062292032635074, -9.99979996964817, 0.00019940095306958148, 0.00019089445331076912, 0.00019031367647120057, -9.999818351183682, 2.292238605764454, 0.00019615860027784147, 0.00017975838001674786, 0.00018048529296622542, 3.0944547703480114, 0.00019491033266654954, 0.00017861893172890347, 0.0001857339021341402, 0.0001911275596997467, -9.54674592529866, 0.5212313055202199, 0.00019700324246040317, 0.00018052935719936795, 0.0001877134110366535, 0.00018135056675953954, -9.999803468276998, 0.00019583711273203058, 0.0001794649239922272, 0.5212203532099793, 0.04330999250439109, 0.00018169662306027922, 0.00019690556473412992, 0.000196208375505722, 0.00017980381484723412, 0.00018998345459550706, 0.00018133483568321442, -9.999803485274224, -9.999804179702934, 0.0001794495183242459, 0.00018188247529324765, 0.10782692875368337, 0.00019644215015623224, 0.0001800172031509934, -9.999812817187848, -19.851670408221626, 0.00019747625573910248, 0.00019677502622225532, 0.00018032104727944205, -9.999812501340429], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 26, 25, 24, 24, 24, 25, 25, 23, 23, 25, 25, 23, 24, 24, 24, 25, 25, 23, 24, 23, 26, 25, 23, 24, 24, 23, 25, 25, 23, 24, 23, 26, 26, 23, 23, 25, 25, 23, 25, 25, 25, 25, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.58881554893344, "mean_inference_ms": 2.1395750169025503, "mean_action_processing_ms": 0.14657007906251782, "mean_env_wait_ms": 1.383083791357209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010115385055541992, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.18035602569580078}}, "episode_reward_max": 6.277860929890187, "episode_reward_min": -19.851670408221626, "episode_reward_mean": -1.7413621762738416, "episode_len_mean": 24.75, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00020462142697878018, 0.07246910994159625, 0.0520788135043564, 0.00020230451103293875, 0.00020536609359929524, 0.00020443901142555635, 0.43854991235670715, 0.00020273700542607805, -9.999798017018643, -9.999794921267146, 0.0002041810395564443, -9.999796646183492, -9.99979740294038, 2.9974893367804865, 0.00020550328064245207, 0.00020460194185601473, 0.00020377124501363872, 0.00020300945703447792, 0.00020214057300349568, 0.00020148345932822744, 0.00020078832073382565, 0.00019997562084915298, 0.0001993881743205606, 0.11055923036090373, 0.00019946784778136043, -9.892171566452767, 0.00019812950684772355, 0.00019751070985967682, 0.00018908981354348503, 0.23218670211749948, 0.00020165551575933495, -9.99979916414048, 2.1881656412562567, 6.277860929890187, 0.0002004385840561228, 0.10782935822671982, 0.00019908722842802167, 2.292240159135374, 0.00019000000256475614, 0.0002014416384002397, 0.000200746787844381, -9.999800065512535, 0.00019934721862070146, -9.679960342405431, 0.00020112277873728714, 0.00020043012234815518, -9.860648194570995, 0.00019906480909898574, 0.6090161925318218, 0.0002010342575866841, 0.0002002195696225362, 0.08538097238706668, -7.363951833300712, 0.00019055953919999875, 0.0002014409007778603, 0.00020062292032635074, -9.99979996964817, 0.00019940095306958148, 0.00019089445331076912, 0.00019031367647120057, -9.999818351183682, 2.292238605764454, 0.00019615860027784147, 0.00017975838001674786, 0.00018048529296622542, 3.0944547703480114, 0.00019491033266654954, 0.00017861893172890347, 0.0001857339021341402, 0.0001911275596997467, -9.54674592529866, 0.5212313055202199, 0.00019700324246040317, 0.00018052935719936795, 0.0001877134110366535, 0.00018135056675953954, -9.999803468276998, 0.00019583711273203058, 0.0001794649239922272, 0.5212203532099793, 0.04330999250439109, 0.00018169662306027922, 0.00019690556473412992, 0.000196208375505722, 0.00017980381484723412, 0.00018998345459550706, 0.00018133483568321442, -9.999803485274224, -9.999804179702934, 0.0001794495183242459, 0.00018188247529324765, 0.10782692875368337, 0.00019644215015623224, 0.0001800172031509934, -9.999812817187848, -19.851670408221626, 0.00019747625573910248, 0.00019677502622225532, 0.00018032104727944205, -9.999812501340429], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 26, 25, 24, 24, 24, 25, 25, 23, 23, 25, 25, 23, 24, 24, 24, 25, 25, 23, 24, 23, 26, 25, 23, 24, 24, 23, 25, 25, 23, 24, 23, 26, 26, 23, 23, 25, 25, 23, 25, 25, 25, 25, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.58881554893344, "mean_inference_ms": 2.1395750169025503, "mean_action_processing_ms": 0.14657007906251782, "mean_env_wait_ms": 1.383083791357209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010115385055541992, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.18035602569580078}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 132600, "num_env_steps_sampled": 69000, "num_env_steps_trained": 132600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.2360204180332195, "num_env_steps_trained_throughput_per_sec": 8.260239815164779, "timesteps_total": 69000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 69000, "timers": {"training_iteration_time_ms": 10132.878, "sample_time_ms": 10066.533, "load_time_ms": 0.24, "load_throughput": 324462.672, "learn_time_ms": 13.304, "learn_throughput": 5862.701, "synch_weights_time_ms": 11.961}, "counters": {"num_env_steps_sampled": 69000, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 132600, "last_target_update_ts": 68640, "num_target_updates": 131}, "done": false, "episodes_total": 2685, "training_iteration": 69, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-48-47", "timestamp": 1713422927, "time_this_iter_s": 236.08064246177673, "time_total_s": 16678.573424339294, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 16678.573424339294, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 13.089285714285714, "ram_util_percent": 23.465773809523814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.043474823236465454, "cur_lr": 0.01}, "td_error": [0.8222078084945679, 1.242934226989746, 1.242934226989746, 1.242931842803955, 1.2429343461990356, 1.2405879497528076, 1.2429324388504028, 1.2429341077804565, 1.242934226989746, 1.242934226989746, 0.8222069144248962, 1.2429343461990356, 1.2429338693618774, 1.2429343461990356, 1.2429341077804565, 1.2429344654083252, 1.2611966133117676, 1.2429338693618774, 1.7327089309692383, 0.8222076892852783, 1.2429333925247192, 1.24293053150177, 0.8546499013900757, 1.2429333925247192, 1.2429341077804565, 1.2429325580596924, 1.3758234977722168, 1.2429335117340088, 1.242934226989746, 1.2429333925247192, 1.2429338693618774, 1.2429338693618774, 0.8222073912620544, 1.242933750152588, 1.2429322004318237, 3.501739740371704, 1.2429345846176147, 1.242933750152588, 0.8222060203552246, 1.242933988571167, 1.242934226989746, 1.242930293083191, 1.2429322004318237, 1.2429338693618774, 0.8222059011459351, 1.2429333925247192, 0.8806203603744507, 1.2429046630859375, 1.2429341077804565, 1.2429330348968506, 1.2429331541061401, 1.242933988571167, 1.2429344654083252, 1.242928147315979, 1.2429335117340088, 0.8222057819366455, 1.2429320812225342, 1.2429332733154297, 1.2429331541061401, 1.242934226989746, 1.2429341077804565, 1.242933988571167, 0.82220458984375, 1.2429333925247192, 1.2429345846176147, 1.2429324388504028, 1.242930293083191, 1.242934226989746, 1.2429338693618774, 1.2429336309432983, 1.242932915687561, 1.2429341077804565, 1.2429343461990356, 1.2429344654083252, 1.2429336309432983, 1.2429345846176147, 0.822206974029541, 0.8215842247009277], "mean_td_error": 1.2165087461471558, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1725.0, "diff_num_grad_updates_vs_sampler_policy": 1724.0}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 134550, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 134550, "last_target_update_ts": 69680, "num_target_updates": 133}, "sampler_results": {"episode_reward_max": 3.0944547703480114, "episode_reward_min": -19.851670408221626, "episode_reward_mean": -1.8392722238083588, "episode_len_mean": 24.74, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.000200746787844381, -9.999800065512535, 0.00019934721862070146, -9.679960342405431, 0.00020112277873728714, 0.00020043012234815518, -9.860648194570995, 0.00019906480909898574, 0.6090161925318218, 0.0002010342575866841, 0.0002002195696225362, 0.08538097238706668, -7.363951833300712, 0.00019055953919999875, 0.0002014409007778603, 0.00020062292032635074, -9.99979996964817, 0.00019940095306958148, 0.00019089445331076912, 0.00019031367647120057, -9.999818351183682, 2.292238605764454, 0.00019615860027784147, 0.00017975838001674786, 0.00018048529296622542, 3.0944547703480114, 0.00019491033266654954, 0.00017861893172890347, 0.0001857339021341402, 0.0001911275596997467, -9.54674592529866, 0.5212313055202199, 0.00019700324246040317, 0.00018052935719936795, 0.0001877134110366535, 0.00018135056675953954, -9.999803468276998, 0.00019583711273203058, 0.0001794649239922272, 0.5212203532099793, 0.04330999250439109, 0.00018169662306027922, 0.00019690556473412992, 0.000196208375505722, 0.00017980381484723412, 0.00018998345459550706, 0.00018133483568321442, -9.999803485274224, -9.999804179702934, 0.0001794495183242459, 0.00018188247529324765, 0.10782692875368337, 0.00019644215015623224, 0.0001800172031509934, -9.999812817187848, -19.851670408221626, 0.00019747625573910248, 0.00019677502622225532, 0.00018032104727944205, -9.999812501340429, 0.00018691457214179146, 0.0001940346466605983, 0.00019313295554744758, 0.0001923732921480207, 0.556012305809029, 0.00019281317908991115, -9.8930627480092, 0.00019119607246634136, 0.00019042718449440073, -9.999810216608836, 0.0001948610590942224, 0.00019395168830864585, 0.11439020601745757, 1.8451034284475705, 0.0001918764352765077, 0.30017755303482346, 0.00019286765245668394, 0.0001921100705799262, 0.00019133382852593543, 0.00019068384262789826, -9.327213403591415, 0.14343943961110917, 0.06303203165363057, -9.999807489926667, -9.999808268901226, 0.7086305238053744, 0.00019370963565540282, 0.00019281095591756802, 0.0001920538185032779, 0.1181035637281222, 0.00019431208532746182, 0.0001934078196514225, 0.0001926459967152997, 0.0001918654263546124, 0.00019121182988390833, 0.08256497626456794, 0.37552845953634184, -9.999806958958471, 0.00019225721383815415, 0.0001916009499973036], "episode_lengths": [25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 26, 25, 24, 24, 24, 25, 25, 23, 23, 25, 25, 23, 24, 24, 24, 25, 25, 23, 24, 23, 26, 25, 23, 24, 24, 23, 25, 25, 23, 24, 23, 26, 26, 23, 23, 25, 25, 23, 25, 25, 25, 25, 23, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.82764551683016, "mean_inference_ms": 2.1386335075934624, "mean_action_processing_ms": 0.14650547858720236, "mean_env_wait_ms": 1.3649813676905194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009746313095092773, "StateBufferConnector_ms": 0.006537914276123047, "ViewRequirementAgentConnector_ms": 0.17476511001586914}}, "episode_reward_max": 3.0944547703480114, "episode_reward_min": -19.851670408221626, "episode_reward_mean": -1.8392722238083588, "episode_len_mean": 24.74, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.000200746787844381, -9.999800065512535, 0.00019934721862070146, -9.679960342405431, 0.00020112277873728714, 0.00020043012234815518, -9.860648194570995, 0.00019906480909898574, 0.6090161925318218, 0.0002010342575866841, 0.0002002195696225362, 0.08538097238706668, -7.363951833300712, 0.00019055953919999875, 0.0002014409007778603, 0.00020062292032635074, -9.99979996964817, 0.00019940095306958148, 0.00019089445331076912, 0.00019031367647120057, -9.999818351183682, 2.292238605764454, 0.00019615860027784147, 0.00017975838001674786, 0.00018048529296622542, 3.0944547703480114, 0.00019491033266654954, 0.00017861893172890347, 0.0001857339021341402, 0.0001911275596997467, -9.54674592529866, 0.5212313055202199, 0.00019700324246040317, 0.00018052935719936795, 0.0001877134110366535, 0.00018135056675953954, -9.999803468276998, 0.00019583711273203058, 0.0001794649239922272, 0.5212203532099793, 0.04330999250439109, 0.00018169662306027922, 0.00019690556473412992, 0.000196208375505722, 0.00017980381484723412, 0.00018998345459550706, 0.00018133483568321442, -9.999803485274224, -9.999804179702934, 0.0001794495183242459, 0.00018188247529324765, 0.10782692875368337, 0.00019644215015623224, 0.0001800172031509934, -9.999812817187848, -19.851670408221626, 0.00019747625573910248, 0.00019677502622225532, 0.00018032104727944205, -9.999812501340429, 0.00018691457214179146, 0.0001940346466605983, 0.00019313295554744758, 0.0001923732921480207, 0.556012305809029, 0.00019281317908991115, -9.8930627480092, 0.00019119607246634136, 0.00019042718449440073, -9.999810216608836, 0.0001948610590942224, 0.00019395168830864585, 0.11439020601745757, 1.8451034284475705, 0.0001918764352765077, 0.30017755303482346, 0.00019286765245668394, 0.0001921100705799262, 0.00019133382852593543, 0.00019068384262789826, -9.327213403591415, 0.14343943961110917, 0.06303203165363057, -9.999807489926667, -9.999808268901226, 0.7086305238053744, 0.00019370963565540282, 0.00019281095591756802, 0.0001920538185032779, 0.1181035637281222, 0.00019431208532746182, 0.0001934078196514225, 0.0001926459967152997, 0.0001918654263546124, 0.00019121182988390833, 0.08256497626456794, 0.37552845953634184, -9.999806958958471, 0.00019225721383815415, 0.0001916009499973036], "episode_lengths": [25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 25, 26, 25, 24, 24, 24, 25, 25, 23, 23, 25, 25, 23, 24, 24, 24, 25, 25, 23, 24, 23, 26, 25, 23, 24, 24, 23, 25, 25, 23, 24, 23, 26, 26, 23, 23, 25, 25, 23, 25, 25, 25, 25, 23, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.82764551683016, "mean_inference_ms": 2.1386335075934624, "mean_action_processing_ms": 0.14650547858720236, "mean_env_wait_ms": 1.3649813676905194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009746313095092773, "StateBufferConnector_ms": 0.006537914276123047, "ViewRequirementAgentConnector_ms": 0.17476511001586914}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 134550, "num_env_steps_sampled": 70000, "num_env_steps_trained": 134550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.728990610173575, "num_env_steps_trained_throughput_per_sec": 7.27153168983847, "timesteps_total": 70000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 11273.11, "sample_time_ms": 11207.759, "load_time_ms": 0.241, "load_throughput": 323948.621, "learn_time_ms": 13.647, "learn_throughput": 5715.429, "synch_weights_time_ms": 11.962}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 134550, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 134550, "last_target_update_ts": 69680, "num_target_updates": 133}, "done": false, "episodes_total": 2725, "training_iteration": 70, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-53-15", "timestamp": 1713423195, "time_this_iter_s": 268.17770051956177, "time_total_s": 16946.751124858856, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 16946.751124858856, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 11.528534031413612, "ram_util_percent": 23.669633507853398}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02110452577471733, "cur_lr": 0.01}, "td_error": [1.1864420175552368, 1.1864421367645264, 1.186442255973816, 1.1864413022994995, 1.186442255973816, 1.1864416599273682, 1.220659613609314, 1.1864421367645264, 1.186441421508789, 1.1864420175552368, 1.1864418983459473, 1.186439871788025, 1.1864420175552368, 1.1864418983459473, 1.186442255973816, 1.1864421367645264, 1.1864413022994995, 1.186442255973816, 1.1864410638809204, 1.725313425064087, 1.1941181421279907, 1.1864415407180786, 1.1864420175552368, 0.8198118209838867, 1.186442255973816, 1.1864417791366577, 1.1864421367645264, 1.1864418983459473, 1.186442255973816, 1.1864420175552368, 1.186441421508789, 1.1864420175552368, 1.1864423751831055, 1.186441421508789, 1.1864423751831055, 1.186442255973816, 0.8198138475418091, 2.428084373474121, 1.2563676834106445, 1.186442494392395, 1.1864421367645264, 1.1864423751831055, 0.8198131918907166, 1.1864420175552368, 1.186442255973816, 1.186442255973816, 1.1864407062530518, 1.1864423751831055, 1.186442494392395, 1.1864420175552368, 1.1864237785339355, 1.1864416599273682, 1.186442255973816, 0.8198137283325195, 0.8198093175888062, 1.1864421367645264, 1.1864423751831055, 1.1864418983459473, 1.186442494392395, 1.1864423751831055, 1.1864420175552368, 1.1864418983459473, 1.1864420175552368, 1.1864420175552368, 1.1864423751831055, 1.18644118309021, 1.1864418983459473, 1.186429500579834, 1.1864420175552368, 1.1864410638809204, 1.1864423751831055, 1.1864420175552368, 1.1864413022994995, 1.186442255973816, 1.1864423751831055, 1.1864420175552368, 1.2650705575942993, 1.186442494392395], "mean_td_error": 1.1882084608078003, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1750.0, "diff_num_grad_updates_vs_sampler_policy": 1749.0}}, "num_env_steps_sampled": 71000, "num_env_steps_trained": 136500, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 136500, "last_target_update_ts": 70720, "num_target_updates": 135}, "sampler_results": {"episode_reward_max": 1.8451034284475705, "episode_reward_min": -19.851670408221626, "episode_reward_mean": -1.252942470577412, "episode_len_mean": 24.84, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.04330999250439109, 0.00018169662306027922, 0.00019690556473412992, 0.000196208375505722, 0.00017980381484723412, 0.00018998345459550706, 0.00018133483568321442, -9.999803485274224, -9.999804179702934, 0.0001794495183242459, 0.00018188247529324765, 0.10782692875368337, 0.00019644215015623224, 0.0001800172031509934, -9.999812817187848, -19.851670408221626, 0.00019747625573910248, 0.00019677502622225532, 0.00018032104727944205, -9.999812501340429, 0.00018691457214179146, 0.0001940346466605983, 0.00019313295554744758, 0.0001923732921480207, 0.556012305809029, 0.00019281317908991115, -9.8930627480092, 0.00019119607246634136, 0.00019042718449440073, -9.999810216608836, 0.0001948610590942224, 0.00019395168830864585, 0.11439020601745757, 1.8451034284475705, 0.0001918764352765077, 0.30017755303482346, 0.00019286765245668394, 0.0001921100705799262, 0.00019133382852593543, 0.00019068384262789826, -9.327213403591415, 0.14343943961110917, 0.06303203165363057, -9.999807489926667, -9.999808268901226, 0.7086305238053744, 0.00019370963565540282, 0.00019281095591756802, 0.0001920538185032779, 0.1181035637281222, 0.00019431208532746182, 0.0001934078196514225, 0.0001926459967152997, 0.0001918654263546124, 0.00019121182988390833, 0.08256497626456794, 0.37552845953634184, -9.999806958958471, 0.00019225721383815415, 0.0001916009499973036, 0.00019100245436185853, 0.0001901695469360201, -7.531791138424463, 0.8031782693420133, 0.13919201894590558, 0.7700765230861821, 0.0001806471448247309, 0.23517040693176092, -9.850376691205094, 0.276180047279217, 0.00019103590579644535, 0.06302146497118935, 0.6312037295679901, 1.455773619669407, 0.11419508803365044, 0.032068407426900675, 0.036972372388397505, 0.28728103935390037, 0.22320788435482977, 0.5037486541986251, 0.533948414584029, 0.00019024657287573156, 0.3432294472480236, 1.1213967576912054, 0.15362137162522652, 0.0885387068563403, 0.1471894211364653, 1.766725503260181, 0.3918318715064275, 0.1401983382187245, 0.40888210443485196, 1.2566148683554657, 0.32468788540052834, 0.968551628903367, 0.4684565504788143, 0.6286483665869775, 0.9394475129504013, 0.9381003670788075, -9.736768035787614, 0.2376473841863044], "episode_lengths": [24, 23, 25, 25, 23, 24, 23, 26, 26, 23, 23, 25, 25, 23, 25, 25, 25, 25, 23, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.0036840388581, "mean_inference_ms": 2.1379722475180625, "mean_action_processing_ms": 0.14646039327714244, "mean_env_wait_ms": 1.3474186871953717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010331869125366211, "StateBufferConnector_ms": 0.00671696662902832, "ViewRequirementAgentConnector_ms": 0.1780714988708496}}, "episode_reward_max": 1.8451034284475705, "episode_reward_min": -19.851670408221626, "episode_reward_mean": -1.252942470577412, "episode_len_mean": 24.84, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.04330999250439109, 0.00018169662306027922, 0.00019690556473412992, 0.000196208375505722, 0.00017980381484723412, 0.00018998345459550706, 0.00018133483568321442, -9.999803485274224, -9.999804179702934, 0.0001794495183242459, 0.00018188247529324765, 0.10782692875368337, 0.00019644215015623224, 0.0001800172031509934, -9.999812817187848, -19.851670408221626, 0.00019747625573910248, 0.00019677502622225532, 0.00018032104727944205, -9.999812501340429, 0.00018691457214179146, 0.0001940346466605983, 0.00019313295554744758, 0.0001923732921480207, 0.556012305809029, 0.00019281317908991115, -9.8930627480092, 0.00019119607246634136, 0.00019042718449440073, -9.999810216608836, 0.0001948610590942224, 0.00019395168830864585, 0.11439020601745757, 1.8451034284475705, 0.0001918764352765077, 0.30017755303482346, 0.00019286765245668394, 0.0001921100705799262, 0.00019133382852593543, 0.00019068384262789826, -9.327213403591415, 0.14343943961110917, 0.06303203165363057, -9.999807489926667, -9.999808268901226, 0.7086305238053744, 0.00019370963565540282, 0.00019281095591756802, 0.0001920538185032779, 0.1181035637281222, 0.00019431208532746182, 0.0001934078196514225, 0.0001926459967152997, 0.0001918654263546124, 0.00019121182988390833, 0.08256497626456794, 0.37552845953634184, -9.999806958958471, 0.00019225721383815415, 0.0001916009499973036, 0.00019100245436185853, 0.0001901695469360201, -7.531791138424463, 0.8031782693420133, 0.13919201894590558, 0.7700765230861821, 0.0001806471448247309, 0.23517040693176092, -9.850376691205094, 0.276180047279217, 0.00019103590579644535, 0.06302146497118935, 0.6312037295679901, 1.455773619669407, 0.11419508803365044, 0.032068407426900675, 0.036972372388397505, 0.28728103935390037, 0.22320788435482977, 0.5037486541986251, 0.533948414584029, 0.00019024657287573156, 0.3432294472480236, 1.1213967576912054, 0.15362137162522652, 0.0885387068563403, 0.1471894211364653, 1.766725503260181, 0.3918318715064275, 0.1401983382187245, 0.40888210443485196, 1.2566148683554657, 0.32468788540052834, 0.968551628903367, 0.4684565504788143, 0.6286483665869775, 0.9394475129504013, 0.9381003670788075, -9.736768035787614, 0.2376473841863044], "episode_lengths": [24, 23, 25, 25, 23, 24, 23, 26, 26, 23, 23, 25, 25, 23, 25, 25, 25, 25, 23, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.0036840388581, "mean_inference_ms": 2.1379722475180625, "mean_action_processing_ms": 0.14646039327714244, "mean_env_wait_ms": 1.3474186871953717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010331869125366211, "StateBufferConnector_ms": 0.00671696662902832, "ViewRequirementAgentConnector_ms": 0.1780714988708496}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 136500, "num_env_steps_sampled": 71000, "num_env_steps_trained": 136500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5647841208384086, "num_env_steps_trained_throughput_per_sec": 6.951329035634897, "timesteps_total": 71000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 71000, "timers": {"training_iteration_time_ms": 11241.112, "sample_time_ms": 11179.268, "load_time_ms": 0.236, "load_throughput": 329960.375, "learn_time_ms": 12.649, "learn_throughput": 6166.548, "synch_weights_time_ms": 11.324}, "counters": {"num_env_steps_sampled": 71000, "num_env_steps_trained": 136500, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 136500, "last_target_update_ts": 70720, "num_target_updates": 135}, "done": false, "episodes_total": 2765, "training_iteration": 71, "trial_id": "cbb9a_00000", "date": "2024-04-18_06-57-55", "timestamp": 1713423475, "time_this_iter_s": 280.5302085876465, "time_total_s": 17227.281333446503, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 17227.281333446503, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 10.885964912280702, "ram_util_percent": 23.796240601503765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.026214195415377617, "cur_lr": 0.01}, "td_error": [1.1637952327728271, 1.1725822687149048, 1.1637941598892212, 1.1637951135635376, 1.1637942790985107, 1.1637954711914062, 1.1637942790985107, 1.1637935638427734, 1.1637954711914062, 1.1637955904006958, 1.1637942790985107, 1.1637954711914062, 1.1637871265411377, 1.1637955904006958, 1.1637945175170898, 1.1637954711914062, 1.1637946367263794, 0.8332540988922119, 1.1637954711914062, 1.1637948751449585, 3.602438449859619, 1.163794994354248, 1.1637951135635376, 1.163794994354248, 0.8145965337753296, 1.163794994354248, 1.1637954711914062, 1.1637955904006958, 1.1637928485870361, 1.1637955904006958, 1.1637890338897705, 1.1637934446334839, 1.1637945175170898, 0.8110175728797913, 1.1637881994247437, 1.1637951135635376, 1.1922192573547363, 3.8135299682617188, 1.1637951135635376, 1.1637951135635376, 1.1637929677963257, 1.1637943983078003, 0.8145946264266968, 0.8145972490310669, 1.1637940406799316, 1.1637934446334839, 1.1637929677963257, 1.1637935638427734, 1.1637951135635376, 0.8371447324752808, 1.1637957096099854, 1.1637945175170898, 1.1637945175170898, 1.1637941598892212, 1.1637777090072632, 1.1637943983078003, 1.1637827157974243, 1.163764476776123, 1.163794994354248, 1.163794994354248, 1.1637855768203735, 1.1637951135635376, 1.1637930870056152, 0.8587197065353394, 1.163793921470642, 0.8145905137062073, 1.1637839078903198, 1.1637942790985107, 1.1637951135635376, 1.1637932062149048, 1.1637955904006958, 1.1637930870056152, 1.1637957096099854, 1.1637911796569824, 1.1637942790985107, 0.8145943284034729, 1.1637946367263794, 1.1637901067733765], "mean_td_error": 1.190261960029602, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1775.0, "diff_num_grad_updates_vs_sampler_policy": 1774.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 138450, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 138450, "last_target_update_ts": 71760, "num_target_updates": 137}, "sampler_results": {"episode_reward_max": 5.1361978256081535, "episode_reward_min": -9.999808268901226, "episode_reward_mean": -1.1298878211105885, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.327213403591415, 0.14343943961110917, 0.06303203165363057, -9.999807489926667, -9.999808268901226, 0.7086305238053744, 0.00019370963565540282, 0.00019281095591756802, 0.0001920538185032779, 0.1181035637281222, 0.00019431208532746182, 0.0001934078196514225, 0.0001926459967152997, 0.0001918654263546124, 0.00019121182988390833, 0.08256497626456794, 0.37552845953634184, -9.999806958958471, 0.00019225721383815415, 0.0001916009499973036, 0.00019100245436185853, 0.0001901695469360201, -7.531791138424463, 0.8031782693420133, 0.13919201894590558, 0.7700765230861821, 0.0001806471448247309, 0.23517040693176092, -9.850376691205094, 0.276180047279217, 0.00019103590579644535, 0.06302146497118935, 0.6312037295679901, 1.455773619669407, 0.11419508803365044, 0.032068407426900675, 0.036972372388397505, 0.28728103935390037, 0.22320788435482977, 0.5037486541986251, 0.533948414584029, 0.00019024657287573156, 0.3432294472480236, 1.1213967576912054, 0.15362137162522652, 0.0885387068563403, 0.1471894211364653, 1.766725503260181, 0.3918318715064275, 0.1401983382187245, 0.40888210443485196, 1.2566148683554657, 0.32468788540052834, 0.968551628903367, 0.4684565504788143, 0.6286483665869775, 0.9394475129504013, 0.9381003670788075, -9.736768035787614, 0.2376473841863044, 0.07686276461537636, 0.05109847261514457, 0.2105726810207889, 5.1361978256081535, 0.5103415181202137, 0.09546659281902199, 0.005650325720849932, -9.348360895190366, 0.05658853138382161, 0.0746220974761375, 0.0650261656259058, -9.62241320765107, 0.032940400338867006, 0.02793958653967517, 0.11431143024771936, 0.23243483045029253, 0.02845900432897981, 0.028076325436682623, 0.09635828283729315, -8.808061282444184, 0.4091034599576088, 0.10228140064402494, -9.956848934713628, 0.031643655269838866, 0.05410337808156995, -9.915906561158238, -9.949111969472957, 0.04478397524638135, 0.023260057429404984, 0.08051850049687083, 0.12201554232936868, 0.030188284313595156, 0.036650777255206435, -9.97077077736753, 0.04577429283512174, 0.1265746252366887, -9.941991392071099, 0.023131982817439094, 2.8793471804284754, 2.194776950270744], "episode_lengths": [25, 25, 25, 26, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.18558053173604, "mean_inference_ms": 2.1378475567491786, "mean_action_processing_ms": 0.14643407195359445, "mean_env_wait_ms": 1.3301643523368694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01067209243774414, "StateBufferConnector_ms": 0.006609439849853516, "ViewRequirementAgentConnector_ms": 0.180220365524292}}, "episode_reward_max": 5.1361978256081535, "episode_reward_min": -9.999808268901226, "episode_reward_mean": -1.1298878211105885, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.327213403591415, 0.14343943961110917, 0.06303203165363057, -9.999807489926667, -9.999808268901226, 0.7086305238053744, 0.00019370963565540282, 0.00019281095591756802, 0.0001920538185032779, 0.1181035637281222, 0.00019431208532746182, 0.0001934078196514225, 0.0001926459967152997, 0.0001918654263546124, 0.00019121182988390833, 0.08256497626456794, 0.37552845953634184, -9.999806958958471, 0.00019225721383815415, 0.0001916009499973036, 0.00019100245436185853, 0.0001901695469360201, -7.531791138424463, 0.8031782693420133, 0.13919201894590558, 0.7700765230861821, 0.0001806471448247309, 0.23517040693176092, -9.850376691205094, 0.276180047279217, 0.00019103590579644535, 0.06302146497118935, 0.6312037295679901, 1.455773619669407, 0.11419508803365044, 0.032068407426900675, 0.036972372388397505, 0.28728103935390037, 0.22320788435482977, 0.5037486541986251, 0.533948414584029, 0.00019024657287573156, 0.3432294472480236, 1.1213967576912054, 0.15362137162522652, 0.0885387068563403, 0.1471894211364653, 1.766725503260181, 0.3918318715064275, 0.1401983382187245, 0.40888210443485196, 1.2566148683554657, 0.32468788540052834, 0.968551628903367, 0.4684565504788143, 0.6286483665869775, 0.9394475129504013, 0.9381003670788075, -9.736768035787614, 0.2376473841863044, 0.07686276461537636, 0.05109847261514457, 0.2105726810207889, 5.1361978256081535, 0.5103415181202137, 0.09546659281902199, 0.005650325720849932, -9.348360895190366, 0.05658853138382161, 0.0746220974761375, 0.0650261656259058, -9.62241320765107, 0.032940400338867006, 0.02793958653967517, 0.11431143024771936, 0.23243483045029253, 0.02845900432897981, 0.028076325436682623, 0.09635828283729315, -8.808061282444184, 0.4091034599576088, 0.10228140064402494, -9.956848934713628, 0.031643655269838866, 0.05410337808156995, -9.915906561158238, -9.949111969472957, 0.04478397524638135, 0.023260057429404984, 0.08051850049687083, 0.12201554232936868, 0.030188284313595156, 0.036650777255206435, -9.97077077736753, 0.04577429283512174, 0.1265746252366887, -9.941991392071099, 0.023131982817439094, 2.8793471804284754, 2.194776950270744], "episode_lengths": [25, 25, 25, 26, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.18558053173604, "mean_inference_ms": 2.1378475567491786, "mean_action_processing_ms": 0.14643407195359445, "mean_env_wait_ms": 1.3301643523368694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01067209243774414, "StateBufferConnector_ms": 0.006609439849853516, "ViewRequirementAgentConnector_ms": 0.180220365524292}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 138450, "num_env_steps_sampled": 72000, "num_env_steps_trained": 138450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.571965130322806, "num_env_steps_trained_throughput_per_sec": 6.965332004129472, "timesteps_total": 72000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 11256.407, "sample_time_ms": 11194.624, "load_time_ms": 0.232, "load_throughput": 335682.036, "learn_time_ms": 12.778, "learn_throughput": 6104.175, "synch_weights_time_ms": 11.357}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 138450, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 138450, "last_target_update_ts": 71760, "num_target_updates": 137}, "done": false, "episodes_total": 2805, "training_iteration": 72, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-02-35", "timestamp": 1713423755, "time_this_iter_s": 279.9661204814911, "time_total_s": 17507.247453927994, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 17507.247453927994, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 10.969095477386935, "ram_util_percent": 23.914070351758795}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.06250055134296417, "cur_lr": 0.01}, "td_error": [1.2724082469940186, 1.2724099159240723, 1.2724099159240723, 1.272410273551941, 0.5087302923202515, 1.286220669746399, 1.2724096775054932, 1.2724100351333618, 1.269390344619751, 1.2724095582962036, 1.2724096775054932, 3.5297629833221436, 1.2724101543426514, 1.2724096775054932, 1.2724100351333618, 1.272409439086914, 3.5443367958068848, 1.2724100351333618, 1.2724099159240723, 1.2724097967147827, 1.2724099159240723, 1.2724099159240723, 1.2724099159240723, 1.2724097967147827, 1.272209644317627, 0.825887143611908, 1.2724099159240723, 1.2724100351333618, 1.2724099159240723, 1.272409439086914, 1.2724100351333618, 0.8258867263793945, 1.2724097967147827, 1.2724100351333618, 1.272410273551941, 1.2724097967147827, 1.2724095582962036, 1.3065272569656372, 1.272409439086914, 1.2724100351333618, 0.8258862495422363, 1.2724100351333618, 1.272410273551941, 1.2724101543426514, 1.2724100351333618, 1.2724097967147827, 3.529763698577881, 0.8258873224258423, 1.2724093198776245, 1.2724100351333618, 1.272409439086914, 1.2724100351333618, 1.2724100351333618, 1.2724097967147827, 1.2724100351333618, 1.2724100351333618, 1.2724101543426514, 0.8258843421936035, 1.2724099159240723, 1.269003987312317, 1.2724100351333618, 1.2724100351333618, 1.2724100351333618, 1.2724100351333618, 1.2724099159240723, 1.2724097967147827, 1.2724101543426514, 1.2866525650024414, 1.2724097967147827, 1.2724099159240723, 0.825886070728302, 1.2724100351333618, 1.2722761631011963, 1.2724099159240723, 1.2724101543426514, 1.2724089622497559, 1.2724097967147827, 1.2724099159240723], "mean_td_error": 1.3159897327423096, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1800.0, "diff_num_grad_updates_vs_sampler_policy": 1799.0}}, "num_env_steps_sampled": 73000, "num_env_steps_trained": 140400, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 140400, "last_target_update_ts": 72800, "num_target_updates": 139}, "sampler_results": {"episode_reward_max": 6.606643328127132, "episode_reward_min": -17.30662564517544, "episode_reward_mean": -0.8217420152995315, "episode_len_mean": 24.99, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.533948414584029, 0.00019024657287573156, 0.3432294472480236, 1.1213967576912054, 0.15362137162522652, 0.0885387068563403, 0.1471894211364653, 1.766725503260181, 0.3918318715064275, 0.1401983382187245, 0.40888210443485196, 1.2566148683554657, 0.32468788540052834, 0.968551628903367, 0.4684565504788143, 0.6286483665869775, 0.9394475129504013, 0.9381003670788075, -9.736768035787614, 0.2376473841863044, 0.07686276461537636, 0.05109847261514457, 0.2105726810207889, 5.1361978256081535, 0.5103415181202137, 0.09546659281902199, 0.005650325720849932, -9.348360895190366, 0.05658853138382161, 0.0746220974761375, 0.0650261656259058, -9.62241320765107, 0.032940400338867006, 0.02793958653967517, 0.11431143024771936, 0.23243483045029253, 0.02845900432897981, 0.028076325436682623, 0.09635828283729315, -8.808061282444184, 0.4091034599576088, 0.10228140064402494, -9.956848934713628, 0.031643655269838866, 0.05410337808156995, -9.915906561158238, -9.949111969472957, 0.04478397524638135, 0.023260057429404984, 0.08051850049687083, 0.12201554232936868, 0.030188284313595156, 0.036650777255206435, -9.97077077736753, 0.04577429283512174, 0.1265746252366887, -9.941991392071099, 0.023131982817439094, 2.8793471804284754, 2.194776950270744, 0.0001856187637776439, 6.606643328127132, 0.2403695079142353, 0.16423758621407317, 0.18334008068750593, 0.15466755759726233, 0.3243647382937022, 0.19157691835440893, 0.7053588349428975, 0.1435685912952975, 4.532667014446983, -9.720071314603397, 4.6653214855839185, 0.7305671665501611, 1.154076551431042, 5.988773935481013, 2.8143482344819, 4.765724345106026, 0.06274892780853075, -9.719998920159421, 0.4790261629761462, 1.4701499914016671, 0.531362412633908, 0.32186618248567067, 0.18385517642925903, -7.96254492832718, 1.4256519258515052, 0.429506036078298, 0.06498644047469791, 0.775096002284174, 3.9358931059864597, -9.357547553713326, 0.3152507687125374, 0.2680042697667591, 0.08719889221600356, -17.30662564517544, 0.9893829010248559, -9.888956971610778, 0.10250962049936992, 0.3184889027196196], "episode_lengths": [25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 24, 24, 26, 25, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 24, 26, 25, 26, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.37612376337415, "mean_inference_ms": 2.1379828774993537, "mean_action_processing_ms": 0.1464843227993075, "mean_env_wait_ms": 1.3134129248421207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010679960250854492, "StateBufferConnector_ms": 0.006898164749145508, "ViewRequirementAgentConnector_ms": 0.18096661567687988}}, "episode_reward_max": 6.606643328127132, "episode_reward_min": -17.30662564517544, "episode_reward_mean": -0.8217420152995315, "episode_len_mean": 24.99, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.533948414584029, 0.00019024657287573156, 0.3432294472480236, 1.1213967576912054, 0.15362137162522652, 0.0885387068563403, 0.1471894211364653, 1.766725503260181, 0.3918318715064275, 0.1401983382187245, 0.40888210443485196, 1.2566148683554657, 0.32468788540052834, 0.968551628903367, 0.4684565504788143, 0.6286483665869775, 0.9394475129504013, 0.9381003670788075, -9.736768035787614, 0.2376473841863044, 0.07686276461537636, 0.05109847261514457, 0.2105726810207889, 5.1361978256081535, 0.5103415181202137, 0.09546659281902199, 0.005650325720849932, -9.348360895190366, 0.05658853138382161, 0.0746220974761375, 0.0650261656259058, -9.62241320765107, 0.032940400338867006, 0.02793958653967517, 0.11431143024771936, 0.23243483045029253, 0.02845900432897981, 0.028076325436682623, 0.09635828283729315, -8.808061282444184, 0.4091034599576088, 0.10228140064402494, -9.956848934713628, 0.031643655269838866, 0.05410337808156995, -9.915906561158238, -9.949111969472957, 0.04478397524638135, 0.023260057429404984, 0.08051850049687083, 0.12201554232936868, 0.030188284313595156, 0.036650777255206435, -9.97077077736753, 0.04577429283512174, 0.1265746252366887, -9.941991392071099, 0.023131982817439094, 2.8793471804284754, 2.194776950270744, 0.0001856187637776439, 6.606643328127132, 0.2403695079142353, 0.16423758621407317, 0.18334008068750593, 0.15466755759726233, 0.3243647382937022, 0.19157691835440893, 0.7053588349428975, 0.1435685912952975, 4.532667014446983, -9.720071314603397, 4.6653214855839185, 0.7305671665501611, 1.154076551431042, 5.988773935481013, 2.8143482344819, 4.765724345106026, 0.06274892780853075, -9.719998920159421, 0.4790261629761462, 1.4701499914016671, 0.531362412633908, 0.32186618248567067, 0.18385517642925903, -7.96254492832718, 1.4256519258515052, 0.429506036078298, 0.06498644047469791, 0.775096002284174, 3.9358931059864597, -9.357547553713326, 0.3152507687125374, 0.2680042697667591, 0.08719889221600356, -17.30662564517544, 0.9893829010248559, -9.888956971610778, 0.10250962049936992, 0.3184889027196196], "episode_lengths": [25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 24, 24, 26, 25, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 24, 26, 25, 26, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.37612376337415, "mean_inference_ms": 2.1379828774993537, "mean_action_processing_ms": 0.1464843227993075, "mean_env_wait_ms": 1.3134129248421207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010679960250854492, "StateBufferConnector_ms": 0.006898164749145508, "ViewRequirementAgentConnector_ms": 0.18096661567687988}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 140400, "num_env_steps_sampled": 73000, "num_env_steps_trained": 140400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.550141049348663, "num_env_steps_trained_throughput_per_sec": 6.922775046229893, "timesteps_total": 73000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 73000, "timers": {"training_iteration_time_ms": 11309.622, "sample_time_ms": 11245.628, "load_time_ms": 0.24, "load_throughput": 324784.783, "learn_time_ms": 13.094, "learn_throughput": 5956.712, "synch_weights_time_ms": 12.459}, "counters": {"num_env_steps_sampled": 73000, "num_env_steps_trained": 140400, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 140400, "last_target_update_ts": 72800, "num_target_updates": 139}, "done": false, "episodes_total": 2845, "training_iteration": 73, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-07-17", "timestamp": 1713424037, "time_this_iter_s": 281.6878695487976, "time_total_s": 17788.93532347679, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 17788.93532347679, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 12.358104738154614, "ram_util_percent": 25.104738154613468}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03783362731337547, "cur_lr": 0.01}, "td_error": [0.8770216703414917, 1.2773716449737549, 1.2773711681365967, 1.2773717641830444, 1.2773704528808594, 1.2773717641830444, 1.2773700952529907, 1.2773715257644653, 1.2773711681365967, 1.2773711681365967, 1.2773709297180176, 1.2773715257644653, 1.2773714065551758, 1.2773710489273071, 1.2773699760437012, 1.277370810508728, 1.2773710489273071, 1.2773712873458862, 1.2773704528808594, 1.2773715257644653, 1.2773712873458862, 1.2773699760437012, 1.284210205078125, 1.2773709297180176, 1.2782516479492188, 1.277370810508728, 1.2773691415786743, 1.277371883392334, 0.8770222663879395, 1.2773716449737549, 1.277368426322937, 1.2773714065551758, 1.2773710489273071, 1.2773698568344116, 1.2773698568344116, 1.2773704528808594, 1.2773717641830444, 1.2773711681365967, 1.2773714065551758, 1.277371883392334, 1.2773685455322266, 0.877021849155426, 1.277366042137146, 1.2773715257644653, 1.2773716449737549, 1.277371883392334, 1.2773712873458862, 1.2773709297180176, 1.2773709297180176, 1.2773715257644653, 1.281690239906311, 1.2773710489273071, 1.2773691415786743, 1.2773712873458862, 1.2773702144622803, 1.2773628234863281, 1.2773709297180176, 1.2773716449737549, 1.2773666381835938, 1.2773714065551758, 1.2773700952529907, 1.2773675918579102, 1.2773693799972534, 1.2773667573928833, 1.2773716449737549, 1.2773703336715698, 1.2773716449737549, 1.2782171964645386, 1.277370572090149, 1.2773714065551758, 1.2773717641830444, 0.8770053386688232, 1.3158514499664307, 1.3063254356384277, 1.2773712873458862, 1.2773696184158325, 1.277371883392334, 0.877018928527832], "mean_td_error": 1.2527366876602173, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1825.0, "diff_num_grad_updates_vs_sampler_policy": 1824.0}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 142350, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 142350, "last_target_update_ts": 73840, "num_target_updates": 141}, "sampler_results": {"episode_reward_max": 6.606643328127132, "episode_reward_min": -17.30662564517544, "episode_reward_mean": -0.4530788653327806, "episode_len_mean": 24.99, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4091034599576088, 0.10228140064402494, -9.956848934713628, 0.031643655269838866, 0.05410337808156995, -9.915906561158238, -9.949111969472957, 0.04478397524638135, 0.023260057429404984, 0.08051850049687083, 0.12201554232936868, 0.030188284313595156, 0.036650777255206435, -9.97077077736753, 0.04577429283512174, 0.1265746252366887, -9.941991392071099, 0.023131982817439094, 2.8793471804284754, 2.194776950270744, 0.0001856187637776439, 6.606643328127132, 0.2403695079142353, 0.16423758621407317, 0.18334008068750593, 0.15466755759726233, 0.3243647382937022, 0.19157691835440893, 0.7053588349428975, 0.1435685912952975, 4.532667014446983, -9.720071314603397, 4.6653214855839185, 0.7305671665501611, 1.154076551431042, 5.988773935481013, 2.8143482344819, 4.765724345106026, 0.06274892780853075, -9.719998920159421, 0.4790261629761462, 1.4701499914016671, 0.531362412633908, 0.32186618248567067, 0.18385517642925903, -7.96254492832718, 1.4256519258515052, 0.429506036078298, 0.06498644047469791, 0.775096002284174, 3.9358931059864597, -9.357547553713326, 0.3152507687125374, 0.2680042697667591, 0.08719889221600356, -17.30662564517544, 0.9893829010248559, -9.888956971610778, 0.10250962049936992, 0.3184889027196196, 0.11396343785917676, 2.399425488414077, 0.6657862360553497, 0.7053696384354351, 0.25255108067073334, 0.8409495754804027, 1.6435742609136257, 0.6288025920203112, 0.3038223695534228, 0.16950156866073296, 0.4663957697261291, 1.0539306230979042, 2.6288709707798588, 0.22303918461175556, 0.10971837175709812, 0.8297547447507889, 0.22389958495614778, -7.472285397290762, 0.18995838170468288, 0.13528718323202474, 0.1314697573327687, 6.538733531205675, 3.2979098185035727, 0.29057186521215034, 0.2668029219807418, 0.28524058375638844, -7.363478928158169, 5.776669202172804, 0.4177582345301221, 0.15526146714268776, -8.94484048069652, 0.3791859613425167, 0.33232923142691023, 0.23412073386418203, 0.44323547308077577, 0.07624572206224486, 6.448852761078097, 1.6103419592532386, 0.38494999525084467, 0.17788968213188527], "episode_lengths": [25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 24, 24, 26, 25, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 24, 26, 25, 26, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.576938046445, "mean_inference_ms": 2.13869589808492, "mean_action_processing_ms": 0.14655505898305168, "mean_env_wait_ms": 1.2971420003024556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010751485824584961, "StateBufferConnector_ms": 0.006921052932739258, "ViewRequirementAgentConnector_ms": 0.18290472030639648}}, "episode_reward_max": 6.606643328127132, "episode_reward_min": -17.30662564517544, "episode_reward_mean": -0.4530788653327806, "episode_len_mean": 24.99, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.4091034599576088, 0.10228140064402494, -9.956848934713628, 0.031643655269838866, 0.05410337808156995, -9.915906561158238, -9.949111969472957, 0.04478397524638135, 0.023260057429404984, 0.08051850049687083, 0.12201554232936868, 0.030188284313595156, 0.036650777255206435, -9.97077077736753, 0.04577429283512174, 0.1265746252366887, -9.941991392071099, 0.023131982817439094, 2.8793471804284754, 2.194776950270744, 0.0001856187637776439, 6.606643328127132, 0.2403695079142353, 0.16423758621407317, 0.18334008068750593, 0.15466755759726233, 0.3243647382937022, 0.19157691835440893, 0.7053588349428975, 0.1435685912952975, 4.532667014446983, -9.720071314603397, 4.6653214855839185, 0.7305671665501611, 1.154076551431042, 5.988773935481013, 2.8143482344819, 4.765724345106026, 0.06274892780853075, -9.719998920159421, 0.4790261629761462, 1.4701499914016671, 0.531362412633908, 0.32186618248567067, 0.18385517642925903, -7.96254492832718, 1.4256519258515052, 0.429506036078298, 0.06498644047469791, 0.775096002284174, 3.9358931059864597, -9.357547553713326, 0.3152507687125374, 0.2680042697667591, 0.08719889221600356, -17.30662564517544, 0.9893829010248559, -9.888956971610778, 0.10250962049936992, 0.3184889027196196, 0.11396343785917676, 2.399425488414077, 0.6657862360553497, 0.7053696384354351, 0.25255108067073334, 0.8409495754804027, 1.6435742609136257, 0.6288025920203112, 0.3038223695534228, 0.16950156866073296, 0.4663957697261291, 1.0539306230979042, 2.6288709707798588, 0.22303918461175556, 0.10971837175709812, 0.8297547447507889, 0.22389958495614778, -7.472285397290762, 0.18995838170468288, 0.13528718323202474, 0.1314697573327687, 6.538733531205675, 3.2979098185035727, 0.29057186521215034, 0.2668029219807418, 0.28524058375638844, -7.363478928158169, 5.776669202172804, 0.4177582345301221, 0.15526146714268776, -8.94484048069652, 0.3791859613425167, 0.33232923142691023, 0.23412073386418203, 0.44323547308077577, 0.07624572206224486, 6.448852761078097, 1.6103419592532386, 0.38494999525084467, 0.17788968213188527], "episode_lengths": [25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 24, 24, 26, 25, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 24, 26, 25, 26, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.576938046445, "mean_inference_ms": 2.13869589808492, "mean_action_processing_ms": 0.14655505898305168, "mean_env_wait_ms": 1.2971420003024556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010751485824584961, "StateBufferConnector_ms": 0.006921052932739258, "ViewRequirementAgentConnector_ms": 0.18290472030639648}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 142350, "num_env_steps_sampled": 74000, "num_env_steps_trained": 142350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5596122379404647, "num_env_steps_trained_throughput_per_sec": 6.941243863983907, "timesteps_total": 74000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 11217.588, "sample_time_ms": 11153.105, "load_time_ms": 0.238, "load_throughput": 328271.836, "learn_time_ms": 13.393, "learn_throughput": 5823.898, "synch_weights_time_ms": 12.457}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 142350, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 142350, "last_target_update_ts": 73840, "num_target_updates": 141}, "done": false, "episodes_total": 2885, "training_iteration": 74, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-11-58", "timestamp": 1713424318, "time_this_iter_s": 280.93936944007874, "time_total_s": 18069.87469291687, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 18069.87469291687, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 12.00475, "ram_util_percent": 24.626499999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.05327112227678299, "cur_lr": 0.01}, "td_error": [1.3156077861785889, 1.4773263931274414, 1.3156092166900635, 1.3156083822250366, 1.3156111240386963, 1.3156107664108276, 1.315610408782959, 1.3156096935272217, 1.3156096935272217, 1.31560480594635, 1.3156094551086426, 1.3156099319458008, 1.315609097480774, 1.3265047073364258, 1.3156096935272217, 1.315603494644165, 1.3156036138534546, 1.3156089782714844, 1.3156088590621948, 1.3156073093414307, 1.317652702331543, 0.902658998966217, 1.315603494644165, 0.9026741981506348, 0.9026695489883423, 1.3156073093414307, 0.9026739001274109, 1.3156108856201172, 0.9026739001274109, 1.3156111240386963, 1.3156102895736694, 1.3156094551086426, 1.3156089782714844, 1.3156105279922485, 1.3186886310577393, 0.902651309967041, 1.315601110458374, 1.3156096935272217, 1.3156100511550903, 1.3156110048294067, 1.3155999183654785, 1.315610408782959, 0.9026764631271362, 1.3175048828125, 1.3156076669692993, 1.3156083822250366, 1.3156102895736694, 1.3156105279922485, 1.3156094551086426, 1.3156076669692993, 1.3156108856201172, 1.3156105279922485, 1.3166743516921997, 1.3156044483184814, 1.3156100511550903, 1.4695905447006226, 1.3156077861785889, 1.31560480594635, 1.3156083822250366, 1.3156064748764038, 1.3155968189239502, 1.3156054019927979, 0.9026663303375244, 1.3156108856201172, 1.3156031370162964, 1.3156105279922485, 1.3156088590621948, 0.9026774764060974, 1.315609335899353, 1.3156071901321411, 1.3156107664108276, 1.3156101703643799, 1.3156094551086426, 0.9129984378814697, 1.3155990839004517, 1.31560218334198, 1.3156051635742188, 1.3156014680862427], "mean_td_error": 1.2670902013778687, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1850.0, "diff_num_grad_updates_vs_sampler_policy": 1849.0}}, "num_env_steps_sampled": 75000, "num_env_steps_trained": 144300, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 144300, "last_target_update_ts": 74880, "num_target_updates": 143}, "sampler_results": {"episode_reward_max": 6.538733531205675, "episode_reward_min": -19.93637372030667, "episode_reward_mean": -0.6999999720407462, "episode_len_mean": 24.99, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4701499914016671, 0.531362412633908, 0.32186618248567067, 0.18385517642925903, -7.96254492832718, 1.4256519258515052, 0.429506036078298, 0.06498644047469791, 0.775096002284174, 3.9358931059864597, -9.357547553713326, 0.3152507687125374, 0.2680042697667591, 0.08719889221600356, -17.30662564517544, 0.9893829010248559, -9.888956971610778, 0.10250962049936992, 0.3184889027196196, 0.11396343785917676, 2.399425488414077, 0.6657862360553497, 0.7053696384354351, 0.25255108067073334, 0.8409495754804027, 1.6435742609136257, 0.6288025920203112, 0.3038223695534228, 0.16950156866073296, 0.4663957697261291, 1.0539306230979042, 2.6288709707798588, 0.22303918461175556, 0.10971837175709812, 0.8297547447507889, 0.22389958495614778, -7.472285397290762, 0.18995838170468288, 0.13528718323202474, 0.1314697573327687, 6.538733531205675, 3.2979098185035727, 0.29057186521215034, 0.2668029219807418, 0.28524058375638844, -7.363478928158169, 5.776669202172804, 0.4177582345301221, 0.15526146714268776, -8.94484048069652, 0.3791859613425167, 0.33232923142691023, 0.23412073386418203, 0.44323547308077577, 0.07624572206224486, 6.448852761078097, 1.6103419592532386, 0.38494999525084467, 0.17788968213188527, 0.09925890179476204, 0.056093072236278144, 3.6042802895144623, 0.06644024098683793, 0.06377767346293495, -19.93637372030667, 0.0612863149523498, 0.05976279918226692, -9.883100749668289, 0.1374679454097578, 0.05613310939700788, 0.061316578559563406, 0.05415945533539888, 0.04630738772420206, 0.051453169491958384, 0.07028634310915712, -9.947621204718745, -9.940416841210077, 0.05217104281579841, 0.054093986933523346, 0.1341248361586302, 0.0524680765708684, 0.060815687439347885, 0.06415532264906985, 0.05451249829669706, 0.07107434087136713, 0.08306260623110648, 0.053711510394469086, 0.06708003603685232, 0.06514310999638365, 0.04645417744335803, 0.06652092749695915, 0.05633495051267905, 0.065363079653458, 0.05499802239267695, 0.053319069314975966, 0.08525216054660203, 0.05450445287414736, 0.06022643319556853, -9.940936328619445, 0.049949343867261985], "episode_lengths": [24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 24, 26, 25, 26, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.8480001143554, "mean_inference_ms": 2.1396483438642537, "mean_action_processing_ms": 0.14662298756945435, "mean_env_wait_ms": 1.2810300489512587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010301351547241211, "StateBufferConnector_ms": 0.006957054138183594, "ViewRequirementAgentConnector_ms": 0.1849501132965088}}, "episode_reward_max": 6.538733531205675, "episode_reward_min": -19.93637372030667, "episode_reward_mean": -0.6999999720407462, "episode_len_mean": 24.99, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.4701499914016671, 0.531362412633908, 0.32186618248567067, 0.18385517642925903, -7.96254492832718, 1.4256519258515052, 0.429506036078298, 0.06498644047469791, 0.775096002284174, 3.9358931059864597, -9.357547553713326, 0.3152507687125374, 0.2680042697667591, 0.08719889221600356, -17.30662564517544, 0.9893829010248559, -9.888956971610778, 0.10250962049936992, 0.3184889027196196, 0.11396343785917676, 2.399425488414077, 0.6657862360553497, 0.7053696384354351, 0.25255108067073334, 0.8409495754804027, 1.6435742609136257, 0.6288025920203112, 0.3038223695534228, 0.16950156866073296, 0.4663957697261291, 1.0539306230979042, 2.6288709707798588, 0.22303918461175556, 0.10971837175709812, 0.8297547447507889, 0.22389958495614778, -7.472285397290762, 0.18995838170468288, 0.13528718323202474, 0.1314697573327687, 6.538733531205675, 3.2979098185035727, 0.29057186521215034, 0.2668029219807418, 0.28524058375638844, -7.363478928158169, 5.776669202172804, 0.4177582345301221, 0.15526146714268776, -8.94484048069652, 0.3791859613425167, 0.33232923142691023, 0.23412073386418203, 0.44323547308077577, 0.07624572206224486, 6.448852761078097, 1.6103419592532386, 0.38494999525084467, 0.17788968213188527, 0.09925890179476204, 0.056093072236278144, 3.6042802895144623, 0.06644024098683793, 0.06377767346293495, -19.93637372030667, 0.0612863149523498, 0.05976279918226692, -9.883100749668289, 0.1374679454097578, 0.05613310939700788, 0.061316578559563406, 0.05415945533539888, 0.04630738772420206, 0.051453169491958384, 0.07028634310915712, -9.947621204718745, -9.940416841210077, 0.05217104281579841, 0.054093986933523346, 0.1341248361586302, 0.0524680765708684, 0.060815687439347885, 0.06415532264906985, 0.05451249829669706, 0.07107434087136713, 0.08306260623110648, 0.053711510394469086, 0.06708003603685232, 0.06514310999638365, 0.04645417744335803, 0.06652092749695915, 0.05633495051267905, 0.065363079653458, 0.05499802239267695, 0.053319069314975966, 0.08525216054660203, 0.05450445287414736, 0.06022643319556853, -9.940936328619445, 0.049949343867261985], "episode_lengths": [24, 25, 25, 25, 26, 24, 25, 25, 25, 24, 26, 25, 25, 24, 26, 25, 26, 25, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.8480001143554, "mean_inference_ms": 2.1396483438642537, "mean_action_processing_ms": 0.14662298756945435, "mean_env_wait_ms": 1.2810300489512587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010301351547241211, "StateBufferConnector_ms": 0.006957054138183594, "ViewRequirementAgentConnector_ms": 0.1849501132965088}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 144300, "num_env_steps_sampled": 75000, "num_env_steps_trained": 144300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5464606011128215, "num_env_steps_trained_throughput_per_sec": 6.915598172170002, "timesteps_total": 75000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 75000, "timers": {"training_iteration_time_ms": 11302.09, "sample_time_ms": 11237.182, "load_time_ms": 0.23, "load_throughput": 339091.741, "learn_time_ms": 13.301, "learn_throughput": 5864.056, "synch_weights_time_ms": 11.81}, "counters": {"num_env_steps_sampled": 75000, "num_env_steps_trained": 144300, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 144300, "last_target_update_ts": 74880, "num_target_updates": 143}, "done": false, "episodes_total": 2926, "training_iteration": 75, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-16-40", "timestamp": 1713424600, "time_this_iter_s": 281.9811444282532, "time_total_s": 18351.855837345123, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 18351.855837345123, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 12.258104738154614, "ram_util_percent": 24.851371571072317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.05158243328332901, "cur_lr": 0.01}, "td_error": [1.319327712059021, 1.3193680047988892, 0.8774832487106323, 1.3159126043319702, 1.3193682432174683, 1.3193680047988892, 1.3193684816360474, 1.319367527961731, 1.3180128335952759, 1.3193684816360474, 1.3716399669647217, 1.3181664943695068, 3.354989528656006, 1.3193684816360474, 1.3193684816360474, 0.8774781227111816, 1.3193682432174683, 1.3193681240081787, 1.3193671703338623, 1.3193681240081787, 1.3190138339996338, 1.3193683624267578, 3.3528506755828857, 1.3193676471710205, 1.31936776638031, 1.3193683624267578, 1.3193680047988892, 1.3285605907440186, 1.3193680047988892, 1.3193680047988892, 1.3193633556365967, 1.3193678855895996, 1.3193683624267578, 1.319367527961731, 1.3193684816360474, 1.3193680047988892, 0.8774835467338562, 1.3146873712539673, 1.317978024482727, 1.319367527961731, 1.3193683624267578, 1.3193639516830444, 1.3193676471710205, 1.3193683624267578, 1.31936776638031, 1.3193684816360474, 1.3193681240081787, 1.3193683624267578, 0.8843212127685547, 1.3193684816360474, 1.3193669319152832, 1.31936776638031, 1.3193678855895996, 1.319367527961731, 0.8774820566177368, 1.3193682432174683, 1.3193665742874146, 1.3193676471710205, 1.346906304359436, 1.5238466262817383, 1.319367527961731, 1.3193682432174683, 1.319366693496704, 1.3193682432174683, 1.317869782447815, 1.3193682432174683, 1.31936776638031, 1.3193680047988892, 1.3193680047988892, 1.3193682432174683, 1.3193680047988892, 1.3193684816360474, 1.3193684816360474, 0.8845442533493042, 1.3193682432174683, 1.3193684816360474, 1.3193683624267578, 1.3193683624267578], "mean_td_error": 1.341306447982788, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1875.0, "diff_num_grad_updates_vs_sampler_policy": 1874.0}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 146250, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 146250, "last_target_update_ts": 75920, "num_target_updates": 145}, "sampler_results": {"episode_reward_max": 6.538733531205675, "episode_reward_min": -19.93637372030667, "episode_reward_mean": -0.7689258681314799, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.538733531205675, 3.2979098185035727, 0.29057186521215034, 0.2668029219807418, 0.28524058375638844, -7.363478928158169, 5.776669202172804, 0.4177582345301221, 0.15526146714268776, -8.94484048069652, 0.3791859613425167, 0.33232923142691023, 0.23412073386418203, 0.44323547308077577, 0.07624572206224486, 6.448852761078097, 1.6103419592532386, 0.38494999525084467, 0.17788968213188527, 0.09925890179476204, 0.056093072236278144, 3.6042802895144623, 0.06644024098683793, 0.06377767346293495, -19.93637372030667, 0.0612863149523498, 0.05976279918226692, -9.883100749668289, 0.1374679454097578, 0.05613310939700788, 0.061316578559563406, 0.05415945533539888, 0.04630738772420206, 0.051453169491958384, 0.07028634310915712, -9.947621204718745, -9.940416841210077, 0.05217104281579841, 0.054093986933523346, 0.1341248361586302, 0.0524680765708684, 0.060815687439347885, 0.06415532264906985, 0.05451249829669706, 0.07107434087136713, 0.08306260623110648, 0.053711510394469086, 0.06708003603685232, 0.06514310999638365, 0.04645417744335803, 0.06652092749695915, 0.05633495051267905, 0.065363079653458, 0.05499802239267695, 0.053319069314975966, 0.08525216054660203, 0.05450445287414736, 0.06022643319556853, -9.940936328619445, 0.049949343867261985, 0.06830625004108382, 0.09202644537331932, 0.15499892587176856, 0.6572464365526626, 0.31883054901570446, 1.8358045678979125, -7.373069509976261, 0.954613968220118, 0.4515305527010513, 0.7788859861594475, 0.06971194295266543, 0.111828678964306, -9.743125983839047, 1.8331963783319503, 0.43118765146271526, 0.04846542026334479, 0.0440533849784344, 0.06609281882990332, 0.0987655342498216, 0.09464854587617887, 0.08510831091596703, 0.2747120908708044, 0.47405919232570753, 0.23776228211256853, 0.21390624091969018, 0.20456533432041077, 0.38198996154148585, 0.5993771872012672, -8.740104916953372, 0.4911751389753353, -9.955465276429315, 0.05182722612814824, 0.041340629589056856, 0.05743635223523038, 0.04608698841142276, -9.937177800089474, 0.06495926111897073, 0.058982265871999506, 0.24212206290336047, 0.1680622674900024], "episode_lengths": [25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 24, 24, 25, 23, 25, 24, 26, 23, 25, 25, 24, 25, 24, 25, 25, 24, 25, 23, 25, 25, 24, 25, 23, 25, 25, 24, 24, 25, 24, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.0877248619696, "mean_inference_ms": 2.1403182308339153, "mean_action_processing_ms": 0.14665782213965856, "mean_env_wait_ms": 1.2658109437246694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010495662689208984, "StateBufferConnector_ms": 0.00693964958190918, "ViewRequirementAgentConnector_ms": 0.18591761589050293}}, "episode_reward_max": 6.538733531205675, "episode_reward_min": -19.93637372030667, "episode_reward_mean": -0.7689258681314799, "episode_len_mean": 24.8, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.538733531205675, 3.2979098185035727, 0.29057186521215034, 0.2668029219807418, 0.28524058375638844, -7.363478928158169, 5.776669202172804, 0.4177582345301221, 0.15526146714268776, -8.94484048069652, 0.3791859613425167, 0.33232923142691023, 0.23412073386418203, 0.44323547308077577, 0.07624572206224486, 6.448852761078097, 1.6103419592532386, 0.38494999525084467, 0.17788968213188527, 0.09925890179476204, 0.056093072236278144, 3.6042802895144623, 0.06644024098683793, 0.06377767346293495, -19.93637372030667, 0.0612863149523498, 0.05976279918226692, -9.883100749668289, 0.1374679454097578, 0.05613310939700788, 0.061316578559563406, 0.05415945533539888, 0.04630738772420206, 0.051453169491958384, 0.07028634310915712, -9.947621204718745, -9.940416841210077, 0.05217104281579841, 0.054093986933523346, 0.1341248361586302, 0.0524680765708684, 0.060815687439347885, 0.06415532264906985, 0.05451249829669706, 0.07107434087136713, 0.08306260623110648, 0.053711510394469086, 0.06708003603685232, 0.06514310999638365, 0.04645417744335803, 0.06652092749695915, 0.05633495051267905, 0.065363079653458, 0.05499802239267695, 0.053319069314975966, 0.08525216054660203, 0.05450445287414736, 0.06022643319556853, -9.940936328619445, 0.049949343867261985, 0.06830625004108382, 0.09202644537331932, 0.15499892587176856, 0.6572464365526626, 0.31883054901570446, 1.8358045678979125, -7.373069509976261, 0.954613968220118, 0.4515305527010513, 0.7788859861594475, 0.06971194295266543, 0.111828678964306, -9.743125983839047, 1.8331963783319503, 0.43118765146271526, 0.04846542026334479, 0.0440533849784344, 0.06609281882990332, 0.0987655342498216, 0.09464854587617887, 0.08510831091596703, 0.2747120908708044, 0.47405919232570753, 0.23776228211256853, 0.21390624091969018, 0.20456533432041077, 0.38198996154148585, 0.5993771872012672, -8.740104916953372, 0.4911751389753353, -9.955465276429315, 0.05182722612814824, 0.041340629589056856, 0.05743635223523038, 0.04608698841142276, -9.937177800089474, 0.06495926111897073, 0.058982265871999506, 0.24212206290336047, 0.1680622674900024], "episode_lengths": [25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 24, 24, 25, 23, 25, 24, 26, 23, 25, 25, 24, 25, 24, 25, 25, 24, 25, 23, 25, 25, 24, 25, 23, 25, 25, 24, 24, 25, 24, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.0877248619696, "mean_inference_ms": 2.1403182308339153, "mean_action_processing_ms": 0.14665782213965856, "mean_env_wait_ms": 1.2658109437246694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010495662689208984, "StateBufferConnector_ms": 0.00693964958190918, "ViewRequirementAgentConnector_ms": 0.18591761589050293}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 146250, "num_env_steps_sampled": 76000, "num_env_steps_trained": 146250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5637507793822825, "num_env_steps_trained_throughput_per_sec": 6.949314019795451, "timesteps_total": 76000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 11208.264, "sample_time_ms": 11141.415, "load_time_ms": 0.263, "load_throughput": 296578.472, "learn_time_ms": 13.758, "learn_throughput": 5669.344, "synch_weights_time_ms": 12.791}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 146250, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 146250, "last_target_update_ts": 75920, "num_target_updates": 145}, "done": false, "episodes_total": 2966, "training_iteration": 76, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-21-21", "timestamp": 1713424881, "time_this_iter_s": 280.61285972595215, "time_total_s": 18632.468697071075, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 18632.468697071075, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 12.037939698492464, "ram_util_percent": 25.100251256281407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.060410648584365845, "cur_lr": 0.01}, "td_error": [1.3025832176208496, 1.3025814294815063, 1.302581548690796, 1.3025671243667603, 1.302581787109375, 1.3025836944580078, 1.3025795221328735, 1.3501070737838745, 1.3025829792022705, 0.8907073736190796, 1.302581787109375, 1.3025798797607422, 1.3025825023651123, 1.302574872970581, 1.302583932876587, 1.3060505390167236, 1.3025829792022705, 1.30258047580719, 1.3025829792022705, 1.3025788068771362, 1.3025829792022705, 1.302580714225769, 1.302582025527954, 1.3081508874893188, 1.3025834560394287, 1.3025672435760498, 1.3025805950164795, 1.302581787109375, 1.3033376932144165, 1.3025808334350586, 1.3025779724121094, 1.302584171295166, 1.3025821447372437, 1.3025808334350586, 1.3025827407836914, 1.302584171295166, 0.9279692769050598, 1.3025786876678467, 1.3025840520858765, 1.3073903322219849, 1.302584171295166, 1.3025844097137451, 1.3025742769241333, 1.302581787109375, 1.3025814294815063, 1.3025803565979004, 1.3025829792022705, 1.3025844097137451, 1.3025816679000854, 1.3025788068771362, 1.3025671243667603, 1.3025788068771362, 1.3025808334350586, 0.9083118438720703, 1.3025816679000854, 1.3025836944580078, 1.3025795221328735, 0.8906930685043335, 1.302584171295166, 1.3025749921798706, 1.3025809526443481, 1.3025836944580078, 1.302581548690796, 1.3025823831558228, 1.3025791645050049, 0.8907092809677124, 1.3025826215744019, 1.3025805950164795, 1.3025761842727661, 1.3447479009628296, 1.3025823831558228, 1.3042340278625488, 1.3021304607391357, 1.3025702238082886, 1.3025835752487183, 1.3546332120895386, 1.3025826215744019, 1.3025785684585571], "mean_td_error": 1.2789016962051392, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1900.0, "diff_num_grad_updates_vs_sampler_policy": 1899.0}}, "num_env_steps_sampled": 77000, "num_env_steps_trained": 148200, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 148200, "last_target_update_ts": 76960, "num_target_updates": 147}, "sampler_results": {"episode_reward_max": 1.8358045678979125, "episode_reward_min": -9.955465276429315, "episode_reward_mean": -0.8726644917648986, "episode_len_mean": 24.74, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0524680765708684, 0.060815687439347885, 0.06415532264906985, 0.05451249829669706, 0.07107434087136713, 0.08306260623110648, 0.053711510394469086, 0.06708003603685232, 0.06514310999638365, 0.04645417744335803, 0.06652092749695915, 0.05633495051267905, 0.065363079653458, 0.05499802239267695, 0.053319069314975966, 0.08525216054660203, 0.05450445287414736, 0.06022643319556853, -9.940936328619445, 0.049949343867261985, 0.06830625004108382, 0.09202644537331932, 0.15499892587176856, 0.6572464365526626, 0.31883054901570446, 1.8358045678979125, -7.373069509976261, 0.954613968220118, 0.4515305527010513, 0.7788859861594475, 0.06971194295266543, 0.111828678964306, -9.743125983839047, 1.8331963783319503, 0.43118765146271526, 0.04846542026334479, 0.0440533849784344, 0.06609281882990332, 0.0987655342498216, 0.09464854587617887, 0.08510831091596703, 0.2747120908708044, 0.47405919232570753, 0.23776228211256853, 0.21390624091969018, 0.20456533432041077, 0.38198996154148585, 0.5993771872012672, -8.740104916953372, 0.4911751389753353, -9.955465276429315, 0.05182722612814824, 0.041340629589056856, 0.05743635223523038, 0.04608698841142276, -9.937177800089474, 0.06495926111897073, 0.058982265871999506, 0.24212206290336047, 0.1680622674900024, -9.15578330137945, 0.14251926395112532, 0.08131308342086732, 0.10299154750824896, -9.950965760946682, 0.1685507912437142, 0.1743989520342681, 0.11581874368325062, 0.10303394442889152, 0.05033271586272216, 0.20576837256679986, 0.2661283675206077, 0.14643045823764672, 0.09706430971215697, 0.09407119513290704, 0.09025426515287394, 0.09455015890979152, 0.09953766052902552, 0.08772920182694656, 0.056428216803419085, 0.25613040191647796, 0.2814329963656775, 0.15003032104926897, 0.10988796890575012, 0.1367874330606465, 0.21472943249977797, 0.18690302098034095, 0.15999817698679103, 0.11641227088400528, 0.061698723530210935, 0.06725163757991592, 0.07573833644493605, 0.05607842024116083, -9.949824137445884, 0.04915681285808174, 0.07197690450378853, -9.852857761640175, 0.07155387565886026, 0.046354498748346185, -9.924793516367709], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 24, 24, 25, 23, 25, 24, 26, 23, 25, 25, 24, 25, 24, 25, 25, 24, 25, 23, 25, 25, 24, 25, 23, 25, 25, 24, 24, 25, 24, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 26, 24, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.3158547495925, "mean_inference_ms": 2.14074355556641, "mean_action_processing_ms": 0.14669570422746683, "mean_env_wait_ms": 1.2509708839692033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011241912841796875, "StateBufferConnector_ms": 0.007025480270385742, "ViewRequirementAgentConnector_ms": 0.18427515029907227}}, "episode_reward_max": 1.8358045678979125, "episode_reward_min": -9.955465276429315, "episode_reward_mean": -0.8726644917648986, "episode_len_mean": 24.74, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0524680765708684, 0.060815687439347885, 0.06415532264906985, 0.05451249829669706, 0.07107434087136713, 0.08306260623110648, 0.053711510394469086, 0.06708003603685232, 0.06514310999638365, 0.04645417744335803, 0.06652092749695915, 0.05633495051267905, 0.065363079653458, 0.05499802239267695, 0.053319069314975966, 0.08525216054660203, 0.05450445287414736, 0.06022643319556853, -9.940936328619445, 0.049949343867261985, 0.06830625004108382, 0.09202644537331932, 0.15499892587176856, 0.6572464365526626, 0.31883054901570446, 1.8358045678979125, -7.373069509976261, 0.954613968220118, 0.4515305527010513, 0.7788859861594475, 0.06971194295266543, 0.111828678964306, -9.743125983839047, 1.8331963783319503, 0.43118765146271526, 0.04846542026334479, 0.0440533849784344, 0.06609281882990332, 0.0987655342498216, 0.09464854587617887, 0.08510831091596703, 0.2747120908708044, 0.47405919232570753, 0.23776228211256853, 0.21390624091969018, 0.20456533432041077, 0.38198996154148585, 0.5993771872012672, -8.740104916953372, 0.4911751389753353, -9.955465276429315, 0.05182722612814824, 0.041340629589056856, 0.05743635223523038, 0.04608698841142276, -9.937177800089474, 0.06495926111897073, 0.058982265871999506, 0.24212206290336047, 0.1680622674900024, -9.15578330137945, 0.14251926395112532, 0.08131308342086732, 0.10299154750824896, -9.950965760946682, 0.1685507912437142, 0.1743989520342681, 0.11581874368325062, 0.10303394442889152, 0.05033271586272216, 0.20576837256679986, 0.2661283675206077, 0.14643045823764672, 0.09706430971215697, 0.09407119513290704, 0.09025426515287394, 0.09455015890979152, 0.09953766052902552, 0.08772920182694656, 0.056428216803419085, 0.25613040191647796, 0.2814329963656775, 0.15003032104926897, 0.10988796890575012, 0.1367874330606465, 0.21472943249977797, 0.18690302098034095, 0.15999817698679103, 0.11641227088400528, 0.061698723530210935, 0.06725163757991592, 0.07573833644493605, 0.05607842024116083, -9.949824137445884, 0.04915681285808174, 0.07197690450378853, -9.852857761640175, 0.07155387565886026, 0.046354498748346185, -9.924793516367709], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 24, 24, 25, 23, 25, 24, 26, 23, 25, 25, 24, 25, 24, 25, 25, 24, 25, 23, 25, 25, 24, 25, 23, 25, 25, 24, 24, 25, 24, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 26, 24, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.3158547495925, "mean_inference_ms": 2.14074355556641, "mean_action_processing_ms": 0.14669570422746683, "mean_env_wait_ms": 1.2509708839692033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011241912841796875, "StateBufferConnector_ms": 0.007025480270385742, "ViewRequirementAgentConnector_ms": 0.18427515029907227}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 148200, "num_env_steps_sampled": 77000, "num_env_steps_trained": 148200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.6944886033071604, "num_env_steps_trained_throughput_per_sec": 7.204252776448962, "timesteps_total": 77000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 77000, "timers": {"training_iteration_time_ms": 10145.741, "sample_time_ms": 10076.628, "load_time_ms": 0.235, "load_throughput": 331364.035, "learn_time_ms": 14.205, "learn_throughput": 5491.005, "synch_weights_time_ms": 13.824}, "counters": {"num_env_steps_sampled": 77000, "num_env_steps_trained": 148200, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 148200, "last_target_update_ts": 76960, "num_target_updates": 147}, "done": false, "episodes_total": 3006, "training_iteration": 77, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-25-51", "timestamp": 1713425151, "time_this_iter_s": 270.6844401359558, "time_total_s": 18903.15313720703, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 18903.15313720703, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 11.551036269430051, "ram_util_percent": 25.175129533678753}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.05091607943177223, "cur_lr": 0.01}, "td_error": [1.3375996351242065, 2.8169140815734863, 0.8891875147819519, 1.3375966548919678, 1.3376001119613647, 1.3379753828048706, 1.3376015424728394, 1.3376001119613647, 1.337601900100708, 1.3376013040542603, 1.3375962972640991, 1.3369221687316895, 1.337601661682129, 1.3376024961471558, 1.3375990390777588, 1.3375962972640991, 1.3375972509384155, 1.3375993967056274, 1.3375964164733887, 1.3376007080078125, 1.337594747543335, 1.3375951051712036, 1.3376002311706543, 1.3825057744979858, 0.8892037868499756, 1.3375972509384155, 1.3376013040542603, 1.3376017808914185, 1.337598204612732, 1.3350285291671753, 1.3376003503799438, 1.3376004695892334, 1.3376015424728394, 1.3375933170318604, 0.8892052173614502, 1.337601661682129, 1.337599277496338, 0.8891870379447937, 1.337600827217102, 1.3375869989395142, 0.8892064094543457, 1.3375909328460693, 1.3375988006591797, 1.3375998735427856, 1.3376022577285767, 1.3376003503799438, 1.3375991582870483, 1.3375998735427856, 1.3376007080078125, 1.0006474256515503, 1.3375965356826782, 1.3376011848449707, 1.337601661682129, 1.337599277496338, 1.3375929594039917, 1.3375993967056274, 1.3375996351242065, 1.3375999927520752, 1.337590217590332, 1.3375897407531738, 1.3376013040542603, 1.3376003503799438, 1.3395397663116455, 1.3376003503799438, 1.3376009464263916, 1.3375964164733887, 0.9669227600097656, 1.3375986814498901, 1.337600827217102, 1.337599754333496, 1.3375967741012573, 3.261429786682129, 1.3376011848449707, 1.3376013040542603, 1.337598204612732, 1.344390630722046, 1.3376007080078125, 1.337601661682129], "mean_td_error": 1.3440638780593872, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1925.0, "diff_num_grad_updates_vs_sampler_policy": 1924.0}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 150150, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 150150, "last_target_update_ts": 78000, "num_target_updates": 149}, "sampler_results": {"episode_reward_max": 0.738003517844662, "episode_reward_min": -19.944114579510504, "episode_reward_mean": -1.4526624363976475, "episode_len_mean": 24.89, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2747120908708044, 0.47405919232570753, 0.23776228211256853, 0.21390624091969018, 0.20456533432041077, 0.38198996154148585, 0.5993771872012672, -8.740104916953372, 0.4911751389753353, -9.955465276429315, 0.05182722612814824, 0.041340629589056856, 0.05743635223523038, 0.04608698841142276, -9.937177800089474, 0.06495926111897073, 0.058982265871999506, 0.24212206290336047, 0.1680622674900024, -9.15578330137945, 0.14251926395112532, 0.08131308342086732, 0.10299154750824896, -9.950965760946682, 0.1685507912437142, 0.1743989520342681, 0.11581874368325062, 0.10303394442889152, 0.05033271586272216, 0.20576837256679986, 0.2661283675206077, 0.14643045823764672, 0.09706430971215697, 0.09407119513290704, 0.09025426515287394, 0.09455015890979152, 0.09953766052902552, 0.08772920182694656, 0.056428216803419085, 0.25613040191647796, 0.2814329963656775, 0.15003032104926897, 0.10988796890575012, 0.1367874330606465, 0.21472943249977797, 0.18690302098034095, 0.15999817698679103, 0.11641227088400528, 0.061698723530210935, 0.06725163757991592, 0.07573833644493605, 0.05607842024116083, -9.949824137445884, 0.04915681285808174, 0.07197690450378853, -9.852857761640175, 0.07155387565886026, 0.046354498748346185, -9.924793516367709, 0.047420106515118916, 0.04024006000519092, 0.058027024327428886, 0.0536243483023908, 0.052156599659426234, 0.04676402807859699, 0.738003517844662, 0.02330020734780308, 0.07882575338275463, -9.913492533206265, 0.06677289411795925, 0.07112656272473138, 0.10240348661700538, 0.053569816467430795, 0.07457112707343114, 0.049503465860514816, 0.052373263532878134, 0.08821059575173092, 0.09750027102668858, 0.07536097273926945, 0.0554334531956229, 0.0898328841832545, 0.24694556828693728, 0.19223071859735313, 0.14003220516929824, 0.1268726744621033, 0.060989637652024246, 0.042449348348003305, 0.053257484335828824, 0.06335373624410048, -9.925094184310861, -9.964495138558373, -9.944412781267953, 0.04216241132591201, 0.046278936404241196, 0.0483467014241001, -9.255746499287044, -9.94320386940772, 0.06414819854856081, 0.051793394728921055, -19.944114579510504], "episode_lengths": [25, 23, 25, 25, 24, 24, 25, 24, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 26, 24, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 26, 25, 25, 24, 26, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.529250522635, "mean_inference_ms": 2.1416366003705787, "mean_action_processing_ms": 0.14670831675808246, "mean_env_wait_ms": 1.235912144468911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011605024337768555, "StateBufferConnector_ms": 0.006940126419067383, "ViewRequirementAgentConnector_ms": 0.1868128776550293}}, "episode_reward_max": 0.738003517844662, "episode_reward_min": -19.944114579510504, "episode_reward_mean": -1.4526624363976475, "episode_len_mean": 24.89, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.2747120908708044, 0.47405919232570753, 0.23776228211256853, 0.21390624091969018, 0.20456533432041077, 0.38198996154148585, 0.5993771872012672, -8.740104916953372, 0.4911751389753353, -9.955465276429315, 0.05182722612814824, 0.041340629589056856, 0.05743635223523038, 0.04608698841142276, -9.937177800089474, 0.06495926111897073, 0.058982265871999506, 0.24212206290336047, 0.1680622674900024, -9.15578330137945, 0.14251926395112532, 0.08131308342086732, 0.10299154750824896, -9.950965760946682, 0.1685507912437142, 0.1743989520342681, 0.11581874368325062, 0.10303394442889152, 0.05033271586272216, 0.20576837256679986, 0.2661283675206077, 0.14643045823764672, 0.09706430971215697, 0.09407119513290704, 0.09025426515287394, 0.09455015890979152, 0.09953766052902552, 0.08772920182694656, 0.056428216803419085, 0.25613040191647796, 0.2814329963656775, 0.15003032104926897, 0.10988796890575012, 0.1367874330606465, 0.21472943249977797, 0.18690302098034095, 0.15999817698679103, 0.11641227088400528, 0.061698723530210935, 0.06725163757991592, 0.07573833644493605, 0.05607842024116083, -9.949824137445884, 0.04915681285808174, 0.07197690450378853, -9.852857761640175, 0.07155387565886026, 0.046354498748346185, -9.924793516367709, 0.047420106515118916, 0.04024006000519092, 0.058027024327428886, 0.0536243483023908, 0.052156599659426234, 0.04676402807859699, 0.738003517844662, 0.02330020734780308, 0.07882575338275463, -9.913492533206265, 0.06677289411795925, 0.07112656272473138, 0.10240348661700538, 0.053569816467430795, 0.07457112707343114, 0.049503465860514816, 0.052373263532878134, 0.08821059575173092, 0.09750027102668858, 0.07536097273926945, 0.0554334531956229, 0.0898328841832545, 0.24694556828693728, 0.19223071859735313, 0.14003220516929824, 0.1268726744621033, 0.060989637652024246, 0.042449348348003305, 0.053257484335828824, 0.06335373624410048, -9.925094184310861, -9.964495138558373, -9.944412781267953, 0.04216241132591201, 0.046278936404241196, 0.0483467014241001, -9.255746499287044, -9.94320386940772, 0.06414819854856081, 0.051793394728921055, -19.944114579510504], "episode_lengths": [25, 23, 25, 25, 24, 24, 25, 24, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 26, 24, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 26, 25, 25, 24, 26, 26, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.529250522635, "mean_inference_ms": 2.1416366003705787, "mean_action_processing_ms": 0.14670831675808246, "mean_env_wait_ms": 1.235912144468911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011605024337768555, "StateBufferConnector_ms": 0.006940126419067383, "ViewRequirementAgentConnector_ms": 0.1868128776550293}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 150150, "num_env_steps_sampled": 78000, "num_env_steps_trained": 150150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.447446225964438, "num_env_steps_trained_throughput_per_sec": 8.672520140630654, "timesteps_total": 78000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 9027.911, "sample_time_ms": 8960.093, "load_time_ms": 0.251, "load_throughput": 310217.819, "learn_time_ms": 13.045, "learn_throughput": 5979.193, "synch_weights_time_ms": 12.699}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 150150, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 150150, "last_target_update_ts": 78000, "num_target_updates": 149}, "done": false, "episodes_total": 3047, "training_iteration": 78, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-29-36", "timestamp": 1713425376, "time_this_iter_s": 224.8584179878235, "time_total_s": 19128.011555194855, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 19128.011555194855, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 13.895, "ram_util_percent": 25.278437500000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.023382598534226418, "cur_lr": 0.01}, "td_error": [1.306864619255066, 0.8992996215820312, 1.3105254173278809, 1.3068584203720093, 1.306867003440857, 1.306867241859436, 1.3068673610687256, 1.3068677186965942, 1.3068650960922241, 1.3068634271621704, 1.3068612813949585, 1.3068647384643555, 1.306865930557251, 1.3068641424179077, 1.306868076324463, 1.3068667650222778, 1.3068673610687256, 1.3068674802780151, 1.3068641424179077, 0.8993051052093506, 1.3092474937438965, 3.3875768184661865, 0.8993030786514282, 1.3068656921386719, 1.3068673610687256, 1.3068671226501465, 1.3093456029891968, 1.3065465688705444, 1.3068666458129883, 1.3068621158599854, 1.3068673610687256, 1.3068668842315674, 1.3068678379058838, 1.306867241859436, 1.306865930557251, 1.3068673610687256, 1.3068673610687256, 1.3044490814208984, 1.306867003440857, 0.8993051648139954, 1.3068674802780151, 1.3068660497665405, 1.3068662881851196, 1.3068649768829346, 1.3068671226501465, 1.3068578243255615, 1.3068673610687256, 1.3068656921386719, 1.3068605661392212, 1.3068665266036987, 1.306864857673645, 1.3068630695343018, 1.3068664073944092, 1.3068654537200928, 1.3068652153015137, 1.3061456680297852, 1.3068618774414062, 1.3068658113479614, 1.3068667650222778, 1.4001256227493286, 1.306865930557251, 1.3068664073944092, 1.3477952480316162, 1.306867241859436, 1.3068675994873047, 1.3068645000457764, 1.3068649768829346, 1.3068660497665405, 1.306867241859436, 1.310177206993103, 3.386892080307007, 1.3068665266036987, 1.3068662881851196, 1.3068665266036987, 1.3068641424179077, 1.3068656921386719, 1.3068677186965942, 0.9131960868835449], "mean_td_error": 1.3360885381698608, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1950.0, "diff_num_grad_updates_vs_sampler_policy": 1949.0}}, "num_env_steps_sampled": 79000, "num_env_steps_trained": 152100, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 152100, "last_target_update_ts": 78520, "num_target_updates": 150}, "sampler_results": {"episode_reward_max": 0.738003517844662, "episode_reward_min": -19.944114579510504, "episode_reward_mean": -1.5112629198769205, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2814329963656775, 0.15003032104926897, 0.10988796890575012, 0.1367874330606465, 0.21472943249977797, 0.18690302098034095, 0.15999817698679103, 0.11641227088400528, 0.061698723530210935, 0.06725163757991592, 0.07573833644493605, 0.05607842024116083, -9.949824137445884, 0.04915681285808174, 0.07197690450378853, -9.852857761640175, 0.07155387565886026, 0.046354498748346185, -9.924793516367709, 0.047420106515118916, 0.04024006000519092, 0.058027024327428886, 0.0536243483023908, 0.052156599659426234, 0.04676402807859699, 0.738003517844662, 0.02330020734780308, 0.07882575338275463, -9.913492533206265, 0.06677289411795925, 0.07112656272473138, 0.10240348661700538, 0.053569816467430795, 0.07457112707343114, 0.049503465860514816, 0.052373263532878134, 0.08821059575173092, 0.09750027102668858, 0.07536097273926945, 0.0554334531956229, 0.0898328841832545, 0.24694556828693728, 0.19223071859735313, 0.14003220516929824, 0.1268726744621033, 0.060989637652024246, 0.042449348348003305, 0.053257484335828824, 0.06335373624410048, -9.925094184310861, -9.964495138558373, -9.944412781267953, 0.04216241132591201, 0.046278936404241196, 0.0483467014241001, -9.255746499287044, -9.94320386940772, 0.06414819854856081, 0.051793394728921055, -19.944114579510504, 0.03973080561222071, 0.035255575795406474, 0.03297671765419287, 0.028194401625703476, 0.022516820381395925, 0.42911822850389614, 0.05778585058315975, 0.05376452588496271, 0.0425254910261987, 0.03624531453011213, 0.40501526281220324, -9.949727719856085, 0.047675941203833075, 0.03520120114979634, 0.0302517223216546, 0.04758155622969717, 0.055689640082145664, 0.04348193498030728, 0.04561687461114954, 0.04238346045946768, 0.08341225834630679, 0.06640761131527512, -9.943126725151235, -9.946866770226665, 0.032405210880893355, 0.05975010359339712, 0.04591132559882124, 0.03792914579040543, 0.03512454975424809, 0.028289532925555413, 0.043641816700609924, -9.962720289258055, 0.037566335384117445, 0.03012634336452038, 0.021223348180555716, 0.04274805497207314, -9.95781746933167, 0.04593509821621359, 0.032476088405433146, 0.02817155367940036], "episode_lengths": [25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 26, 25, 25, 24, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.7361242486372, "mean_inference_ms": 2.142005776306799, "mean_action_processing_ms": 0.14672419552136484, "mean_env_wait_ms": 1.2218130633985091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011100292205810547, "StateBufferConnector_ms": 0.006857395172119141, "ViewRequirementAgentConnector_ms": 0.18631792068481445}}, "episode_reward_max": 0.738003517844662, "episode_reward_min": -19.944114579510504, "episode_reward_mean": -1.5112629198769205, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.2814329963656775, 0.15003032104926897, 0.10988796890575012, 0.1367874330606465, 0.21472943249977797, 0.18690302098034095, 0.15999817698679103, 0.11641227088400528, 0.061698723530210935, 0.06725163757991592, 0.07573833644493605, 0.05607842024116083, -9.949824137445884, 0.04915681285808174, 0.07197690450378853, -9.852857761640175, 0.07155387565886026, 0.046354498748346185, -9.924793516367709, 0.047420106515118916, 0.04024006000519092, 0.058027024327428886, 0.0536243483023908, 0.052156599659426234, 0.04676402807859699, 0.738003517844662, 0.02330020734780308, 0.07882575338275463, -9.913492533206265, 0.06677289411795925, 0.07112656272473138, 0.10240348661700538, 0.053569816467430795, 0.07457112707343114, 0.049503465860514816, 0.052373263532878134, 0.08821059575173092, 0.09750027102668858, 0.07536097273926945, 0.0554334531956229, 0.0898328841832545, 0.24694556828693728, 0.19223071859735313, 0.14003220516929824, 0.1268726744621033, 0.060989637652024246, 0.042449348348003305, 0.053257484335828824, 0.06335373624410048, -9.925094184310861, -9.964495138558373, -9.944412781267953, 0.04216241132591201, 0.046278936404241196, 0.0483467014241001, -9.255746499287044, -9.94320386940772, 0.06414819854856081, 0.051793394728921055, -19.944114579510504, 0.03973080561222071, 0.035255575795406474, 0.03297671765419287, 0.028194401625703476, 0.022516820381395925, 0.42911822850389614, 0.05778585058315975, 0.05376452588496271, 0.0425254910261987, 0.03624531453011213, 0.40501526281220324, -9.949727719856085, 0.047675941203833075, 0.03520120114979634, 0.0302517223216546, 0.04758155622969717, 0.055689640082145664, 0.04348193498030728, 0.04561687461114954, 0.04238346045946768, 0.08341225834630679, 0.06640761131527512, -9.943126725151235, -9.946866770226665, 0.032405210880893355, 0.05975010359339712, 0.04591132559882124, 0.03792914579040543, 0.03512454975424809, 0.028289532925555413, 0.043641816700609924, -9.962720289258055, 0.037566335384117445, 0.03012634336452038, 0.021223348180555716, 0.04274805497207314, -9.95781746933167, 0.04593509821621359, 0.032476088405433146, 0.02817155367940036], "episode_lengths": [25, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 26, 25, 25, 24, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.7361242486372, "mean_inference_ms": 2.142005776306799, "mean_action_processing_ms": 0.14672419552136484, "mean_env_wait_ms": 1.2218130633985091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011100292205810547, "StateBufferConnector_ms": 0.006857395172119141, "ViewRequirementAgentConnector_ms": 0.18631792068481445}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 152100, "num_env_steps_sampled": 79000, "num_env_steps_trained": 152100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.43313865806686, "num_env_steps_trained_throughput_per_sec": 8.644620383230377, "timesteps_total": 79000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 79000, "timers": {"training_iteration_time_ms": 9106.597, "sample_time_ms": 9044.085, "load_time_ms": 0.233, "load_throughput": 335441.107, "learn_time_ms": 12.842, "learn_throughput": 6073.792, "synch_weights_time_ms": 11.46}, "counters": {"num_env_steps_sampled": 79000, "num_env_steps_trained": 152100, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 152100, "last_target_update_ts": 78520, "num_target_updates": 150}, "done": false, "episodes_total": 3087, "training_iteration": 79, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-33-22", "timestamp": 1713425602, "time_this_iter_s": 225.58337259292603, "time_total_s": 19353.59492778778, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 19353.59492778778, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 13.6284375, "ram_util_percent": 25.435000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02563934028148651, "cur_lr": 0.01}, "td_error": [0.894181489944458, 1.3034310340881348, 1.3078099489212036, 1.307810664176941, 1.3078120946884155, 1.3265966176986694, 1.307812213897705, 1.3069216012954712, 1.307812213897705, 1.307812213897705, 1.3287019729614258, 1.3078114986419678, 1.3078120946884155, 1.3078126907348633, 0.8941836357116699, 1.3078118562698364, 1.3078116178512573, 0.8941781520843506, 1.304063320159912, 1.305920124053955, 1.3078093528747559, 1.3078120946884155, 1.6048314571380615, 1.3078117370605469, 3.329695463180542, 1.307812213897705, 1.307812213897705, 1.3078125715255737, 1.3041244745254517, 0.8941779136657715, 1.3078128099441528, 1.3078105449676514, 1.307812213897705, 1.3078124523162842, 1.3059866428375244, 1.307812213897705, 1.3054789304733276, 1.3078114986419678, 1.3078111410140991, 1.30781090259552, 1.3078123331069946, 0.8941817283630371, 1.3051940202713013, 1.305895209312439, 1.307811975479126, 1.3078117370605469, 1.3078118562698364, 1.3078125715255737, 1.3078099489212036, 1.3078128099441528, 1.3078112602233887, 1.3078116178512573, 1.3078118562698364, 0.8941739201545715, 1.3078120946884155, 1.3078101873397827, 1.3078118562698364, 1.3078123331069946, 0.8941812515258789, 1.307812213897705, 1.3060473203659058, 1.3139612674713135, 1.3078100681304932, 1.307812213897705, 1.3078124523162842, 1.3043265342712402, 1.305546522140503, 1.3056977987289429, 1.307807207107544, 1.307812213897705, 1.3078120946884155, 1.3078117370605469, 1.3078114986419678, 1.3078100681304932, 1.307811975479126, 1.307812213897705, 1.3078118562698364, 1.3078116178512573], "mean_td_error": 1.3005858659744263, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1975.0, "diff_num_grad_updates_vs_sampler_policy": 1974.0}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 154050, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 154050, "last_target_update_ts": 79560, "num_target_updates": 152}, "sampler_results": {"episode_reward_max": 0.42911822850389614, "episode_reward_min": -19.972973268302294, "episode_reward_mean": -1.7430617507834378, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0898328841832545, 0.24694556828693728, 0.19223071859735313, 0.14003220516929824, 0.1268726744621033, 0.060989637652024246, 0.042449348348003305, 0.053257484335828824, 0.06335373624410048, -9.925094184310861, -9.964495138558373, -9.944412781267953, 0.04216241132591201, 0.046278936404241196, 0.0483467014241001, -9.255746499287044, -9.94320386940772, 0.06414819854856081, 0.051793394728921055, -19.944114579510504, 0.03973080561222071, 0.035255575795406474, 0.03297671765419287, 0.028194401625703476, 0.022516820381395925, 0.42911822850389614, 0.05778585058315975, 0.05376452588496271, 0.0425254910261987, 0.03624531453011213, 0.40501526281220324, -9.949727719856085, 0.047675941203833075, 0.03520120114979634, 0.0302517223216546, 0.04758155622969717, 0.055689640082145664, 0.04348193498030728, 0.04561687461114954, 0.04238346045946768, 0.08341225834630679, 0.06640761131527512, -9.943126725151235, -9.946866770226665, 0.032405210880893355, 0.05975010359339712, 0.04591132559882124, 0.03792914579040543, 0.03512454975424809, 0.028289532925555413, 0.043641816700609924, -9.962720289258055, 0.037566335384117445, 0.03012634336452038, 0.021223348180555716, 0.04274805497207314, -9.95781746933167, 0.04593509821621359, 0.032476088405433146, 0.02817155367940036, 0.022068397481696908, 0.021845107048360884, 0.01950683732824753, 0.01724354478640884, 0.015787443875875495, 0.021023407473750123, 0.02688752105659865, 0.02558293767535132, 0.022669055394956016, 0.020948866274793126, 0.02052554961587103, 0.028772748274297367, 0.027966706677219823, 0.02406888229461345, 0.020471093892422347, -9.970910948099975, -19.972973268302294, 0.025311180973569967, -9.975332635930954, 0.02103143929307864, 0.03678071594500448, 0.033385722383365235, 0.031471250410689204, -9.97125366276775, 0.023664733681785108, 0.020070032647547965, 0.027686466150269616, 0.024842589724563564, 0.022159457225648112, 0.019888123303955202, 0.023367631148972324, -9.97635411210427, 0.0226192478813321, 0.019960933638084776, 0.01795106909547446, 0.0265660049553625, 0.027515025725245484, 0.024182159209615972, 0.023192026119467368, 0.020138064098165324], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 26, 25, 25, 24, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.8831683295411, "mean_inference_ms": 2.1410104974401145, "mean_action_processing_ms": 0.1467015480880319, "mean_env_wait_ms": 1.2081623878033827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010027647018432617, "StateBufferConnector_ms": 0.006563901901245117, "ViewRequirementAgentConnector_ms": 0.17829608917236328}}, "episode_reward_max": 0.42911822850389614, "episode_reward_min": -19.972973268302294, "episode_reward_mean": -1.7430617507834378, "episode_len_mean": 25.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0898328841832545, 0.24694556828693728, 0.19223071859735313, 0.14003220516929824, 0.1268726744621033, 0.060989637652024246, 0.042449348348003305, 0.053257484335828824, 0.06335373624410048, -9.925094184310861, -9.964495138558373, -9.944412781267953, 0.04216241132591201, 0.046278936404241196, 0.0483467014241001, -9.255746499287044, -9.94320386940772, 0.06414819854856081, 0.051793394728921055, -19.944114579510504, 0.03973080561222071, 0.035255575795406474, 0.03297671765419287, 0.028194401625703476, 0.022516820381395925, 0.42911822850389614, 0.05778585058315975, 0.05376452588496271, 0.0425254910261987, 0.03624531453011213, 0.40501526281220324, -9.949727719856085, 0.047675941203833075, 0.03520120114979634, 0.0302517223216546, 0.04758155622969717, 0.055689640082145664, 0.04348193498030728, 0.04561687461114954, 0.04238346045946768, 0.08341225834630679, 0.06640761131527512, -9.943126725151235, -9.946866770226665, 0.032405210880893355, 0.05975010359339712, 0.04591132559882124, 0.03792914579040543, 0.03512454975424809, 0.028289532925555413, 0.043641816700609924, -9.962720289258055, 0.037566335384117445, 0.03012634336452038, 0.021223348180555716, 0.04274805497207314, -9.95781746933167, 0.04593509821621359, 0.032476088405433146, 0.02817155367940036, 0.022068397481696908, 0.021845107048360884, 0.01950683732824753, 0.01724354478640884, 0.015787443875875495, 0.021023407473750123, 0.02688752105659865, 0.02558293767535132, 0.022669055394956016, 0.020948866274793126, 0.02052554961587103, 0.028772748274297367, 0.027966706677219823, 0.02406888229461345, 0.020471093892422347, -9.970910948099975, -19.972973268302294, 0.025311180973569967, -9.975332635930954, 0.02103143929307864, 0.03678071594500448, 0.033385722383365235, 0.031471250410689204, -9.97125366276775, 0.023664733681785108, 0.020070032647547965, 0.027686466150269616, 0.024842589724563564, 0.022159457225648112, 0.019888123303955202, 0.023367631148972324, -9.97635411210427, 0.0226192478813321, 0.019960933638084776, 0.01795106909547446, 0.0265660049553625, 0.027515025725245484, 0.024182159209615972, 0.023192026119467368, 0.020138064098165324], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 26, 25, 25, 24, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 432.8831683295411, "mean_inference_ms": 2.1410104974401145, "mean_action_processing_ms": 0.1467015480880319, "mean_env_wait_ms": 1.2081623878033827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010027647018432617, "StateBufferConnector_ms": 0.006563901901245117, "ViewRequirementAgentConnector_ms": 0.17829608917236328}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 154050, "num_env_steps_sampled": 80000, "num_env_steps_trained": 154050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7300728188704797, "num_env_steps_trained_throughput_per_sec": 7.273641996797435, "timesteps_total": 80000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 11058.2, "sample_time_ms": 10995.103, "load_time_ms": 0.236, "load_throughput": 330293.5, "learn_time_ms": 12.945, "learn_throughput": 6025.466, "synch_weights_time_ms": 11.742}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 154050, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 154050, "last_target_update_ts": 79560, "num_target_updates": 152}, "done": false, "episodes_total": 3127, "training_iteration": 80, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-37-50", "timestamp": 1713425870, "time_this_iter_s": 268.1008081436157, "time_total_s": 19621.695735931396, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 19621.695735931396, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 11.53333333333333, "ram_util_percent": 25.54776902887139}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03092007525265217, "cur_lr": 0.01}, "td_error": [0.8868379592895508, 3.4534075260162354, 1.2992069721221924, 0.8868381381034851, 1.299206256866455, 0.8868386745452881, 1.2992064952850342, 1.2992068529129028, 1.2992067337036133, 1.2992067337036133, 1.2992068529129028, 1.299206256866455, 1.2944656610488892, 1.2992063760757446, 1.2992068529129028, 1.2992067337036133, 1.2992057800292969, 1.2992063760757446, 1.2987571954727173, 1.2992067337036133, 1.299206018447876, 1.2992066144943237, 1.2992068529129028, 1.299206018447876, 1.2992053031921387, 0.8766962289810181, 1.2992068529129028, 1.2992064952850342, 1.2947434186935425, 1.299206018447876, 1.2992069721221924, 0.8868346214294434, 0.886837363243103, 1.2992067337036133, 1.2992066144943237, 1.2992057800292969, 1.2992067337036133, 1.2992068529129028, 1.2992041110992432, 1.2985272407531738, 1.2992068529129028, 1.2992064952850342, 3.450928211212158, 1.2992067337036133, 1.2992067337036133, 1.2992054224014282, 1.2992066144943237, 1.2992069721221924, 1.2992066144943237, 1.2992068529129028, 1.299206256866455, 1.2992068529129028, 0.8868350386619568, 1.2992068529129028, 1.29920494556427, 1.2992066144943237, 1.2992061376571655, 1.2992063760757446, 1.2992064952850342, 1.2992066144943237, 1.2992056608200073, 3.2397427558898926, 1.2992068529129028, 2.1783030033111572, 1.2992042303085327, 1.299207091331482, 1.2992061376571655, 0.8868392705917358, 1.2992066144943237, 0.8789019584655762, 1.2992066144943237, 1.2954087257385254, 1.2992064952850342, 1.2992067337036133, 1.2992057800292969, 1.2992066144943237, 1.2992063760757446, 1.2992067337036133], "mean_td_error": 1.342565655708313, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2000.0, "diff_num_grad_updates_vs_sampler_policy": 1999.0}}, "num_env_steps_sampled": 81000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 156000, "last_target_update_ts": 80600, "num_target_updates": 154}, "sampler_results": {"episode_reward_max": 1.505379736868492, "episode_reward_min": -19.972973268302294, "episode_reward_mean": -1.3305502244420564, "episode_len_mean": 25.13, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.08341225834630679, 0.06640761131527512, -9.943126725151235, -9.946866770226665, 0.032405210880893355, 0.05975010359339712, 0.04591132559882124, 0.03792914579040543, 0.03512454975424809, 0.028289532925555413, 0.043641816700609924, -9.962720289258055, 0.037566335384117445, 0.03012634336452038, 0.021223348180555716, 0.04274805497207314, -9.95781746933167, 0.04593509821621359, 0.032476088405433146, 0.02817155367940036, 0.022068397481696908, 0.021845107048360884, 0.01950683732824753, 0.01724354478640884, 0.015787443875875495, 0.021023407473750123, 0.02688752105659865, 0.02558293767535132, 0.022669055394956016, 0.020948866274793126, 0.02052554961587103, 0.028772748274297367, 0.027966706677219823, 0.02406888229461345, 0.020471093892422347, -9.970910948099975, -19.972973268302294, 0.025311180973569967, -9.975332635930954, 0.02103143929307864, 0.03678071594500448, 0.033385722383365235, 0.031471250410689204, -9.97125366276775, 0.023664733681785108, 0.020070032647547965, 0.027686466150269616, 0.024842589724563564, 0.022159457225648112, 0.019888123303955202, 0.023367631148972324, -9.97635411210427, 0.0226192478813321, 0.019960933638084776, 0.01795106909547446, 0.0265660049553625, 0.027515025725245484, 0.024182159209615972, 0.023192026119467368, 0.020138064098165324, 0.01600080189849306, 0.01623410897512221, 0.01861050722786035, 0.02017865865116226, 0.021037651619524863, 0.019124369773785416, 0.017556692283307057, 0.019526591538378105, 0.017815594124083258, 0.017750430061377078, 0.019572537686693613, 0.01775571949674895, 0.016950125506373703, 0.016366820342732336, 0.01547962000850829, 1.505379736868492, 0.017780692761926186, 0.017317084496621466, 0.01707230445613527, 0.017506954227595926, 0.02208427030489067, 0.019613934728797567, 0.01835797303002865, 0.017303825705432443, -7.061701586604058, -9.981747380520822, 0.016868144103844466, 0.01673656964920013, 0.01758920413090734, -9.981097028553032, 0.016873455719200736, 0.015808368264473578, 0.016797024699556712, 0.016047479218603174, 0.018141246420446067, -9.981083078323307, 0.017982678535359814, 0.018051521799908175, 0.018494925027061314, 0.017924537756327814], "episode_lengths": [25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.0228449027714, "mean_inference_ms": 2.140468958164993, "mean_action_processing_ms": 0.14665858607621665, "mean_env_wait_ms": 1.1945572772258652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010479450225830078, "StateBufferConnector_ms": 0.006404399871826172, "ViewRequirementAgentConnector_ms": 0.17766070365905762}}, "episode_reward_max": 1.505379736868492, "episode_reward_min": -19.972973268302294, "episode_reward_mean": -1.3305502244420564, "episode_len_mean": 25.13, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.08341225834630679, 0.06640761131527512, -9.943126725151235, -9.946866770226665, 0.032405210880893355, 0.05975010359339712, 0.04591132559882124, 0.03792914579040543, 0.03512454975424809, 0.028289532925555413, 0.043641816700609924, -9.962720289258055, 0.037566335384117445, 0.03012634336452038, 0.021223348180555716, 0.04274805497207314, -9.95781746933167, 0.04593509821621359, 0.032476088405433146, 0.02817155367940036, 0.022068397481696908, 0.021845107048360884, 0.01950683732824753, 0.01724354478640884, 0.015787443875875495, 0.021023407473750123, 0.02688752105659865, 0.02558293767535132, 0.022669055394956016, 0.020948866274793126, 0.02052554961587103, 0.028772748274297367, 0.027966706677219823, 0.02406888229461345, 0.020471093892422347, -9.970910948099975, -19.972973268302294, 0.025311180973569967, -9.975332635930954, 0.02103143929307864, 0.03678071594500448, 0.033385722383365235, 0.031471250410689204, -9.97125366276775, 0.023664733681785108, 0.020070032647547965, 0.027686466150269616, 0.024842589724563564, 0.022159457225648112, 0.019888123303955202, 0.023367631148972324, -9.97635411210427, 0.0226192478813321, 0.019960933638084776, 0.01795106909547446, 0.0265660049553625, 0.027515025725245484, 0.024182159209615972, 0.023192026119467368, 0.020138064098165324, 0.01600080189849306, 0.01623410897512221, 0.01861050722786035, 0.02017865865116226, 0.021037651619524863, 0.019124369773785416, 0.017556692283307057, 0.019526591538378105, 0.017815594124083258, 0.017750430061377078, 0.019572537686693613, 0.01775571949674895, 0.016950125506373703, 0.016366820342732336, 0.01547962000850829, 1.505379736868492, 0.017780692761926186, 0.017317084496621466, 0.01707230445613527, 0.017506954227595926, 0.02208427030489067, 0.019613934728797567, 0.01835797303002865, 0.017303825705432443, -7.061701586604058, -9.981747380520822, 0.016868144103844466, 0.01673656964920013, 0.01758920413090734, -9.981097028553032, 0.016873455719200736, 0.015808368264473578, 0.016797024699556712, 0.016047479218603174, 0.018141246420446067, -9.981083078323307, 0.017982678535359814, 0.018051521799908175, 0.018494925027061314, 0.017924537756327814], "episode_lengths": [25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.0228449027714, "mean_inference_ms": 2.140468958164993, "mean_action_processing_ms": 0.14665858607621665, "mean_env_wait_ms": 1.1945572772258652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010479450225830078, "StateBufferConnector_ms": 0.006404399871826172, "ViewRequirementAgentConnector_ms": 0.17766070365905762}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 81000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7113512013765466, "num_env_steps_trained_throughput_per_sec": 7.237134842684266, "timesteps_total": 81000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 81000, "timers": {"training_iteration_time_ms": 10043.794, "sample_time_ms": 9982.517, "load_time_ms": 0.229, "load_throughput": 341356.127, "learn_time_ms": 12.611, "learn_throughput": 6185.201, "synch_weights_time_ms": 11.381}, "counters": {"num_env_steps_sampled": 81000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 156000, "last_target_update_ts": 80600, "num_target_updates": 154}, "done": false, "episodes_total": 3167, "training_iteration": 81, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-42-20", "timestamp": 1713426140, "time_this_iter_s": 269.45262360572815, "time_total_s": 19891.148359537125, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 19891.148359537125, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 11.604687499999999, "ram_util_percent": 25.71770833333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03217756003141403, "cur_lr": 0.01}, "td_error": [1.2950516939163208, 1.2950515747070312, 1.2950507402420044, 0.8685651421546936, 1.295052409172058, 0.8908655643463135, 1.2961857318878174, 1.2950520515441895, 1.2950527667999268, 1.2989684343338013, 1.295052170753479, 1.2989422082901, 1.2950528860092163, 1.295721411705017, 0.8685734272003174, 1.295052170753479, 1.2957063913345337, 0.8685722947120667, 1.2950514554977417, 1.2950520515441895, 1.3391581773757935, 1.299048900604248, 3.4207100868225098, 1.2950525283813477, 1.295052170753479, 1.2949426174163818, 1.2950513362884521, 1.2950502634048462, 1.2950518131256104, 1.2950503826141357, 1.2950528860092163, 1.2956804037094116, 1.2950525283813477, 1.2950527667999268, 1.298208236694336, 1.2950522899627686, 1.295052409172058, 0.8685735464096069, 1.2950525283813477, 1.2950527667999268, 0.8685720562934875, 1.2950522899627686, 1.2950528860092163, 1.2988613843917847, 1.2950527667999268, 1.2950527667999268, 1.2950519323349, 1.2950509786605835, 1.2980326414108276, 1.295052170753479, 0.8781021237373352, 0.8685716390609741, 0.8685674667358398, 1.2950527667999268, 1.2989174127578735, 1.2950528860092163, 1.2950528860092163, 1.2950525283813477, 1.2986668348312378, 1.2988656759262085, 1.2950522899627686, 0.8685717582702637, 1.3386471271514893, 1.2950519323349, 1.2950526475906372, 1.2950518131256104, 1.2950525283813477, 1.2950527667999268, 1.2950527667999268, 1.2950527667999268, 1.2950528860092163, 1.2950518131256104, 3.42073917388916, 1.2950513362884521, 1.2950522899627686, 1.295738697052002, 1.2950528860092163, 1.2950527667999268], "mean_td_error": 1.2968825101852417, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2025.0, "diff_num_grad_updates_vs_sampler_policy": 2024.0}}, "num_env_steps_sampled": 82000, "num_env_steps_trained": 157950, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 157950, "last_target_update_ts": 81640, "num_target_updates": 156}, "sampler_results": {"episode_reward_max": 1.505379736868492, "episode_reward_min": -9.98730592841598, "episode_reward_mean": -1.3378407677014605, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.975332635930954, 0.02103143929307864, 0.03678071594500448, 0.033385722383365235, 0.031471250410689204, -9.97125366276775, 0.023664733681785108, 0.020070032647547965, 0.027686466150269616, 0.024842589724563564, 0.022159457225648112, 0.019888123303955202, 0.023367631148972324, -9.97635411210427, 0.0226192478813321, 0.019960933638084776, 0.01795106909547446, 0.0265660049553625, 0.027515025725245484, 0.024182159209615972, 0.023192026119467368, 0.020138064098165324, 0.01600080189849306, 0.01623410897512221, 0.01861050722786035, 0.02017865865116226, 0.021037651619524863, 0.019124369773785416, 0.017556692283307057, 0.019526591538378105, 0.017815594124083258, 0.017750430061377078, 0.019572537686693613, 0.01775571949674895, 0.016950125506373703, 0.016366820342732336, 0.01547962000850829, 1.505379736868492, 0.017780692761926186, 0.017317084496621466, 0.01707230445613527, 0.017506954227595926, 0.02208427030489067, 0.019613934728797567, 0.01835797303002865, 0.017303825705432443, -7.061701586604058, -9.981747380520822, 0.016868144103844466, 0.01673656964920013, 0.01758920413090734, -9.981097028553032, 0.016873455719200736, 0.015808368264473578, 0.016797024699556712, 0.016047479218603174, 0.018141246420446067, -9.981083078323307, 0.017982678535359814, 0.018051521799908175, 0.018494925027061314, 0.017924537756327814, 0.019672049107488338, 0.017776309860111108, 0.016225598792030976, -9.985158331968893, 0.016936396315231802, 0.015304987893360624, 0.01420664733880823, 0.013253685377789912, 0.012739095092426864, 0.015155083351344726, 0.013676510370481492, 0.01279338281502939, 0.012345068268925365, 0.011093165760464837, 0.0162822001083726, 0.014606954022423357, 0.013603553443692276, 0.012785479099609158, 0.011943513190294014, -9.984885590913981, -9.986436963129131, -9.98730592841598, -9.987151821089979, 0.017152610255070314, 0.016079626574804246, -9.985609260002837, 0.013414073057009212, 0.012783868930713644, 0.018005866412500703, 0.016112024104850513, 0.014898937543682933, -9.986324198162336, 0.012567600487086324, 0.016525474211732977, 0.014879095222899834, 0.01332732104034428, 0.012789601692741358, 0.012264174863377676], "episode_lengths": [26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.0299243472171, "mean_inference_ms": 2.13937536038145, "mean_action_processing_ms": 0.1466859088353094, "mean_env_wait_ms": 1.1816328141236279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010489225387573242, "StateBufferConnector_ms": 0.006807565689086914, "ViewRequirementAgentConnector_ms": 0.17749547958374023}}, "episode_reward_max": 1.505379736868492, "episode_reward_min": -9.98730592841598, "episode_reward_mean": -1.3378407677014605, "episode_len_mean": 25.14, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.975332635930954, 0.02103143929307864, 0.03678071594500448, 0.033385722383365235, 0.031471250410689204, -9.97125366276775, 0.023664733681785108, 0.020070032647547965, 0.027686466150269616, 0.024842589724563564, 0.022159457225648112, 0.019888123303955202, 0.023367631148972324, -9.97635411210427, 0.0226192478813321, 0.019960933638084776, 0.01795106909547446, 0.0265660049553625, 0.027515025725245484, 0.024182159209615972, 0.023192026119467368, 0.020138064098165324, 0.01600080189849306, 0.01623410897512221, 0.01861050722786035, 0.02017865865116226, 0.021037651619524863, 0.019124369773785416, 0.017556692283307057, 0.019526591538378105, 0.017815594124083258, 0.017750430061377078, 0.019572537686693613, 0.01775571949674895, 0.016950125506373703, 0.016366820342732336, 0.01547962000850829, 1.505379736868492, 0.017780692761926186, 0.017317084496621466, 0.01707230445613527, 0.017506954227595926, 0.02208427030489067, 0.019613934728797567, 0.01835797303002865, 0.017303825705432443, -7.061701586604058, -9.981747380520822, 0.016868144103844466, 0.01673656964920013, 0.01758920413090734, -9.981097028553032, 0.016873455719200736, 0.015808368264473578, 0.016797024699556712, 0.016047479218603174, 0.018141246420446067, -9.981083078323307, 0.017982678535359814, 0.018051521799908175, 0.018494925027061314, 0.017924537756327814, 0.019672049107488338, 0.017776309860111108, 0.016225598792030976, -9.985158331968893, 0.016936396315231802, 0.015304987893360624, 0.01420664733880823, 0.013253685377789912, 0.012739095092426864, 0.015155083351344726, 0.013676510370481492, 0.01279338281502939, 0.012345068268925365, 0.011093165760464837, 0.0162822001083726, 0.014606954022423357, 0.013603553443692276, 0.012785479099609158, 0.011943513190294014, -9.984885590913981, -9.986436963129131, -9.98730592841598, -9.987151821089979, 0.017152610255070314, 0.016079626574804246, -9.985609260002837, 0.013414073057009212, 0.012783868930713644, 0.018005866412500703, 0.016112024104850513, 0.014898937543682933, -9.986324198162336, 0.012567600487086324, 0.016525474211732977, 0.014879095222899834, 0.01332732104034428, 0.012789601692741358, 0.012264174863377676], "episode_lengths": [26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.0299243472171, "mean_inference_ms": 2.13937536038145, "mean_action_processing_ms": 0.1466859088353094, "mean_env_wait_ms": 1.1816328141236279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010489225387573242, "StateBufferConnector_ms": 0.006807565689086914, "ViewRequirementAgentConnector_ms": 0.17749547958374023}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 157950, "num_env_steps_sampled": 82000, "num_env_steps_trained": 157950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.210659646322576, "num_env_steps_trained_throughput_per_sec": 8.210786310329022, "timesteps_total": 82000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 82000, "timers": {"training_iteration_time_ms": 9088.962, "sample_time_ms": 9023.781, "load_time_ms": 0.249, "load_throughput": 313277.518, "learn_time_ms": 13.644, "learn_throughput": 5716.827, "synch_weights_time_ms": 11.782}, "counters": {"num_env_steps_sampled": 82000, "num_env_steps_trained": 157950, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 157950, "last_target_update_ts": 81640, "num_target_updates": 156}, "done": false, "episodes_total": 3205, "training_iteration": 82, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-46-17", "timestamp": 1713426377, "time_this_iter_s": 237.5007836818695, "time_total_s": 20128.649143218994, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 20128.649143218994, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 12.361242603550297, "ram_util_percent": 25.838165680473377}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01196301355957985, "cur_lr": 0.01}, "td_error": [1.452375888824463, 1.252254843711853, 1.2522555589675903, 1.252254843711853, 1.2522614002227783, 1.2522587776184082, 1.2522592544555664, 1.2522588968276978, 1.2522602081298828, 1.252259373664856, 1.2522603273391724, 1.2522568702697754, 1.2522609233856201, 1.2522616386413574, 1.2522573471069336, 1.2522610425949097, 1.2522609233856201, 1.2522612810134888, 1.2522602081298828, 0.8504196405410767, 1.2522615194320679, 1.252458095550537, 1.2522599697113037, 1.252259612083435, 1.252258062362671, 1.252255916595459, 1.2522609233856201, 1.2522603273391724, 1.252259373664856, 1.2522599697113037, 1.2546865940093994, 1.252260446548462, 1.2522600889205933, 1.252261757850647, 1.252258539199829, 3.622736930847168, 0.8504124879837036, 1.2522609233856201, 1.2522605657577515, 0.869533360004425, 0.8504160046577454, 1.2522615194320679, 1.2522610425949097, 1.2522610425949097, 1.252463698387146, 1.3999279737472534, 1.2522574663162231, 1.2547969818115234, 1.2522612810134888, 1.2522602081298828, 1.2522610425949097, 1.2522588968276978, 1.2522614002227783, 1.2522599697113037, 0.8504191637039185, 1.2522612810134888, 1.2522612810134888, 1.252261757850647, 1.2524538040161133, 1.2522598505020142, 1.2522610425949097, 1.2522605657577515, 0.8504166603088379, 1.2545510530471802, 1.4980268478393555, 1.2522599697113037, 1.254682183265686, 1.2522614002227783, 1.252258539199829, 1.252259612083435, 0.8504196405410767, 1.252351999282837, 1.2546812295913696, 1.2522591352462769, 1.2523645162582397, 1.2522609233856201, 1.2522605657577515, 1.252258062362671], "mean_td_error": 1.2546076774597168, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2050.0, "diff_num_grad_updates_vs_sampler_policy": 2049.0}}, "num_env_steps_sampled": 83000, "num_env_steps_trained": 159900, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 159900, "last_target_update_ts": 82680, "num_target_updates": 158}, "sampler_results": {"episode_reward_max": 0.5275838217720028, "episode_reward_min": -19.031063467040646, "episode_reward_mean": -1.7362370255378945, "episode_len_mean": 25.1, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.01707230445613527, 0.017506954227595926, 0.02208427030489067, 0.019613934728797567, 0.01835797303002865, 0.017303825705432443, -7.061701586604058, -9.981747380520822, 0.016868144103844466, 0.01673656964920013, 0.01758920413090734, -9.981097028553032, 0.016873455719200736, 0.015808368264473578, 0.016797024699556712, 0.016047479218603174, 0.018141246420446067, -9.981083078323307, 0.017982678535359814, 0.018051521799908175, 0.018494925027061314, 0.017924537756327814, 0.019672049107488338, 0.017776309860111108, 0.016225598792030976, -9.985158331968893, 0.016936396315231802, 0.015304987893360624, 0.01420664733880823, 0.013253685377789912, 0.012739095092426864, 0.015155083351344726, 0.013676510370481492, 0.01279338281502939, 0.012345068268925365, 0.011093165760464837, 0.0162822001083726, 0.014606954022423357, 0.013603553443692276, 0.012785479099609158, 0.011943513190294014, -9.984885590913981, -9.986436963129131, -9.98730592841598, -9.987151821089979, 0.017152610255070314, 0.016079626574804246, -9.985609260002837, 0.013414073057009212, 0.012783868930713644, 0.018005866412500703, 0.016112024104850513, 0.014898937543682933, -9.986324198162336, 0.012567600487086324, 0.016525474211732977, 0.014879095222899834, 0.01332732104034428, 0.012789601692741358, 0.012264174863377676, -9.9860128205838, 0.013656572230420156, 0.5172204202612238, 0.013469853856810632, 0.010825209376906696, 0.012781629725284219, 0.013091803757516849, 0.014159095956963484, 0.014405189992231032, 0.013223930310422188, 0.01170802765309498, 0.011778253789403958, 0.5275838217720028, 0.015431626081797378, -9.987080449868792, 0.01283387389397431, -9.986770724262204, 0.014600503683463713, 0.014931407101508306, 0.014300872418080361, 0.012822301429742783, 0.012983625378765368, 0.014115619503826789, 0.016760679866801104, 0.016346160643263618, 0.013733720134528263, 0.012592331173189537, 0.012584094246587562, -19.031063467040646, 0.013722772707332196, 0.012822018558449621, 0.012673315692173694, 0.013618350272764706, -9.987284614914278, 0.012440415072779178, 0.012672460411099448, 0.013090493267906532, 0.01277518628795535, 0.015945855571335165, -9.985145173897482], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.08019938818865, "mean_inference_ms": 2.139081865305227, "mean_action_processing_ms": 0.14667789788773153, "mean_env_wait_ms": 1.168447206027143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010883331298828125, "StateBufferConnector_ms": 0.007064342498779297, "ViewRequirementAgentConnector_ms": 0.18181276321411133}}, "episode_reward_max": 0.5275838217720028, "episode_reward_min": -19.031063467040646, "episode_reward_mean": -1.7362370255378945, "episode_len_mean": 25.1, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.01707230445613527, 0.017506954227595926, 0.02208427030489067, 0.019613934728797567, 0.01835797303002865, 0.017303825705432443, -7.061701586604058, -9.981747380520822, 0.016868144103844466, 0.01673656964920013, 0.01758920413090734, -9.981097028553032, 0.016873455719200736, 0.015808368264473578, 0.016797024699556712, 0.016047479218603174, 0.018141246420446067, -9.981083078323307, 0.017982678535359814, 0.018051521799908175, 0.018494925027061314, 0.017924537756327814, 0.019672049107488338, 0.017776309860111108, 0.016225598792030976, -9.985158331968893, 0.016936396315231802, 0.015304987893360624, 0.01420664733880823, 0.013253685377789912, 0.012739095092426864, 0.015155083351344726, 0.013676510370481492, 0.01279338281502939, 0.012345068268925365, 0.011093165760464837, 0.0162822001083726, 0.014606954022423357, 0.013603553443692276, 0.012785479099609158, 0.011943513190294014, -9.984885590913981, -9.986436963129131, -9.98730592841598, -9.987151821089979, 0.017152610255070314, 0.016079626574804246, -9.985609260002837, 0.013414073057009212, 0.012783868930713644, 0.018005866412500703, 0.016112024104850513, 0.014898937543682933, -9.986324198162336, 0.012567600487086324, 0.016525474211732977, 0.014879095222899834, 0.01332732104034428, 0.012789601692741358, 0.012264174863377676, -9.9860128205838, 0.013656572230420156, 0.5172204202612238, 0.013469853856810632, 0.010825209376906696, 0.012781629725284219, 0.013091803757516849, 0.014159095956963484, 0.014405189992231032, 0.013223930310422188, 0.01170802765309498, 0.011778253789403958, 0.5275838217720028, 0.015431626081797378, -9.987080449868792, 0.01283387389397431, -9.986770724262204, 0.014600503683463713, 0.014931407101508306, 0.014300872418080361, 0.012822301429742783, 0.012983625378765368, 0.014115619503826789, 0.016760679866801104, 0.016346160643263618, 0.013733720134528263, 0.012592331173189537, 0.012584094246587562, -19.031063467040646, 0.013722772707332196, 0.012822018558449621, 0.012673315692173694, 0.013618350272764706, -9.987284614914278, 0.012440415072779178, 0.012672460411099448, 0.013090493267906532, 0.01277518628795535, 0.015945855571335165, -9.985145173897482], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.08019938818865, "mean_inference_ms": 2.139081865305227, "mean_action_processing_ms": 0.14667789788773153, "mean_env_wait_ms": 1.168447206027143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010883331298828125, "StateBufferConnector_ms": 0.007064342498779297, "ViewRequirementAgentConnector_ms": 0.18181276321411133}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 159900, "num_env_steps_sampled": 83000, "num_env_steps_trained": 159900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.414672054641957, "num_env_steps_trained_throughput_per_sec": 8.608610506551816, "timesteps_total": 83000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 83000, "timers": {"training_iteration_time_ms": 9145.037, "sample_time_ms": 9077.601, "load_time_ms": 0.247, "load_throughput": 315209.28, "learn_time_ms": 13.628, "learn_throughput": 5723.388, "synch_weights_time_ms": 12.287}, "counters": {"num_env_steps_sampled": 83000, "num_env_steps_trained": 159900, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 159900, "last_target_update_ts": 82680, "num_target_updates": 158}, "done": false, "episodes_total": 3245, "training_iteration": 83, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-50-04", "timestamp": 1713426604, "time_this_iter_s": 226.5282337665558, "time_total_s": 20355.17737698555, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 20355.17737698555, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 13.54503105590062, "ram_util_percent": 25.972981366459624}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03491681069135666, "cur_lr": 0.01}, "td_error": [1.2457607984542847, 1.2457609176635742, 1.2457622289657593, 0.8551095724105835, 1.246781587600708, 1.2457610368728638, 1.2457619905471802, 1.245761513710022, 1.2457621097564697, 1.2457609176635742, 1.246208906173706, 1.2457612752914429, 1.245761513710022, 1.2457618713378906, 1.245761513710022, 1.2457610368728638, 0.8426216840744019, 1.2457622289657593, 1.246629238128662, 1.2457606792449951, 1.2457618713378906, 0.855111837387085, 1.2457622289657593, 0.8551115989685059, 1.2457612752914429, 0.8551139831542969, 1.2457579374313354, 1.2457605600357056, 1.295677900314331, 1.245761513710022, 0.8551110029220581, 1.2457592487335205, 2.7340505123138428, 1.2457619905471802, 0.8551115989685059, 1.2457616329193115, 1.2457612752914429, 0.8551126718521118, 1.24575936794281, 0.8551111221313477, 0.855111837387085, 1.2461966276168823, 1.2457622289657593, 1.2457612752914429, 1.2461016178131104, 1.2457621097564697, 1.2457612752914429, 1.245761752128601, 1.2457609176635742, 0.8601675033569336, 1.2457619905471802, 1.245760202407837, 1.2641459703445435, 1.2457612752914429, 1.2457618713378906, 1.2461931705474854, 1.245758295059204, 1.2457622289657593, 1.245759129524231, 1.245761513710022, 1.2457622289657593, 1.2457621097564697, 1.2457597255706787, 1.245760440826416, 0.85511314868927, 1.2457596063613892, 1.2457612752914429, 1.2457618713378906, 3.610269546508789, 1.245760440826416, 1.2457618713378906, 0.8551133275032043, 1.2457606792449951, 1.246739149093628, 1.2457598447799683, 0.8551058769226074, 1.2457616329193115, 1.2453893423080444], "mean_td_error": 1.2258729934692383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2075.0, "diff_num_grad_updates_vs_sampler_policy": 2074.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 161850, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 161850, "last_target_update_ts": 83720, "num_target_updates": 160}, "sampler_results": {"episode_reward_max": 0.5275838217720028, "episode_reward_min": -19.987315155850652, "episode_reward_mean": -1.8671081581009417, "episode_len_mean": 25.03, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.984885590913981, -9.986436963129131, -9.98730592841598, -9.987151821089979, 0.017152610255070314, 0.016079626574804246, -9.985609260002837, 0.013414073057009212, 0.012783868930713644, 0.018005866412500703, 0.016112024104850513, 0.014898937543682933, -9.986324198162336, 0.012567600487086324, 0.016525474211732977, 0.014879095222899834, 0.01332732104034428, 0.012789601692741358, 0.012264174863377676, -9.9860128205838, 0.013656572230420156, 0.5172204202612238, 0.013469853856810632, 0.010825209376906696, 0.012781629725284219, 0.013091803757516849, 0.014159095956963484, 0.014405189992231032, 0.013223930310422188, 0.01170802765309498, 0.011778253789403958, 0.5275838217720028, 0.015431626081797378, -9.987080449868792, 0.01283387389397431, -9.986770724262204, 0.014600503683463713, 0.014931407101508306, 0.014300872418080361, 0.012822301429742783, 0.012983625378765368, 0.014115619503826789, 0.016760679866801104, 0.016346160643263618, 0.013733720134528263, 0.012592331173189537, 0.012584094246587562, -19.031063467040646, 0.013722772707332196, 0.012822018558449621, 0.012673315692173694, 0.013618350272764706, -9.987284614914278, 0.012440415072779178, 0.012672460411099448, 0.013090493267906532, 0.01277518628795535, 0.015945855571335165, -9.985145173897482, 0.011468076476290258, 0.011453448301812837, 0.01057746391372984, 0.010906022720489551, 0.010357243438792236, 0.010515558742072141, 0.013823066970167917, 0.013778513485399544, -19.987315155850652, 0.011806070768868868, 0.01124884942476123, 0.013107324189500634, -9.987410943855801, 0.011445247163582552, -9.989157043266138, 0.01043167807876406, 0.01443400702377427, 0.012268432435496131, 0.012985396881819388, 0.012453135901243697, 0.011171839169029809, 0.014318141397925664, 0.01522989204715226, 0.013836350388922551, 0.013297692509560857, 0.012438078820621081, 0.013552100878901345, 0.012266755633206701, -9.987569792853733, 0.011698028087651892, 0.01066878545822814, 0.011525157266374564, 0.011941992850200983, 0.009961914041167006, 0.010443726473311356, 0.010266114692383019, 0.01543008579549097, -9.985416666699612, 0.013432491743025216, 0.011886098485576998, 0.012198256581488801], "episode_lengths": [26, 26, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.25916709199345, "mean_inference_ms": 2.1403120575285572, "mean_action_processing_ms": 0.146638636176577, "mean_env_wait_ms": 1.155386255512963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01064157485961914, "StateBufferConnector_ms": 0.0068705081939697266, "ViewRequirementAgentConnector_ms": 0.18306756019592285}}, "episode_reward_max": 0.5275838217720028, "episode_reward_min": -19.987315155850652, "episode_reward_mean": -1.8671081581009417, "episode_len_mean": 25.03, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.984885590913981, -9.986436963129131, -9.98730592841598, -9.987151821089979, 0.017152610255070314, 0.016079626574804246, -9.985609260002837, 0.013414073057009212, 0.012783868930713644, 0.018005866412500703, 0.016112024104850513, 0.014898937543682933, -9.986324198162336, 0.012567600487086324, 0.016525474211732977, 0.014879095222899834, 0.01332732104034428, 0.012789601692741358, 0.012264174863377676, -9.9860128205838, 0.013656572230420156, 0.5172204202612238, 0.013469853856810632, 0.010825209376906696, 0.012781629725284219, 0.013091803757516849, 0.014159095956963484, 0.014405189992231032, 0.013223930310422188, 0.01170802765309498, 0.011778253789403958, 0.5275838217720028, 0.015431626081797378, -9.987080449868792, 0.01283387389397431, -9.986770724262204, 0.014600503683463713, 0.014931407101508306, 0.014300872418080361, 0.012822301429742783, 0.012983625378765368, 0.014115619503826789, 0.016760679866801104, 0.016346160643263618, 0.013733720134528263, 0.012592331173189537, 0.012584094246587562, -19.031063467040646, 0.013722772707332196, 0.012822018558449621, 0.012673315692173694, 0.013618350272764706, -9.987284614914278, 0.012440415072779178, 0.012672460411099448, 0.013090493267906532, 0.01277518628795535, 0.015945855571335165, -9.985145173897482, 0.011468076476290258, 0.011453448301812837, 0.01057746391372984, 0.010906022720489551, 0.010357243438792236, 0.010515558742072141, 0.013823066970167917, 0.013778513485399544, -19.987315155850652, 0.011806070768868868, 0.01124884942476123, 0.013107324189500634, -9.987410943855801, 0.011445247163582552, -9.989157043266138, 0.01043167807876406, 0.01443400702377427, 0.012268432435496131, 0.012985396881819388, 0.012453135901243697, 0.011171839169029809, 0.014318141397925664, 0.01522989204715226, 0.013836350388922551, 0.013297692509560857, 0.012438078820621081, 0.013552100878901345, 0.012266755633206701, -9.987569792853733, 0.011698028087651892, 0.01066878545822814, 0.011525157266374564, 0.011941992850200983, 0.009961914041167006, 0.010443726473311356, 0.010266114692383019, 0.01543008579549097, -9.985416666699612, 0.013432491743025216, 0.011886098485576998, 0.012198256581488801], "episode_lengths": [26, 26, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.25916709199345, "mean_inference_ms": 2.1403120575285572, "mean_action_processing_ms": 0.146638636176577, "mean_env_wait_ms": 1.155386255512963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01064157485961914, "StateBufferConnector_ms": 0.0068705081939697266, "ViewRequirementAgentConnector_ms": 0.18306756019592285}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 161850, "num_env_steps_sampled": 84000, "num_env_steps_trained": 161850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.235643388133551, "num_env_steps_trained_throughput_per_sec": 8.259504606860423, "timesteps_total": 84000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 11293.099, "sample_time_ms": 11228.163, "load_time_ms": 0.237, "load_throughput": 328965.02, "learn_time_ms": 13.159, "learn_throughput": 5927.507, "synch_weights_time_ms": 11.719}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 161850, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 161850, "last_target_update_ts": 83720, "num_target_updates": 160}, "done": false, "episodes_total": 3286, "training_iteration": 84, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-54-00", "timestamp": 1713426840, "time_this_iter_s": 236.10285305976868, "time_total_s": 20591.28023004532, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 20591.28023004532, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 13.37261904761905, "ram_util_percent": 26.217857142857138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01708953082561493, "cur_lr": 0.01}, "td_error": [1.205586552619934, 1.2046829462051392, 1.2055866718292236, 2.2522571086883545, 1.205581784248352, 1.2055847644805908, 1.2039260864257812, 1.2034754753112793, 1.3995610475540161, 1.2055879831314087, 1.205587387084961, 1.205586314201355, 1.2037315368652344, 1.2055847644805908, 1.2055877447128296, 1.2055869102478027, 1.2055853605270386, 1.2055840492248535, 1.2055860757827759, 1.204708456993103, 1.205586552619934, 1.2055877447128296, 0.8403046131134033, 1.205587387084961, 1.2055875062942505, 1.2055861949920654, 1.2055864334106445, 3.6151998043060303, 1.2055866718292236, 1.2042205333709717, 1.2055878639221191, 1.2055871486663818, 0.9694454073905945, 1.2055846452713013, 1.2055875062942505, 1.205586314201355, 1.2039167881011963, 1.2046653032302856, 1.2055864334106445, 1.2054545879364014, 1.2055877447128296, 1.205586552619934, 1.2331534624099731, 0.8403030633926392, 1.205587387084961, 1.2116824388504028, 1.2046195268630981, 1.205587387084961, 1.2055877447128296, 1.2055871486663818, 1.203751802444458, 1.2055869102478027, 1.2055864334106445, 1.2055870294570923, 1.2055877447128296, 1.205587387084961, 1.20558762550354, 0.8403052687644958, 1.2043908834457397, 0.8403064012527466, 0.8403072953224182, 0.8403060436248779, 1.2055857181549072, 1.2055866718292236, 1.2055854797363281, 1.2055857181549072, 1.2043814659118652, 1.2055855989456177, 1.205585241317749, 1.2055869102478027, 0.8403000831604004, 1.2039728164672852, 1.2055859565734863, 1.2044038772583008, 1.2055871486663818, 1.2055872678756714, 3.6177926063537598, 1.2055838108062744], "mean_td_error": 1.2476829290390015, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2100.0, "diff_num_grad_updates_vs_sampler_policy": 2099.0}}, "num_env_steps_sampled": 85000, "num_env_steps_trained": 163800, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 163800, "last_target_update_ts": 84760, "num_target_updates": 162}, "sampler_results": {"episode_reward_max": 0.44464902782602966, "episode_reward_min": -19.98954030178743, "episode_reward_mean": -1.971046895456921, "episode_len_mean": 25.02, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.012983625378765368, 0.014115619503826789, 0.016760679866801104, 0.016346160643263618, 0.013733720134528263, 0.012592331173189537, 0.012584094246587562, -19.031063467040646, 0.013722772707332196, 0.012822018558449621, 0.012673315692173694, 0.013618350272764706, -9.987284614914278, 0.012440415072779178, 0.012672460411099448, 0.013090493267906532, 0.01277518628795535, 0.015945855571335165, -9.985145173897482, 0.011468076476290258, 0.011453448301812837, 0.01057746391372984, 0.010906022720489551, 0.010357243438792236, 0.010515558742072141, 0.013823066970167917, 0.013778513485399544, -19.987315155850652, 0.011806070768868868, 0.01124884942476123, 0.013107324189500634, -9.987410943855801, 0.011445247163582552, -9.989157043266138, 0.01043167807876406, 0.01443400702377427, 0.012268432435496131, 0.012985396881819388, 0.012453135901243697, 0.011171839169029809, 0.014318141397925664, 0.01522989204715226, 0.013836350388922551, 0.013297692509560857, 0.012438078820621081, 0.013552100878901345, 0.012266755633206701, -9.987569792853733, 0.011698028087651892, 0.01066878545822814, 0.011525157266374564, 0.011941992850200983, 0.009961914041167006, 0.010443726473311356, 0.010266114692383019, 0.01543008579549097, -9.985416666699612, 0.013432491743025216, 0.011886098485576998, 0.012198256581488801, 0.010356573455394895, 0.01054190534938934, 0.01076049024756812, 0.009903844098013334, 0.008053973612814801, 0.011093983240715699, 0.3408851838579664, 0.010742870252867874, 0.010369609390480032, 0.009579523108248215, 0.010667389235771948, 0.44464902782602966, 0.009866322931744121, 0.009788097553015084, -9.991297135193117, 0.01128423680367225, 0.010551488430600992, 0.010686411643905611, 0.010365849964364453, 0.009708111129072779, -9.988321712691071, 0.011695351016465273, 0.011273286548152744, 0.011104431246127365, -9.989478516233593, -9.989050067833329, -9.989521868343811, 0.010537701256995637, 0.009711495313467145, 0.008978910912979567, -19.98954030178743, -9.990084430765652, 0.009959849351513478, 0.009386576559568897, 0.00901355094901196, 0.011653703625857614, 0.011133610279966767, -19.989211738159398, 0.010623257214891968, 0.00975233026148365], "episode_lengths": [25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 27, 26, 25, 25, 24, 25, 25, 27, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.4522591119652, "mean_inference_ms": 2.140581145753029, "mean_action_processing_ms": 0.1466451353440863, "mean_env_wait_ms": 1.1432226830484602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010917425155639648, "StateBufferConnector_ms": 0.006838798522949219, "ViewRequirementAgentConnector_ms": 0.1846613883972168}}, "episode_reward_max": 0.44464902782602966, "episode_reward_min": -19.98954030178743, "episode_reward_mean": -1.971046895456921, "episode_len_mean": 25.02, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.012983625378765368, 0.014115619503826789, 0.016760679866801104, 0.016346160643263618, 0.013733720134528263, 0.012592331173189537, 0.012584094246587562, -19.031063467040646, 0.013722772707332196, 0.012822018558449621, 0.012673315692173694, 0.013618350272764706, -9.987284614914278, 0.012440415072779178, 0.012672460411099448, 0.013090493267906532, 0.01277518628795535, 0.015945855571335165, -9.985145173897482, 0.011468076476290258, 0.011453448301812837, 0.01057746391372984, 0.010906022720489551, 0.010357243438792236, 0.010515558742072141, 0.013823066970167917, 0.013778513485399544, -19.987315155850652, 0.011806070768868868, 0.01124884942476123, 0.013107324189500634, -9.987410943855801, 0.011445247163582552, -9.989157043266138, 0.01043167807876406, 0.01443400702377427, 0.012268432435496131, 0.012985396881819388, 0.012453135901243697, 0.011171839169029809, 0.014318141397925664, 0.01522989204715226, 0.013836350388922551, 0.013297692509560857, 0.012438078820621081, 0.013552100878901345, 0.012266755633206701, -9.987569792853733, 0.011698028087651892, 0.01066878545822814, 0.011525157266374564, 0.011941992850200983, 0.009961914041167006, 0.010443726473311356, 0.010266114692383019, 0.01543008579549097, -9.985416666699612, 0.013432491743025216, 0.011886098485576998, 0.012198256581488801, 0.010356573455394895, 0.01054190534938934, 0.01076049024756812, 0.009903844098013334, 0.008053973612814801, 0.011093983240715699, 0.3408851838579664, 0.010742870252867874, 0.010369609390480032, 0.009579523108248215, 0.010667389235771948, 0.44464902782602966, 0.009866322931744121, 0.009788097553015084, -9.991297135193117, 0.01128423680367225, 0.010551488430600992, 0.010686411643905611, 0.010365849964364453, 0.009708111129072779, -9.988321712691071, 0.011695351016465273, 0.011273286548152744, 0.011104431246127365, -9.989478516233593, -9.989050067833329, -9.989521868343811, 0.010537701256995637, 0.009711495313467145, 0.008978910912979567, -19.98954030178743, -9.990084430765652, 0.009959849351513478, 0.009386576559568897, 0.00901355094901196, 0.011653703625857614, 0.011133610279966767, -19.989211738159398, 0.010623257214891968, 0.00975233026148365], "episode_lengths": [25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 25, 27, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 27, 26, 25, 25, 24, 25, 25, 27, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.4522591119652, "mean_inference_ms": 2.140581145753029, "mean_action_processing_ms": 0.1466451353440863, "mean_env_wait_ms": 1.1432226830484602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010917425155639648, "StateBufferConnector_ms": 0.006838798522949219, "ViewRequirementAgentConnector_ms": 0.1846613883972168}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 163800, "num_env_steps_sampled": 85000, "num_env_steps_trained": 163800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5632295383333914, "num_env_steps_trained_throughput_per_sec": 6.948297599750113, "timesteps_total": 85000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 85000, "timers": {"training_iteration_time_ms": 11264.62, "sample_time_ms": 11198.491, "load_time_ms": 0.249, "load_throughput": 313547.74, "learn_time_ms": 13.584, "learn_throughput": 5742.002, "synch_weights_time_ms": 11.533}, "counters": {"num_env_steps_sampled": 85000, "num_env_steps_trained": 163800, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 163800, "last_target_update_ts": 84760, "num_target_updates": 162}, "done": false, "episodes_total": 3326, "training_iteration": 85, "trial_id": "cbb9a_00000", "date": "2024-04-18_07-58-40", "timestamp": 1713427120, "time_this_iter_s": 280.6546301841736, "time_total_s": 20871.934860229492, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 20871.934860229492, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 11.089473684210526, "ram_util_percent": 26.36766917293233}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.018507514148950577, "cur_lr": 0.01}, "td_error": [1.1908801794052124, 1.190881609916687, 1.3301995992660522, 1.1908817291259766, 1.1908807754516602, 1.18899405002594, 1.1890051364898682, 1.1908812522888184, 1.1890010833740234, 1.1908811330795288, 1.1908800601959229, 1.1908818483352661, 0.842025637626648, 1.1908800601959229, 1.190881609916687, 1.19087815284729, 0.8420194387435913, 0.8420249223709106, 1.190881609916687, 1.1908819675445557, 1.1908811330795288, 1.1908810138702393, 1.190880537033081, 1.189408302307129, 1.1908807754516602, 1.1883714199066162, 0.8420220613479614, 1.1882895231246948, 1.19087815284729, 1.1908791065216064, 1.1908793449401855, 1.1908801794052124, 1.1908811330795288, 0.8420266509056091, 1.190880298614502, 1.190880537033081, 1.1908814907073975, 0.8338340520858765, 1.1908811330795288, 1.1906102895736694, 0.8420275449752808, 1.1908800601959229, 1.1908810138702393, 1.1888444423675537, 1.1908798217773438, 1.190881609916687, 0.8338340520858765, 3.5817160606384277, 1.190880537033081, 1.190881371498108, 1.1908814907073975, 1.1891030073165894, 1.190881609916687, 0.8420225381851196, 1.190881371498108, 1.1908797025680542, 0.8420252799987793, 1.1889872550964355, 0.8336526155471802, 1.1892707347869873, 1.1908808946609497, 1.188925862312317, 1.1908795833587646, 1.1908817291259766, 1.1908819675445557, 3.5817644596099854, 1.1893742084503174, 1.1908798217773438, 1.1908807754516602, 1.1908777952194214, 1.1908811330795288, 1.1908811330795288, 1.1908808946609497, 1.190881371498108, 1.1908793449401855, 1.1908810138702393, 0.8420257568359375, 1.190880537033081], "mean_td_error": 1.1996850967407227, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2125.0, "diff_num_grad_updates_vs_sampler_policy": 2124.0}}, "num_env_steps_sampled": 86000, "num_env_steps_trained": 165750, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 165750, "last_target_update_ts": 85800, "num_target_updates": 164}, "sampler_results": {"episode_reward_max": 0.44464902782602966, "episode_reward_min": -19.98954030178743, "episode_reward_mean": -1.6700163060147646, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.014318141397925664, 0.01522989204715226, 0.013836350388922551, 0.013297692509560857, 0.012438078820621081, 0.013552100878901345, 0.012266755633206701, -9.987569792853733, 0.011698028087651892, 0.01066878545822814, 0.011525157266374564, 0.011941992850200983, 0.009961914041167006, 0.010443726473311356, 0.010266114692383019, 0.01543008579549097, -9.985416666699612, 0.013432491743025216, 0.011886098485576998, 0.012198256581488801, 0.010356573455394895, 0.01054190534938934, 0.01076049024756812, 0.009903844098013334, 0.008053973612814801, 0.011093983240715699, 0.3408851838579664, 0.010742870252867874, 0.010369609390480032, 0.009579523108248215, 0.010667389235771948, 0.44464902782602966, 0.009866322931744121, 0.009788097553015084, -9.991297135193117, 0.01128423680367225, 0.010551488430600992, 0.010686411643905611, 0.010365849964364453, 0.009708111129072779, -9.988321712691071, 0.011695351016465273, 0.011273286548152744, 0.011104431246127365, -9.989478516233593, -9.989050067833329, -9.989521868343811, 0.010537701256995637, 0.009711495313467145, 0.008978910912979567, -19.98954030178743, -9.990084430765652, 0.009959849351513478, 0.009386576559568897, 0.00901355094901196, 0.011653703625857614, 0.011133610279966767, -19.989211738159398, 0.010623257214891968, 0.00975233026148365, 0.2819597801125977, 0.007639292347481914, 0.008022391404165009, -9.991828769580655, 0.00778003409608571, 0.009437938885704914, 0.008944575934885521, 0.008796354073686017, 0.008374686556718122, 0.008278761338101561, 0.008250292754533919, -9.034393539200027, 0.008444523072778492, 0.008011084509002194, 0.007136838790088378, 0.00901897371703855, 0.00885753674749154, 0.008961053199321632, 0.008743264716630894, 0.008839646061706077, 0.009488352278736706, 0.008952419568339216, 0.008844229544984, 0.00864898520188126, 0.008355922483179845, 0.008133349744244067, 0.008046190957685467, 0.008725666362969422, 0.008307552742911365, 0.007904580540590027, -9.992105659385805, 0.008221372761626329, 0.007848145430864331, -9.992148316186956, 0.007681660178893214, 0.009621119198371105, 0.008950812655575641, 0.008882457032246634, -9.991162845976142, 0.008320304593461616], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 27, 26, 25, 25, 24, 25, 25, 27, 25, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.5980085269468, "mean_inference_ms": 2.1399456621436186, "mean_action_processing_ms": 0.1466480546703678, "mean_env_wait_ms": 1.1314621370318085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010513544082641602, "StateBufferConnector_ms": 0.006680011749267578, "ViewRequirementAgentConnector_ms": 0.18297600746154785}}, "episode_reward_max": 0.44464902782602966, "episode_reward_min": -19.98954030178743, "episode_reward_mean": -1.6700163060147646, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.014318141397925664, 0.01522989204715226, 0.013836350388922551, 0.013297692509560857, 0.012438078820621081, 0.013552100878901345, 0.012266755633206701, -9.987569792853733, 0.011698028087651892, 0.01066878545822814, 0.011525157266374564, 0.011941992850200983, 0.009961914041167006, 0.010443726473311356, 0.010266114692383019, 0.01543008579549097, -9.985416666699612, 0.013432491743025216, 0.011886098485576998, 0.012198256581488801, 0.010356573455394895, 0.01054190534938934, 0.01076049024756812, 0.009903844098013334, 0.008053973612814801, 0.011093983240715699, 0.3408851838579664, 0.010742870252867874, 0.010369609390480032, 0.009579523108248215, 0.010667389235771948, 0.44464902782602966, 0.009866322931744121, 0.009788097553015084, -9.991297135193117, 0.01128423680367225, 0.010551488430600992, 0.010686411643905611, 0.010365849964364453, 0.009708111129072779, -9.988321712691071, 0.011695351016465273, 0.011273286548152744, 0.011104431246127365, -9.989478516233593, -9.989050067833329, -9.989521868343811, 0.010537701256995637, 0.009711495313467145, 0.008978910912979567, -19.98954030178743, -9.990084430765652, 0.009959849351513478, 0.009386576559568897, 0.00901355094901196, 0.011653703625857614, 0.011133610279966767, -19.989211738159398, 0.010623257214891968, 0.00975233026148365, 0.2819597801125977, 0.007639292347481914, 0.008022391404165009, -9.991828769580655, 0.00778003409608571, 0.009437938885704914, 0.008944575934885521, 0.008796354073686017, 0.008374686556718122, 0.008278761338101561, 0.008250292754533919, -9.034393539200027, 0.008444523072778492, 0.008011084509002194, 0.007136838790088378, 0.00901897371703855, 0.00885753674749154, 0.008961053199321632, 0.008743264716630894, 0.008839646061706077, 0.009488352278736706, 0.008952419568339216, 0.008844229544984, 0.00864898520188126, 0.008355922483179845, 0.008133349744244067, 0.008046190957685467, 0.008725666362969422, 0.008307552742911365, 0.007904580540590027, -9.992105659385805, 0.008221372761626329, 0.007848145430864331, -9.992148316186956, 0.007681660178893214, 0.009621119198371105, 0.008950812655575641, 0.008882457032246634, -9.991162845976142, 0.008320304593461616], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 27, 26, 25, 25, 24, 25, 25, 27, 25, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.5980085269468, "mean_inference_ms": 2.1399456621436186, "mean_action_processing_ms": 0.1466480546703678, "mean_env_wait_ms": 1.1314621370318085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010513544082641602, "StateBufferConnector_ms": 0.006680011749267578, "ViewRequirementAgentConnector_ms": 0.18297600746154785}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 165750, "num_env_steps_sampled": 86000, "num_env_steps_trained": 165750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5593318028472933, "num_env_steps_trained_throughput_per_sec": 6.940697015552222, "timesteps_total": 86000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 86000, "timers": {"training_iteration_time_ms": 11302.301, "sample_time_ms": 11237.463, "load_time_ms": 0.248, "load_throughput": 315027.166, "learn_time_ms": 13.394, "learn_throughput": 5823.359, "synch_weights_time_ms": 11.551}, "counters": {"num_env_steps_sampled": 86000, "num_env_steps_trained": 165750, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 165750, "last_target_update_ts": 85800, "num_target_updates": 164}, "done": false, "episodes_total": 3366, "training_iteration": 86, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-03-21", "timestamp": 1713427401, "time_this_iter_s": 280.96123480796814, "time_total_s": 21152.89609503746, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21152.89609503746, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 11.1531328320802, "ram_util_percent": 26.521303258145362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.027461089193820953, "cur_lr": 0.01}, "td_error": [1.174106240272522, 1.1751890182495117, 0.8283286094665527, 1.1751890182495117, 1.1729621887207031, 1.1751888990402222, 1.1751888990402222, 0.8283295631408691, 1.1751888990402222, 1.1731842756271362, 1.1751890182495117, 1.1751887798309326, 1.1751890182495117, 1.1751891374588013, 1.1751890182495117, 1.1751888990402222, 1.1751887798309326, 0.8283291459083557, 1.1741095781326294, 1.1751890182495117, 1.1751888990402222, 1.1751887798309326, 1.1751888990402222, 1.1751890182495117, 1.5548185110092163, 0.8283272981643677, 1.1751890182495117, 1.1751888990402222, 1.1741023063659668, 1.1732183694839478, 0.8229526281356812, 1.1751890182495117, 1.1751888990402222, 1.1751890182495117, 1.1751887798309326, 1.1751888990402222, 1.1751890182495117, 1.1751888990402222, 1.1751888990402222, 1.1731919050216675, 1.1751888990402222, 1.173174262046814, 1.174046516418457, 1.1751887798309326, 3.619356155395508, 1.1741057634353638, 1.1751888990402222, 0.8283284902572632, 1.1740113496780396, 1.1751888990402222, 1.1751888990402222, 1.1731964349746704, 1.1751888990402222, 1.1751888990402222, 0.8283277750015259, 1.1751890182495117, 1.1751888990402222, 1.1751888990402222, 1.1751888990402222, 1.1751888990402222, 1.1751888990402222, 1.1751888990402222, 0.8283292055130005, 1.1751888990402222, 1.1751891374588013, 1.1751888990402222, 1.1751888990402222, 0.823928713798523, 1.1751887798309326, 1.1751888990402222, 1.1751891374588013, 1.1751888990402222, 0.8283286690711975, 1.175188660621643, 0.8283296823501587, 0.8283292055130005, 1.1751890182495117, 1.1741080284118652], "mean_td_error": 1.1576474905014038, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2150.0, "diff_num_grad_updates_vs_sampler_policy": 2149.0}}, "num_env_steps_sampled": 87000, "num_env_steps_trained": 167700, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 167700, "last_target_update_ts": 86840, "num_target_updates": 166}, "sampler_results": {"episode_reward_max": 0.2819597801125977, "episode_reward_min": -19.992736662157853, "episode_reward_mean": -2.1788027983152785, "episode_len_mean": 25.17, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.009708111129072779, -9.988321712691071, 0.011695351016465273, 0.011273286548152744, 0.011104431246127365, -9.989478516233593, -9.989050067833329, -9.989521868343811, 0.010537701256995637, 0.009711495313467145, 0.008978910912979567, -19.98954030178743, -9.990084430765652, 0.009959849351513478, 0.009386576559568897, 0.00901355094901196, 0.011653703625857614, 0.011133610279966767, -19.989211738159398, 0.010623257214891968, 0.00975233026148365, 0.2819597801125977, 0.007639292347481914, 0.008022391404165009, -9.991828769580655, 0.00778003409608571, 0.009437938885704914, 0.008944575934885521, 0.008796354073686017, 0.008374686556718122, 0.008278761338101561, 0.008250292754533919, -9.034393539200027, 0.008444523072778492, 0.008011084509002194, 0.007136838790088378, 0.00901897371703855, 0.00885753674749154, 0.008961053199321632, 0.008743264716630894, 0.008839646061706077, 0.009488352278736706, 0.008952419568339216, 0.008844229544984, 0.00864898520188126, 0.008355922483179845, 0.008133349744244067, 0.008046190957685467, 0.008725666362969422, 0.008307552742911365, 0.007904580540590027, -9.992105659385805, 0.008221372761626329, 0.007848145430864331, -9.992148316186956, 0.007681660178893214, 0.009621119198371105, 0.008950812655575641, 0.008882457032246634, -9.991162845976142, 0.008320304593461616, 0.007501278757353317, -19.992736662157853, 0.009005047483212599, -9.989620840502162, 0.008142866130445361, 0.00867067039469944, 0.008727383905701777, -9.992006534327569, 0.0076675531476464295, 0.00829656670952614, 0.008344695597749223, 0.008505234245852311, 0.008706276203736924, -9.992240388336942, 0.008441089757965108, 0.008456103276970993, 0.009008653114492147, 0.008881079016235367, 0.008493045306682816, 0.00896146040090541, 0.00854638163420045, 0.007921333326124646, 0.009128186435415077, 0.008431055729224838, 0.008462759522965995, -9.991720046249965, -9.99164386184412, 0.00933326025411807, 0.007589331092340158, 0.008459813947477494, 0.008997793411613244, 0.00981203433125041, 0.007739381663571303, 0.00916892261096949, 0.00842375109675499, 0.008482227961752983, 0.008640438834111478, -9.991460814602132, 0.00808909207558755], "episode_lengths": [24, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 27, 26, 25, 25, 24, 25, 25, 27, 25, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 27, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.68170179655203, "mean_inference_ms": 2.1390909357508874, "mean_action_processing_ms": 0.1466504432618799, "mean_env_wait_ms": 1.1199164605677125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009954452514648438, "StateBufferConnector_ms": 0.006646633148193359, "ViewRequirementAgentConnector_ms": 0.17903685569763184}}, "episode_reward_max": 0.2819597801125977, "episode_reward_min": -19.992736662157853, "episode_reward_mean": -2.1788027983152785, "episode_len_mean": 25.17, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.009708111129072779, -9.988321712691071, 0.011695351016465273, 0.011273286548152744, 0.011104431246127365, -9.989478516233593, -9.989050067833329, -9.989521868343811, 0.010537701256995637, 0.009711495313467145, 0.008978910912979567, -19.98954030178743, -9.990084430765652, 0.009959849351513478, 0.009386576559568897, 0.00901355094901196, 0.011653703625857614, 0.011133610279966767, -19.989211738159398, 0.010623257214891968, 0.00975233026148365, 0.2819597801125977, 0.007639292347481914, 0.008022391404165009, -9.991828769580655, 0.00778003409608571, 0.009437938885704914, 0.008944575934885521, 0.008796354073686017, 0.008374686556718122, 0.008278761338101561, 0.008250292754533919, -9.034393539200027, 0.008444523072778492, 0.008011084509002194, 0.007136838790088378, 0.00901897371703855, 0.00885753674749154, 0.008961053199321632, 0.008743264716630894, 0.008839646061706077, 0.009488352278736706, 0.008952419568339216, 0.008844229544984, 0.00864898520188126, 0.008355922483179845, 0.008133349744244067, 0.008046190957685467, 0.008725666362969422, 0.008307552742911365, 0.007904580540590027, -9.992105659385805, 0.008221372761626329, 0.007848145430864331, -9.992148316186956, 0.007681660178893214, 0.009621119198371105, 0.008950812655575641, 0.008882457032246634, -9.991162845976142, 0.008320304593461616, 0.007501278757353317, -19.992736662157853, 0.009005047483212599, -9.989620840502162, 0.008142866130445361, 0.00867067039469944, 0.008727383905701777, -9.992006534327569, 0.0076675531476464295, 0.00829656670952614, 0.008344695597749223, 0.008505234245852311, 0.008706276203736924, -9.992240388336942, 0.008441089757965108, 0.008456103276970993, 0.009008653114492147, 0.008881079016235367, 0.008493045306682816, 0.00896146040090541, 0.00854638163420045, 0.007921333326124646, 0.009128186435415077, 0.008431055729224838, 0.008462759522965995, -9.991720046249965, -9.99164386184412, 0.00933326025411807, 0.007589331092340158, 0.008459813947477494, 0.008997793411613244, 0.00981203433125041, 0.007739381663571303, 0.00916892261096949, 0.00842375109675499, 0.008482227961752983, 0.008640438834111478, -9.991460814602132, 0.00808909207558755], "episode_lengths": [24, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 27, 26, 25, 25, 24, 25, 25, 27, 25, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 27, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.68170179655203, "mean_inference_ms": 2.1390909357508874, "mean_action_processing_ms": 0.1466504432618799, "mean_env_wait_ms": 1.1199164605677125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009954452514648438, "StateBufferConnector_ms": 0.006646633148193359, "ViewRequirementAgentConnector_ms": 0.17903685569763184}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 167700, "num_env_steps_sampled": 87000, "num_env_steps_trained": 167700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.032460511839052, "num_env_steps_trained_throughput_per_sec": 7.863297998086153, "timesteps_total": 87000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 87000, "timers": {"training_iteration_time_ms": 10118.778, "sample_time_ms": 10056.123, "load_time_ms": 0.236, "load_throughput": 330160.17, "learn_time_ms": 13.04, "learn_throughput": 5981.521, "synch_weights_time_ms": 11.202}, "counters": {"num_env_steps_sampled": 87000, "num_env_steps_trained": 167700, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 167700, "last_target_update_ts": 86840, "num_target_updates": 166}, "done": false, "episodes_total": 3405, "training_iteration": 87, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-07-29", "timestamp": 1713427649, "time_this_iter_s": 247.99724411964417, "time_total_s": 21400.893339157104, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21400.893339157104, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 12.147875354107649, "ram_util_percent": 26.645042492917845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.029469605535268784, "cur_lr": 0.01}, "td_error": [0.8247126340866089, 1.178152322769165, 1.1778299808502197, 1.1800943613052368, 1.1800917387008667, 1.177635669708252, 1.177780270576477, 1.1800950765609741, 1.1800966262817383, 1.1800967454910278, 1.1800963878631592, 1.1800967454910278, 1.180094599723816, 1.1800949573516846, 1.180094599723816, 1.1800956726074219, 1.1800917387008667, 2.2717185020446777, 1.1767245531082153, 1.1800960302352905, 1.1800962686538696, 1.1800956726074219, 0.8356338739395142, 1.180090308189392, 1.1800965070724487, 1.1800950765609741, 1.1800965070724487, 1.1800943613052368, 1.1800928115844727, 0.8356343507766724, 1.1800951957702637, 1.1800955533981323, 1.1800364255905151, 3.6494784355163574, 1.1800955533981323, 1.1778284311294556, 1.1800949573516846, 1.18009352684021, 1.1800955533981323, 1.1800960302352905, 1.1777456998825073, 1.1800916194915771, 1.18009614944458, 1.1800954341888428, 1.1781644821166992, 1.1800966262817383, 1.4449697732925415, 1.1800934076309204, 1.18009614944458, 1.1800960302352905, 3.6494786739349365, 1.1800960302352905, 1.1765930652618408, 1.1800960302352905, 1.1800944805145264, 1.1800956726074219, 1.1800955533981323, 0.8279725313186646, 1.1800954341888428, 1.1800950765609741, 1.1775541305541992, 1.1800960302352905, 1.1800963878631592, 1.180094838142395, 1.1781644821166992, 1.180091142654419, 1.1772799491882324, 1.177769422531128, 1.1800955533981323, 1.1800916194915771, 1.180095911026001, 1.1800963878631592, 1.1800949573516846, 1.1800918579101562, 1.1781654357910156, 1.1799476146697998, 0.8356339931488037, 1.1800936460494995], "mean_td_error": 1.2380465269088745, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2175.0, "diff_num_grad_updates_vs_sampler_policy": 2174.0}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 169650, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 169650, "last_target_update_ts": 87880, "num_target_updates": 168}, "sampler_results": {"episode_reward_max": 7.525274273439598, "episode_reward_min": -19.992736662157853, "episode_reward_mean": -1.5938452719759821, "episode_len_mean": 25.07, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.008839646061706077, 0.009488352278736706, 0.008952419568339216, 0.008844229544984, 0.00864898520188126, 0.008355922483179845, 0.008133349744244067, 0.008046190957685467, 0.008725666362969422, 0.008307552742911365, 0.007904580540590027, -9.992105659385805, 0.008221372761626329, 0.007848145430864331, -9.992148316186956, 0.007681660178893214, 0.009621119198371105, 0.008950812655575641, 0.008882457032246634, -9.991162845976142, 0.008320304593461616, 0.007501278757353317, -19.992736662157853, 0.009005047483212599, -9.989620840502162, 0.008142866130445361, 0.00867067039469944, 0.008727383905701777, -9.992006534327569, 0.0076675531476464295, 0.00829656670952614, 0.008344695597749223, 0.008505234245852311, 0.008706276203736924, -9.992240388336942, 0.008441089757965108, 0.008456103276970993, 0.009008653114492147, 0.008881079016235367, 0.008493045306682816, 0.00896146040090541, 0.00854638163420045, 0.007921333326124646, 0.009128186435415077, 0.008431055729224838, 0.008462759522965995, -9.991720046249965, -9.99164386184412, 0.00933326025411807, 0.007589331092340158, 0.008459813947477494, 0.008997793411613244, 0.00981203433125041, 0.007739381663571303, 0.00916892261096949, 0.00842375109675499, 0.008482227961752983, 0.008640438834111478, -9.991460814602132, 0.00808909207558755, -19.991580588327412, 0.012349427084799627, 1.4610087793218658, 0.011786865550605048, 0.012371666610379032, 0.009861202805281273, 0.010042049088855077, 7.525274273439598, 0.010054629856636023, 0.00988595889368246, 0.010933215508200964, 0.0103938098319177, 0.01193327778828813, 0.01114779645061401, 0.010328635882780268, 0.007409732816799533, 0.009181281172457395, 0.009771637709703143, 0.00971518447432206, 0.009209949126709154, 0.0074253788154722234, 0.010691276302580486, 0.009631266210615178, 0.010303365947278688, 0.010230411305453857, -9.990851943069144, 0.01125613380784546, 0.01130151744963726, 0.011393666110521415, 0.01072032320240341, -9.990162396406667, -9.989296206133822, 0.010565312377234322, 0.010038273545849925, 0.010213249527310272, 0.008846052758764978, 0.009848856077017621, 0.009999623813936947, 0.7430843925096265, -9.990806101981466], "episode_lengths": [25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 27, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.76799048455536, "mean_inference_ms": 2.139403214525583, "mean_action_processing_ms": 0.14665660987838863, "mean_env_wait_ms": 1.1083391759185097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010227203369140625, "StateBufferConnector_ms": 0.00695490837097168, "ViewRequirementAgentConnector_ms": 0.1834578514099121}}, "episode_reward_max": 7.525274273439598, "episode_reward_min": -19.992736662157853, "episode_reward_mean": -1.5938452719759821, "episode_len_mean": 25.07, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.008839646061706077, 0.009488352278736706, 0.008952419568339216, 0.008844229544984, 0.00864898520188126, 0.008355922483179845, 0.008133349744244067, 0.008046190957685467, 0.008725666362969422, 0.008307552742911365, 0.007904580540590027, -9.992105659385805, 0.008221372761626329, 0.007848145430864331, -9.992148316186956, 0.007681660178893214, 0.009621119198371105, 0.008950812655575641, 0.008882457032246634, -9.991162845976142, 0.008320304593461616, 0.007501278757353317, -19.992736662157853, 0.009005047483212599, -9.989620840502162, 0.008142866130445361, 0.00867067039469944, 0.008727383905701777, -9.992006534327569, 0.0076675531476464295, 0.00829656670952614, 0.008344695597749223, 0.008505234245852311, 0.008706276203736924, -9.992240388336942, 0.008441089757965108, 0.008456103276970993, 0.009008653114492147, 0.008881079016235367, 0.008493045306682816, 0.00896146040090541, 0.00854638163420045, 0.007921333326124646, 0.009128186435415077, 0.008431055729224838, 0.008462759522965995, -9.991720046249965, -9.99164386184412, 0.00933326025411807, 0.007589331092340158, 0.008459813947477494, 0.008997793411613244, 0.00981203433125041, 0.007739381663571303, 0.00916892261096949, 0.00842375109675499, 0.008482227961752983, 0.008640438834111478, -9.991460814602132, 0.00808909207558755, -19.991580588327412, 0.012349427084799627, 1.4610087793218658, 0.011786865550605048, 0.012371666610379032, 0.009861202805281273, 0.010042049088855077, 7.525274273439598, 0.010054629856636023, 0.00988595889368246, 0.010933215508200964, 0.0103938098319177, 0.01193327778828813, 0.01114779645061401, 0.010328635882780268, 0.007409732816799533, 0.009181281172457395, 0.009771637709703143, 0.00971518447432206, 0.009209949126709154, 0.0074253788154722234, 0.010691276302580486, 0.009631266210615178, 0.010303365947278688, 0.010230411305453857, -9.990851943069144, 0.01125613380784546, 0.01130151744963726, 0.011393666110521415, 0.01072032320240341, -9.990162396406667, -9.989296206133822, 0.010565312377234322, 0.010038273545849925, 0.010213249527310272, 0.008846052758764978, 0.009848856077017621, 0.009999623813936947, 0.7430843925096265, -9.990806101981466], "episode_lengths": [25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 27, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.76799048455536, "mean_inference_ms": 2.139403214525583, "mean_action_processing_ms": 0.14665660987838863, "mean_env_wait_ms": 1.1083391759185097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010227203369140625, "StateBufferConnector_ms": 0.00695490837097168, "ViewRequirementAgentConnector_ms": 0.1834578514099121}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 169650, "num_env_steps_sampled": 88000, "num_env_steps_trained": 169650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.211461071832546, "num_env_steps_trained_throughput_per_sec": 10.162349090073466, "timesteps_total": 88000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 6720.89, "sample_time_ms": 6658.789, "load_time_ms": 0.232, "load_throughput": 335957.807, "learn_time_ms": 12.713, "learn_throughput": 6135.634, "synch_weights_time_ms": 11.484}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 169650, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 169650, "last_target_update_ts": 87880, "num_target_updates": 168}, "done": false, "episodes_total": 3445, "training_iteration": 88, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-10-41", "timestamp": 1713427841, "time_this_iter_s": 191.89364433288574, "time_total_s": 21592.78698348999, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21592.78698348999, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 15.7125, "ram_util_percent": 26.750367647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0191759392619133, "cur_lr": 0.01}, "td_error": [1.1421822309494019, 1.139032244682312, 1.1416538953781128, 1.1421823501586914, 1.1421829462051392, 1.1390230655670166, 1.142183780670166, 1.1421836614608765, 1.14218270778656, 0.8266092538833618, 1.1421821117401123, 1.1418389081954956, 1.142183542251587, 1.1421838998794556, 1.1421831846237183, 1.4232277870178223, 1.1421822309494019, 1.142183780670166, 1.1405688524246216, 1.1421833038330078, 1.1421831846237183, 1.142183542251587, 0.8216578364372253, 1.141985297203064, 1.1421836614608765, 1.1420115232467651, 1.1421836614608765, 1.1421836614608765, 1.1421822309494019, 1.1421836614608765, 1.1421825885772705, 1.1421834230422974, 0.8278954029083252, 1.1380292177200317, 1.142183542251587, 1.1421828269958496, 1.142183542251587, 0.8266096115112305, 1.1421830654144287, 1.1421828269958496, 1.1421834230422974, 1.1421838998794556, 1.1421821117401123, 1.1421836614608765, 1.1421830654144287, 0.8266096115112305, 3.5773203372955322, 1.1421829462051392, 1.1421829462051392, 1.1421833038330078, 1.1421828269958496, 1.1418194770812988, 1.1420232057571411, 1.1421830654144287, 1.1420003175735474, 1.1421819925308228, 1.1421830654144287, 1.1421831846237183, 1.1421834230422974, 1.1390291452407837, 1.141420602798462, 1.142182469367981, 1.1390286684036255, 1.1421828269958496, 1.141876459121704, 1.1421831846237183, 0.8266083002090454, 1.1421817541122437, 1.142183780670166, 1.139011263847351, 1.142182469367981, 1.1421831846237183, 1.1420091390609741, 1.142182469367981, 0.8272308111190796, 1.1420115232467651, 1.142183780670166, 0.8266085386276245], "mean_td_error": 1.1442807912826538, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2200.0, "diff_num_grad_updates_vs_sampler_policy": 2199.0}}, "num_env_steps_sampled": 89000, "num_env_steps_trained": 171600, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 171600, "last_target_update_ts": 88920, "num_target_updates": 170}, "sampler_results": {"episode_reward_max": 7.525274273439598, "episode_reward_min": -19.991580588327412, "episode_reward_mean": -1.1619023358363154, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00896146040090541, 0.00854638163420045, 0.007921333326124646, 0.009128186435415077, 0.008431055729224838, 0.008462759522965995, -9.991720046249965, -9.99164386184412, 0.00933326025411807, 0.007589331092340158, 0.008459813947477494, 0.008997793411613244, 0.00981203433125041, 0.007739381663571303, 0.00916892261096949, 0.00842375109675499, 0.008482227961752983, 0.008640438834111478, -9.991460814602132, 0.00808909207558755, -19.991580588327412, 0.012349427084799627, 1.4610087793218658, 0.011786865550605048, 0.012371666610379032, 0.009861202805281273, 0.010042049088855077, 7.525274273439598, 0.010054629856636023, 0.00988595889368246, 0.010933215508200964, 0.0103938098319177, 0.01193327778828813, 0.01114779645061401, 0.010328635882780268, 0.007409732816799533, 0.009181281172457395, 0.009771637709703143, 0.00971518447432206, 0.009209949126709154, 0.0074253788154722234, 0.010691276302580486, 0.009631266210615178, 0.010303365947278688, 0.010230411305453857, -9.990851943069144, 0.01125613380784546, 0.01130151744963726, 0.011393666110521415, 0.01072032320240341, -9.990162396406667, -9.989296206133822, 0.010565312377234322, 0.010038273545849925, 0.010213249527310272, 0.008846052758764978, 0.009848856077017621, 0.009999623813936947, 0.7430843925096265, -9.990806101981466, 0.01021702316106377, 0.01031135530618876, 0.009504561085435133, 0.009360421220942652, 0.009098200786142895, 0.009190991557816303, 0.008381142483422947, 0.008481797963576631, 0.008405713886970402, 0.0074220085868092305, 0.009939806294330562, 0.008804648663304545, -9.991662223350183, 0.00819733867637832, 0.00817817614649131, 0.008287244774673352, 0.008373704348664216, 1.6018283424774888, 0.007928177812136249, 0.007643972931233711, -19.990353468662615, 0.009023931630863617, 0.008704006935490533, 0.008560984121552519, 0.007990587470254927, 0.009525157652376421, 0.009151871647912873, 0.008815016828396301, 0.008725715983038113, 0.008230512952347988, 0.008492159438309319, 0.009103419970899675, 1.6021902334203597, -9.991927813995106, 0.008024863290583783, 0.008683370884916823, 0.008302630516971398, 0.008164015248269664, 0.007960015971159284, 0.0076330613608941835], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.9108758696791, "mean_inference_ms": 2.1405365826914338, "mean_action_processing_ms": 0.14665258329464875, "mean_env_wait_ms": 1.0970719210547186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010215044021606445, "StateBufferConnector_ms": 0.008704185485839844, "ViewRequirementAgentConnector_ms": 0.18468141555786133}}, "episode_reward_max": 7.525274273439598, "episode_reward_min": -19.991580588327412, "episode_reward_mean": -1.1619023358363154, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00896146040090541, 0.00854638163420045, 0.007921333326124646, 0.009128186435415077, 0.008431055729224838, 0.008462759522965995, -9.991720046249965, -9.99164386184412, 0.00933326025411807, 0.007589331092340158, 0.008459813947477494, 0.008997793411613244, 0.00981203433125041, 0.007739381663571303, 0.00916892261096949, 0.00842375109675499, 0.008482227961752983, 0.008640438834111478, -9.991460814602132, 0.00808909207558755, -19.991580588327412, 0.012349427084799627, 1.4610087793218658, 0.011786865550605048, 0.012371666610379032, 0.009861202805281273, 0.010042049088855077, 7.525274273439598, 0.010054629856636023, 0.00988595889368246, 0.010933215508200964, 0.0103938098319177, 0.01193327778828813, 0.01114779645061401, 0.010328635882780268, 0.007409732816799533, 0.009181281172457395, 0.009771637709703143, 0.00971518447432206, 0.009209949126709154, 0.0074253788154722234, 0.010691276302580486, 0.009631266210615178, 0.010303365947278688, 0.010230411305453857, -9.990851943069144, 0.01125613380784546, 0.01130151744963726, 0.011393666110521415, 0.01072032320240341, -9.990162396406667, -9.989296206133822, 0.010565312377234322, 0.010038273545849925, 0.010213249527310272, 0.008846052758764978, 0.009848856077017621, 0.009999623813936947, 0.7430843925096265, -9.990806101981466, 0.01021702316106377, 0.01031135530618876, 0.009504561085435133, 0.009360421220942652, 0.009098200786142895, 0.009190991557816303, 0.008381142483422947, 0.008481797963576631, 0.008405713886970402, 0.0074220085868092305, 0.009939806294330562, 0.008804648663304545, -9.991662223350183, 0.00819733867637832, 0.00817817614649131, 0.008287244774673352, 0.008373704348664216, 1.6018283424774888, 0.007928177812136249, 0.007643972931233711, -19.990353468662615, 0.009023931630863617, 0.008704006935490533, 0.008560984121552519, 0.007990587470254927, 0.009525157652376421, 0.009151871647912873, 0.008815016828396301, 0.008725715983038113, 0.008230512952347988, 0.008492159438309319, 0.009103419970899675, 1.6021902334203597, -9.991927813995106, 0.008024863290583783, 0.008683370884916823, 0.008302630516971398, 0.008164015248269664, 0.007960015971159284, 0.0076330613608941835], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 433.9108758696791, "mean_inference_ms": 2.1405365826914338, "mean_action_processing_ms": 0.14665258329464875, "mean_env_wait_ms": 1.0970719210547186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010215044021606445, "StateBufferConnector_ms": 0.008704185485839844, "ViewRequirementAgentConnector_ms": 0.18468141555786133}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 171600, "num_env_steps_sampled": 89000, "num_env_steps_trained": 171600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.881628450014555, "num_env_steps_trained_throughput_per_sec": 9.519175477528382, "timesteps_total": 89000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 89000, "timers": {"training_iteration_time_ms": 9111.449, "sample_time_ms": 9048.533, "load_time_ms": 0.233, "load_throughput": 334275.786, "learn_time_ms": 12.926, "learn_throughput": 6034.179, "synch_weights_time_ms": 10.985}, "counters": {"num_env_steps_sampled": 89000, "num_env_steps_trained": 171600, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 171600, "last_target_update_ts": 88920, "num_target_updates": 170}, "done": false, "episodes_total": 3485, "training_iteration": 89, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-14-06", "timestamp": 1713428046, "time_this_iter_s": 204.85831761360168, "time_total_s": 21797.645301103592, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21797.645301103592, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 15.331506849315069, "ram_util_percent": 27.070547945205476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01855640672147274, "cur_lr": 0.01}, "td_error": [1.1544990539550781, 1.1531468629837036, 1.1529874801635742, 1.1530859470367432, 1.1544989347457886, 1.1530681848526, 1.1530503034591675, 1.1544383764266968, 1.1544983386993408, 1.1544991731643677, 1.1544989347457886, 1.3344136476516724, 1.1544989347457886, 1.1544986963272095, 1.1544991731643677, 1.1544991731643677, 1.1530952453613281, 1.1544990539550781, 1.1544990539550781, 1.1529879570007324, 1.1544990539550781, 1.154498815536499, 1.1544989347457886, 1.1544989347457886, 1.1527719497680664, 1.1544990539550781, 1.1530933380126953, 1.1525506973266602, 1.1544990539550781, 1.1544989347457886, 1.1544990539550781, 0.8118600845336914, 1.1544990539550781, 1.154498815536499, 1.1530719995498657, 1.1544984579086304, 3.784614324569702, 1.1544991731643677, 1.1544990539550781, 1.1544990539550781, 0.8077486753463745, 1.1544986963272095, 1.1544990539550781, 3.7828736305236816, 1.1530193090438843, 1.154498815536499, 0.8114468455314636, 1.1544991731643677, 1.1544989347457886, 1.1530756950378418, 1.1544989347457886, 1.1544990539550781, 1.1544989347457886, 1.1544989347457886, 1.1530869007110596, 1.1528538465499878, 1.1544989347457886, 1.1531336307525635, 1.1530896425247192, 1.1544990539550781, 0.811438798904419, 1.1530468463897705, 0.8114111423492432, 1.1544991731643677, 1.1544991731643677, 1.1544990539550781, 1.2043137550354004, 0.8077478408813477, 1.1544991731643677, 1.1544991731643677, 0.8114792108535767, 1.1544989347457886, 1.1544920206069946, 1.1544990539550781, 1.1544989347457886, 1.1544991731643677, 1.1531367301940918, 1.1544990539550781], "mean_td_error": 1.1936228275299072, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2225.0, "diff_num_grad_updates_vs_sampler_policy": 2224.0}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 173550, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 173550, "last_target_update_ts": 89960, "num_target_updates": 172}, "sampler_results": {"episode_reward_max": 1.6021902334203597, "episode_reward_min": -19.990353468662615, "episode_reward_mean": -1.1523380449736669, "episode_len_mean": 25.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0074253788154722234, 0.010691276302580486, 0.009631266210615178, 0.010303365947278688, 0.010230411305453857, -9.990851943069144, 0.01125613380784546, 0.01130151744963726, 0.011393666110521415, 0.01072032320240341, -9.990162396406667, -9.989296206133822, 0.010565312377234322, 0.010038273545849925, 0.010213249527310272, 0.008846052758764978, 0.009848856077017621, 0.009999623813936947, 0.7430843925096265, -9.990806101981466, 0.01021702316106377, 0.01031135530618876, 0.009504561085435133, 0.009360421220942652, 0.009098200786142895, 0.009190991557816303, 0.008381142483422947, 0.008481797963576631, 0.008405713886970402, 0.0074220085868092305, 0.009939806294330562, 0.008804648663304545, -9.991662223350183, 0.00819733867637832, 0.00817817614649131, 0.008287244774673352, 0.008373704348664216, 1.6018283424774888, 0.007928177812136249, 0.007643972931233711, -19.990353468662615, 0.009023931630863617, 0.008704006935490533, 0.008560984121552519, 0.007990587470254927, 0.009525157652376421, 0.009151871647912873, 0.008815016828396301, 0.008725715983038113, 0.008230512952347988, 0.008492159438309319, 0.009103419970899675, 1.6021902334203597, -9.991927813995106, 0.008024863290583783, 0.008683370884916823, 0.008302630516971398, 0.008164015248269664, 0.007960015971159284, 0.0076330613608941835, 0.008830186524145255, 0.008701886591658827, 0.008122953363977125, -9.992279646421652, 0.0074531883577414765, 0.008016904968747242, 0.007750497849650799, 0.007651389384839509, 0.007191455416172093, 0.007170456011236765, 0.008177206213410624, 0.007705763249461954, 0.00746010157943102, 0.007188007859558573, 0.007327753396530896, -9.992746968604504, -9.992675256281615, 0.007203868526925941, 0.007010833396933359, 0.006808544492177839, 0.007728619367999364, 0.007681975618026435, 0.007322510989324374, 0.00727604661742439, 0.0069200185616942475, 0.007901299941287326, 0.007824684178908753, 0.007492711192756858, 0.007378004309594736, 0.007218746150214281, 0.008015687521504812, 0.007567386264513599, 0.007302794372400931, 0.00702764359476779, -9.992969129655771, 0.007472206232402789, 0.007227209744997702, 0.007144198541447422, 0.006638503117547359, 0.006630130447236696], "episode_lengths": [25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.04378719972146, "mean_inference_ms": 2.140057684353838, "mean_action_processing_ms": 0.14662026803600875, "mean_env_wait_ms": 1.0861022707142325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00994563102722168, "StateBufferConnector_ms": 0.008455991744995117, "ViewRequirementAgentConnector_ms": 0.18160128593444824}}, "episode_reward_max": 1.6021902334203597, "episode_reward_min": -19.990353468662615, "episode_reward_mean": -1.1523380449736669, "episode_len_mean": 25.08, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0074253788154722234, 0.010691276302580486, 0.009631266210615178, 0.010303365947278688, 0.010230411305453857, -9.990851943069144, 0.01125613380784546, 0.01130151744963726, 0.011393666110521415, 0.01072032320240341, -9.990162396406667, -9.989296206133822, 0.010565312377234322, 0.010038273545849925, 0.010213249527310272, 0.008846052758764978, 0.009848856077017621, 0.009999623813936947, 0.7430843925096265, -9.990806101981466, 0.01021702316106377, 0.01031135530618876, 0.009504561085435133, 0.009360421220942652, 0.009098200786142895, 0.009190991557816303, 0.008381142483422947, 0.008481797963576631, 0.008405713886970402, 0.0074220085868092305, 0.009939806294330562, 0.008804648663304545, -9.991662223350183, 0.00819733867637832, 0.00817817614649131, 0.008287244774673352, 0.008373704348664216, 1.6018283424774888, 0.007928177812136249, 0.007643972931233711, -19.990353468662615, 0.009023931630863617, 0.008704006935490533, 0.008560984121552519, 0.007990587470254927, 0.009525157652376421, 0.009151871647912873, 0.008815016828396301, 0.008725715983038113, 0.008230512952347988, 0.008492159438309319, 0.009103419970899675, 1.6021902334203597, -9.991927813995106, 0.008024863290583783, 0.008683370884916823, 0.008302630516971398, 0.008164015248269664, 0.007960015971159284, 0.0076330613608941835, 0.008830186524145255, 0.008701886591658827, 0.008122953363977125, -9.992279646421652, 0.0074531883577414765, 0.008016904968747242, 0.007750497849650799, 0.007651389384839509, 0.007191455416172093, 0.007170456011236765, 0.008177206213410624, 0.007705763249461954, 0.00746010157943102, 0.007188007859558573, 0.007327753396530896, -9.992746968604504, -9.992675256281615, 0.007203868526925941, 0.007010833396933359, 0.006808544492177839, 0.007728619367999364, 0.007681975618026435, 0.007322510989324374, 0.00727604661742439, 0.0069200185616942475, 0.007901299941287326, 0.007824684178908753, 0.007492711192756858, 0.007378004309594736, 0.007218746150214281, 0.008015687521504812, 0.007567386264513599, 0.007302794372400931, 0.00702764359476779, -9.992969129655771, 0.007472206232402789, 0.007227209744997702, 0.007144198541447422, 0.006638503117547359, 0.006630130447236696], "episode_lengths": [25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.04378719972146, "mean_inference_ms": 2.140057684353838, "mean_action_processing_ms": 0.14662026803600875, "mean_env_wait_ms": 1.0861022707142325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00994563102722168, "StateBufferConnector_ms": 0.008455991744995117, "ViewRequirementAgentConnector_ms": 0.18160128593444824}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 173550, "num_env_steps_sampled": 90000, "num_env_steps_trained": 173550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5666817286963215, "num_env_steps_trained_throughput_per_sec": 6.955029370957828, "timesteps_total": 90000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 11282.428, "sample_time_ms": 11215.735, "load_time_ms": 0.248, "load_throughput": 314391.42, "learn_time_ms": 13.508, "learn_throughput": 5774.494, "synch_weights_time_ms": 12.442}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 173550, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 173550, "last_target_update_ts": 89960, "num_target_updates": 172}, "done": false, "episodes_total": 3525, "training_iteration": 90, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-18-47", "timestamp": 1713428327, "time_this_iter_s": 280.38094091415405, "time_total_s": 22078.026242017746, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 22078.026242017746, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 11.079699248120301, "ram_util_percent": 27.213784461152883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.029642030596733093, "cur_lr": 0.01}, "td_error": [1.1439181566238403, 1.1439038515090942, 1.1439164876937866, 1.1439268589019775, 1.1434073448181152, 1.1439263820648193, 1.143444299697876, 1.143568515777588, 1.143925428390503, 1.143912672996521, 1.1439260244369507, 1.1435120105743408, 1.1434848308563232, 1.143925666809082, 1.143925666809082, 1.143926978111267, 1.1439263820648193, 0.8106588125228882, 1.1439260244369507, 1.1439270973205566, 1.1439155340194702, 1.1439259052276611, 1.143926978111267, 1.1439266204833984, 1.1439266204833984, 1.14348566532135, 1.2399547100067139, 1.1434799432754517, 1.2051277160644531, 4.002549171447754, 1.1439262628555298, 1.143926739692688, 1.1439249515533447, 3.9112284183502197, 1.1642848253250122, 1.143926978111267, 1.1439268589019775, 1.143270492553711, 1.1438539028167725, 1.143926739692688, 1.1439248323440552, 1.1439270973205566, 1.1439260244369507, 1.1438477039337158, 1.143903136253357, 1.1439266204833984, 0.8118036985397339, 1.1439262628555298, 1.1439260244369507, 1.1439260244369507, 1.1438591480255127, 1.1439270973205566, 1.142433524131775, 1.143463373184204, 1.1439266204833984, 0.8118048906326294, 0.8118045926094055, 1.1428908109664917, 1.143926978111267, 1.1439265012741089, 1.1426984071731567, 1.9498839378356934, 1.1439266204833984, 1.1439270973205566, 1.1439263820648193, 1.2002242803573608, 1.1439259052276611, 0.8026415109634399, 1.143925428390503, 1.1439244747161865, 0.8118032217025757, 1.1435575485229492, 1.1439257860183716, 1.1439261436462402, 0.8106228113174438, 1.143926739692688, 1.1439251899719238, 1.1439260244369507], "mean_td_error": 1.199320912361145, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2250.0, "diff_num_grad_updates_vs_sampler_policy": 2249.0}}, "num_env_steps_sampled": 91000, "num_env_steps_trained": 175500, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 175500, "last_target_update_ts": 91000, "num_target_updates": 174}, "sampler_results": {"episode_reward_max": 1.6021902334203597, "episode_reward_min": -19.99312424967753, "episode_reward_mean": -1.5766946629747394, "episode_len_mean": 25.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.990353468662615, 0.009023931630863617, 0.008704006935490533, 0.008560984121552519, 0.007990587470254927, 0.009525157652376421, 0.009151871647912873, 0.008815016828396301, 0.008725715983038113, 0.008230512952347988, 0.008492159438309319, 0.009103419970899675, 1.6021902334203597, -9.991927813995106, 0.008024863290583783, 0.008683370884916823, 0.008302630516971398, 0.008164015248269664, 0.007960015971159284, 0.0076330613608941835, 0.008830186524145255, 0.008701886591658827, 0.008122953363977125, -9.992279646421652, 0.0074531883577414765, 0.008016904968747242, 0.007750497849650799, 0.007651389384839509, 0.007191455416172093, 0.007170456011236765, 0.008177206213410624, 0.007705763249461954, 0.00746010157943102, 0.007188007859558573, 0.007327753396530896, -9.992746968604504, -9.992675256281615, 0.007203868526925941, 0.007010833396933359, 0.006808544492177839, 0.007728619367999364, 0.007681975618026435, 0.007322510989324374, 0.00727604661742439, 0.0069200185616942475, 0.007901299941287326, 0.007824684178908753, 0.007492711192756858, 0.007378004309594736, 0.007218746150214281, 0.008015687521504812, 0.007567386264513599, 0.007302794372400931, 0.00702764359476779, -9.992969129655771, 0.007472206232402789, 0.007227209744997702, 0.007144198541447422, 0.006638503117547359, 0.006630130447236696, 0.007552412392009583, -9.992909028958458, -19.99312424967753, 0.0065022056621172, -9.993889793422849, 0.007046904134440284, 0.006843103261696361, 0.0066974271800272385, 0.006480579573842297, 0.006024379191505007, 0.007175529512852502, 0.0067328558253024464, -9.993465507509343, 0.006247814758892093, 0.0062228267727180596, 0.006796689141081218, -9.993332661129529, 0.006873348989303213, 0.006536147701920467, 0.006553581040198948, -19.99305786952207, 0.006761941640305354, 0.006857852593101278, 0.006879581361583002, 0.006680534035264927, 0.007154102253930689, 0.006625447191620894, 0.0066755821798157805, -9.993898051015782, 0.006556363233555252, 0.006699437937224336, 0.00661452446461256, 0.006487739548642419, 0.00625416326530471, 0.0062006501445175, 0.006649648429931525, 0.006693365134633259, 0.006876145462344841, 0.006744459747252835, 0.006642874350125568], "episode_lengths": [27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.1707888870215, "mean_inference_ms": 2.139272444655882, "mean_action_processing_ms": 0.14657526714919894, "mean_env_wait_ms": 1.0753633926160253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01066136360168457, "StateBufferConnector_ms": 0.0065042972564697266, "ViewRequirementAgentConnector_ms": 0.17843031883239746}}, "episode_reward_max": 1.6021902334203597, "episode_reward_min": -19.99312424967753, "episode_reward_mean": -1.5766946629747394, "episode_len_mean": 25.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.990353468662615, 0.009023931630863617, 0.008704006935490533, 0.008560984121552519, 0.007990587470254927, 0.009525157652376421, 0.009151871647912873, 0.008815016828396301, 0.008725715983038113, 0.008230512952347988, 0.008492159438309319, 0.009103419970899675, 1.6021902334203597, -9.991927813995106, 0.008024863290583783, 0.008683370884916823, 0.008302630516971398, 0.008164015248269664, 0.007960015971159284, 0.0076330613608941835, 0.008830186524145255, 0.008701886591658827, 0.008122953363977125, -9.992279646421652, 0.0074531883577414765, 0.008016904968747242, 0.007750497849650799, 0.007651389384839509, 0.007191455416172093, 0.007170456011236765, 0.008177206213410624, 0.007705763249461954, 0.00746010157943102, 0.007188007859558573, 0.007327753396530896, -9.992746968604504, -9.992675256281615, 0.007203868526925941, 0.007010833396933359, 0.006808544492177839, 0.007728619367999364, 0.007681975618026435, 0.007322510989324374, 0.00727604661742439, 0.0069200185616942475, 0.007901299941287326, 0.007824684178908753, 0.007492711192756858, 0.007378004309594736, 0.007218746150214281, 0.008015687521504812, 0.007567386264513599, 0.007302794372400931, 0.00702764359476779, -9.992969129655771, 0.007472206232402789, 0.007227209744997702, 0.007144198541447422, 0.006638503117547359, 0.006630130447236696, 0.007552412392009583, -9.992909028958458, -19.99312424967753, 0.0065022056621172, -9.993889793422849, 0.007046904134440284, 0.006843103261696361, 0.0066974271800272385, 0.006480579573842297, 0.006024379191505007, 0.007175529512852502, 0.0067328558253024464, -9.993465507509343, 0.006247814758892093, 0.0062228267727180596, 0.006796689141081218, -9.993332661129529, 0.006873348989303213, 0.006536147701920467, 0.006553581040198948, -19.99305786952207, 0.006761941640305354, 0.006857852593101278, 0.006879581361583002, 0.006680534035264927, 0.007154102253930689, 0.006625447191620894, 0.0066755821798157805, -9.993898051015782, 0.006556363233555252, 0.006699437937224336, 0.00661452446461256, 0.006487739548642419, 0.00625416326530471, 0.0062006501445175, 0.006649648429931525, 0.006693365134633259, 0.006876145462344841, 0.006744459747252835, 0.006642874350125568], "episode_lengths": [27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.1707888870215, "mean_inference_ms": 2.139272444655882, "mean_action_processing_ms": 0.14657526714919894, "mean_env_wait_ms": 1.0753633926160253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01066136360168457, "StateBufferConnector_ms": 0.0065042972564697266, "ViewRequirementAgentConnector_ms": 0.17843031883239746}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 175500, "num_env_steps_sampled": 91000, "num_env_steps_trained": 175500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5651076424929617, "num_env_steps_trained_throughput_per_sec": 6.951959902861275, "timesteps_total": 91000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 91000, "timers": {"training_iteration_time_ms": 11304.187, "sample_time_ms": 11238.517, "load_time_ms": 0.238, "load_throughput": 327712.824, "learn_time_ms": 13.355, "learn_throughput": 5840.554, "synch_weights_time_ms": 11.779}, "counters": {"num_env_steps_sampled": 91000, "num_env_steps_trained": 175500, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 175500, "last_target_update_ts": 91000, "num_target_updates": 174}, "done": false, "episodes_total": 3565, "training_iteration": 91, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-23-27", "timestamp": 1713428607, "time_this_iter_s": 280.50533056259155, "time_total_s": 22358.531572580338, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 22358.531572580338, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 11.276691729323309, "ram_util_percent": 27.336090225563915}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01938016712665558, "cur_lr": 0.01}, "td_error": [1.1391451358795166, 1.138789176940918, 1.1390719413757324, 1.1387890577316284, 1.1387892961502075, 1.1387890577316284, 1.1387885808944702, 1.1387890577316284, 0.8103289604187012, 1.1387892961502075, 1.1387892961502075, 1.138789176940918, 1.1387892961502075, 1.1387889385223389, 1.138789415359497, 3.7723920345306396, 1.1387887001037598, 1.1387889385223389, 0.810329794883728, 1.1387890577316284, 1.1375459432601929, 1.1387890577316284, 1.1387887001037598, 1.1387890577316284, 1.138789176940918, 1.1387890577316284, 1.1387887001037598, 1.138789415359497, 1.1387890577316284, 1.1387885808944702, 1.1387887001037598, 1.1387890577316284, 1.1387889385223389, 1.1387890577316284, 1.1387887001037598, 1.1387889385223389, 1.1387892961502075, 1.1387892961502075, 1.138789176940918, 1.1375430822372437, 1.1387885808944702, 1.1392930746078491, 1.1374818086624146, 0.8082878589630127, 1.137540340423584, 1.1387892961502075, 1.1387885808944702, 1.1375595331192017, 1.1387887001037598, 1.1387887001037598, 1.1375555992126465, 1.1391240358352661, 1.1387890577316284, 1.1387888193130493, 1.1390764713287354, 1.137351632118225, 1.145391583442688, 1.1387888193130493, 1.1387890577316284, 1.1390975713729858, 1.1387887001037598, 1.1375151872634888, 1.1375256776809692, 1.1390777826309204, 1.1387889385223389, 1.138789176940918, 1.139081358909607, 1.1387890577316284, 1.137549877166748, 1.1387890577316284, 1.138789176940918, 1.138789176940918, 1.1387892961502075, 1.5343177318572998, 1.1391533613204956, 1.1387892961502075, 1.1375380754470825, 1.1387890577316284], "mean_td_error": 1.1649090051651, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2275.0, "diff_num_grad_updates_vs_sampler_policy": 2274.0}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 177450, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 177450, "last_target_update_ts": 91520, "num_target_updates": 175}, "sampler_results": {"episode_reward_max": 0.008015687521504812, "episode_reward_min": -19.99312424967753, "episode_reward_mean": -1.59339104095256, "episode_len_mean": 25.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.007728619367999364, 0.007681975618026435, 0.007322510989324374, 0.00727604661742439, 0.0069200185616942475, 0.007901299941287326, 0.007824684178908753, 0.007492711192756858, 0.007378004309594736, 0.007218746150214281, 0.008015687521504812, 0.007567386264513599, 0.007302794372400931, 0.00702764359476779, -9.992969129655771, 0.007472206232402789, 0.007227209744997702, 0.007144198541447422, 0.006638503117547359, 0.006630130447236696, 0.007552412392009583, -9.992909028958458, -19.99312424967753, 0.0065022056621172, -9.993889793422849, 0.007046904134440284, 0.006843103261696361, 0.0066974271800272385, 0.006480579573842297, 0.006024379191505007, 0.007175529512852502, 0.0067328558253024464, -9.993465507509343, 0.006247814758892093, 0.0062228267727180596, 0.006796689141081218, -9.993332661129529, 0.006873348989303213, 0.006536147701920467, 0.006553581040198948, -19.99305786952207, 0.006761941640305354, 0.006857852593101278, 0.006879581361583002, 0.006680534035264927, 0.007154102253930689, 0.006625447191620894, 0.0066755821798157805, -9.993898051015782, 0.006556363233555252, 0.006699437937224336, 0.00661452446461256, 0.006487739548642419, 0.00625416326530471, 0.0062006501445175, 0.006649648429931525, 0.006693365134633259, 0.006876145462344841, 0.006744459747252835, 0.006642874350125568, 0.006364758976682611, 0.005999102603194648, 0.006682306901087819, 0.00655583602911379, 0.006547066062684404, -9.994342508618358, -9.994401159754668, 0.006415448678816384, 0.006385609879445533, 0.00630984416228803, 0.006142011171600433, 0.0062810281694618275, 0.005760633785937596, 0.006312140320615032, 0.006220828792478398, -9.994080793169172, 0.006313896844567362, 0.005776236058415463, -9.99383584701965, 0.005980660307944628, 0.00601354055074244, 0.0064070618600609915, 0.006354560664547673, 0.006280273720815886, 0.00615805838383148, 0.006236643391904354, 0.006317379891930586, 0.0063252452906704245, 0.00631388181253688, -9.993791283141233, 0.0058822800774600646, 0.006350651627681289, 0.006321050836267803, 0.006203051660845695, 0.006061889756731007, 0.005909027213959393, 0.006352797545211214, -9.993738414493874, 0.006114102372332113, 0.005972701554702828], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.2934543397605, "mean_inference_ms": 2.1387766294682886, "mean_action_processing_ms": 0.14654805476486416, "mean_env_wait_ms": 1.064885246044096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010770559310913086, "StateBufferConnector_ms": 0.006632804870605469, "ViewRequirementAgentConnector_ms": 0.1796092987060547}}, "episode_reward_max": 0.008015687521504812, "episode_reward_min": -19.99312424967753, "episode_reward_mean": -1.59339104095256, "episode_len_mean": 25.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.007728619367999364, 0.007681975618026435, 0.007322510989324374, 0.00727604661742439, 0.0069200185616942475, 0.007901299941287326, 0.007824684178908753, 0.007492711192756858, 0.007378004309594736, 0.007218746150214281, 0.008015687521504812, 0.007567386264513599, 0.007302794372400931, 0.00702764359476779, -9.992969129655771, 0.007472206232402789, 0.007227209744997702, 0.007144198541447422, 0.006638503117547359, 0.006630130447236696, 0.007552412392009583, -9.992909028958458, -19.99312424967753, 0.0065022056621172, -9.993889793422849, 0.007046904134440284, 0.006843103261696361, 0.0066974271800272385, 0.006480579573842297, 0.006024379191505007, 0.007175529512852502, 0.0067328558253024464, -9.993465507509343, 0.006247814758892093, 0.0062228267727180596, 0.006796689141081218, -9.993332661129529, 0.006873348989303213, 0.006536147701920467, 0.006553581040198948, -19.99305786952207, 0.006761941640305354, 0.006857852593101278, 0.006879581361583002, 0.006680534035264927, 0.007154102253930689, 0.006625447191620894, 0.0066755821798157805, -9.993898051015782, 0.006556363233555252, 0.006699437937224336, 0.00661452446461256, 0.006487739548642419, 0.00625416326530471, 0.0062006501445175, 0.006649648429931525, 0.006693365134633259, 0.006876145462344841, 0.006744459747252835, 0.006642874350125568, 0.006364758976682611, 0.005999102603194648, 0.006682306901087819, 0.00655583602911379, 0.006547066062684404, -9.994342508618358, -9.994401159754668, 0.006415448678816384, 0.006385609879445533, 0.00630984416228803, 0.006142011171600433, 0.0062810281694618275, 0.005760633785937596, 0.006312140320615032, 0.006220828792478398, -9.994080793169172, 0.006313896844567362, 0.005776236058415463, -9.99383584701965, 0.005980660307944628, 0.00601354055074244, 0.0064070618600609915, 0.006354560664547673, 0.006280273720815886, 0.00615805838383148, 0.006236643391904354, 0.006317379891930586, 0.0063252452906704245, 0.00631388181253688, -9.993791283141233, 0.0058822800774600646, 0.006350651627681289, 0.006321050836267803, 0.006203051660845695, 0.006061889756731007, 0.005909027213959393, 0.006352797545211214, -9.993738414493874, 0.006114102372332113, 0.005972701554702828], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 27, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.2934543397605, "mean_inference_ms": 2.1387766294682886, "mean_action_processing_ms": 0.14654805476486416, "mean_env_wait_ms": 1.064885246044096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010770559310913086, "StateBufferConnector_ms": 0.006632804870605469, "ViewRequirementAgentConnector_ms": 0.1796092987060547}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 177450, "num_env_steps_sampled": 92000, "num_env_steps_trained": 177450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.54690247593125, "num_env_steps_trained_throughput_per_sec": 6.916459828065937, "timesteps_total": 92000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 11243.514, "sample_time_ms": 11178.168, "load_time_ms": 0.239, "load_throughput": 326014.661, "learn_time_ms": 13.335, "learn_throughput": 5849.2, "synch_weights_time_ms": 12.258}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 177450, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 177450, "last_target_update_ts": 91520, "num_target_updates": 175}, "done": false, "episodes_total": 3605, "training_iteration": 92, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-28-09", "timestamp": 1713428889, "time_this_iter_s": 281.94612860679626, "time_total_s": 22640.477701187134, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 22640.477701187134, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 11.14788029925187, "ram_util_percent": 27.50473815461347}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01990429498255253, "cur_lr": 0.01}, "td_error": [1.108879804611206, 1.1088793277740479, 1.1088799238204956, 1.1088792085647583, 1.1088802814483643, 1.1088790893554688, 1.1088794469833374, 1.108344554901123, 0.803398847579956, 1.1088788509368896, 1.1070396900177002, 1.107038140296936, 1.1088777780532837, 1.1088802814483643, 1.1082855463027954, 1.1088788509368896, 1.1088800430297852, 1.1083790063858032, 1.108880639076233, 1.1083753108978271, 1.1088801622390747, 1.1088796854019165, 1.1088805198669434, 1.108879566192627, 0.803398847579956, 1.1070579290390015, 1.107071042060852, 1.1088792085647583, 1.1070688962936401, 1.1070351600646973, 1.1088804006576538, 1.1088801622390747, 1.1088796854019165, 1.108879566192627, 1.1088790893554688, 1.1088802814483643, 1.1070231199264526, 1.1070654392242432, 1.1083804368972778, 1.1083786487579346, 1.1088776588439941, 1.1088794469833374, 1.1066765785217285, 1.1088805198669434, 1.1088794469833374, 1.108879804611206, 1.1088800430297852, 1.1070635318756104, 0.8033993244171143, 1.1070678234100342, 1.1088786125183105, 1.1083751916885376, 1.108880639076233, 1.1088802814483643, 1.1088804006576538, 1.3925273418426514, 1.1083228588104248, 1.108239769935608, 1.108879804611206, 1.1088794469833374, 1.1083701848983765, 1.108879804611206, 1.107056736946106, 1.1088789701461792, 3.742164373397827, 1.1088796854019165, 4.03765344619751, 1.1088792085647583, 1.108878493309021, 1.1070584058761597, 1.1088796854019165, 1.1088790893554688, 1.107069492340088, 0.8033995032310486, 1.108879804611206, 1.1088800430297852, 1.108880639076233, 1.1088789701461792], "mean_td_error": 1.1677581071853638, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2300.0, "diff_num_grad_updates_vs_sampler_policy": 2299.0}}, "num_env_steps_sampled": 93000, "num_env_steps_trained": 179400, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 179400, "last_target_update_ts": 92560, "num_target_updates": 177}, "sampler_results": {"episode_reward_max": 1.8197667149965557, "episode_reward_min": -19.99461174689916, "episode_reward_mean": -1.2687030305299616, "episode_len_mean": 25.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.99305786952207, 0.006761941640305354, 0.006857852593101278, 0.006879581361583002, 0.006680534035264927, 0.007154102253930689, 0.006625447191620894, 0.0066755821798157805, -9.993898051015782, 0.006556363233555252, 0.006699437937224336, 0.00661452446461256, 0.006487739548642419, 0.00625416326530471, 0.0062006501445175, 0.006649648429931525, 0.006693365134633259, 0.006876145462344841, 0.006744459747252835, 0.006642874350125568, 0.006364758976682611, 0.005999102603194648, 0.006682306901087819, 0.00655583602911379, 0.006547066062684404, -9.994342508618358, -9.994401159754668, 0.006415448678816384, 0.006385609879445533, 0.00630984416228803, 0.006142011171600433, 0.0062810281694618275, 0.005760633785937596, 0.006312140320615032, 0.006220828792478398, -9.994080793169172, 0.006313896844567362, 0.005776236058415463, -9.99383584701965, 0.005980660307944628, 0.00601354055074244, 0.0064070618600609915, 0.006354560664547673, 0.006280273720815886, 0.00615805838383148, 0.006236643391904354, 0.006317379891930586, 0.0063252452906704245, 0.00631388181253688, -9.993791283141233, 0.0058822800774600646, 0.006350651627681289, 0.006321050836267803, 0.006203051660845695, 0.006061889756731007, 0.005909027213959393, 0.006352797545211214, -9.993738414493874, 0.006114102372332113, 0.005972701554702828, 0.006366614021466519, 0.0059332989433549975, 0.005707432703365875, 0.005696769367715634, 0.0060615665786583625, 1.8197667149965557, -9.994021662261993, 0.005913905945419414, 0.005872736596736084, 0.005588574739162636, 0.006046505079660871, 0.005719617926079658, 0.005871786470665524, 0.005849758293710396, 0.0055172186281372895, 0.005984289660091376, 0.0059943152015671155, 0.006040642044617511, 0.0058943796204434275, 0.0054470767198034, 0.006032965202879269, 0.006094474865341858, 0.006007177207935105, 0.005906138572006339, -9.994218221288229, 0.005856109381171505, 0.707007842109607, 0.005830613476711434, 0.005798746134174074, 0.005787385314442951, 0.005884551934879521, 0.0058071990237206885, 0.005657768016014897, 0.005787876342712923, 0.005454623009371064, 0.005992919292906742, 0.006110073647049743, 0.0059472292709596645, 0.0057815879186021, -19.99461174689916], "episode_lengths": [27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.42146822413656, "mean_inference_ms": 2.1387763014946852, "mean_action_processing_ms": 0.14654241057262596, "mean_env_wait_ms": 1.0546573024183785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009930133819580078, "StateBufferConnector_ms": 0.0066645145416259766, "ViewRequirementAgentConnector_ms": 0.18405699729919434}}, "episode_reward_max": 1.8197667149965557, "episode_reward_min": -19.99461174689916, "episode_reward_mean": -1.2687030305299616, "episode_len_mean": 25.08, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.99305786952207, 0.006761941640305354, 0.006857852593101278, 0.006879581361583002, 0.006680534035264927, 0.007154102253930689, 0.006625447191620894, 0.0066755821798157805, -9.993898051015782, 0.006556363233555252, 0.006699437937224336, 0.00661452446461256, 0.006487739548642419, 0.00625416326530471, 0.0062006501445175, 0.006649648429931525, 0.006693365134633259, 0.006876145462344841, 0.006744459747252835, 0.006642874350125568, 0.006364758976682611, 0.005999102603194648, 0.006682306901087819, 0.00655583602911379, 0.006547066062684404, -9.994342508618358, -9.994401159754668, 0.006415448678816384, 0.006385609879445533, 0.00630984416228803, 0.006142011171600433, 0.0062810281694618275, 0.005760633785937596, 0.006312140320615032, 0.006220828792478398, -9.994080793169172, 0.006313896844567362, 0.005776236058415463, -9.99383584701965, 0.005980660307944628, 0.00601354055074244, 0.0064070618600609915, 0.006354560664547673, 0.006280273720815886, 0.00615805838383148, 0.006236643391904354, 0.006317379891930586, 0.0063252452906704245, 0.00631388181253688, -9.993791283141233, 0.0058822800774600646, 0.006350651627681289, 0.006321050836267803, 0.006203051660845695, 0.006061889756731007, 0.005909027213959393, 0.006352797545211214, -9.993738414493874, 0.006114102372332113, 0.005972701554702828, 0.006366614021466519, 0.0059332989433549975, 0.005707432703365875, 0.005696769367715634, 0.0060615665786583625, 1.8197667149965557, -9.994021662261993, 0.005913905945419414, 0.005872736596736084, 0.005588574739162636, 0.006046505079660871, 0.005719617926079658, 0.005871786470665524, 0.005849758293710396, 0.0055172186281372895, 0.005984289660091376, 0.0059943152015671155, 0.006040642044617511, 0.0058943796204434275, 0.0054470767198034, 0.006032965202879269, 0.006094474865341858, 0.006007177207935105, 0.005906138572006339, -9.994218221288229, 0.005856109381171505, 0.707007842109607, 0.005830613476711434, 0.005798746134174074, 0.005787385314442951, 0.005884551934879521, 0.0058071990237206885, 0.005657768016014897, 0.005787876342712923, 0.005454623009371064, 0.005992919292906742, 0.006110073647049743, 0.0059472292709596645, 0.0057815879186021, -19.99461174689916], "episode_lengths": [27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.42146822413656, "mean_inference_ms": 2.1387763014946852, "mean_action_processing_ms": 0.14654241057262596, "mean_env_wait_ms": 1.0546573024183785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009930133819580078, "StateBufferConnector_ms": 0.0066645145416259766, "ViewRequirementAgentConnector_ms": 0.18405699729919434}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 179400, "num_env_steps_sampled": 93000, "num_env_steps_trained": 179400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.698995043807315, "num_env_steps_trained_throughput_per_sec": 7.213040335424265, "timesteps_total": 93000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 93000, "timers": {"training_iteration_time_ms": 10213.02, "sample_time_ms": 10147.227, "load_time_ms": 0.243, "load_throughput": 321434.184, "learn_time_ms": 13.492, "learn_throughput": 5781.066, "synch_weights_time_ms": 12.81}, "counters": {"num_env_steps_sampled": 93000, "num_env_steps_trained": 179400, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 179400, "last_target_update_ts": 92560, "num_target_updates": 177}, "done": false, "episodes_total": 3645, "training_iteration": 93, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-32-40", "timestamp": 1713429160, "time_this_iter_s": 270.3538336753845, "time_total_s": 22910.83153486252, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 22910.83153486252, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 11.528645833333334, "ram_util_percent": 27.664322916666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02937820367515087, "cur_lr": 0.01}, "td_error": [1.1200056076049805, 1.12209153175354, 0.8062747120857239, 1.3966091871261597, 1.1220910549163818, 1.1220897436141968, 1.1200486421585083, 1.122091293334961, 1.12208890914917, 1.1204628944396973, 1.1200155019760132, 1.120461344718933, 1.1220892667770386, 1.1220895051956177, 1.122090220451355, 1.122090458869934, 1.1204639673233032, 1.122091293334961, 1.1220914125442505, 1.1220903396606445, 1.1220911741256714, 1.1200250387191772, 1.1220897436141968, 1.1220916509628296, 1.1204655170440674, 1.1210566759109497, 1.1220914125442505, 3.651827096939087, 1.1220914125442505, 1.1220903396606445, 1.1220898628234863, 1.1344692707061768, 1.12209153175354, 1.1212807893753052, 1.1204636096954346, 1.122090458869934, 1.1200450658798218, 1.12209153175354, 1.1220914125442505, 1.1220905780792236, 1.12208890914917, 1.120031714439392, 1.1220908164978027, 1.120427131652832, 1.122090458869934, 1.12209153175354, 1.1200454235076904, 1.1220914125442505, 1.1220905780792236, 1.120402216911316, 1.120044469833374, 1.1204135417938232, 1.1199657917022705, 0.8062736988067627, 1.12209153175354, 1.1220909357070923, 1.122090458869934, 1.1220901012420654, 1.1199870109558105, 1.122090458869934, 1.1220897436141968, 1.1213905811309814, 1.1220893859863281, 0.8062736392021179, 1.1220916509628296, 0.8062755465507507, 1.1220906972885132, 1.1200324296951294, 1.1220906972885132, 0.878658652305603, 1.1204655170440674, 1.120347023010254, 1.122091293334961, 1.1220914125442505, 0.7964702248573303, 1.1220908164978027, 1.119951605796814, 0.7902694344520569], "mean_td_error": 1.1298922300338745, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2325.0, "diff_num_grad_updates_vs_sampler_policy": 2324.0}}, "num_env_steps_sampled": 94000, "num_env_steps_trained": 181350, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 181350, "last_target_update_ts": 93600, "num_target_updates": 179}, "sampler_results": {"episode_reward_max": 8.772362909162196, "episode_reward_min": -26.671468025019095, "episode_reward_mean": -1.4482529474666008, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00601354055074244, 0.0064070618600609915, 0.006354560664547673, 0.006280273720815886, 0.00615805838383148, 0.006236643391904354, 0.006317379891930586, 0.0063252452906704245, 0.00631388181253688, -9.993791283141233, 0.0058822800774600646, 0.006350651627681289, 0.006321050836267803, 0.006203051660845695, 0.006061889756731007, 0.005909027213959393, 0.006352797545211214, -9.993738414493874, 0.006114102372332113, 0.005972701554702828, 0.006366614021466519, 0.0059332989433549975, 0.005707432703365875, 0.005696769367715634, 0.0060615665786583625, 1.8197667149965557, -9.994021662261993, 0.005913905945419414, 0.005872736596736084, 0.005588574739162636, 0.006046505079660871, 0.005719617926079658, 0.005871786470665524, 0.005849758293710396, 0.0055172186281372895, 0.005984289660091376, 0.0059943152015671155, 0.006040642044617511, 0.0058943796204434275, 0.0054470767198034, 0.006032965202879269, 0.006094474865341858, 0.006007177207935105, 0.005906138572006339, -9.994218221288229, 0.005856109381171505, 0.707007842109607, 0.005830613476711434, 0.005798746134174074, 0.005787385314442951, 0.005884551934879521, 0.0058071990237206885, 0.005657768016014897, 0.005787876342712923, 0.005454623009371064, 0.005992919292906742, 0.006110073647049743, 0.0059472292709596645, 0.0057815879186021, -19.99461174689916, 0.005758533743298467, 0.005786447476670564, 0.005635412230595333, 0.0055233066130802025, 0.005192928978024059, 0.005631975693890295, 0.005253687852169182, 0.0054267880343424725, -9.995140565099776, 0.005142360764974441, -9.994405168462988, -9.994513389517872, 0.005417174726433098, 0.005099978495451887, 0.005240713476117235, 0.005469411679620692, 8.772362909162196, 0.005350675356773088, 0.00490316328840395, 0.00502590065186981, 0.005160943185822032, 0.005489133550789474, -19.994694430824467, -26.671468025019095, 0.00489584755028607, 0.005388296100330388, -9.994558332691348, 0.005310644769031147, 0.0051734852681564235, -9.995150144668044, 0.0055880415350665884, 0.005439147892062192, 0.005383523501133135, 0.004668923707669273, 0.00521002345565531, 0.0053648902639092996, 0.005053113468582822, 0.005241716260887939, 0.004870691576659522, 0.0049641649281007335], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 24, 25, 27, 28, 24, 24, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.53830473157, "mean_inference_ms": 2.1388132897430374, "mean_action_processing_ms": 0.14654141134179663, "mean_env_wait_ms": 1.0446487464957754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010031461715698242, "StateBufferConnector_ms": 0.0067632198333740234, "ViewRequirementAgentConnector_ms": 0.18451499938964844}}, "episode_reward_max": 8.772362909162196, "episode_reward_min": -26.671468025019095, "episode_reward_mean": -1.4482529474666008, "episode_len_mean": 25.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00601354055074244, 0.0064070618600609915, 0.006354560664547673, 0.006280273720815886, 0.00615805838383148, 0.006236643391904354, 0.006317379891930586, 0.0063252452906704245, 0.00631388181253688, -9.993791283141233, 0.0058822800774600646, 0.006350651627681289, 0.006321050836267803, 0.006203051660845695, 0.006061889756731007, 0.005909027213959393, 0.006352797545211214, -9.993738414493874, 0.006114102372332113, 0.005972701554702828, 0.006366614021466519, 0.0059332989433549975, 0.005707432703365875, 0.005696769367715634, 0.0060615665786583625, 1.8197667149965557, -9.994021662261993, 0.005913905945419414, 0.005872736596736084, 0.005588574739162636, 0.006046505079660871, 0.005719617926079658, 0.005871786470665524, 0.005849758293710396, 0.0055172186281372895, 0.005984289660091376, 0.0059943152015671155, 0.006040642044617511, 0.0058943796204434275, 0.0054470767198034, 0.006032965202879269, 0.006094474865341858, 0.006007177207935105, 0.005906138572006339, -9.994218221288229, 0.005856109381171505, 0.707007842109607, 0.005830613476711434, 0.005798746134174074, 0.005787385314442951, 0.005884551934879521, 0.0058071990237206885, 0.005657768016014897, 0.005787876342712923, 0.005454623009371064, 0.005992919292906742, 0.006110073647049743, 0.0059472292709596645, 0.0057815879186021, -19.99461174689916, 0.005758533743298467, 0.005786447476670564, 0.005635412230595333, 0.0055233066130802025, 0.005192928978024059, 0.005631975693890295, 0.005253687852169182, 0.0054267880343424725, -9.995140565099776, 0.005142360764974441, -9.994405168462988, -9.994513389517872, 0.005417174726433098, 0.005099978495451887, 0.005240713476117235, 0.005469411679620692, 8.772362909162196, 0.005350675356773088, 0.00490316328840395, 0.00502590065186981, 0.005160943185822032, 0.005489133550789474, -19.994694430824467, -26.671468025019095, 0.00489584755028607, 0.005388296100330388, -9.994558332691348, 0.005310644769031147, 0.0051734852681564235, -9.995150144668044, 0.0055880415350665884, 0.005439147892062192, 0.005383523501133135, 0.004668923707669273, 0.00521002345565531, 0.0053648902639092996, 0.005053113468582822, 0.005241716260887939, 0.004870691576659522, 0.0049641649281007335], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 24, 25, 27, 28, 24, 24, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.53830473157, "mean_inference_ms": 2.1388132897430374, "mean_action_processing_ms": 0.14654141134179663, "mean_env_wait_ms": 1.0446487464957754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010031461715698242, "StateBufferConnector_ms": 0.0067632198333740234, "ViewRequirementAgentConnector_ms": 0.18451499938964844}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 181350, "num_env_steps_sampled": 94000, "num_env_steps_trained": 181350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.051715567890923, "num_env_steps_trained_throughput_per_sec": 7.9008453573873005, "timesteps_total": 94000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 94000, "timers": {"training_iteration_time_ms": 8896.2, "sample_time_ms": 8830.019, "load_time_ms": 0.25, "load_throughput": 311725.309, "learn_time_ms": 13.309, "learn_throughput": 5860.653, "synch_weights_time_ms": 12.398}, "counters": {"num_env_steps_sampled": 94000, "num_env_steps_trained": 181350, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 181350, "last_target_update_ts": 93600, "num_target_updates": 179}, "done": false, "episodes_total": 3685, "training_iteration": 94, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-36-46", "timestamp": 1713429406, "time_this_iter_s": 246.81845951080322, "time_total_s": 23157.64999437332, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 23157.64999437332, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 12.304829545454545, "ram_util_percent": 27.82528409090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.025492196902632713, "cur_lr": 0.01}, "td_error": [1.0898069143295288, 1.0906864404678345, 1.0906867980957031, 1.0906872749328613, 1.088524580001831, 1.0906869173049927, 0.7943987250328064, 1.090686321258545, 1.090686321258545, 1.089842438697815, 1.0898106098175049, 1.090686321258545, 1.090686321258545, 1.1388137340545654, 1.4004887342453003, 1.090686559677124, 1.0906867980957031, 1.090686559677124, 1.088501214981079, 1.0885158777236938, 1.0885250568389893, 1.0898257493972778, 0.7897623777389526, 1.0906866788864136, 1.0898091793060303, 1.0906864404678345, 1.0908195972442627, 0.7897584438323975, 1.0885053873062134, 1.0898032188415527, 1.090686321258545, 1.090686559677124, 0.797186017036438, 1.0906864404678345, 1.089821696281433, 1.0906864404678345, 1.0885241031646729, 1.090686321258545, 1.0906867980957031, 1.0898109674453735, 1.0906870365142822, 0.7971861362457275, 1.0884358882904053, 1.0906864404678345, 1.0906864404678345, 1.0906864404678345, 1.0898128747940063, 1.0906867980957031, 1.0906870365142822, 1.0906872749328613, 0.7971858978271484, 1.090686321258545, 1.0885237455368042, 0.797186017036438, 1.0884883403778076, 1.088517189025879, 1.0906867980957031, 1.0885231494903564, 1.0898054838180542, 1.0898830890655518, 1.0898126363754272, 1.088523507118225, 1.0885237455368042, 1.0906864404678345, 1.0906870365142822, 1.091603398323059, 0.8315607905387878, 1.0906864404678345, 1.090686321258545, 1.0906867980957031, 1.0885170698165894, 1.090686321258545, 1.0906867980957031, 2.6157846450805664, 0.7971858978271484, 1.090686559677124, 1.0885213613510132, 1.090686321258545], "mean_td_error": 1.0806388854980469, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2350.0, "diff_num_grad_updates_vs_sampler_policy": 2349.0}}, "num_env_steps_sampled": 95000, "num_env_steps_trained": 183300, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 183300, "last_target_update_ts": 94640, "num_target_updates": 181}, "sampler_results": {"episode_reward_max": 8.772362909162196, "episode_reward_min": -26.671468025019095, "episode_reward_mean": -1.9507198689561323, "episode_len_mean": 24.92, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006032965202879269, 0.006094474865341858, 0.006007177207935105, 0.005906138572006339, -9.994218221288229, 0.005856109381171505, 0.707007842109607, 0.005830613476711434, 0.005798746134174074, 0.005787385314442951, 0.005884551934879521, 0.0058071990237206885, 0.005657768016014897, 0.005787876342712923, 0.005454623009371064, 0.005992919292906742, 0.006110073647049743, 0.0059472292709596645, 0.0057815879186021, -19.99461174689916, 0.005758533743298467, 0.005786447476670564, 0.005635412230595333, 0.0055233066130802025, 0.005192928978024059, 0.005631975693890295, 0.005253687852169182, 0.0054267880343424725, -9.995140565099776, 0.005142360764974441, -9.994405168462988, -9.994513389517872, 0.005417174726433098, 0.005099978495451887, 0.005240713476117235, 0.005469411679620692, 8.772362909162196, 0.005350675356773088, 0.00490316328840395, 0.00502590065186981, 0.005160943185822032, 0.005489133550789474, -19.994694430824467, -26.671468025019095, 0.00489584755028607, 0.005388296100330388, -9.994558332691348, 0.005310644769031147, 0.0051734852681564235, -9.995150144668044, 0.0055880415350665884, 0.005439147892062192, 0.005383523501133135, 0.004668923707669273, 0.00521002345565531, 0.0053648902639092996, 0.005053113468582822, 0.005241716260887939, 0.004870691576659522, 0.0049641649281007335, 0.005328388348700846, 0.0050394552251442236, 0.005418613340070388, 0.005391598462303997, 0.0051627447169020025, 0.005027995820348484, 0.005225930918595154, 0.005461542656455129, -9.994854185751015, -9.99442661878754, -9.995007844193955, 0.005298471967998005, 0.00537089877445727, 0.004939502243514499, 0.005243641004393578, 0.005027265500359477, 0.005218491926783012, 0.005307089616011125, 0.005268613302865554, 0.26076980514982206, 0.005030774284542136, 0.00507454485877841, 0.005509448413709727, 0.005686667699345126, 0.005019603543483396, 0.0050582161096372055, 1.349867094734112, 0.005124234332664444, 0.005606071677413733, 0.004817528554146958, -9.995073325628, 0.005265685376862859, 0.005242487659528225, 0.004874922785244798, -19.99496376503006, -9.995180425529561, 0.005332755918700992, 0.005250681927891023, 0.005501578341087386, -9.994652287372542], "episode_lengths": [25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 24, 25, 27, 28, 24, 24, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 24, 25, 25, 24, 24, 25, 25, 25, 26, 25, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 25, 24, 27, 25, 25, 25, 24, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.6388025290705, "mean_inference_ms": 2.1384005059119096, "mean_action_processing_ms": 0.14651226898739683, "mean_env_wait_ms": 1.034802356014815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01041865348815918, "StateBufferConnector_ms": 0.006612539291381836, "ViewRequirementAgentConnector_ms": 0.18091368675231934}}, "episode_reward_max": 8.772362909162196, "episode_reward_min": -26.671468025019095, "episode_reward_mean": -1.9507198689561323, "episode_len_mean": 24.92, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.006032965202879269, 0.006094474865341858, 0.006007177207935105, 0.005906138572006339, -9.994218221288229, 0.005856109381171505, 0.707007842109607, 0.005830613476711434, 0.005798746134174074, 0.005787385314442951, 0.005884551934879521, 0.0058071990237206885, 0.005657768016014897, 0.005787876342712923, 0.005454623009371064, 0.005992919292906742, 0.006110073647049743, 0.0059472292709596645, 0.0057815879186021, -19.99461174689916, 0.005758533743298467, 0.005786447476670564, 0.005635412230595333, 0.0055233066130802025, 0.005192928978024059, 0.005631975693890295, 0.005253687852169182, 0.0054267880343424725, -9.995140565099776, 0.005142360764974441, -9.994405168462988, -9.994513389517872, 0.005417174726433098, 0.005099978495451887, 0.005240713476117235, 0.005469411679620692, 8.772362909162196, 0.005350675356773088, 0.00490316328840395, 0.00502590065186981, 0.005160943185822032, 0.005489133550789474, -19.994694430824467, -26.671468025019095, 0.00489584755028607, 0.005388296100330388, -9.994558332691348, 0.005310644769031147, 0.0051734852681564235, -9.995150144668044, 0.0055880415350665884, 0.005439147892062192, 0.005383523501133135, 0.004668923707669273, 0.00521002345565531, 0.0053648902639092996, 0.005053113468582822, 0.005241716260887939, 0.004870691576659522, 0.0049641649281007335, 0.005328388348700846, 0.0050394552251442236, 0.005418613340070388, 0.005391598462303997, 0.0051627447169020025, 0.005027995820348484, 0.005225930918595154, 0.005461542656455129, -9.994854185751015, -9.99442661878754, -9.995007844193955, 0.005298471967998005, 0.00537089877445727, 0.004939502243514499, 0.005243641004393578, 0.005027265500359477, 0.005218491926783012, 0.005307089616011125, 0.005268613302865554, 0.26076980514982206, 0.005030774284542136, 0.00507454485877841, 0.005509448413709727, 0.005686667699345126, 0.005019603543483396, 0.0050582161096372055, 1.349867094734112, 0.005124234332664444, 0.005606071677413733, 0.004817528554146958, -9.995073325628, 0.005265685376862859, 0.005242487659528225, 0.004874922785244798, -19.99496376503006, -9.995180425529561, 0.005332755918700992, 0.005250681927891023, 0.005501578341087386, -9.994652287372542], "episode_lengths": [25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 24, 25, 27, 28, 24, 24, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 24, 25, 25, 24, 24, 25, 25, 25, 26, 25, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 25, 24, 27, 25, 25, 25, 24, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.6388025290705, "mean_inference_ms": 2.1384005059119096, "mean_action_processing_ms": 0.14651226898739683, "mean_env_wait_ms": 1.034802356014815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01041865348815918, "StateBufferConnector_ms": 0.006612539291381836, "ViewRequirementAgentConnector_ms": 0.18091368675231934}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 183300, "num_env_steps_sampled": 95000, "num_env_steps_trained": 183300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.23280189620867, "num_env_steps_trained_throughput_per_sec": 8.253963697606906, "timesteps_total": 95000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 95000, "timers": {"training_iteration_time_ms": 10027.974, "sample_time_ms": 9964.729, "load_time_ms": 0.228, "load_throughput": 342643.184, "learn_time_ms": 12.807, "learn_throughput": 6090.187, "synch_weights_time_ms": 11.549}, "counters": {"num_env_steps_sampled": 95000, "num_env_steps_trained": 183300, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 183300, "last_target_update_ts": 94640, "num_target_updates": 181}, "done": false, "episodes_total": 3725, "training_iteration": 95, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-40-43", "timestamp": 1713429643, "time_this_iter_s": 236.26079058647156, "time_total_s": 23393.910784959793, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 23393.910784959793, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 13.002380952380953, "ram_util_percent": 28.006845238095234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.016743499785661697, "cur_lr": 0.01}, "td_error": [4.742579936981201, 1.099765419960022, 1.099765419960022, 1.096350908279419, 1.0994564294815063, 1.099765419960022, 0.8063143491744995, 1.0997653007507324, 3.524595260620117, 1.0997653007507324, 1.0997653007507324, 1.2948557138442993, 1.0997653007507324, 1.0997655391693115, 1.099765419960022, 1.099765419960022, 1.099765419960022, 1.0997653007507324, 1.0997653007507324, 1.099765419960022, 1.0963364839553833, 1.0964030027389526, 1.099472999572754, 1.0997653007507324, 1.096333622932434, 1.0994670391082764, 0.8063129186630249, 1.0997653007507324, 1.099765419960022, 1.099765419960022, 1.0997653007507324, 1.0991426706314087, 1.0994499921798706, 1.0997653007507324, 1.099765419960022, 0.806312084197998, 1.0997653007507324, 1.0963330268859863, 1.099765419960022, 1.099765419960022, 1.0997653007507324, 1.0997653007507324, 0.8280768990516663, 1.0997653007507324, 1.0997653007507324, 0.7965202331542969, 1.0997653007507324, 1.099765419960022, 0.8070037364959717, 1.0997653007507324, 0.9703999757766724, 1.0963612794876099, 1.0994731187820435, 1.0997655391693115, 1.099765419960022, 0.8280863165855408, 1.099472165107727, 1.099765419960022, 1.0963337421417236, 1.0997653007507324, 1.096331238746643, 1.099765419960022, 0.8063130378723145, 1.0997653007507324, 1.0994672775268555, 1.0994712114334106, 1.0994696617126465, 1.0963318347930908, 1.0997653007507324, 1.0963313579559326, 1.099765419960022, 1.099765419960022, 1.0994713306427002, 1.0994629859924316, 1.0997653007507324, 1.09633207321167, 1.099765419960022, 1.0994764566421509], "mean_td_error": 1.1482056379318237, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2375.0, "diff_num_grad_updates_vs_sampler_policy": 2374.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 185250, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 185250, "last_target_update_ts": 95680, "num_target_updates": 183}, "sampler_results": {"episode_reward_max": 1.349867094734112, "episode_reward_min": -26.671468025019095, "episode_reward_mean": -2.2456732207821672, "episode_len_mean": 25.01, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005160943185822032, 0.005489133550789474, -19.994694430824467, -26.671468025019095, 0.00489584755028607, 0.005388296100330388, -9.994558332691348, 0.005310644769031147, 0.0051734852681564235, -9.995150144668044, 0.0055880415350665884, 0.005439147892062192, 0.005383523501133135, 0.004668923707669273, 0.00521002345565531, 0.0053648902639092996, 0.005053113468582822, 0.005241716260887939, 0.004870691576659522, 0.0049641649281007335, 0.005328388348700846, 0.0050394552251442236, 0.005418613340070388, 0.005391598462303997, 0.0051627447169020025, 0.005027995820348484, 0.005225930918595154, 0.005461542656455129, -9.994854185751015, -9.99442661878754, -9.995007844193955, 0.005298471967998005, 0.00537089877445727, 0.004939502243514499, 0.005243641004393578, 0.005027265500359477, 0.005218491926783012, 0.005307089616011125, 0.005268613302865554, 0.26076980514982206, 0.005030774284542136, 0.00507454485877841, 0.005509448413709727, 0.005686667699345126, 0.005019603543483396, 0.0050582161096372055, 1.349867094734112, 0.005124234332664444, 0.005606071677413733, 0.004817528554146958, -9.995073325628, 0.005265685376862859, 0.005242487659528225, 0.004874922785244798, -19.99496376503006, -9.995180425529561, 0.005332755918700992, 0.005250681927891023, 0.005501578341087386, -9.994652287372542, 0.0050708498087059534, 0.004486538746387835, 0.0034132177629997208, 0.004792408934555387, -9.995248006369033, 0.005182113239546829, 0.004659206202042186, 0.005215729815542563, -9.994965902108662, 0.005139580430605783, 0.004919646604033647, 0.004411379837473607, 0.005136115993316227, 0.004686828450852374, 0.0050243320556142435, 0.005328556503777438, 0.005448765800777459, -9.995387838207662, -9.994806049879955, 0.005292037496847634, 0.005103994050761389, 0.005356527703711922, -9.99568665977941, 0.005005276094647181, 0.004991016430050539, 0.005380543411238184, 0.005404324727725094, 0.004679636910159245, -9.995281867402042, 0.005122056120065368, 0.005000806055952928, 0.003917595245878282, -9.995325840560495, 0.004830699420578837, -9.99502475060404, 0.004897420651065531, 0.005532412672897519, 0.004707900819386518, 0.005077201350924226, 0.005254570636035082], "episode_lengths": [24, 25, 27, 28, 24, 24, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 24, 25, 25, 24, 24, 25, 25, 25, 26, 25, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 25, 24, 27, 25, 25, 25, 24, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.7384238913427, "mean_inference_ms": 2.1376938465361333, "mean_action_processing_ms": 0.1464649646110049, "mean_env_wait_ms": 1.0251354576923941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010495424270629883, "StateBufferConnector_ms": 0.0066225528717041016, "ViewRequirementAgentConnector_ms": 0.17815828323364258}}, "episode_reward_max": 1.349867094734112, "episode_reward_min": -26.671468025019095, "episode_reward_mean": -2.2456732207821672, "episode_len_mean": 25.01, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.005160943185822032, 0.005489133550789474, -19.994694430824467, -26.671468025019095, 0.00489584755028607, 0.005388296100330388, -9.994558332691348, 0.005310644769031147, 0.0051734852681564235, -9.995150144668044, 0.0055880415350665884, 0.005439147892062192, 0.005383523501133135, 0.004668923707669273, 0.00521002345565531, 0.0053648902639092996, 0.005053113468582822, 0.005241716260887939, 0.004870691576659522, 0.0049641649281007335, 0.005328388348700846, 0.0050394552251442236, 0.005418613340070388, 0.005391598462303997, 0.0051627447169020025, 0.005027995820348484, 0.005225930918595154, 0.005461542656455129, -9.994854185751015, -9.99442661878754, -9.995007844193955, 0.005298471967998005, 0.00537089877445727, 0.004939502243514499, 0.005243641004393578, 0.005027265500359477, 0.005218491926783012, 0.005307089616011125, 0.005268613302865554, 0.26076980514982206, 0.005030774284542136, 0.00507454485877841, 0.005509448413709727, 0.005686667699345126, 0.005019603543483396, 0.0050582161096372055, 1.349867094734112, 0.005124234332664444, 0.005606071677413733, 0.004817528554146958, -9.995073325628, 0.005265685376862859, 0.005242487659528225, 0.004874922785244798, -19.99496376503006, -9.995180425529561, 0.005332755918700992, 0.005250681927891023, 0.005501578341087386, -9.994652287372542, 0.0050708498087059534, 0.004486538746387835, 0.0034132177629997208, 0.004792408934555387, -9.995248006369033, 0.005182113239546829, 0.004659206202042186, 0.005215729815542563, -9.994965902108662, 0.005139580430605783, 0.004919646604033647, 0.004411379837473607, 0.005136115993316227, 0.004686828450852374, 0.0050243320556142435, 0.005328556503777438, 0.005448765800777459, -9.995387838207662, -9.994806049879955, 0.005292037496847634, 0.005103994050761389, 0.005356527703711922, -9.99568665977941, 0.005005276094647181, 0.004991016430050539, 0.005380543411238184, 0.005404324727725094, 0.004679636910159245, -9.995281867402042, 0.005122056120065368, 0.005000806055952928, 0.003917595245878282, -9.995325840560495, 0.004830699420578837, -9.99502475060404, 0.004897420651065531, 0.005532412672897519, 0.004707900819386518, 0.005077201350924226, 0.005254570636035082], "episode_lengths": [24, 25, 27, 28, 24, 24, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 24, 25, 25, 24, 24, 25, 25, 25, 26, 25, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 25, 24, 27, 25, 25, 25, 24, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.7384238913427, "mean_inference_ms": 2.1376938465361333, "mean_action_processing_ms": 0.1464649646110049, "mean_env_wait_ms": 1.0251354576923941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010495424270629883, "StateBufferConnector_ms": 0.0066225528717041016, "ViewRequirementAgentConnector_ms": 0.17815828323364258}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 185250, "num_env_steps_sampled": 96000, "num_env_steps_trained": 185250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.70425179759128, "num_env_steps_trained_throughput_per_sec": 7.223291005302996, "timesteps_total": 96000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 10195.746, "sample_time_ms": 10133.555, "load_time_ms": 0.244, "load_throughput": 319737.795, "learn_time_ms": 12.925, "learn_throughput": 6035.003, "synch_weights_time_ms": 10.978}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 185250, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 185250, "last_target_update_ts": 95680, "num_target_updates": 183}, "done": false, "episodes_total": 3765, "training_iteration": 96, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-45-13", "timestamp": 1713429913, "time_this_iter_s": 269.97037053108215, "time_total_s": 23663.881155490875, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 23663.881155490875, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 11.466927083333331, "ram_util_percent": 28.18177083333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02491832710802555, "cur_lr": 0.01}, "td_error": [1.102970838546753, 1.1020628213882446, 1.1029709577560425, 1.102970838546753, 1.1029702425003052, 4.644314765930176, 1.102970838546753, 1.1029695272445679, 1.1029698848724365, 1.102969765663147, 1.1029702425003052, 1.1029714345932007, 1.1029698848724365, 1.102969765663147, 1.102971076965332, 1.1029706001281738, 1.1020866632461548, 1.102969765663147, 1.1030044555664062, 0.7973416447639465, 1.1029695272445679, 1.1030102968215942, 1.1029703617095947, 1.1029707193374634, 1.102970838546753, 1.1032840013504028, 1.1008633375167847, 1.1029698848724365, 0.7973417043685913, 1.102969765663147, 1.102969765663147, 1.1029703617095947, 0.7973417043685913, 1.1029701232910156, 1.1029702425003052, 1.102969765663147, 1.1020807027816772, 1.1020852327346802, 1.1029711961746216, 0.5666437149047852, 1.102969765663147, 1.1020456552505493, 1.1029696464538574, 0.7973417043685913, 1.101004719734192, 1.102969765663147, 1.1029703617095947, 1.1029706001281738, 1.1029698848724365, 0.7918341755867004, 0.7984656095504761, 3.614903450012207, 1.102969765663147, 1.1029703617095947, 1.100861668586731, 0.7973417043685913, 1.1029702425003052, 3.614903450012207, 1.1008700132369995, 1.1020830869674683, 1.102969765663147, 0.7920053601264954, 1.1029696464538574, 1.1008636951446533, 1.1020841598510742, 1.1029703617095947, 1.1008602380752563, 1.100858449935913, 1.1008621454238892, 1.1029703617095947, 1.1029702425003052, 1.1029711961746216, 1.1008700132369995, 1.1020863056182861, 1.1029706001281738, 1.1917853355407715, 1.1029711961746216, 1.1029715538024902], "mean_td_error": 1.1752442121505737, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2400.0, "diff_num_grad_updates_vs_sampler_policy": 2399.0}}, "num_env_steps_sampled": 97000, "num_env_steps_trained": 187200, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 187200, "last_target_update_ts": 96720, "num_target_updates": 185}, "sampler_results": {"episode_reward_max": 1.349867094734112, "episode_reward_min": -19.99496376503006, "episode_reward_mean": -1.7815732235131836, "episode_len_mean": 25.1, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005030774284542136, 0.00507454485877841, 0.005509448413709727, 0.005686667699345126, 0.005019603543483396, 0.0050582161096372055, 1.349867094734112, 0.005124234332664444, 0.005606071677413733, 0.004817528554146958, -9.995073325628, 0.005265685376862859, 0.005242487659528225, 0.004874922785244798, -19.99496376503006, -9.995180425529561, 0.005332755918700992, 0.005250681927891023, 0.005501578341087386, -9.994652287372542, 0.0050708498087059534, 0.004486538746387835, 0.0034132177629997208, 0.004792408934555387, -9.995248006369033, 0.005182113239546829, 0.004659206202042186, 0.005215729815542563, -9.994965902108662, 0.005139580430605783, 0.004919646604033647, 0.004411379837473607, 0.005136115993316227, 0.004686828450852374, 0.0050243320556142435, 0.005328556503777438, 0.005448765800777459, -9.995387838207662, -9.994806049879955, 0.005292037496847634, 0.005103994050761389, 0.005356527703711922, -9.99568665977941, 0.005005276094647181, 0.004991016430050539, 0.005380543411238184, 0.005404324727725094, 0.004679636910159245, -9.995281867402042, 0.005122056120065368, 0.005000806055952928, 0.003917595245878282, -9.995325840560495, 0.004830699420578837, -9.99502475060404, 0.004897420651065531, 0.005532412672897519, 0.004707900819386518, 0.005077201350924226, 0.005254570636035082, 0.004915913456897822, 0.005050825728204418, 0.0048050299689684365, 0.004946266583027319, 0.004787897738329175, 0.005113504903157218, -9.994930155217531, 0.005010829543194142, 0.004997974341226963, 0.004879705963723501, 0.0049764308942084985, 0.004926692171472842, 0.004886991773026492, 0.004575084950556793, 0.004702472277608283, 0.005130772327848395, 0.0050546113731595455, 0.005072589332040645, 0.005077392072917172, 0.004740564762182262, 0.004862338034968228, -9.994962700977263, -9.994840316116571, 0.005160086949626555, 0.005128060133738796, 0.004978122546585015, 0.005028604536726375, 0.004947109820215274, -9.995104904923274, 0.004823175119437864, 0.004740266956197835, 0.004933975762373371, 0.004760234948862311, 0.004677244999048692, 0.004742869634975974, 0.005115570160646166, 0.005117849311607935, 0.005013950895173284, 0.004970857358139804, -9.995271009143645], "episode_lengths": [25, 24, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 25, 24, 27, 25, 25, 25, 24, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.84118982476036, "mean_inference_ms": 2.1369613641527945, "mean_action_processing_ms": 0.14641305437207727, "mean_env_wait_ms": 1.0156759036334875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010315179824829102, "StateBufferConnector_ms": 0.0066204071044921875, "ViewRequirementAgentConnector_ms": 0.17694640159606934}}, "episode_reward_max": 1.349867094734112, "episode_reward_min": -19.99496376503006, "episode_reward_mean": -1.7815732235131836, "episode_len_mean": 25.1, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.005030774284542136, 0.00507454485877841, 0.005509448413709727, 0.005686667699345126, 0.005019603543483396, 0.0050582161096372055, 1.349867094734112, 0.005124234332664444, 0.005606071677413733, 0.004817528554146958, -9.995073325628, 0.005265685376862859, 0.005242487659528225, 0.004874922785244798, -19.99496376503006, -9.995180425529561, 0.005332755918700992, 0.005250681927891023, 0.005501578341087386, -9.994652287372542, 0.0050708498087059534, 0.004486538746387835, 0.0034132177629997208, 0.004792408934555387, -9.995248006369033, 0.005182113239546829, 0.004659206202042186, 0.005215729815542563, -9.994965902108662, 0.005139580430605783, 0.004919646604033647, 0.004411379837473607, 0.005136115993316227, 0.004686828450852374, 0.0050243320556142435, 0.005328556503777438, 0.005448765800777459, -9.995387838207662, -9.994806049879955, 0.005292037496847634, 0.005103994050761389, 0.005356527703711922, -9.99568665977941, 0.005005276094647181, 0.004991016430050539, 0.005380543411238184, 0.005404324727725094, 0.004679636910159245, -9.995281867402042, 0.005122056120065368, 0.005000806055952928, 0.003917595245878282, -9.995325840560495, 0.004830699420578837, -9.99502475060404, 0.004897420651065531, 0.005532412672897519, 0.004707900819386518, 0.005077201350924226, 0.005254570636035082, 0.004915913456897822, 0.005050825728204418, 0.0048050299689684365, 0.004946266583027319, 0.004787897738329175, 0.005113504903157218, -9.994930155217531, 0.005010829543194142, 0.004997974341226963, 0.004879705963723501, 0.0049764308942084985, 0.004926692171472842, 0.004886991773026492, 0.004575084950556793, 0.004702472277608283, 0.005130772327848395, 0.0050546113731595455, 0.005072589332040645, 0.005077392072917172, 0.004740564762182262, 0.004862338034968228, -9.994962700977263, -9.994840316116571, 0.005160086949626555, 0.005128060133738796, 0.004978122546585015, 0.005028604536726375, 0.004947109820215274, -9.995104904923274, 0.004823175119437864, 0.004740266956197835, 0.004933975762373371, 0.004760234948862311, 0.004677244999048692, 0.004742869634975974, 0.005115570160646166, 0.005117849311607935, 0.005013950895173284, 0.004970857358139804, -9.995271009143645], "episode_lengths": [25, 24, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 25, 24, 27, 25, 25, 25, 24, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.84118982476036, "mean_inference_ms": 2.1369613641527945, "mean_action_processing_ms": 0.14641305437207727, "mean_env_wait_ms": 1.0156759036334875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010315179824829102, "StateBufferConnector_ms": 0.0066204071044921875, "ViewRequirementAgentConnector_ms": 0.17694640159606934}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 187200, "num_env_steps_sampled": 97000, "num_env_steps_trained": 187200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.451702564084407, "num_env_steps_trained_throughput_per_sec": 8.680819999964593, "timesteps_total": 97000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 97000, "timers": {"training_iteration_time_ms": 9003.672, "sample_time_ms": 8941.375, "load_time_ms": 0.242, "load_throughput": 322766.093, "learn_time_ms": 12.716, "learn_throughput": 6134.139, "synch_weights_time_ms": 11.336}, "counters": {"num_env_steps_sampled": 97000, "num_env_steps_trained": 187200, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 187200, "last_target_update_ts": 96720, "num_target_updates": 185}, "done": false, "episodes_total": 3805, "training_iteration": 97, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-48-57", "timestamp": 1713430137, "time_this_iter_s": 224.64211058616638, "time_total_s": 23888.52326607704, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 23888.52326607704, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 13.3053125, "ram_util_percent": 28.345625000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.038422953337430954, "cur_lr": 0.01}, "td_error": [1.109420895576477, 1.1094205379486084, 1.1094200611114502, 1.1094210147857666, 1.107254981994629, 1.1072454452514648, 1.1428741216659546, 1.1094202995300293, 1.107753038406372, 1.106973648071289, 1.1094199419021606, 1.2421318292617798, 1.1094210147857666, 3.5346076488494873, 1.1072484254837036, 1.1083130836486816, 1.1072514057159424, 1.1094201803207397, 1.1094189882278442, 1.1083143949508667, 1.1083046197891235, 1.1083018779754639, 1.1094199419021606, 0.8018054366111755, 1.1082781553268433, 2.9574785232543945, 0.8078904151916504, 1.1445200443267822, 1.1094210147857666, 0.8078893423080444, 0.8078899383544922, 1.108325481414795, 1.107252597808838, 1.1072534322738647, 1.109420657157898, 1.1082899570465088, 1.1094201803207397, 1.1083248853683472, 1.1069574356079102, 1.1094210147857666, 1.1094210147857666, 1.1080660820007324, 1.1094202995300293, 1.1071598529815674, 1.2438358068466187, 1.1094207763671875, 1.109419345855713, 1.1072465181350708, 1.1094207763671875, 1.109420657157898, 1.107122778892517, 1.1094210147857666, 1.1094191074371338, 1.1094204187393188, 1.1083204746246338, 0.8078900575637817, 1.1094202995300293, 1.1072354316711426, 1.1094200611114502, 1.1094201803207397, 1.1083016395568848, 1.1094201803207397, 1.1094200611114502, 0.7941693067550659, 1.1094202995300293, 1.1072516441345215, 1.1072425842285156, 0.8018442988395691, 0.8613994121551514, 2.7296032905578613, 0.8016798496246338, 1.1071829795837402, 1.1094200611114502, 1.1094199419021606, 1.107251524925232, 1.1083011627197266, 1.109420657157898, 0.8078875541687012], "mean_td_error": 1.1502457857131958, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2425.0, "diff_num_grad_updates_vs_sampler_policy": 2424.0}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 189150, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 189150, "last_target_update_ts": 97760, "num_target_updates": 187}, "sampler_results": {"episode_reward_max": 2.926544265299423, "episode_reward_min": -9.99568665977941, "episode_reward_mean": -1.3304915872211138, "episode_len_mean": 24.98, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005103994050761389, 0.005356527703711922, -9.99568665977941, 0.005005276094647181, 0.004991016430050539, 0.005380543411238184, 0.005404324727725094, 0.004679636910159245, -9.995281867402042, 0.005122056120065368, 0.005000806055952928, 0.003917595245878282, -9.995325840560495, 0.004830699420578837, -9.99502475060404, 0.004897420651065531, 0.005532412672897519, 0.004707900819386518, 0.005077201350924226, 0.005254570636035082, 0.004915913456897822, 0.005050825728204418, 0.0048050299689684365, 0.004946266583027319, 0.004787897738329175, 0.005113504903157218, -9.994930155217531, 0.005010829543194142, 0.004997974341226963, 0.004879705963723501, 0.0049764308942084985, 0.004926692171472842, 0.004886991773026492, 0.004575084950556793, 0.004702472277608283, 0.005130772327848395, 0.0050546113731595455, 0.005072589332040645, 0.005077392072917172, 0.004740564762182262, 0.004862338034968228, -9.994962700977263, -9.994840316116571, 0.005160086949626555, 0.005128060133738796, 0.004978122546585015, 0.005028604536726375, 0.004947109820215274, -9.995104904923274, 0.004823175119437864, 0.004740266956197835, 0.004933975762373371, 0.004760234948862311, 0.004677244999048692, 0.004742869634975974, 0.005115570160646166, 0.005117849311607935, 0.005013950895173284, 0.004970857358139804, -9.995271009143645, 0.004739581307047595, 0.7286342512560184, 0.004701002341762153, 0.0044456682282029356, 0.004188207498608546, -9.995563153174547, 0.004793326843185741, 0.004694934901932422, 0.0045775859768948865, 0.0044623765528064895, 0.0043730244514962316, 0.004715914137948891, 0.004534003825540513, 0.00438997985819691, 2.926544265299423, 0.004445109527673601, 0.004794751970852194, 0.004775068162315752, 0.004698285362684447, 0.004577005052100538, 0.004962720831076175, 2.82900704112123, 0.0049344273032505695, 0.004961425819402357, 0.004859934739529213, -9.995253070548383, -9.995667091296863, 0.004638052484541071, -9.995486238483783, 0.004430125902441962, 0.004369547431721278, 0.004667600427753845, 0.004390878334594138, 0.004300325433886394, 0.004198486070391598, -9.995546868770445, 0.004839235195777593, 0.004843727413009937, 0.0047438110672165705, 0.004640373125262312], "episode_lengths": [25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 26, 24, 25, 26, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.93369258918347, "mean_inference_ms": 2.1360402826136253, "mean_action_processing_ms": 0.14634879967297704, "mean_env_wait_ms": 1.0064075663092502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009837627410888672, "StateBufferConnector_ms": 0.006348609924316406, "ViewRequirementAgentConnector_ms": 0.1741650104522705}}, "episode_reward_max": 2.926544265299423, "episode_reward_min": -9.99568665977941, "episode_reward_mean": -1.3304915872211138, "episode_len_mean": 24.98, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.005103994050761389, 0.005356527703711922, -9.99568665977941, 0.005005276094647181, 0.004991016430050539, 0.005380543411238184, 0.005404324727725094, 0.004679636910159245, -9.995281867402042, 0.005122056120065368, 0.005000806055952928, 0.003917595245878282, -9.995325840560495, 0.004830699420578837, -9.99502475060404, 0.004897420651065531, 0.005532412672897519, 0.004707900819386518, 0.005077201350924226, 0.005254570636035082, 0.004915913456897822, 0.005050825728204418, 0.0048050299689684365, 0.004946266583027319, 0.004787897738329175, 0.005113504903157218, -9.994930155217531, 0.005010829543194142, 0.004997974341226963, 0.004879705963723501, 0.0049764308942084985, 0.004926692171472842, 0.004886991773026492, 0.004575084950556793, 0.004702472277608283, 0.005130772327848395, 0.0050546113731595455, 0.005072589332040645, 0.005077392072917172, 0.004740564762182262, 0.004862338034968228, -9.994962700977263, -9.994840316116571, 0.005160086949626555, 0.005128060133738796, 0.004978122546585015, 0.005028604536726375, 0.004947109820215274, -9.995104904923274, 0.004823175119437864, 0.004740266956197835, 0.004933975762373371, 0.004760234948862311, 0.004677244999048692, 0.004742869634975974, 0.005115570160646166, 0.005117849311607935, 0.005013950895173284, 0.004970857358139804, -9.995271009143645, 0.004739581307047595, 0.7286342512560184, 0.004701002341762153, 0.0044456682282029356, 0.004188207498608546, -9.995563153174547, 0.004793326843185741, 0.004694934901932422, 0.0045775859768948865, 0.0044623765528064895, 0.0043730244514962316, 0.004715914137948891, 0.004534003825540513, 0.00438997985819691, 2.926544265299423, 0.004445109527673601, 0.004794751970852194, 0.004775068162315752, 0.004698285362684447, 0.004577005052100538, 0.004962720831076175, 2.82900704112123, 0.0049344273032505695, 0.004961425819402357, 0.004859934739529213, -9.995253070548383, -9.995667091296863, 0.004638052484541071, -9.995486238483783, 0.004430125902441962, 0.004369547431721278, 0.004667600427753845, 0.004390878334594138, 0.004300325433886394, 0.004198486070391598, -9.995546868770445, 0.004839235195777593, 0.004843727413009937, 0.0047438110672165705, 0.004640373125262312], "episode_lengths": [25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 26, 24, 25, 26, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 434.93369258918347, "mean_inference_ms": 2.1360402826136253, "mean_action_processing_ms": 0.14634879967297704, "mean_env_wait_ms": 1.0064075663092502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009837627410888672, "StateBufferConnector_ms": 0.006348609924316406, "ViewRequirementAgentConnector_ms": 0.1741650104522705}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 189150, "num_env_steps_sampled": 98000, "num_env_steps_trained": 189150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7310988130055476, "num_env_steps_trained_throughput_per_sec": 7.275642685360817, "timesteps_total": 98000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 11213.681, "sample_time_ms": 11150.907, "load_time_ms": 0.246, "load_throughput": 317226.522, "learn_time_ms": 13.286, "learn_throughput": 5870.981, "synch_weights_time_ms": 11.073}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 189150, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 189150, "last_target_update_ts": 97760, "num_target_updates": 187}, "done": false, "episodes_total": 3845, "training_iteration": 98, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-53-25", "timestamp": 1713430405, "time_this_iter_s": 268.02542901039124, "time_total_s": 24156.548695087433, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 24156.548695087433, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 11.350131233595802, "ram_util_percent": 28.5251968503937}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.030314672738313675, "cur_lr": 0.01}, "td_error": [1.079292893409729, 0.8051559925079346, 1.0792930126190186, 1.079293131828308, 1.080428123474121, 1.0792933702468872, 1.0916228294372559, 1.0792930126190186, 1.079293131828308, 1.0792932510375977, 1.0792927742004395, 1.079343318939209, 1.0768516063690186, 1.0792927742004395, 1.0792933702468872, 1.0804332494735718, 1.0792932510375977, 1.079292893409729, 1.0792930126190186, 1.07929265499115, 1.079293131828308, 1.079293131828308, 1.1197563409805298, 0.8046393394470215, 1.079292893409729, 1.0792930126190186, 1.0804044008255005, 1.0768290758132935, 1.0768508911132812, 1.079293131828308, 1.079293131828308, 1.0768516063690186, 1.079293131828308, 0.8052023649215698, 1.0792932510375977, 1.080418348312378, 1.0792930126190186, 1.0768572092056274, 1.0792927742004395, 1.0768277645111084, 1.08042573928833, 1.0792930126190186, 0.798296332359314, 1.0767276287078857, 1.0792932510375977, 1.0766528844833374, 0.789376974105835, 1.0802080631256104, 1.0768624544143677, 1.080280065536499, 1.0792933702468872, 0.7982966899871826, 1.0960571765899658, 1.0792932510375977, 0.7982964515686035, 1.0804234743118286, 1.0804336071014404, 1.0792932510375977, 1.0792932510375977, 0.7891573905944824, 1.0803492069244385, 1.0792930126190186, 1.08041512966156, 1.0792932510375977, 1.0792930126190186, 1.0792932510375977, 1.0792930126190186, 1.0767983198165894, 1.0792930126190186, 1.076856255531311, 1.0792932510375977, 1.0792932510375977, 1.0804252624511719, 1.079293131828308, 1.079293131828308, 1.0767837762832642, 1.0792927742004395, 1.0792927742004395], "mean_td_error": 1.051178216934204, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2450.0, "diff_num_grad_updates_vs_sampler_policy": 2449.0}}, "num_env_steps_sampled": 99000, "num_env_steps_trained": 191100, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 191100, "last_target_update_ts": 98800, "num_target_updates": 189}, "sampler_results": {"episode_reward_max": 2.926544265299423, "episode_reward_min": -9.995667091296863, "episode_reward_mean": -1.0306725653071442, "episode_len_mean": 24.95, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.004862338034968228, -9.994962700977263, -9.994840316116571, 0.005160086949626555, 0.005128060133738796, 0.004978122546585015, 0.005028604536726375, 0.004947109820215274, -9.995104904923274, 0.004823175119437864, 0.004740266956197835, 0.004933975762373371, 0.004760234948862311, 0.004677244999048692, 0.004742869634975974, 0.005115570160646166, 0.005117849311607935, 0.005013950895173284, 0.004970857358139804, -9.995271009143645, 0.004739581307047595, 0.7286342512560184, 0.004701002341762153, 0.0044456682282029356, 0.004188207498608546, -9.995563153174547, 0.004793326843185741, 0.004694934901932422, 0.0045775859768948865, 0.0044623765528064895, 0.0043730244514962316, 0.004715914137948891, 0.004534003825540513, 0.00438997985819691, 2.926544265299423, 0.004445109527673601, 0.004794751970852194, 0.004775068162315752, 0.004698285362684447, 0.004577005052100538, 0.004962720831076175, 2.82900704112123, 0.0049344273032505695, 0.004961425819402357, 0.004859934739529213, -9.995253070548383, -9.995667091296863, 0.004638052484541071, -9.995486238483783, 0.004430125902441962, 0.004369547431721278, 0.004667600427753845, 0.004390878334594138, 0.004300325433886394, 0.004198486070391598, -9.995546868770445, 0.004839235195777593, 0.004843727413009937, 0.0047438110672165705, 0.004640373125262312, 0.004378286747966541, 0.0044306643778279815, 0.0042227781373138625, 0.004610953513057504, 0.004894045865875663, 0.004330350062217951, 0.004419874797721829, 0.004534839869222754, 0.004327597872588744, 0.004614341381981498, 0.004143604764109151, 0.0043624169217087675, 0.004437699455763217, 0.004398186029547966, 0.004556409577588745, -9.995484059726898, 0.004489401870619275, 0.004538794429715549, 0.004526972449227488, 0.0046334967052820706, 0.004745046244382124, 0.004466806045658517, 0.004661051016706066, 0.004672878486099621, 0.004638778128363247, 0.0044099140854375225, 0.004390046908671529, 0.004422031954712525, 0.0045096801081181605, -9.99562392933521, 0.004227430088405248, 0.004357736534195082, 0.004166814342549658, 0.004710537546617346, 0.004816950615789429, 0.004603835595294503, 0.004537703133106307, 0.004550260944292375, 0.004346202974140086, 0.004590019776492246], "episode_lengths": [25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 26, 24, 25, 26, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 435.0158351344611, "mean_inference_ms": 2.135315206773854, "mean_action_processing_ms": 0.14629998345567963, "mean_env_wait_ms": 0.9973444649068958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009810209274291992, "StateBufferConnector_ms": 0.006353616714477539, "ViewRequirementAgentConnector_ms": 0.17635202407836914}}, "episode_reward_max": 2.926544265299423, "episode_reward_min": -9.995667091296863, "episode_reward_mean": -1.0306725653071442, "episode_len_mean": 24.95, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.004862338034968228, -9.994962700977263, -9.994840316116571, 0.005160086949626555, 0.005128060133738796, 0.004978122546585015, 0.005028604536726375, 0.004947109820215274, -9.995104904923274, 0.004823175119437864, 0.004740266956197835, 0.004933975762373371, 0.004760234948862311, 0.004677244999048692, 0.004742869634975974, 0.005115570160646166, 0.005117849311607935, 0.005013950895173284, 0.004970857358139804, -9.995271009143645, 0.004739581307047595, 0.7286342512560184, 0.004701002341762153, 0.0044456682282029356, 0.004188207498608546, -9.995563153174547, 0.004793326843185741, 0.004694934901932422, 0.0045775859768948865, 0.0044623765528064895, 0.0043730244514962316, 0.004715914137948891, 0.004534003825540513, 0.00438997985819691, 2.926544265299423, 0.004445109527673601, 0.004794751970852194, 0.004775068162315752, 0.004698285362684447, 0.004577005052100538, 0.004962720831076175, 2.82900704112123, 0.0049344273032505695, 0.004961425819402357, 0.004859934739529213, -9.995253070548383, -9.995667091296863, 0.004638052484541071, -9.995486238483783, 0.004430125902441962, 0.004369547431721278, 0.004667600427753845, 0.004390878334594138, 0.004300325433886394, 0.004198486070391598, -9.995546868770445, 0.004839235195777593, 0.004843727413009937, 0.0047438110672165705, 0.004640373125262312, 0.004378286747966541, 0.0044306643778279815, 0.0042227781373138625, 0.004610953513057504, 0.004894045865875663, 0.004330350062217951, 0.004419874797721829, 0.004534839869222754, 0.004327597872588744, 0.004614341381981498, 0.004143604764109151, 0.0043624169217087675, 0.004437699455763217, 0.004398186029547966, 0.004556409577588745, -9.995484059726898, 0.004489401870619275, 0.004538794429715549, 0.004526972449227488, 0.0046334967052820706, 0.004745046244382124, 0.004466806045658517, 0.004661051016706066, 0.004672878486099621, 0.004638778128363247, 0.0044099140854375225, 0.004390046908671529, 0.004422031954712525, 0.0045096801081181605, -9.99562392933521, 0.004227430088405248, 0.004357736534195082, 0.004166814342549658, 0.004710537546617346, 0.004816950615789429, 0.004603835595294503, 0.004537703133106307, 0.004550260944292375, 0.004346202974140086, 0.004590019776492246], "episode_lengths": [25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 26, 24, 25, 26, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 435.0158351344611, "mean_inference_ms": 2.135315206773854, "mean_action_processing_ms": 0.14629998345567963, "mean_env_wait_ms": 0.9973444649068958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009810209274291992, "StateBufferConnector_ms": 0.006353616714477539, "ViewRequirementAgentConnector_ms": 0.17635202407836914}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 191100, "num_env_steps_sampled": 99000, "num_env_steps_trained": 191100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.57107343604842, "num_env_steps_trained_throughput_per_sec": 6.963593200294419, "timesteps_total": 99000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 99000, "timers": {"training_iteration_time_ms": 11174.18, "sample_time_ms": 11108.334, "load_time_ms": 0.237, "load_throughput": 329064.285, "learn_time_ms": 13.161, "learn_throughput": 5926.755, "synch_weights_time_ms": 13.006}, "counters": {"num_env_steps_sampled": 99000, "num_env_steps_trained": 191100, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 191100, "last_target_update_ts": 98800, "num_target_updates": 189}, "done": false, "episodes_total": 3885, "training_iteration": 99, "trial_id": "cbb9a_00000", "date": "2024-04-18_08-58-05", "timestamp": 1713430685, "time_this_iter_s": 280.03903317451477, "time_total_s": 24436.587728261948, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 24436.587728261948, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 10.873869346733667, "ram_util_percent": 28.680150753768846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.012143147177994251, "cur_lr": 0.01}, "td_error": [1.0888006687164307, 1.0903605222702026, 1.0903600454330444, 1.0903599262237549, 1.090360164642334, 1.0888081789016724, 1.0903600454330444, 1.090360403060913, 1.090360403060913, 1.0881648063659668, 1.0888018608093262, 1.090360164642334, 1.0903600454330444, 1.0874203443527222, 1.088810920715332, 1.090360164642334, 1.088191270828247, 0.7970201969146729, 1.090360403060913, 1.0903605222702026, 0.8034343719482422, 1.0903602838516235, 1.0903605222702026, 1.090360403060913, 1.0903605222702026, 1.0882070064544678, 1.0881096124649048, 1.0899139642715454, 1.0882198810577393, 1.0903605222702026, 1.088181734085083, 1.090360403060913, 1.090360164642334, 1.0882023572921753, 1.0903472900390625, 2.658224582672119, 1.0885319709777832, 1.090360164642334, 1.0900099277496338, 1.0888031721115112, 3.567211151123047, 1.090360403060913, 1.1286096572875977, 1.087969422340393, 1.0903605222702026, 1.0888078212738037, 0.7970163822174072, 1.0882163047790527, 1.0880897045135498, 1.090360164642334, 1.090360164642334, 1.0903599262237549, 0.8034343719482422, 1.090360164642334, 1.0903605222702026, 1.0903599262237549, 1.0881863832473755, 0.8034341931343079, 1.0888086557388306, 1.088218331336975, 1.0887892246246338, 1.0903605222702026, 1.0881998538970947, 1.0881836414337158, 1.0878537893295288, 0.8034346103668213, 1.0903602838516235, 1.090360164642334, 1.090360403060913, 0.8034346103668213, 1.0881226062774658, 1.0886913537979126, 0.7970296144485474, 1.0903600454330444, 1.0887928009033203, 0.7946814298629761, 1.090360403060913, 1.0882121324539185], "mean_td_error": 1.1084855794906616, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2475.0, "diff_num_grad_updates_vs_sampler_policy": 2474.0}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 193050, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 193050, "last_target_update_ts": 99840, "num_target_updates": 191}, "sampler_results": {"episode_reward_max": 2.82900704112123, "episode_reward_min": -9.995868500172588, "episode_reward_mean": -1.4471658091978166, "episode_len_mean": 25.07, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.004962720831076175, 2.82900704112123, 0.0049344273032505695, 0.004961425819402357, 0.004859934739529213, -9.995253070548383, -9.995667091296863, 0.004638052484541071, -9.995486238483783, 0.004430125902441962, 0.004369547431721278, 0.004667600427753845, 0.004390878334594138, 0.004300325433886394, 0.004198486070391598, -9.995546868770445, 0.004839235195777593, 0.004843727413009937, 0.0047438110672165705, 0.004640373125262312, 0.004378286747966541, 0.0044306643778279815, 0.0042227781373138625, 0.004610953513057504, 0.004894045865875663, 0.004330350062217951, 0.004419874797721829, 0.004534839869222754, 0.004327597872588744, 0.004614341381981498, 0.004143604764109151, 0.0043624169217087675, 0.004437699455763217, 0.004398186029547966, 0.004556409577588745, -9.995484059726898, 0.004489401870619275, 0.004538794429715549, 0.004526972449227488, 0.0046334967052820706, 0.004745046244382124, 0.004466806045658517, 0.004661051016706066, 0.004672878486099621, 0.004638778128363247, 0.0044099140854375225, 0.004390046908671529, 0.004422031954712525, 0.0045096801081181605, -9.99562392933521, 0.004227430088405248, 0.004357736534195082, 0.004166814342549658, 0.004710537546617346, 0.004816950615789429, 0.004603835595294503, 0.004537703133106307, 0.004550260944292375, 0.004346202974140086, 0.004590019776492246, 0.004815813360967981, 0.005028390725040335, 0.00470932568501791, 0.004303831800555725, 0.004204787705749683, 0.004756685660737963, 0.004711128293394194, 0.004389324208178538, 0.004301344198464867, 0.0040001341443881965, 1.349908702897313, 0.004636458729135719, 0.004427936570350853, 0.0037613958881004277, 0.003991512611093838, 0.0045905014827739895, -9.995401686100335, -9.995502855646135, 0.004143260148634625, -9.995794643187303, 0.004655445011969934, 0.004584527011043626, 0.004485548838209619, 0.00441407441449609, 0.004347445200497924, -9.99533822794474, -9.99537218876363, 0.004428865766164298, 0.6685927687226081, -9.995868500172588, 0.004716097912943904, 0.00468413527163124, -9.995504360461256, -9.99581215221051, 0.004137991589914252, 0.004579271770331993, 0.004479304431627815, -9.99560793089712, 0.004294889420001691, 0.0041398322327448], "episode_lengths": [25, 23, 25, 25, 25, 26, 24, 25, 26, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 435.10001584130293, "mean_inference_ms": 2.1347397120667386, "mean_action_processing_ms": 0.14625601170908106, "mean_env_wait_ms": 0.9884687734585867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009973526000976562, "StateBufferConnector_ms": 0.006351470947265625, "ViewRequirementAgentConnector_ms": 0.17755126953125}}, "episode_reward_max": 2.82900704112123, "episode_reward_min": -9.995868500172588, "episode_reward_mean": -1.4471658091978166, "episode_len_mean": 25.07, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.004962720831076175, 2.82900704112123, 0.0049344273032505695, 0.004961425819402357, 0.004859934739529213, -9.995253070548383, -9.995667091296863, 0.004638052484541071, -9.995486238483783, 0.004430125902441962, 0.004369547431721278, 0.004667600427753845, 0.004390878334594138, 0.004300325433886394, 0.004198486070391598, -9.995546868770445, 0.004839235195777593, 0.004843727413009937, 0.0047438110672165705, 0.004640373125262312, 0.004378286747966541, 0.0044306643778279815, 0.0042227781373138625, 0.004610953513057504, 0.004894045865875663, 0.004330350062217951, 0.004419874797721829, 0.004534839869222754, 0.004327597872588744, 0.004614341381981498, 0.004143604764109151, 0.0043624169217087675, 0.004437699455763217, 0.004398186029547966, 0.004556409577588745, -9.995484059726898, 0.004489401870619275, 0.004538794429715549, 0.004526972449227488, 0.0046334967052820706, 0.004745046244382124, 0.004466806045658517, 0.004661051016706066, 0.004672878486099621, 0.004638778128363247, 0.0044099140854375225, 0.004390046908671529, 0.004422031954712525, 0.0045096801081181605, -9.99562392933521, 0.004227430088405248, 0.004357736534195082, 0.004166814342549658, 0.004710537546617346, 0.004816950615789429, 0.004603835595294503, 0.004537703133106307, 0.004550260944292375, 0.004346202974140086, 0.004590019776492246, 0.004815813360967981, 0.005028390725040335, 0.00470932568501791, 0.004303831800555725, 0.004204787705749683, 0.004756685660737963, 0.004711128293394194, 0.004389324208178538, 0.004301344198464867, 0.0040001341443881965, 1.349908702897313, 0.004636458729135719, 0.004427936570350853, 0.0037613958881004277, 0.003991512611093838, 0.0045905014827739895, -9.995401686100335, -9.995502855646135, 0.004143260148634625, -9.995794643187303, 0.004655445011969934, 0.004584527011043626, 0.004485548838209619, 0.00441407441449609, 0.004347445200497924, -9.99533822794474, -9.99537218876363, 0.004428865766164298, 0.6685927687226081, -9.995868500172588, 0.004716097912943904, 0.00468413527163124, -9.995504360461256, -9.99581215221051, 0.004137991589914252, 0.004579271770331993, 0.004479304431627815, -9.99560793089712, 0.004294889420001691, 0.0041398322327448], "episode_lengths": [25, 23, 25, 25, 25, 26, 24, 25, 26, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 435.10001584130293, "mean_inference_ms": 2.1347397120667386, "mean_action_processing_ms": 0.14625601170908106, "mean_env_wait_ms": 0.9884687734585867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009973526000976562, "StateBufferConnector_ms": 0.006351470947265625, "ViewRequirementAgentConnector_ms": 0.17755126953125}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 193050, "num_env_steps_sampled": 100000, "num_env_steps_trained": 193050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.442989030217263, "num_env_steps_trained_throughput_per_sec": 8.663828608923664, "timesteps_total": 100000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 8963.051, "sample_time_ms": 8899.257, "load_time_ms": 0.234, "load_throughput": 333424.085, "learn_time_ms": 13.218, "learn_throughput": 5901.088, "synch_weights_time_ms": 11.836}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 193050, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 193050, "last_target_update_ts": 99840, "num_target_updates": 191}, "done": true, "episodes_total": 3925, "training_iteration": 100, "trial_id": "cbb9a_00000", "date": "2024-04-18_09-01-51", "timestamp": 1713430911, "time_this_iter_s": 225.08784675598145, "time_total_s": 24661.67557501793, "pid": 705849, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa17e3deb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 24661.67557501793, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 13.4796875, "ram_util_percent": 28.85}}
