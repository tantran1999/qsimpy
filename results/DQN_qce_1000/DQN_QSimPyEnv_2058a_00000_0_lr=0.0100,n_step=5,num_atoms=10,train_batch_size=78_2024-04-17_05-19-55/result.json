{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -88.29921905112035, "episode_reward_min": -268.5885363918793, "episode_reward_mean": -157.83805398320973, "episode_len_mean": 40.95652173913044, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158.75767733640197, -187.37500373340433, -139.00478578146024, -137.23382496776944, -117.75463362001476, -229.58068652317507, -216.9105465089066, -88.8070210527343, -148.80191606437594, -147.9974932951132, -88.29921905112035, -108.71837262167197, -116.16987721869376, -178.48924893306582, -189.1065584336889, -137.66717566411353, -157.8822624586567, -188.90667271992874, -147.7427981681481, -119.51240987127775, -88.71793439393454, -268.5885363918793, -268.2505868042884], "episode_lengths": [41, 44, 39, 39, 37, 48, 47, 34, 40, 40, 34, 36, 37, 43, 44, 39, 41, 44, 40, 37, 34, 52, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 247.44286242643656, "mean_inference_ms": 1.9734403525984976, "mean_action_processing_ms": 0.1394321706230843, "mean_env_wait_ms": 84.42194680660819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010852191759192425, "StateBufferConnector_ms": 0.005954244862432065, "ViewRequirementAgentConnector_ms": 0.15376547108525815}}, "episode_reward_max": -88.29921905112035, "episode_reward_min": -268.5885363918793, "episode_reward_mean": -157.83805398320973, "episode_len_mean": 40.95652173913044, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158.75767733640197, -187.37500373340433, -139.00478578146024, -137.23382496776944, -117.75463362001476, -229.58068652317507, -216.9105465089066, -88.8070210527343, -148.80191606437594, -147.9974932951132, -88.29921905112035, -108.71837262167197, -116.16987721869376, -178.48924893306582, -189.1065584336889, -137.66717566411353, -157.8822624586567, -188.90667271992874, -147.7427981681481, -119.51240987127775, -88.71793439393454, -268.5885363918793, -268.2505868042884], "episode_lengths": [41, 44, 39, 39, 37, 48, 47, 34, 40, 40, 34, 36, 37, 43, 44, 39, 41, 44, 40, 37, 34, 52, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 247.44286242643656, "mean_inference_ms": 1.9734403525984976, "mean_action_processing_ms": 0.1394321706230843, "mean_env_wait_ms": 84.42194680660819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010852191759192425, "StateBufferConnector_ms": 0.005954244862432065, "ViewRequirementAgentConnector_ms": 0.15376547108525815}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.717644237040459, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 6485.734, "sample_time_ms": 6480.733}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 23, "training_iteration": 1, "trial_id": "2058a_00000", "date": "2024-04-17_05-22-35", "timestamp": 1713331355, "time_this_iter_s": 129.57995128631592, "time_total_s": 129.57995128631592, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 129.57995128631592, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.804864864864864, "ram_util_percent": 12.882162162162166}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48128414154052734, "cur_lr": 0.01}, "td_error": [1.620363712310791, 1.6784335374832153, 1.9689431190490723, 1.620363712310791, 2.3045601844787598, 1.9874893426895142, 2.304560661315918, 2.37164568901062, 1.9680829048156738, 2.238311290740967, 2.2577717304229736, 2.257856845855713, 2.039921283721924, 1.6784335374832153, 1.620363712310791, 1.6515709161758423, 2.2355542182922363, 1.9874893426895142, 2.148298740386963, 1.6625205278396606, 2.304560661315918, 1.6812469959259033, 2.305675983428955, 2.376734972000122, 2.1613266468048096, 2.304558277130127, 2.221658229827881, 1.6784335374832153, 2.304997444152832, 1.9690192937850952, 1.9681819677352905, 1.6784335374832153, 2.304560661315918, 1.6784335374832153, 2.0143537521362305, 2.199876070022583, 2.149541139602661, 2.3041348457336426, 2.309218406677246, 1.620363712310791, 2.304560661315918, 2.257751941680908, 2.3051869869232178, 2.0200893878936768, 2.148298740386963, 2.148298740386963, 2.235759973526001, 2.148298740386963, 2.304558277130127, 1.6784335374832153, 2.3052754402160645, 2.3707242012023926, 1.9697109460830688, 2.15486741065979, 2.3041787147521973, 1.9907335042953491, 2.235555410385132, 2.305729866027832, 1.9874893426895142, 2.3055503368377686, 2.437134265899658, 2.2432594299316406, 2.2358357906341553, 1.620363712310791, 2.257746458053589, 1.9874893426895142, 1.9690192937850952, 1.6784335374832153, 1.620363712310791, 2.424316644668579, 2.2432782649993896, 1.6784335374832153, 2.30428147315979, 2.2213950157165527, 2.3043932914733887, 2.2359509468078613, 1.620363712310791, 2.151315689086914], "mean_td_error": 2.075029134750366, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 1950, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 1950, "last_target_update_ts": 1560, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": -21.535342395771757, "episode_reward_min": -268.5885363918793, "episode_reward_mean": -122.84755314598844, "episode_len_mean": 37.69387755102041, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158.75767733640197, -187.37500373340433, -139.00478578146024, -137.23382496776944, -117.75463362001476, -229.58068652317507, -216.9105465089066, -88.8070210527343, -148.80191606437594, -147.9974932951132, -88.29921905112035, -108.71837262167197, -116.16987721869376, -178.48924893306582, -189.1065584336889, -137.66717566411353, -157.8822624586567, -188.90667271992874, -147.7427981681481, -119.51240987127775, -88.71793439393454, -268.5885363918793, -268.2505868042884, -98.12398552081744, -76.53153665984452, -101.87550669092185, -58.17663560667182, -127.42843075606166, -84.1299784579527, -207.1827014646652, -39.58426068640575, -65.3245575600418, -126.84595262429488, -104.84943165176283, -79.37187044322455, -38.26425020644704, -49.18337642370978, -47.98837289590859, -79.36129198586887, -77.30018864606897, -40.60272069222075, -95.01961444547811, -207.53878792911058, -106.55715473769075, -133.54633202120775, -158.71408675755038, -118.87894424269572, -45.33955103721615, -21.535342395771757], "episode_lengths": [41, 44, 39, 39, 37, 48, 47, 34, 40, 40, 34, 36, 37, 43, 44, 39, 41, 44, 40, 37, 34, 52, 52, 35, 33, 36, 31, 38, 35, 46, 30, 33, 38, 36, 34, 29, 31, 30, 33, 33, 30, 36, 46, 36, 39, 41, 37, 30, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 254.85595621404994, "mean_inference_ms": 1.9998043918216626, "mean_action_processing_ms": 0.14077901043570537, "mean_env_wait_ms": 62.12619395823427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011179398517219387, "StateBufferConnector_ms": 0.0062139666810327645, "ViewRequirementAgentConnector_ms": 0.15854884167106784}}, "episode_reward_max": -21.535342395771757, "episode_reward_min": -268.5885363918793, "episode_reward_mean": -122.84755314598844, "episode_len_mean": 37.69387755102041, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158.75767733640197, -187.37500373340433, -139.00478578146024, -137.23382496776944, -117.75463362001476, -229.58068652317507, -216.9105465089066, -88.8070210527343, -148.80191606437594, -147.9974932951132, -88.29921905112035, -108.71837262167197, -116.16987721869376, -178.48924893306582, -189.1065584336889, -137.66717566411353, -157.8822624586567, -188.90667271992874, -147.7427981681481, -119.51240987127775, -88.71793439393454, -268.5885363918793, -268.2505868042884, -98.12398552081744, -76.53153665984452, -101.87550669092185, -58.17663560667182, -127.42843075606166, -84.1299784579527, -207.1827014646652, -39.58426068640575, -65.3245575600418, -126.84595262429488, -104.84943165176283, -79.37187044322455, -38.26425020644704, -49.18337642370978, -47.98837289590859, -79.36129198586887, -77.30018864606897, -40.60272069222075, -95.01961444547811, -207.53878792911058, -106.55715473769075, -133.54633202120775, -158.71408675755038, -118.87894424269572, -45.33955103721615, -21.535342395771757], "episode_lengths": [41, 44, 39, 39, 37, 48, 47, 34, 40, 40, 34, 36, 37, 43, 44, 39, 41, 44, 40, 37, 34, 52, 52, 35, 33, 36, 31, 38, 35, 46, 30, 33, 38, 36, 34, 29, 31, 30, 33, 33, 30, 36, 46, 36, 39, 41, 37, 30, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 254.85595621404994, "mean_inference_ms": 1.9998043918216626, "mean_action_processing_ms": 0.14077901043570537, "mean_env_wait_ms": 62.12619395823427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011179398517219387, "StateBufferConnector_ms": 0.0062139666810327645, "ViewRequirementAgentConnector_ms": 0.15854884167106784}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 1950, "num_env_steps_sampled": 2000, "num_env_steps_trained": 1950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.797902462080672, "num_env_steps_trained_throughput_per_sec": 11.30590980105731, "timesteps_total": 2000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 7498.09, "sample_time_ms": 7438.901, "load_time_ms": 0.23, "load_throughput": 339725.558, "learn_time_ms": 12.818, "learn_throughput": 6085.135, "synch_weights_time_ms": 12.302}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 1950, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 1950, "last_target_update_ts": 1560, "num_target_updates": 2}, "done": false, "episodes_total": 49, "training_iteration": 2, "trial_id": "2058a_00000", "date": "2024-04-17_05-25-27", "timestamp": 1713331527, "time_this_iter_s": 172.48478150367737, "time_total_s": 302.0647327899933, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 302.0647327899933, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.111836734693878, "ram_util_percent": 13.024489795918363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3232342600822449, "cur_lr": 0.01}, "td_error": [2.126124143600464, 2.3182408809661865, 2.3182895183563232, 1.1602375507354736, 1.724618911743164, 1.7216774225234985, 2.119612216949463, 2.172783136367798, 2.1207056045532227, 1.9986563920974731, 2.3101024627685547, 1.9410209655761719, 1.166398525238037, 1.166398525238037, 2.3107268810272217, 2.305554151535034, 2.468703269958496, 2.315847873687744, 2.3107352256774902, 1.1602375507354736, 2.095505714416504, 2.310539722442627, 1.166398525238037, 2.3099522590637207, 1.7340646982192993, 2.3192765712738037, 2.097378969192505, 2.3426501750946045, 1.9424045085906982, 2.0961201190948486, 2.306175470352173, 2.30629301071167, 2.305480718612671, 2.318321943283081, 1.7216774225234985, 2.307241439819336, 2.311176061630249, 1.7219130992889404, 1.7216774225234985, 2.3224616050720215, 1.166398525238037, 1.7326788902282715, 1.7232704162597656, 2.310201406478882, 2.0973637104034424, 1.1602375507354736, 2.12109112739563, 2.1207289695739746, 2.311110734939575, 2.3104312419891357, 1.166398525238037, 1.9989272356033325, 2.5932178497314453, 2.372004747390747, 2.310201406478882, 2.30564546585083, 2.318262815475464, 2.1218101978302, 1.7341117858886719, 1.7717719078063965, 2.3105173110961914, 2.3061280250549316, 1.74040687084198, 1.1602375507354736, 2.3061933517456055, 2.119377374649048, 1.7728338241577148, 2.3102810382843018, 2.1261305809020996, 2.1261134147644043, 1.1602375507354736, 1.1602375507354736, 1.1602375507354736, 2.32096004486084, 2.095733165740967, 1.7469271421432495, 2.1207289695739746, 1.171185851097107], "mean_td_error": 1.9737656116485596, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 3900, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 3900, "last_target_update_ts": 2600, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": -20.623711304062414, "episode_reward_min": -268.5885363918793, "episode_reward_mean": -110.3949927359396, "episode_len_mean": 36.37179487179487, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158.75767733640197, -187.37500373340433, -139.00478578146024, -137.23382496776944, -117.75463362001476, -229.58068652317507, -216.9105465089066, -88.8070210527343, -148.80191606437594, -147.9974932951132, -88.29921905112035, -108.71837262167197, -116.16987721869376, -178.48924893306582, -189.1065584336889, -137.66717566411353, -157.8822624586567, -188.90667271992874, -147.7427981681481, -119.51240987127775, -88.71793439393454, -268.5885363918793, -268.2505868042884, -98.12398552081744, -76.53153665984452, -101.87550669092185, -58.17663560667182, -127.42843075606166, -84.1299784579527, -207.1827014646652, -39.58426068640575, -65.3245575600418, -126.84595262429488, -104.84943165176283, -79.37187044322455, -38.26425020644704, -49.18337642370978, -47.98837289590859, -79.36129198586887, -77.30018864606897, -40.60272069222075, -95.01961444547811, -207.53878792911058, -106.55715473769075, -133.54633202120775, -158.71408675755038, -118.87894424269572, -45.33955103721615, -21.535342395771757, -78.85420091652963, -89.20434602698195, -48.466312767223585, -48.900688857103646, -29.251911164994734, -139.16046848337206, -146.90996216201168, -20.623711304062414, -99.56136516453738, -59.812364281754526, -78.14372347116415, -48.330049018472764, -88.90636888171693, -99.28208836936135, -66.43681408037283, -68.90372680748166, -109.42393036375022, -42.582272102526005, -159.85806672775152, -58.96963594337748, -99.18246758105477, -58.123656199910975, -48.03959231021773, -119.44894304550118, -219.83452101866294, -118.20218041188232, -169.22784207476826, -118.80454307135177, -58.833576641958665], "episode_lengths": [41, 44, 39, 39, 37, 48, 47, 34, 40, 40, 34, 36, 37, 43, 44, 39, 41, 44, 40, 37, 34, 52, 52, 35, 33, 36, 31, 38, 35, 46, 30, 33, 38, 36, 34, 29, 31, 30, 33, 33, 30, 36, 46, 36, 39, 41, 37, 30, 29, 33, 34, 30, 30, 28, 39, 40, 28, 35, 31, 33, 30, 34, 35, 32, 32, 36, 30, 42, 31, 35, 31, 30, 37, 47, 37, 42, 37, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 263.7805890309421, "mean_inference_ms": 2.013202222155822, "mean_action_processing_ms": 0.14136931334623776, "mean_env_wait_ms": 49.574631007148625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01082145250760592, "StateBufferConnector_ms": 0.006490181653927534, "ViewRequirementAgentConnector_ms": 0.16277050360655174}}, "episode_reward_max": -20.623711304062414, "episode_reward_min": -268.5885363918793, "episode_reward_mean": -110.3949927359396, "episode_len_mean": 36.37179487179487, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158.75767733640197, -187.37500373340433, -139.00478578146024, -137.23382496776944, -117.75463362001476, -229.58068652317507, -216.9105465089066, -88.8070210527343, -148.80191606437594, -147.9974932951132, -88.29921905112035, -108.71837262167197, -116.16987721869376, -178.48924893306582, -189.1065584336889, -137.66717566411353, -157.8822624586567, -188.90667271992874, -147.7427981681481, -119.51240987127775, -88.71793439393454, -268.5885363918793, -268.2505868042884, -98.12398552081744, -76.53153665984452, -101.87550669092185, -58.17663560667182, -127.42843075606166, -84.1299784579527, -207.1827014646652, -39.58426068640575, -65.3245575600418, -126.84595262429488, -104.84943165176283, -79.37187044322455, -38.26425020644704, -49.18337642370978, -47.98837289590859, -79.36129198586887, -77.30018864606897, -40.60272069222075, -95.01961444547811, -207.53878792911058, -106.55715473769075, -133.54633202120775, -158.71408675755038, -118.87894424269572, -45.33955103721615, -21.535342395771757, -78.85420091652963, -89.20434602698195, -48.466312767223585, -48.900688857103646, -29.251911164994734, -139.16046848337206, -146.90996216201168, -20.623711304062414, -99.56136516453738, -59.812364281754526, -78.14372347116415, -48.330049018472764, -88.90636888171693, -99.28208836936135, -66.43681408037283, -68.90372680748166, -109.42393036375022, -42.582272102526005, -159.85806672775152, -58.96963594337748, -99.18246758105477, -58.123656199910975, -48.03959231021773, -119.44894304550118, -219.83452101866294, -118.20218041188232, -169.22784207476826, -118.80454307135177, -58.833576641958665], "episode_lengths": [41, 44, 39, 39, 37, 48, 47, 34, 40, 40, 34, 36, 37, 43, 44, 39, 41, 44, 40, 37, 34, 52, 52, 35, 33, 36, 31, 38, 35, 46, 30, 33, 38, 36, 34, 29, 31, 30, 33, 33, 30, 36, 46, 36, 39, 41, 37, 30, 29, 33, 34, 30, 30, 28, 39, 40, 28, 35, 31, 33, 30, 34, 35, 32, 32, 36, 30, 42, 31, 35, 31, 30, 37, 47, 37, 42, 37, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 263.7805890309421, "mean_inference_ms": 2.013202222155822, "mean_action_processing_ms": 0.14136931334623776, "mean_env_wait_ms": 49.574631007148625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01082145250760592, "StateBufferConnector_ms": 0.006490181653927534, "ViewRequirementAgentConnector_ms": 0.16277050360655174}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 3900, "num_env_steps_sampled": 3000, "num_env_steps_trained": 3900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.405086664308619, "num_env_steps_trained_throughput_per_sec": 10.539918995401806, "timesteps_total": 3000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 6457.067, "sample_time_ms": 6398.727, "load_time_ms": 0.239, "load_throughput": 326535.295, "learn_time_ms": 12.799, "learn_throughput": 6094.396, "synch_weights_time_ms": 10.868}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 3900, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 3900, "last_target_update_ts": 2600, "num_target_updates": 4}, "done": false, "episodes_total": 78, "training_iteration": 3, "trial_id": "2058a_00000", "date": "2024-04-17_05-28-32", "timestamp": 1713331712, "time_this_iter_s": 185.01930141448975, "time_total_s": 487.08403420448303, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 487.08403420448303, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.537878787878787, "ram_util_percent": 13.104166666666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2618095576763153, "cur_lr": 0.01}, "td_error": [2.3058555126190186, 2.7088217735290527, 0.8668084740638733, 2.3060622215270996, 0.8668084740638733, 0.9093202352523804, 1.6298943758010864, 2.094836711883545, 2.306443452835083, 1.630508542060852, 2.3060312271118164, 2.306002616882324, 2.3057494163513184, 2.119276762008667, 2.3451874256134033, 2.7100913524627686, 2.3055906295776367, 1.6298943758010864, 2.123509407043457, 0.9093202352523804, 2.3349854946136475, 2.325406551361084, 2.094609022140503, 1.6298943758010864, 2.3417673110961914, 2.3061230182647705, 1.962449550628662, 1.6298943758010864, 1.6874440908432007, 1.650937795639038, 0.8668084740638733, 2.3413803577423096, 0.8668084740638733, 1.6298943758010864, 2.305762529373169, 2.4209446907043457, 2.1183555126190186, 1.6510440111160278, 2.1195566654205322, 2.636467456817627, 2.306450366973877, 2.0945868492126465, 1.9182990789413452, 2.09647798538208, 2.1215336322784424, 1.629996418952942, 0.8668084740638733, 2.3414382934570312, 0.8668084740638733, 1.962023377418518, 2.0947883129119873, 1.5974524021148682, 2.305983781814575, 1.9271819591522217, 0.9368512034416199, 2.1190578937530518, 2.110417604446411, 1.5967603921890259, 1.5930064916610718, 2.309171676635742, 2.3058533668518066, 2.344115734100342, 0.9216176867485046, 1.6511255502700806, 2.344115734100342, 1.7268855571746826, 1.9415770769119263, 2.0960373878479004, 0.8668084740638733, 2.341399669647217, 1.9177801609039307, 2.350196599960327, 1.9268912076950073, 2.3055694103240967, 2.3073742389678955, 1.9415770769119263, 1.6875081062316895, 2.7106895446777344], "mean_td_error": 1.9242150783538818, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 5850, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 5850, "last_target_update_ts": 3640, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": -11.609527620021483, "episode_reward_min": -268.5885363918793, "episode_reward_mean": -94.74298786896186, "episode_len_mean": 34.86, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.29921905112035, -108.71837262167197, -116.16987721869376, -178.48924893306582, -189.1065584336889, -137.66717566411353, -157.8822624586567, -188.90667271992874, -147.7427981681481, -119.51240987127775, -88.71793439393454, -268.5885363918793, -268.2505868042884, -98.12398552081744, -76.53153665984452, -101.87550669092185, -58.17663560667182, -127.42843075606166, -84.1299784579527, -207.1827014646652, -39.58426068640575, -65.3245575600418, -126.84595262429488, -104.84943165176283, -79.37187044322455, -38.26425020644704, -49.18337642370978, -47.98837289590859, -79.36129198586887, -77.30018864606897, -40.60272069222075, -95.01961444547811, -207.53878792911058, -106.55715473769075, -133.54633202120775, -158.71408675755038, -118.87894424269572, -45.33955103721615, -21.535342395771757, -78.85420091652963, -89.20434602698195, -48.466312767223585, -48.900688857103646, -29.251911164994734, -139.16046848337206, -146.90996216201168, -20.623711304062414, -99.56136516453738, -59.812364281754526, -78.14372347116415, -48.330049018472764, -88.90636888171693, -99.28208836936135, -66.43681408037283, -68.90372680748166, -109.42393036375022, -42.582272102526005, -159.85806672775152, -58.96963594337748, -99.18246758105477, -58.123656199910975, -48.03959231021773, -119.44894304550118, -219.83452101866294, -118.20218041188232, -169.22784207476826, -118.80454307135177, -58.833576641958665, -53.59370670704294, -114.84661770219135, -96.00207901368255, -39.08566102511425, -36.78883771539252, -108.44739605219944, -68.08730545797937, -99.20478242445604, -39.096038782182454, -76.01765095033565, -68.99927732172593, -69.68052172437588, -139.65658407855466, -72.87161754240424, -69.68866315936803, -11.609527620021483, -78.27659018555563, -78.80670076909003, -96.09627851449923, -46.46251961886173, -69.04168155155989, -105.2082130602682, -65.7778079774364, -12.672592766908855, -108.79780799410382, -89.77125410288185, -103.05383432377899, -74.75406437831438, -112.7251858281893, -68.42987855766769, -83.59200882180019, -78.57025664830834], "episode_lengths": [34, 36, 37, 43, 44, 39, 41, 44, 40, 37, 34, 52, 52, 35, 33, 36, 31, 38, 35, 46, 30, 33, 38, 36, 34, 29, 31, 30, 33, 33, 30, 36, 46, 36, 39, 41, 37, 30, 29, 33, 34, 30, 30, 28, 39, 40, 28, 35, 31, 33, 30, 34, 35, 32, 32, 36, 30, 42, 31, 35, 31, 30, 37, 47, 37, 42, 37, 31, 31, 37, 35, 29, 29, 36, 32, 35, 29, 33, 32, 32, 39, 33, 32, 27, 33, 34, 35, 30, 32, 36, 32, 29, 36, 34, 36, 33, 38, 32, 34, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 274.4730678457216, "mean_inference_ms": 2.028966132621341, "mean_action_processing_ms": 0.14221128717514003, "mean_env_wait_ms": 37.08373836136722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011104822158813477, "StateBufferConnector_ms": 0.0068149566650390625, "ViewRequirementAgentConnector_ms": 0.16753888130187988}}, "episode_reward_max": -11.609527620021483, "episode_reward_min": -268.5885363918793, "episode_reward_mean": -94.74298786896186, "episode_len_mean": 34.86, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88.29921905112035, -108.71837262167197, -116.16987721869376, -178.48924893306582, -189.1065584336889, -137.66717566411353, -157.8822624586567, -188.90667271992874, -147.7427981681481, -119.51240987127775, -88.71793439393454, -268.5885363918793, -268.2505868042884, -98.12398552081744, -76.53153665984452, -101.87550669092185, -58.17663560667182, -127.42843075606166, -84.1299784579527, -207.1827014646652, -39.58426068640575, -65.3245575600418, -126.84595262429488, -104.84943165176283, -79.37187044322455, -38.26425020644704, -49.18337642370978, -47.98837289590859, -79.36129198586887, -77.30018864606897, -40.60272069222075, -95.01961444547811, -207.53878792911058, -106.55715473769075, -133.54633202120775, -158.71408675755038, -118.87894424269572, -45.33955103721615, -21.535342395771757, -78.85420091652963, -89.20434602698195, -48.466312767223585, -48.900688857103646, -29.251911164994734, -139.16046848337206, -146.90996216201168, -20.623711304062414, -99.56136516453738, -59.812364281754526, -78.14372347116415, -48.330049018472764, -88.90636888171693, -99.28208836936135, -66.43681408037283, -68.90372680748166, -109.42393036375022, -42.582272102526005, -159.85806672775152, -58.96963594337748, -99.18246758105477, -58.123656199910975, -48.03959231021773, -119.44894304550118, -219.83452101866294, -118.20218041188232, -169.22784207476826, -118.80454307135177, -58.833576641958665, -53.59370670704294, -114.84661770219135, -96.00207901368255, -39.08566102511425, -36.78883771539252, -108.44739605219944, -68.08730545797937, -99.20478242445604, -39.096038782182454, -76.01765095033565, -68.99927732172593, -69.68052172437588, -139.65658407855466, -72.87161754240424, -69.68866315936803, -11.609527620021483, -78.27659018555563, -78.80670076909003, -96.09627851449923, -46.46251961886173, -69.04168155155989, -105.2082130602682, -65.7778079774364, -12.672592766908855, -108.79780799410382, -89.77125410288185, -103.05383432377899, -74.75406437831438, -112.7251858281893, -68.42987855766769, -83.59200882180019, -78.57025664830834], "episode_lengths": [34, 36, 37, 43, 44, 39, 41, 44, 40, 37, 34, 52, 52, 35, 33, 36, 31, 38, 35, 46, 30, 33, 38, 36, 34, 29, 31, 30, 33, 33, 30, 36, 46, 36, 39, 41, 37, 30, 29, 33, 34, 30, 30, 28, 39, 40, 28, 35, 31, 33, 30, 34, 35, 32, 32, 36, 30, 42, 31, 35, 31, 30, 37, 47, 37, 42, 37, 31, 31, 37, 35, 29, 29, 36, 32, 35, 29, 33, 32, 32, 39, 33, 32, 27, 33, 34, 35, 30, 32, 36, 32, 29, 36, 34, 36, 33, 38, 32, 34, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 274.4730678457216, "mean_inference_ms": 2.028966132621341, "mean_action_processing_ms": 0.14221128717514003, "mean_env_wait_ms": 37.08373836136722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011104822158813477, "StateBufferConnector_ms": 0.0068149566650390625, "ViewRequirementAgentConnector_ms": 0.16753888130187988}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 5850, "num_env_steps_sampled": 4000, "num_env_steps_trained": 5850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 7.00959943697844, "num_env_steps_trained_throughput_per_sec": 13.668718902107958, "timesteps_total": 4000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 6617.18, "sample_time_ms": 6556.721, "load_time_ms": 0.254, "load_throughput": 306612.664, "learn_time_ms": 12.9, "learn_throughput": 6046.548, "synch_weights_time_ms": 11.474}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 5850, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 5850, "last_target_update_ts": 3640, "num_target_updates": 6}, "done": false, "episodes_total": 110, "training_iteration": 4, "trial_id": "2058a_00000", "date": "2024-04-17_05-30-55", "timestamp": 1713331855, "time_this_iter_s": 142.66984295845032, "time_total_s": 629.7538771629333, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 629.7538771629333, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 16.264356435643563, "ram_util_percent": 13.235148514851485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16588103771209717, "cur_lr": 0.01}, "td_error": [2.2889509201049805, 1.8359954357147217, 1.47114098072052, 2.282132387161255, 1.6474171876907349, 2.2885313034057617, 0.6390549540519714, 2.282219886779785, 1.8345412015914917, 1.823337197303772, 2.2781615257263184, 2.2888193130493164, 2.288706064224243, 2.2829952239990234, 1.8242398500442505, 1.8386743068695068, 1.8444795608520508, 2.2826197147369385, 1.8421262502670288, 1.8277571201324463, 1.9040367603302002, 2.2894158363342285, 2.2788681983947754, 2.2790534496307373, 1.9053813219070435, 1.46840500831604, 2.298659086227417, 2.283576250076294, 2.2820417881011963, 2.297192335128784, 0.6390549540519714, 2.2886219024658203, 2.283052682876587, 2.289802312850952, 0.6390549540519714, 1.45650053024292, 2.2887582778930664, 1.8397486209869385, 1.7771035432815552, 1.9072576761245728, 0.6390549540519714, 1.5301117897033691, 2.282451629638672, 2.2782247066497803, 2.2868285179138184, 0.6627916097640991, 2.7536282539367676, 0.7036236524581909, 2.288618326187134, 2.2885918617248535, 1.638813853263855, 0.7201644778251648, 0.6390549540519714, 1.4670196771621704, 2.146611213684082, 2.288182258605957, 1.493668794631958, 1.4581942558288574, 1.9057337045669556, 1.9127271175384521, 2.2797060012817383, 2.282965898513794, 2.3448691368103027, 0.6390549540519714, 1.4551491737365723, 2.1462488174438477, 1.4551491737365723, 2.2868072986602783, 2.280606269836426, 2.281550407409668, 2.278320074081421, 1.6566579341888428, 0.6390549540519714, 2.2977702617645264, 2.2828314304351807, 1.47114098072052, 2.8765692710876465, 2.278212547302246], "mean_td_error": 1.8756954669952393, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 100.0, "diff_num_grad_updates_vs_sampler_policy": 99.0}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 7800, "last_target_update_ts": 4680, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": -11.609527620021483, "episode_reward_min": -219.83452101866294, "episode_reward_mean": -78.1273985121045, "episode_len_mean": 33.1, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.53878792911058, -106.55715473769075, -133.54633202120775, -158.71408675755038, -118.87894424269572, -45.33955103721615, -21.535342395771757, -78.85420091652963, -89.20434602698195, -48.466312767223585, -48.900688857103646, -29.251911164994734, -139.16046848337206, -146.90996216201168, -20.623711304062414, -99.56136516453738, -59.812364281754526, -78.14372347116415, -48.330049018472764, -88.90636888171693, -99.28208836936135, -66.43681408037283, -68.90372680748166, -109.42393036375022, -42.582272102526005, -159.85806672775152, -58.96963594337748, -99.18246758105477, -58.123656199910975, -48.03959231021773, -119.44894304550118, -219.83452101866294, -118.20218041188232, -169.22784207476826, -118.80454307135177, -58.833576641958665, -53.59370670704294, -114.84661770219135, -96.00207901368255, -39.08566102511425, -36.78883771539252, -108.44739605219944, -68.08730545797937, -99.20478242445604, -39.096038782182454, -76.01765095033565, -68.99927732172593, -69.68052172437588, -139.65658407855466, -72.87161754240424, -69.68866315936803, -11.609527620021483, -78.27659018555563, -78.80670076909003, -96.09627851449923, -46.46251961886173, -69.04168155155989, -105.2082130602682, -65.7778079774364, -12.672592766908855, -108.79780799410382, -89.77125410288185, -103.05383432377899, -74.75406437831438, -112.7251858281893, -68.42987855766769, -83.59200882180019, -78.57025664830834, -76.72844760027418, -37.93464298441505, -19.345210307012092, -59.919071371736976, -75.73820978866802, -48.71311838253041, -39.894778726297176, -99.5511049147444, -96.49071159438115, -59.12679786813754, -37.35366291175342, -39.833297598111685, -39.05070900338895, -58.07262876439999, -59.153747797243916, -49.129947186724465, -79.85721532645476, -49.903454771689475, -57.74087821644019, -39.57991020483876, -99.76661988116204, -79.82004495421918, -49.43476086480501, -89.38117442166295, -102.3597199175583, -69.88316130118835, -79.90221341206419, -39.912740942984215, -52.474475829819426, -28.6734792149565, -89.23232814152786, -89.67911626191149], "episode_lengths": [46, 36, 39, 41, 37, 30, 29, 33, 34, 30, 30, 28, 39, 40, 28, 35, 31, 33, 30, 34, 35, 32, 32, 36, 30, 42, 31, 35, 31, 30, 37, 47, 37, 42, 37, 31, 31, 37, 35, 29, 29, 36, 32, 35, 29, 33, 32, 32, 39, 33, 32, 27, 33, 34, 35, 30, 32, 36, 32, 29, 36, 34, 36, 33, 38, 32, 34, 33, 33, 29, 27, 31, 33, 30, 29, 35, 35, 31, 29, 29, 29, 31, 31, 30, 33, 30, 31, 29, 35, 33, 30, 34, 36, 32, 33, 29, 31, 28, 34, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 290.37102235236705, "mean_inference_ms": 2.047399170981042, "mean_action_processing_ms": 0.14318881818260987, "mean_env_wait_ms": 23.49106313125337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01077890396118164, "StateBufferConnector_ms": 0.0070896148681640625, "ViewRequirementAgentConnector_ms": 0.1714005470275879}}, "episode_reward_max": -11.609527620021483, "episode_reward_min": -219.83452101866294, "episode_reward_mean": -78.1273985121045, "episode_len_mean": 33.1, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207.53878792911058, -106.55715473769075, -133.54633202120775, -158.71408675755038, -118.87894424269572, -45.33955103721615, -21.535342395771757, -78.85420091652963, -89.20434602698195, -48.466312767223585, -48.900688857103646, -29.251911164994734, -139.16046848337206, -146.90996216201168, -20.623711304062414, -99.56136516453738, -59.812364281754526, -78.14372347116415, -48.330049018472764, -88.90636888171693, -99.28208836936135, -66.43681408037283, -68.90372680748166, -109.42393036375022, -42.582272102526005, -159.85806672775152, -58.96963594337748, -99.18246758105477, -58.123656199910975, -48.03959231021773, -119.44894304550118, -219.83452101866294, -118.20218041188232, -169.22784207476826, -118.80454307135177, -58.833576641958665, -53.59370670704294, -114.84661770219135, -96.00207901368255, -39.08566102511425, -36.78883771539252, -108.44739605219944, -68.08730545797937, -99.20478242445604, -39.096038782182454, -76.01765095033565, -68.99927732172593, -69.68052172437588, -139.65658407855466, -72.87161754240424, -69.68866315936803, -11.609527620021483, -78.27659018555563, -78.80670076909003, -96.09627851449923, -46.46251961886173, -69.04168155155989, -105.2082130602682, -65.7778079774364, -12.672592766908855, -108.79780799410382, -89.77125410288185, -103.05383432377899, -74.75406437831438, -112.7251858281893, -68.42987855766769, -83.59200882180019, -78.57025664830834, -76.72844760027418, -37.93464298441505, -19.345210307012092, -59.919071371736976, -75.73820978866802, -48.71311838253041, -39.894778726297176, -99.5511049147444, -96.49071159438115, -59.12679786813754, -37.35366291175342, -39.833297598111685, -39.05070900338895, -58.07262876439999, -59.153747797243916, -49.129947186724465, -79.85721532645476, -49.903454771689475, -57.74087821644019, -39.57991020483876, -99.76661988116204, -79.82004495421918, -49.43476086480501, -89.38117442166295, -102.3597199175583, -69.88316130118835, -79.90221341206419, -39.912740942984215, -52.474475829819426, -28.6734792149565, -89.23232814152786, -89.67911626191149], "episode_lengths": [46, 36, 39, 41, 37, 30, 29, 33, 34, 30, 30, 28, 39, 40, 28, 35, 31, 33, 30, 34, 35, 32, 32, 36, 30, 42, 31, 35, 31, 30, 37, 47, 37, 42, 37, 31, 31, 37, 35, 29, 29, 36, 32, 35, 29, 33, 32, 32, 39, 33, 32, 27, 33, 34, 35, 30, 32, 36, 32, 29, 36, 34, 36, 33, 38, 32, 34, 33, 33, 29, 27, 31, 33, 30, 29, 35, 35, 31, 29, 29, 29, 31, 31, 30, 33, 30, 31, 29, 35, 33, 30, 34, 36, 32, 33, 29, 31, 28, 34, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 290.37102235236705, "mean_inference_ms": 2.047399170981042, "mean_action_processing_ms": 0.14318881818260987, "mean_env_wait_ms": 23.49106313125337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01077890396118164, "StateBufferConnector_ms": 0.0070896148681640625, "ViewRequirementAgentConnector_ms": 0.1714005470275879}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 7800, "num_env_steps_sampled": 5000, "num_env_steps_trained": 7800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.737973254481656, "num_env_steps_trained_throughput_per_sec": 11.18904784623923, "timesteps_total": 5000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 8666.507, "sample_time_ms": 8609.741, "load_time_ms": 0.218, "load_throughput": 358605.406, "learn_time_ms": 12.315, "learn_throughput": 6333.648, "synch_weights_time_ms": 10.392}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 7800, "last_target_update_ts": 4680, "num_target_updates": 8}, "done": false, "episodes_total": 142, "training_iteration": 5, "trial_id": "2058a_00000", "date": "2024-04-17_05-33-49", "timestamp": 1713332029, "time_this_iter_s": 174.28522157669067, "time_total_s": 804.039098739624, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 804.039098739624, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.343145161290321, "ram_util_percent": 13.343548387096778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13641703128814697, "cur_lr": 0.01}, "td_error": [1.3704209327697754, 1.3734062910079956, 2.2461459636688232, 2.2410643100738525, 2.2425076961517334, 2.2402002811431885, 2.240640163421631, 1.7798728942871094, 2.2398762702941895, 1.5184134244918823, 2.255152702331543, 1.7808952331542969, 2.254431962966919, 1.3456462621688843, 1.7798808813095093, 2.2402448654174805, 2.239567518234253, 1.790723204612732, 2.3460428714752197, 2.3303170204162598, 2.2430198192596436, 2.2402727603912354, 1.5181708335876465, 0.5424324870109558, 3.0598206520080566, 2.2541494369506836, 3.24995493888855, 1.3456462621688843, 1.8096927404403687, 0.6445915699005127, 1.3499950170516968, 1.3536909818649292, 2.2574055194854736, 1.3536909818649292, 1.3462642431259155, 2.2598466873168945, 0.6497119069099426, 1.7986825704574585, 0.5424324870109558, 2.255093574523926, 1.350846290588379, 2.249116897583008, 1.935448408126831, 1.7876508235931396, 2.2540123462677, 2.2399959564208984, 2.256588935852051, 1.4818693399429321, 2.244096279144287, 1.7006049156188965, 2.243241786956787, 2.253546953201294, 1.3705646991729736, 2.246703863143921, 1.3457109928131104, 2.254660129547119, 2.573505163192749, 2.2568001747131348, 1.3704209327697754, 2.258315086364746, 2.0212271213531494, 2.2432749271392822, 2.242664337158203, 0.5424324870109558, 2.247713088989258, 2.2574071884155273, 2.2426483631134033, 2.2429087162017822, 1.3460304737091064, 2.362877607345581, 1.5337483882904053, 1.371219515800476, 1.7906159162521362, 1.4480836391448975, 1.3456462621688843, 1.3456462621688843, 1.4883251190185547, 1.7012920379638672], "mean_td_error": 1.8638139963150024, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 125.0, "diff_num_grad_updates_vs_sampler_policy": 124.0}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 9750, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 9750, "last_target_update_ts": 5720, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": -9.128572747453013, "episode_reward_min": -139.65658407855466, "episode_reward_mean": -61.54939684093234, "episode_len_mean": 31.38, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.80454307135177, -58.833576641958665, -53.59370670704294, -114.84661770219135, -96.00207901368255, -39.08566102511425, -36.78883771539252, -108.44739605219944, -68.08730545797937, -99.20478242445604, -39.096038782182454, -76.01765095033565, -68.99927732172593, -69.68052172437588, -139.65658407855466, -72.87161754240424, -69.68866315936803, -11.609527620021483, -78.27659018555563, -78.80670076909003, -96.09627851449923, -46.46251961886173, -69.04168155155989, -105.2082130602682, -65.7778079774364, -12.672592766908855, -108.79780799410382, -89.77125410288185, -103.05383432377899, -74.75406437831438, -112.7251858281893, -68.42987855766769, -83.59200882180019, -78.57025664830834, -76.72844760027418, -37.93464298441505, -19.345210307012092, -59.919071371736976, -75.73820978866802, -48.71311838253041, -39.894778726297176, -99.5511049147444, -96.49071159438115, -59.12679786813754, -37.35366291175342, -39.833297598111685, -39.05070900338895, -58.07262876439999, -59.153747797243916, -49.129947186724465, -79.85721532645476, -49.903454771689475, -57.74087821644019, -39.57991020483876, -99.76661988116204, -79.82004495421918, -49.43476086480501, -89.38117442166295, -102.3597199175583, -69.88316130118835, -79.90221341206419, -39.912740942984215, -52.474475829819426, -28.6734792149565, -89.23232814152786, -89.67911626191149, -89.33298772217871, -49.94505045670351, -39.948443655756904, -38.96294643398237, -19.91454283212805, -49.92981318401183, -49.9623496281164, -38.92630873347231, -79.64389693747322, -22.941310888674554, -38.70040723522907, -68.97078916836145, -39.842562514474615, -9.631294838376403, -49.94372653302589, -69.94564702716134, -9.128572747453013, -19.679861531135654, -19.27260457003372, -29.956375622855884, -29.63069155009074, -15.932811537104172, -89.81224510588453, -49.91381067410524, -28.58403008287305, -39.93780417596668, -79.93651631782608, -39.592949167454385, -69.63707981585762, -19.134190382588802, -89.85590683146297, -89.92190011249497, -41.521455713884784, -29.96035781237029], "episode_lengths": [37, 31, 31, 37, 35, 29, 29, 36, 32, 35, 29, 33, 32, 32, 39, 33, 32, 27, 33, 34, 35, 30, 32, 36, 32, 29, 36, 34, 36, 33, 38, 32, 34, 33, 33, 29, 27, 31, 33, 30, 29, 35, 35, 31, 29, 29, 29, 31, 31, 30, 33, 30, 31, 29, 35, 33, 30, 34, 36, 32, 33, 29, 31, 28, 34, 34, 34, 30, 29, 29, 27, 30, 30, 29, 33, 28, 29, 32, 29, 26, 30, 32, 26, 27, 27, 28, 28, 27, 34, 30, 28, 29, 33, 29, 32, 27, 34, 34, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 304.0280523215135, "mean_inference_ms": 2.0633152915923016, "mean_action_processing_ms": 0.14401395608381587, "mean_env_wait_ms": 17.698872564451737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010792970657348633, "StateBufferConnector_ms": 0.007059574127197266, "ViewRequirementAgentConnector_ms": 0.17217469215393066}}, "episode_reward_max": -9.128572747453013, "episode_reward_min": -139.65658407855466, "episode_reward_mean": -61.54939684093234, "episode_len_mean": 31.38, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-118.80454307135177, -58.833576641958665, -53.59370670704294, -114.84661770219135, -96.00207901368255, -39.08566102511425, -36.78883771539252, -108.44739605219944, -68.08730545797937, -99.20478242445604, -39.096038782182454, -76.01765095033565, -68.99927732172593, -69.68052172437588, -139.65658407855466, -72.87161754240424, -69.68866315936803, -11.609527620021483, -78.27659018555563, -78.80670076909003, -96.09627851449923, -46.46251961886173, -69.04168155155989, -105.2082130602682, -65.7778079774364, -12.672592766908855, -108.79780799410382, -89.77125410288185, -103.05383432377899, -74.75406437831438, -112.7251858281893, -68.42987855766769, -83.59200882180019, -78.57025664830834, -76.72844760027418, -37.93464298441505, -19.345210307012092, -59.919071371736976, -75.73820978866802, -48.71311838253041, -39.894778726297176, -99.5511049147444, -96.49071159438115, -59.12679786813754, -37.35366291175342, -39.833297598111685, -39.05070900338895, -58.07262876439999, -59.153747797243916, -49.129947186724465, -79.85721532645476, -49.903454771689475, -57.74087821644019, -39.57991020483876, -99.76661988116204, -79.82004495421918, -49.43476086480501, -89.38117442166295, -102.3597199175583, -69.88316130118835, -79.90221341206419, -39.912740942984215, -52.474475829819426, -28.6734792149565, -89.23232814152786, -89.67911626191149, -89.33298772217871, -49.94505045670351, -39.948443655756904, -38.96294643398237, -19.91454283212805, -49.92981318401183, -49.9623496281164, -38.92630873347231, -79.64389693747322, -22.941310888674554, -38.70040723522907, -68.97078916836145, -39.842562514474615, -9.631294838376403, -49.94372653302589, -69.94564702716134, -9.128572747453013, -19.679861531135654, -19.27260457003372, -29.956375622855884, -29.63069155009074, -15.932811537104172, -89.81224510588453, -49.91381067410524, -28.58403008287305, -39.93780417596668, -79.93651631782608, -39.592949167454385, -69.63707981585762, -19.134190382588802, -89.85590683146297, -89.92190011249497, -41.521455713884784, -29.96035781237029], "episode_lengths": [37, 31, 31, 37, 35, 29, 29, 36, 32, 35, 29, 33, 32, 32, 39, 33, 32, 27, 33, 34, 35, 30, 32, 36, 32, 29, 36, 34, 36, 33, 38, 32, 34, 33, 33, 29, 27, 31, 33, 30, 29, 35, 35, 31, 29, 29, 29, 31, 31, 30, 33, 30, 31, 29, 35, 33, 30, 34, 36, 32, 33, 29, 31, 28, 34, 34, 34, 30, 29, 29, 27, 30, 30, 29, 33, 28, 29, 32, 29, 26, 30, 32, 26, 27, 27, 28, 28, 27, 34, 30, 28, 29, 33, 29, 32, 27, 34, 34, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 304.0280523215135, "mean_inference_ms": 2.0633152915923016, "mean_action_processing_ms": 0.14401395608381587, "mean_env_wait_ms": 17.698872564451737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010792970657348633, "StateBufferConnector_ms": 0.007059574127197266, "ViewRequirementAgentConnector_ms": 0.17217469215393066}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 9750, "num_env_steps_sampled": 6000, "num_env_steps_trained": 9750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.987969409844062, "num_env_steps_trained_throughput_per_sec": 7.776540349195921, "timesteps_total": 6000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 9813.109, "sample_time_ms": 9753.935, "load_time_ms": 0.233, "load_throughput": 335200.525, "learn_time_ms": 12.345, "learn_throughput": 6318.492, "synch_weights_time_ms": 12.12}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 9750, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 9750, "last_target_update_ts": 5720, "num_target_updates": 10}, "done": false, "episodes_total": 176, "training_iteration": 6, "trial_id": "2058a_00000", "date": "2024-04-17_05-38-00", "timestamp": 1713332280, "time_this_iter_s": 250.76359462738037, "time_total_s": 1054.8026933670044, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 1054.8026933670044, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 10.086834733893557, "ram_util_percent": 13.421008403361348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11963506042957306, "cur_lr": 0.01}, "td_error": [1.2382234334945679, 1.2465711832046509, 2.215928554534912, 1.3239158391952515, 2.222897529602051, 2.224116802215576, 1.5781409740447998, 1.2401206493377686, 2.215414524078369, 1.2374634742736816, 0.5043448209762573, 1.236251711845398, 0.5043448209762573, 1.562882900238037, 2.219789505004883, 2.2198686599731445, 2.2057745456695557, 2.2107787132263184, 1.2407816648483276, 1.227186679840088, 2.2336392402648926, 2.2146408557891846, 1.6309144496917725, 2.208751916885376, 2.21718692779541, 1.2385247945785522, 2.2058660984039307, 1.5869410037994385, 2.229451894760132, 0.5058632493019104, 1.587799310684204, 1.5751110315322876, 2.2221574783325195, 2.2214717864990234, 2.223844051361084, 1.6416306495666504, 1.564077615737915, 1.236251711845398, 2.206414222717285, 2.3300631046295166, 3.110058546066284, 2.223844528198242, 0.5043448209762573, 0.5341755151748657, 1.3426461219787598, 0.5457081198692322, 1.6411705017089844, 2.2148804664611816, 1.236251711845398, 2.2487752437591553, 2.2270450592041016, 0.5043448209762573, 2.2059240341186523, 2.2057807445526123, 1.3039954900741577, 0.5043448209762573, 2.2144625186920166, 2.8178436756134033, 2.2058568000793457, 2.2232398986816406, 1.97944176197052, 1.5929640531539917, 2.223512649536133, 2.0325684547424316, 2.2240402698516846, 1.1825759410858154, 2.2171175479888916, 1.236251711845398, 2.2058982849121094, 2.619241952896118, 1.2333085536956787, 2.2075459957122803, 2.3655893802642822, 2.223480224609375, 1.236322283744812, 2.325727939605713, 2.2186317443847656, 0.5043448209762573], "mean_td_error": 1.753828763961792, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 150.0, "diff_num_grad_updates_vs_sampler_policy": 149.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 11700, "last_target_update_ts": 6760, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 0.10976531600873793, "episode_reward_min": -102.3597199175583, "episode_reward_mean": -45.59067307651292, "episode_len_mean": 29.28, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.345210307012092, -59.919071371736976, -75.73820978866802, -48.71311838253041, -39.894778726297176, -99.5511049147444, -96.49071159438115, -59.12679786813754, -37.35366291175342, -39.833297598111685, -39.05070900338895, -58.07262876439999, -59.153747797243916, -49.129947186724465, -79.85721532645476, -49.903454771689475, -57.74087821644019, -39.57991020483876, -99.76661988116204, -79.82004495421918, -49.43476086480501, -89.38117442166295, -102.3597199175583, -69.88316130118835, -79.90221341206419, -39.912740942984215, -52.474475829819426, -28.6734792149565, -89.23232814152786, -89.67911626191149, -89.33298772217871, -49.94505045670351, -39.948443655756904, -38.96294643398237, -19.91454283212805, -49.92981318401183, -49.9623496281164, -38.92630873347231, -79.64389693747322, -22.941310888674554, -38.70040723522907, -68.97078916836145, -39.842562514474615, -9.631294838376403, -49.94372653302589, -69.94564702716134, -9.128572747453013, -19.679861531135654, -19.27260457003372, -29.956375622855884, -29.63069155009074, -15.932811537104172, -89.81224510588453, -49.91381067410524, -28.58403008287305, -39.93780417596668, -79.93651631782608, -39.592949167454385, -69.63707981585762, -19.134190382588802, -89.85590683146297, -89.92190011249497, -41.521455713884784, -29.96035781237029, -24.406755033613635, -39.25286206402807, -17.113838204575647, -9.687676070216636, -28.032116239211913, -46.13148506240378, -19.91354628615904, 0.010196738366852271, 0.10976531600873793, -27.909368540181735, -8.212378860192928, -59.95619054157888, -39.3345674674815, -29.948680157632452, 0.03886274116272435, -39.956374373774906, -19.97419389834609, -39.63702730975357, -59.36212198813766, -69.96665584503639, -9.284208175225833, -69.98529928336657, -26.124433662724584, -49.141807585900935, -17.17943447988472, -29.977459345744144, -49.96982277640644, -9.943814259346837, -19.95342081915769, -45.84182337894532, -29.309326113386007, -39.98966862823484, -69.49714900272194, -8.575391835867833, -19.977741073732663, -58.75396266487803], "episode_lengths": [27, 31, 33, 30, 29, 35, 35, 31, 29, 29, 29, 31, 31, 30, 33, 30, 31, 29, 35, 33, 30, 34, 36, 32, 33, 29, 31, 28, 34, 34, 34, 30, 29, 29, 27, 30, 30, 29, 33, 28, 29, 32, 29, 26, 30, 32, 26, 27, 27, 28, 28, 27, 34, 30, 28, 29, 33, 29, 32, 27, 34, 34, 30, 28, 28, 29, 23, 26, 28, 30, 27, 20, 25, 28, 26, 31, 24, 28, 25, 29, 22, 29, 31, 32, 21, 32, 28, 30, 27, 23, 30, 26, 27, 30, 28, 24, 32, 26, 27, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 315.9611720606514, "mean_inference_ms": 2.068958463087546, "mean_action_processing_ms": 0.14429917376775414, "mean_env_wait_ms": 14.380717941962695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010332107543945312, "StateBufferConnector_ms": 0.0071964263916015625, "ViewRequirementAgentConnector_ms": 0.17629480361938477}}, "episode_reward_max": 0.10976531600873793, "episode_reward_min": -102.3597199175583, "episode_reward_mean": -45.59067307651292, "episode_len_mean": 29.28, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.345210307012092, -59.919071371736976, -75.73820978866802, -48.71311838253041, -39.894778726297176, -99.5511049147444, -96.49071159438115, -59.12679786813754, -37.35366291175342, -39.833297598111685, -39.05070900338895, -58.07262876439999, -59.153747797243916, -49.129947186724465, -79.85721532645476, -49.903454771689475, -57.74087821644019, -39.57991020483876, -99.76661988116204, -79.82004495421918, -49.43476086480501, -89.38117442166295, -102.3597199175583, -69.88316130118835, -79.90221341206419, -39.912740942984215, -52.474475829819426, -28.6734792149565, -89.23232814152786, -89.67911626191149, -89.33298772217871, -49.94505045670351, -39.948443655756904, -38.96294643398237, -19.91454283212805, -49.92981318401183, -49.9623496281164, -38.92630873347231, -79.64389693747322, -22.941310888674554, -38.70040723522907, -68.97078916836145, -39.842562514474615, -9.631294838376403, -49.94372653302589, -69.94564702716134, -9.128572747453013, -19.679861531135654, -19.27260457003372, -29.956375622855884, -29.63069155009074, -15.932811537104172, -89.81224510588453, -49.91381067410524, -28.58403008287305, -39.93780417596668, -79.93651631782608, -39.592949167454385, -69.63707981585762, -19.134190382588802, -89.85590683146297, -89.92190011249497, -41.521455713884784, -29.96035781237029, -24.406755033613635, -39.25286206402807, -17.113838204575647, -9.687676070216636, -28.032116239211913, -46.13148506240378, -19.91354628615904, 0.010196738366852271, 0.10976531600873793, -27.909368540181735, -8.212378860192928, -59.95619054157888, -39.3345674674815, -29.948680157632452, 0.03886274116272435, -39.956374373774906, -19.97419389834609, -39.63702730975357, -59.36212198813766, -69.96665584503639, -9.284208175225833, -69.98529928336657, -26.124433662724584, -49.141807585900935, -17.17943447988472, -29.977459345744144, -49.96982277640644, -9.943814259346837, -19.95342081915769, -45.84182337894532, -29.309326113386007, -39.98966862823484, -69.49714900272194, -8.575391835867833, -19.977741073732663, -58.75396266487803], "episode_lengths": [27, 31, 33, 30, 29, 35, 35, 31, 29, 29, 29, 31, 31, 30, 33, 30, 31, 29, 35, 33, 30, 34, 36, 32, 33, 29, 31, 28, 34, 34, 34, 30, 29, 29, 27, 30, 30, 29, 33, 28, 29, 32, 29, 26, 30, 32, 26, 27, 27, 28, 28, 27, 34, 30, 28, 29, 33, 29, 32, 27, 34, 34, 30, 28, 28, 29, 23, 26, 28, 30, 27, 20, 25, 28, 26, 31, 24, 28, 25, 29, 22, 29, 31, 32, 21, 32, 28, 30, 27, 23, 30, 26, 27, 30, 28, 24, 32, 26, 27, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 315.9611720606514, "mean_inference_ms": 2.068958463087546, "mean_action_processing_ms": 0.14429917376775414, "mean_env_wait_ms": 14.380717941962695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010332107543945312, "StateBufferConnector_ms": 0.0071964263916015625, "ViewRequirementAgentConnector_ms": 0.17629480361938477}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 11700, "num_env_steps_sampled": 7000, "num_env_steps_trained": 11700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.035174863960463, "num_env_steps_trained_throughput_per_sec": 9.818590984722901, "timesteps_total": 7000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 8802.436, "sample_time_ms": 8744.301, "load_time_ms": 0.232, "load_throughput": 336579.951, "learn_time_ms": 12.426, "learn_throughput": 6277.127, "synch_weights_time_ms": 11.135}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 11700, "last_target_update_ts": 6760, "num_target_updates": 12}, "done": false, "episodes_total": 212, "training_iteration": 7, "trial_id": "2058a_00000", "date": "2024-04-17_05-41-19", "timestamp": 1713332479, "time_this_iter_s": 198.61221647262573, "time_total_s": 1253.4149098396301, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 1253.4149098396301, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.318374558303887, "ram_util_percent": 13.512720848056537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.08765862882137299, "cur_lr": 0.01}, "td_error": [2.153463125228882, 1.1624106168746948, 1.36199152469635, 2.1712656021118164, 2.1530518531799316, 2.23478627204895, 2.883742570877075, 0.49187320470809937, 0.49187320470809937, 2.967170238494873, 0.49187320470809937, 1.8970497846603394, 3.3710691928863525, 0.49187320470809937, 2.007524251937866, 2.1748881340026855, 2.168273687362671, 1.1688591241836548, 1.5479896068572998, 1.542314052581787, 2.1684327125549316, 1.5549198389053345, 2.3033621311187744, 0.5388474464416504, 2.1704840660095215, 0.5388474464416504, 2.0103375911712646, 2.1683759689331055, 2.1530754566192627, 3.154808521270752, 2.1768038272857666, 3.3903841972351074, 1.9774219989776611, 1.9505668878555298, 2.167576551437378, 2.169905185699463, 2.009406566619873, 1.5421197414398193, 2.168325185775757, 0.49187320470809937, 1.8970496654510498, 2.1533195972442627, 2.1721718311309814, 3.159728765487671, 2.153094530105591, 2.1530725955963135, 1.6323201656341553, 2.1704459190368652, 2.169203281402588, 1.178086519241333, 1.9634841680526733, 2.153085947036743, 2.2828657627105713, 1.632486343383789, 2.1535489559173584, 1.1762785911560059, 2.1797056198120117, 2.1532046794891357, 2.158027172088623, 2.1677722930908203, 1.184261441230774, 1.9773619174957275, 2.661652088165283, 0.49187320470809937, 1.5548548698425293, 2.5515384674072266, 1.8970497846603394, 1.2098485231399536, 1.6283316612243652, 2.645895481109619, 1.5368468761444092, 1.162349820137024, 1.977360725402832, 2.153066635131836, 1.542495846748352, 1.6460814476013184, 1.3827069997787476, 1.6369726657867432], "mean_td_error": 1.8645989894866943, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 175.0, "diff_num_grad_updates_vs_sampler_policy": 174.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 13650, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 13650, "last_target_update_ts": 7800, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 0.9892000858575037, "episode_reward_min": -89.92190011249497, "episode_reward_mean": -35.03621806890649, "episode_len_mean": 28.2, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.9623496281164, -38.92630873347231, -79.64389693747322, -22.941310888674554, -38.70040723522907, -68.97078916836145, -39.842562514474615, -9.631294838376403, -49.94372653302589, -69.94564702716134, -9.128572747453013, -19.679861531135654, -19.27260457003372, -29.956375622855884, -29.63069155009074, -15.932811537104172, -89.81224510588453, -49.91381067410524, -28.58403008287305, -39.93780417596668, -79.93651631782608, -39.592949167454385, -69.63707981585762, -19.134190382588802, -89.85590683146297, -89.92190011249497, -41.521455713884784, -29.96035781237029, -24.406755033613635, -39.25286206402807, -17.113838204575647, -9.687676070216636, -28.032116239211913, -46.13148506240378, -19.91354628615904, 0.010196738366852271, 0.10976531600873793, -27.909368540181735, -8.212378860192928, -59.95619054157888, -39.3345674674815, -29.948680157632452, 0.03886274116272435, -39.956374373774906, -19.97419389834609, -39.63702730975357, -59.36212198813766, -69.96665584503639, -9.284208175225833, -69.98529928336657, -26.124433662724584, -49.141807585900935, -17.17943447988472, -29.977459345744144, -49.96982277640644, -9.943814259346837, -19.95342081915769, -45.84182337894532, -29.309326113386007, -39.98966862823484, -69.49714900272194, -8.575391835867833, -19.977741073732663, -58.75396266487803, -49.866253263156935, -39.9288429946244, -29.515757691959006, -9.983511656609066, -39.98344183074618, -29.78584379745684, -69.83722096049877, -9.1072234735025, -59.7348765277188, -19.978831811519083, -28.943799381010272, 0.9892000858575037, -29.960337863158838, -19.240672313519077, 0.2525406827989327, -24.91194967752843, -28.69230573773373, -39.96012237557918, -9.28171200296054, -9.675798066315288, -47.84005555785221, -19.493484676173505, -39.71157755644935, -59.89450088226704, -39.906791432808866, -39.29902695442473, -19.91326494243812, -29.823304456569883, -19.885227571337705, -49.86500237815711, 0.018115097086171508, -29.974997399876735, -29.299181759665963, -49.97200420133617, -69.86476215813056, -19.690745915189197], "episode_lengths": [30, 29, 33, 28, 29, 32, 29, 26, 30, 32, 26, 27, 27, 28, 28, 27, 34, 30, 28, 29, 33, 29, 32, 27, 34, 34, 30, 28, 28, 29, 23, 26, 28, 30, 27, 20, 25, 28, 26, 31, 24, 28, 25, 29, 22, 29, 31, 32, 21, 32, 28, 30, 27, 23, 30, 26, 27, 30, 28, 24, 32, 26, 27, 26, 30, 29, 28, 26, 29, 28, 32, 26, 31, 27, 28, 25, 28, 27, 25, 28, 28, 29, 26, 26, 30, 27, 29, 31, 29, 29, 27, 28, 27, 30, 25, 28, 28, 30, 32, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 326.04467570142987, "mean_inference_ms": 2.069180515664213, "mean_action_processing_ms": 0.14447448705522803, "mean_env_wait_ms": 12.262586259804188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010627269744873047, "StateBufferConnector_ms": 0.007045745849609375, "ViewRequirementAgentConnector_ms": 0.17630338668823242}}, "episode_reward_max": 0.9892000858575037, "episode_reward_min": -89.92190011249497, "episode_reward_mean": -35.03621806890649, "episode_len_mean": 28.2, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.9623496281164, -38.92630873347231, -79.64389693747322, -22.941310888674554, -38.70040723522907, -68.97078916836145, -39.842562514474615, -9.631294838376403, -49.94372653302589, -69.94564702716134, -9.128572747453013, -19.679861531135654, -19.27260457003372, -29.956375622855884, -29.63069155009074, -15.932811537104172, -89.81224510588453, -49.91381067410524, -28.58403008287305, -39.93780417596668, -79.93651631782608, -39.592949167454385, -69.63707981585762, -19.134190382588802, -89.85590683146297, -89.92190011249497, -41.521455713884784, -29.96035781237029, -24.406755033613635, -39.25286206402807, -17.113838204575647, -9.687676070216636, -28.032116239211913, -46.13148506240378, -19.91354628615904, 0.010196738366852271, 0.10976531600873793, -27.909368540181735, -8.212378860192928, -59.95619054157888, -39.3345674674815, -29.948680157632452, 0.03886274116272435, -39.956374373774906, -19.97419389834609, -39.63702730975357, -59.36212198813766, -69.96665584503639, -9.284208175225833, -69.98529928336657, -26.124433662724584, -49.141807585900935, -17.17943447988472, -29.977459345744144, -49.96982277640644, -9.943814259346837, -19.95342081915769, -45.84182337894532, -29.309326113386007, -39.98966862823484, -69.49714900272194, -8.575391835867833, -19.977741073732663, -58.75396266487803, -49.866253263156935, -39.9288429946244, -29.515757691959006, -9.983511656609066, -39.98344183074618, -29.78584379745684, -69.83722096049877, -9.1072234735025, -59.7348765277188, -19.978831811519083, -28.943799381010272, 0.9892000858575037, -29.960337863158838, -19.240672313519077, 0.2525406827989327, -24.91194967752843, -28.69230573773373, -39.96012237557918, -9.28171200296054, -9.675798066315288, -47.84005555785221, -19.493484676173505, -39.71157755644935, -59.89450088226704, -39.906791432808866, -39.29902695442473, -19.91326494243812, -29.823304456569883, -19.885227571337705, -49.86500237815711, 0.018115097086171508, -29.974997399876735, -29.299181759665963, -49.97200420133617, -69.86476215813056, -19.690745915189197], "episode_lengths": [30, 29, 33, 28, 29, 32, 29, 26, 30, 32, 26, 27, 27, 28, 28, 27, 34, 30, 28, 29, 33, 29, 32, 27, 34, 34, 30, 28, 28, 29, 23, 26, 28, 30, 27, 20, 25, 28, 26, 31, 24, 28, 25, 29, 22, 29, 31, 32, 21, 32, 28, 30, 27, 23, 30, 26, 27, 30, 28, 24, 32, 26, 27, 26, 30, 29, 28, 26, 29, 28, 32, 26, 31, 27, 28, 25, 28, 27, 25, 28, 28, 29, 26, 26, 30, 27, 29, 31, 29, 29, 27, 28, 27, 30, 25, 28, 28, 30, 32, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 326.04467570142987, "mean_inference_ms": 2.069180515664213, "mean_action_processing_ms": 0.14447448705522803, "mean_env_wait_ms": 12.262586259804188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010627269744873047, "StateBufferConnector_ms": 0.007045745849609375, "ViewRequirementAgentConnector_ms": 0.17630338668823242}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 13650, "num_env_steps_sampled": 8000, "num_env_steps_trained": 13650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.9579428486204837, "num_env_steps_trained_throughput_per_sec": 7.717988554809943, "timesteps_total": 8000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10963.81, "sample_time_ms": 10904.643, "load_time_ms": 0.229, "load_throughput": 340432.583, "learn_time_ms": 12.558, "learn_throughput": 6211.023, "synch_weights_time_ms": 11.486}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 13650, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 13650, "last_target_update_ts": 7800, "num_target_updates": 14}, "done": false, "episodes_total": 248, "training_iteration": 8, "trial_id": "2058a_00000", "date": "2024-04-17_05-45-31", "timestamp": 1713332731, "time_this_iter_s": 252.66359066963196, "time_total_s": 1506.078500509262, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 1506.078500509262, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 10.612777777777778, "ram_util_percent": 13.604444444444441}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0556180402636528, "cur_lr": 0.01}, "td_error": [1.9796266555786133, 1.0797960758209229, 2.1083931922912598, 2.107980966567993, 2.1076526641845703, 1.0625046491622925, 1.442165493965149, 1.0677626132965088, 2.1398448944091797, 0.4661509096622467, 2.1185617446899414, 2.1076128482818604, 0.4144022762775421, 2.1076107025146484, 1.4798318147659302, 1.907926082611084, 3.2100863456726074, 1.0797960758209229, 1.4502310752868652, 2.119443893432617, 3.0692901611328125, 1.0625046491622925, 1.4334893226623535, 0.385395884513855, 1.4846563339233398, 2.133967876434326, 0.385395884513855, 1.0797960758209229, 1.979621171951294, 0.385395884513855, 0.4873693585395813, 1.442848801612854, 2.107654571533203, 2.125105142593384, 2.1096131801605225, 1.0797960758209229, 2.119511127471924, 2.1088366508483887, 1.0914984941482544, 2.1080269813537598, 1.1104435920715332, 2.065427780151367, 2.108510971069336, 2.7044804096221924, 0.4661509096622467, 2.8137924671173096, 2.180628776550293, 1.4797701835632324, 1.194254994392395, 2.107623338699341, 2.1196396350860596, 2.119067668914795, 1.0689491033554077, 2.7527613639831543, 1.4849063158035278, 2.123755931854248, 2.1199214458465576, 0.385395884513855, 2.276258707046509, 2.115340232849121, 1.0632243156433105, 2.134011745452881, 0.4661509096622467, 2.1077370643615723, 2.1082468032836914, 3.3954813480377197, 0.4661509096622467, 2.1186816692352295, 1.9796295166015625, 2.125504970550537, 1.6677275896072388, 2.1195104122161865, 2.1076760292053223, 2.120899200439453, 1.4389883279800415, 1.907890796661377, 2.699857711791992, 2.1184496879577637], "mean_td_error": 1.7266674041748047, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 200.0, "diff_num_grad_updates_vs_sampler_policy": 199.0}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 15600, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 15600, "last_target_update_ts": 8840, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": 2.0166223558908576, "episode_reward_min": -69.98529928336657, "episode_reward_mean": -25.47291692336141, "episode_len_mean": 27.36, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.212378860192928, -59.95619054157888, -39.3345674674815, -29.948680157632452, 0.03886274116272435, -39.956374373774906, -19.97419389834609, -39.63702730975357, -59.36212198813766, -69.96665584503639, -9.284208175225833, -69.98529928336657, -26.124433662724584, -49.141807585900935, -17.17943447988472, -29.977459345744144, -49.96982277640644, -9.943814259346837, -19.95342081915769, -45.84182337894532, -29.309326113386007, -39.98966862823484, -69.49714900272194, -8.575391835867833, -19.977741073732663, -58.75396266487803, -49.866253263156935, -39.9288429946244, -29.515757691959006, -9.983511656609066, -39.98344183074618, -29.78584379745684, -69.83722096049877, -9.1072234735025, -59.7348765277188, -19.978831811519083, -28.943799381010272, 0.9892000858575037, -29.960337863158838, -19.240672313519077, 0.2525406827989327, -24.91194967752843, -28.69230573773373, -39.96012237557918, -9.28171200296054, -9.675798066315288, -47.84005555785221, -19.493484676173505, -39.71157755644935, -59.89450088226704, -39.906791432808866, -39.29902695442473, -19.91326494243812, -29.823304456569883, -19.885227571337705, -49.86500237815711, 0.018115097086171508, -29.974997399876735, -29.299181759665963, -49.97200420133617, -69.86476215813056, -19.690745915189197, -19.422508414458907, -29.97458966897423, -8.656778394762744, -26.525775896097525, -16.917480301024675, -9.9771123608855, -19.953350832749788, -18.611463499442028, -6.064274932386252, 0.046537331422944105, -9.902009322504432, -4.985931409923819, -9.96007870055598, -15.181852773953743, 0.7821929617836004, -4.252576597435166, -9.518990069711036, -6.656288506469128, -17.558398745129278, 0.07121228745906508, -33.89452453635887, -9.96981888171514, 0.38716701072067317, -19.24974604064486, -19.527217924792573, -24.210278167023667, -7.264196134192387, -28.176224103115942, 2.0166223558908576, -9.990260500024524, 0.02433365755856388, -4.810229361095078, -6.913664880420416, -9.975665797056239, -29.82057535441971, -38.70033598565715, -42.866073856592806, 0.24517819742450728], "episode_lengths": [26, 31, 24, 28, 25, 29, 22, 29, 31, 32, 21, 32, 28, 30, 27, 23, 30, 26, 27, 30, 28, 24, 32, 26, 27, 26, 30, 29, 28, 26, 29, 28, 32, 26, 31, 27, 28, 25, 28, 27, 25, 28, 28, 29, 26, 26, 30, 27, 29, 31, 29, 29, 27, 28, 27, 30, 25, 28, 28, 30, 32, 27, 27, 28, 26, 28, 27, 26, 27, 27, 26, 25, 26, 26, 26, 27, 25, 26, 26, 26, 27, 25, 29, 26, 25, 27, 27, 28, 26, 28, 25, 26, 25, 26, 26, 26, 28, 29, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 334.9377529227425, "mean_inference_ms": 2.072599206780996, "mean_action_processing_ms": 0.14469936968266342, "mean_env_wait_ms": 10.678721659052623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010222911834716797, "StateBufferConnector_ms": 0.006642341613769531, "ViewRequirementAgentConnector_ms": 0.17989802360534668}}, "episode_reward_max": 2.0166223558908576, "episode_reward_min": -69.98529928336657, "episode_reward_mean": -25.47291692336141, "episode_len_mean": 27.36, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.212378860192928, -59.95619054157888, -39.3345674674815, -29.948680157632452, 0.03886274116272435, -39.956374373774906, -19.97419389834609, -39.63702730975357, -59.36212198813766, -69.96665584503639, -9.284208175225833, -69.98529928336657, -26.124433662724584, -49.141807585900935, -17.17943447988472, -29.977459345744144, -49.96982277640644, -9.943814259346837, -19.95342081915769, -45.84182337894532, -29.309326113386007, -39.98966862823484, -69.49714900272194, -8.575391835867833, -19.977741073732663, -58.75396266487803, -49.866253263156935, -39.9288429946244, -29.515757691959006, -9.983511656609066, -39.98344183074618, -29.78584379745684, -69.83722096049877, -9.1072234735025, -59.7348765277188, -19.978831811519083, -28.943799381010272, 0.9892000858575037, -29.960337863158838, -19.240672313519077, 0.2525406827989327, -24.91194967752843, -28.69230573773373, -39.96012237557918, -9.28171200296054, -9.675798066315288, -47.84005555785221, -19.493484676173505, -39.71157755644935, -59.89450088226704, -39.906791432808866, -39.29902695442473, -19.91326494243812, -29.823304456569883, -19.885227571337705, -49.86500237815711, 0.018115097086171508, -29.974997399876735, -29.299181759665963, -49.97200420133617, -69.86476215813056, -19.690745915189197, -19.422508414458907, -29.97458966897423, -8.656778394762744, -26.525775896097525, -16.917480301024675, -9.9771123608855, -19.953350832749788, -18.611463499442028, -6.064274932386252, 0.046537331422944105, -9.902009322504432, -4.985931409923819, -9.96007870055598, -15.181852773953743, 0.7821929617836004, -4.252576597435166, -9.518990069711036, -6.656288506469128, -17.558398745129278, 0.07121228745906508, -33.89452453635887, -9.96981888171514, 0.38716701072067317, -19.24974604064486, -19.527217924792573, -24.210278167023667, -7.264196134192387, -28.176224103115942, 2.0166223558908576, -9.990260500024524, 0.02433365755856388, -4.810229361095078, -6.913664880420416, -9.975665797056239, -29.82057535441971, -38.70033598565715, -42.866073856592806, 0.24517819742450728], "episode_lengths": [26, 31, 24, 28, 25, 29, 22, 29, 31, 32, 21, 32, 28, 30, 27, 23, 30, 26, 27, 30, 28, 24, 32, 26, 27, 26, 30, 29, 28, 26, 29, 28, 32, 26, 31, 27, 28, 25, 28, 27, 25, 28, 28, 29, 26, 26, 30, 27, 29, 31, 29, 29, 27, 28, 27, 30, 25, 28, 28, 30, 32, 27, 27, 28, 26, 28, 27, 26, 27, 27, 26, 25, 26, 26, 26, 27, 25, 26, 26, 26, 27, 25, 29, 26, 25, 27, 27, 28, 26, 28, 25, 26, 25, 26, 26, 26, 28, 29, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 334.9377529227425, "mean_inference_ms": 2.072599206780996, "mean_action_processing_ms": 0.14469936968266342, "mean_env_wait_ms": 10.678721659052623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010222911834716797, "StateBufferConnector_ms": 0.006642341613769531, "ViewRequirementAgentConnector_ms": 0.17989802360534668}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 15600, "num_env_steps_sampled": 9000, "num_env_steps_trained": 15600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7779189071394184, "num_env_steps_trained_throughput_per_sec": 7.366941868921866, "timesteps_total": 9000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 11094.048, "sample_time_ms": 11030.97, "load_time_ms": 0.261, "load_throughput": 299401.219, "learn_time_ms": 12.901, "learn_throughput": 6046.045, "synch_weights_time_ms": 12.805}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 15600, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 15600, "last_target_update_ts": 8840, "num_target_updates": 16}, "done": false, "episodes_total": 286, "training_iteration": 9, "trial_id": "2058a_00000", "date": "2024-04-17_05-49-56", "timestamp": 1713332996, "time_this_iter_s": 264.70400404930115, "time_total_s": 1770.7825045585632, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 1770.7825045585632, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 10.851329787234043, "ram_util_percent": 13.715957446808508}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0628521591424942, "cur_lr": 0.01}, "td_error": [2.063257932662964, 1.8601312637329102, 2.099699020385742, 3.306323289871216, 1.4268970489501953, 1.0514439344406128, 2.0650265216827393, 0.9898855090141296, 2.0305514335632324, 2.275785207748413, 1.1622915267944336, 1.3402518033981323, 2.06630802154541, 1.880511999130249, 1.4261494874954224, 2.0585830211639404, 2.058915376663208, 2.065612316131592, 0.9735437631607056, 2.0653276443481445, 0.9897640347480774, 1.00758695602417, 2.0587337017059326, 2.0583996772766113, 1.7058438062667847, 2.1571521759033203, 1.3318116664886475, 1.2142298221588135, 1.880706548690796, 2.058459758758545, 1.0303146839141846, 2.0801730155944824, 2.065807580947876, 0.9744493365287781, 2.06522274017334, 1.4247857332229614, 2.087538957595825, 2.1302883625030518, 2.059075117111206, 2.05835223197937, 2.0871529579162598, 1.8602466583251953, 1.4417754411697388, 1.880666732788086, 0.3866606056690216, 2.8426928520202637, 2.0648255348205566, 1.3733365535736084, 0.9735437631607056, 0.47974011301994324, 0.9735437631607056, 2.0861384868621826, 2.065427303314209, 2.0687708854675293, 2.0605404376983643, 2.065065860748291, 2.0589962005615234, 1.879207730293274, 2.058271884918213, 1.8602633476257324, 2.064771890640259, 1.1605350971221924, 1.1605350971221924, 1.340991497039795, 2.0861642360687256, 2.069596767425537, 2.065828323364258, 0.9735437631607056, 1.4368411302566528, 2.0668070316314697, 2.064662218093872, 0.9924499988555908, 1.8602571487426758, 2.0582780838012695, 1.0922778844833374, 1.8805174827575684, 1.4321174621582031, 2.7176003456115723], "mean_td_error": 1.7409722805023193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 225.0, "diff_num_grad_updates_vs_sampler_policy": 224.0}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 17550, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 17550, "last_target_update_ts": 9880, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": 3.8062521693888347, "episode_reward_min": -69.86476215813056, "episode_reward_mean": -14.895407398500529, "episode_len_mean": 26.59, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.960337863158838, -19.240672313519077, 0.2525406827989327, -24.91194967752843, -28.69230573773373, -39.96012237557918, -9.28171200296054, -9.675798066315288, -47.84005555785221, -19.493484676173505, -39.71157755644935, -59.89450088226704, -39.906791432808866, -39.29902695442473, -19.91326494243812, -29.823304456569883, -19.885227571337705, -49.86500237815711, 0.018115097086171508, -29.974997399876735, -29.299181759665963, -49.97200420133617, -69.86476215813056, -19.690745915189197, -19.422508414458907, -29.97458966897423, -8.656778394762744, -26.525775896097525, -16.917480301024675, -9.9771123608855, -19.953350832749788, -18.611463499442028, -6.064274932386252, 0.046537331422944105, -9.902009322504432, -4.985931409923819, -9.96007870055598, -15.181852773953743, 0.7821929617836004, -4.252576597435166, -9.518990069711036, -6.656288506469128, -17.558398745129278, 0.07121228745906508, -33.89452453635887, -9.96981888171514, 0.38716701072067317, -19.24974604064486, -19.527217924792573, -24.210278167023667, -7.264196134192387, -28.176224103115942, 2.0166223558908576, -9.990260500024524, 0.02433365755856388, -4.810229361095078, -6.913664880420416, -9.975665797056239, -29.82057535441971, -38.70033598565715, -42.866073856592806, 0.24517819742450728, 0.16022851212585915, -9.743852223319838, 0.03084795888700479, 0.022916669654048785, 0.017525332747150606, 3.8062521693888347, 0.03492806130026297, -9.847689772636887, 0.02277079761067674, 0.4535085941613514, -29.958392850511117, -39.97281779035228, 0.023800001642524424, 0.022501907331261083, 0.014756534557716264, 0.15240599735620142, -19.52148785638002, -19.8797543353278, 0.027695924313595147, 0.1300119241976806, 0.029935459906037507, -19.978460161892652, 0.012654460189382525, -9.983730326409452, -15.474551573925766, -19.83540688814628, -9.953419791006734, -9.913125530618599, 0.1910723412560223, 0.03404912044869369, 0.024316334445239812, -9.981311866535284, -9.985957409983993, -9.935183764438971, 0.06308646338764856, 0.7116905994220141, 0.2118069619326092, -9.97316158792855], "episode_lengths": [28, 27, 25, 28, 28, 29, 26, 26, 30, 27, 29, 31, 29, 29, 27, 28, 27, 30, 25, 28, 28, 30, 32, 27, 27, 28, 26, 28, 27, 26, 27, 27, 26, 25, 26, 26, 26, 27, 25, 26, 26, 26, 27, 25, 29, 26, 25, 27, 27, 28, 26, 28, 25, 26, 25, 26, 26, 26, 28, 29, 30, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 28, 29, 25, 25, 25, 25, 27, 27, 25, 25, 25, 27, 25, 26, 27, 27, 26, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 343.5019759247943, "mean_inference_ms": 2.0760306701465896, "mean_action_processing_ms": 0.14478738231795912, "mean_env_wait_ms": 9.48044268478439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010537385940551758, "StateBufferConnector_ms": 0.006579875946044922, "ViewRequirementAgentConnector_ms": 0.17826318740844727}}, "episode_reward_max": 3.8062521693888347, "episode_reward_min": -69.86476215813056, "episode_reward_mean": -14.895407398500529, "episode_len_mean": 26.59, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29.960337863158838, -19.240672313519077, 0.2525406827989327, -24.91194967752843, -28.69230573773373, -39.96012237557918, -9.28171200296054, -9.675798066315288, -47.84005555785221, -19.493484676173505, -39.71157755644935, -59.89450088226704, -39.906791432808866, -39.29902695442473, -19.91326494243812, -29.823304456569883, -19.885227571337705, -49.86500237815711, 0.018115097086171508, -29.974997399876735, -29.299181759665963, -49.97200420133617, -69.86476215813056, -19.690745915189197, -19.422508414458907, -29.97458966897423, -8.656778394762744, -26.525775896097525, -16.917480301024675, -9.9771123608855, -19.953350832749788, -18.611463499442028, -6.064274932386252, 0.046537331422944105, -9.902009322504432, -4.985931409923819, -9.96007870055598, -15.181852773953743, 0.7821929617836004, -4.252576597435166, -9.518990069711036, -6.656288506469128, -17.558398745129278, 0.07121228745906508, -33.89452453635887, -9.96981888171514, 0.38716701072067317, -19.24974604064486, -19.527217924792573, -24.210278167023667, -7.264196134192387, -28.176224103115942, 2.0166223558908576, -9.990260500024524, 0.02433365755856388, -4.810229361095078, -6.913664880420416, -9.975665797056239, -29.82057535441971, -38.70033598565715, -42.866073856592806, 0.24517819742450728, 0.16022851212585915, -9.743852223319838, 0.03084795888700479, 0.022916669654048785, 0.017525332747150606, 3.8062521693888347, 0.03492806130026297, -9.847689772636887, 0.02277079761067674, 0.4535085941613514, -29.958392850511117, -39.97281779035228, 0.023800001642524424, 0.022501907331261083, 0.014756534557716264, 0.15240599735620142, -19.52148785638002, -19.8797543353278, 0.027695924313595147, 0.1300119241976806, 0.029935459906037507, -19.978460161892652, 0.012654460189382525, -9.983730326409452, -15.474551573925766, -19.83540688814628, -9.953419791006734, -9.913125530618599, 0.1910723412560223, 0.03404912044869369, 0.024316334445239812, -9.981311866535284, -9.985957409983993, -9.935183764438971, 0.06308646338764856, 0.7116905994220141, 0.2118069619326092, -9.97316158792855], "episode_lengths": [28, 27, 25, 28, 28, 29, 26, 26, 30, 27, 29, 31, 29, 29, 27, 28, 27, 30, 25, 28, 28, 30, 32, 27, 27, 28, 26, 28, 27, 26, 27, 27, 26, 25, 26, 26, 26, 27, 25, 26, 26, 26, 27, 25, 29, 26, 25, 27, 27, 28, 26, 28, 25, 26, 25, 26, 26, 26, 28, 29, 30, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 28, 29, 25, 25, 25, 25, 27, 27, 25, 25, 25, 27, 25, 26, 27, 27, 26, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 343.5019759247943, "mean_inference_ms": 2.0760306701465896, "mean_action_processing_ms": 0.14478738231795912, "mean_env_wait_ms": 9.48044268478439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010537385940551758, "StateBufferConnector_ms": 0.006579875946044922, "ViewRequirementAgentConnector_ms": 0.17826318740844727}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 17550, "num_env_steps_sampled": 10000, "num_env_steps_trained": 17550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.1382789614038895, "num_env_steps_trained_throughput_per_sec": 8.069643974737584, "timesteps_total": 10000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 8832.266, "sample_time_ms": 8769.378, "load_time_ms": 0.232, "load_throughput": 335716.482, "learn_time_ms": 12.812, "learn_throughput": 6088.011, "synch_weights_time_ms": 11.422}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 17550, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 17550, "last_target_update_ts": 9880, "num_target_updates": 18}, "done": false, "episodes_total": 324, "training_iteration": 10, "trial_id": "2058a_00000", "date": "2024-04-17_05-53-58", "timestamp": 1713333238, "time_this_iter_s": 241.65515875816345, "time_total_s": 2012.4376633167267, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 2012.4376633167267, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.63517441860465, "ram_util_percent": 13.801744186046513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.08280343562364578, "cur_lr": 0.01}, "td_error": [1.1967183351516724, 3.3205840587615967, 2.0350799560546875, 1.369244933128357, 2.0438544750213623, 2.0847599506378174, 2.035639762878418, 0.391658216714859, 2.0350167751312256, 0.43490836024284363, 1.2786122560501099, 1.3536895513534546, 2.0735576152801514, 2.043872356414795, 1.081961750984192, 1.496095061302185, 2.0350897312164307, 2.071413993835449, 2.8098127841949463, 1.4503408670425415, 0.9691632986068726, 2.0352609157562256, 1.458925485610962, 2.348785161972046, 2.0771117210388184, 2.0756821632385254, 2.0351345539093018, 2.0813827514648438, 2.1156513690948486, 2.0450100898742676, 0.9695548415184021, 0.391658216714859, 0.9553730487823486, 0.9554072618484497, 1.7466315031051636, 1.1967183351516724, 1.1975195407867432, 0.9695869088172913, 1.444956660270691, 1.9821845293045044, 2.9419000148773193, 2.0327510833740234, 2.0350263118743896, 1.1967183351516724, 2.0356476306915283, 2.035017967224121, 1.497301459312439, 2.0350379943847656, 2.053032636642456, 2.044539213180542, 1.199302315711975, 2.03498911857605, 2.0444796085357666, 2.0368964672088623, 2.035055637359619, 2.035515546798706, 1.367392897605896, 3.2055068016052246, 1.7534935474395752, 2.0447421073913574, 2.0351579189300537, 0.970198929309845, 2.035334348678589, 2.044764757156372, 1.0811201333999634, 2.0443053245544434, 2.0353121757507324, 1.746667504310608, 2.0350069999694824, 0.391658216714859, 2.0445258617401123, 2.0443992614746094, 2.044557809829712, 1.0811201333999634, 0.9686129689216614, 2.0460197925567627, 0.43490836024284363, 2.0452983379364014], "mean_td_error": 1.7241913080215454, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 250.0, "diff_num_grad_updates_vs_sampler_policy": 249.0}}, "num_env_steps_sampled": 11000, "num_env_steps_trained": 19500, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 19500, "last_target_update_ts": 10920, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": 3.8062521693888347, "episode_reward_min": -42.866073856592806, "episode_reward_mean": -6.416607465838609, "episode_len_mean": 25.7, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.518990069711036, -6.656288506469128, -17.558398745129278, 0.07121228745906508, -33.89452453635887, -9.96981888171514, 0.38716701072067317, -19.24974604064486, -19.527217924792573, -24.210278167023667, -7.264196134192387, -28.176224103115942, 2.0166223558908576, -9.990260500024524, 0.02433365755856388, -4.810229361095078, -6.913664880420416, -9.975665797056239, -29.82057535441971, -38.70033598565715, -42.866073856592806, 0.24517819742450728, 0.16022851212585915, -9.743852223319838, 0.03084795888700479, 0.022916669654048785, 0.017525332747150606, 3.8062521693888347, 0.03492806130026297, -9.847689772636887, 0.02277079761067674, 0.4535085941613514, -29.958392850511117, -39.97281779035228, 0.023800001642524424, 0.022501907331261083, 0.014756534557716264, 0.15240599735620142, -19.52148785638002, -19.8797543353278, 0.027695924313595147, 0.1300119241976806, 0.029935459906037507, -19.978460161892652, 0.012654460189382525, -9.983730326409452, -15.474551573925766, -19.83540688814628, -9.953419791006734, -9.913125530618599, 0.1910723412560223, 0.03404912044869369, 0.024316334445239812, -9.981311866535284, -9.985957409983993, -9.935183764438971, 0.06308646338764856, 0.7116905994220141, 0.2118069619326092, -9.97316158792855, 0.015790671631093593, -9.984024163984655, 0.05454758602184321, 0.013520497716166188, -9.990668206725822, -9.986967556204677, 0.013565947862749256, -9.993046036042271, 0.009011405102864063, 0.006001908592091782, 0.020856809126751592, 0.012951367813528541, -9.537605429758708, 0.010760131735059792, 0.00690387455834439, 0.016095929011391653, 0.014536620663174224, 0.01334576745640758, 0.009847004713705632, 0.009946679086875682, 0.010272224148989392, 0.01699220548062575, 0.009545783444809554, 0.009273143679413022, 0.004100038377032981, 0.01975835581039967, 0.017252289019762796, 0.5539018601546474, 0.010720293423389895, 0.005443610757852175, -9.986527105819658, 0.00849099786886337, 0.22860390637286018, 0.009829450118450893, -9.993482704479474, -9.982133820871805, 0.7235139108966856, 0.016536131881367013, 0.010124254515095969, 0.009184721501479911], "episode_lengths": [26, 26, 27, 25, 29, 26, 25, 27, 27, 28, 26, 28, 25, 26, 25, 26, 26, 26, 28, 29, 30, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 28, 29, 25, 25, 25, 25, 27, 27, 25, 25, 25, 27, 25, 26, 27, 27, 26, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 25, 26, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 351.1757063083156, "mean_inference_ms": 2.080680274025547, "mean_action_processing_ms": 0.1448558264053197, "mean_env_wait_ms": 8.514284498339416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011567354202270508, "StateBufferConnector_ms": 0.006509542465209961, "ViewRequirementAgentConnector_ms": 0.1798861026763916}}, "episode_reward_max": 3.8062521693888347, "episode_reward_min": -42.866073856592806, "episode_reward_mean": -6.416607465838609, "episode_len_mean": 25.7, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.518990069711036, -6.656288506469128, -17.558398745129278, 0.07121228745906508, -33.89452453635887, -9.96981888171514, 0.38716701072067317, -19.24974604064486, -19.527217924792573, -24.210278167023667, -7.264196134192387, -28.176224103115942, 2.0166223558908576, -9.990260500024524, 0.02433365755856388, -4.810229361095078, -6.913664880420416, -9.975665797056239, -29.82057535441971, -38.70033598565715, -42.866073856592806, 0.24517819742450728, 0.16022851212585915, -9.743852223319838, 0.03084795888700479, 0.022916669654048785, 0.017525332747150606, 3.8062521693888347, 0.03492806130026297, -9.847689772636887, 0.02277079761067674, 0.4535085941613514, -29.958392850511117, -39.97281779035228, 0.023800001642524424, 0.022501907331261083, 0.014756534557716264, 0.15240599735620142, -19.52148785638002, -19.8797543353278, 0.027695924313595147, 0.1300119241976806, 0.029935459906037507, -19.978460161892652, 0.012654460189382525, -9.983730326409452, -15.474551573925766, -19.83540688814628, -9.953419791006734, -9.913125530618599, 0.1910723412560223, 0.03404912044869369, 0.024316334445239812, -9.981311866535284, -9.985957409983993, -9.935183764438971, 0.06308646338764856, 0.7116905994220141, 0.2118069619326092, -9.97316158792855, 0.015790671631093593, -9.984024163984655, 0.05454758602184321, 0.013520497716166188, -9.990668206725822, -9.986967556204677, 0.013565947862749256, -9.993046036042271, 0.009011405102864063, 0.006001908592091782, 0.020856809126751592, 0.012951367813528541, -9.537605429758708, 0.010760131735059792, 0.00690387455834439, 0.016095929011391653, 0.014536620663174224, 0.01334576745640758, 0.009847004713705632, 0.009946679086875682, 0.010272224148989392, 0.01699220548062575, 0.009545783444809554, 0.009273143679413022, 0.004100038377032981, 0.01975835581039967, 0.017252289019762796, 0.5539018601546474, 0.010720293423389895, 0.005443610757852175, -9.986527105819658, 0.00849099786886337, 0.22860390637286018, 0.009829450118450893, -9.993482704479474, -9.982133820871805, 0.7235139108966856, 0.016536131881367013, 0.010124254515095969, 0.009184721501479911], "episode_lengths": [26, 26, 27, 25, 29, 26, 25, 27, 27, 28, 26, 28, 25, 26, 25, 26, 26, 26, 28, 29, 30, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 28, 29, 25, 25, 25, 25, 27, 27, 25, 25, 25, 27, 25, 26, 27, 27, 26, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 25, 26, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 351.1757063083156, "mean_inference_ms": 2.080680274025547, "mean_action_processing_ms": 0.1448558264053197, "mean_env_wait_ms": 8.514284498339416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011567354202270508, "StateBufferConnector_ms": 0.006509542465209961, "ViewRequirementAgentConnector_ms": 0.1798861026763916}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 19500, "num_env_steps_sampled": 11000, "num_env_steps_trained": 19500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.623077600382926, "num_env_steps_trained_throughput_per_sec": 7.065001320746705, "timesteps_total": 11000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 11000, "timers": {"training_iteration_time_ms": 11150.23, "sample_time_ms": 11088.406, "load_time_ms": 0.245, "load_throughput": 318461.707, "learn_time_ms": 13.646, "learn_throughput": 5715.818, "synch_weights_time_ms": 11.31}, "counters": {"num_env_steps_sampled": 11000, "num_env_steps_trained": 19500, "num_agent_steps_sampled": 11000, "num_agent_steps_trained": 19500, "last_target_update_ts": 10920, "num_target_updates": 20}, "done": false, "episodes_total": 364, "training_iteration": 11, "trial_id": "2058a_00000", "date": "2024-04-17_05-58-34", "timestamp": 1713333514, "time_this_iter_s": 276.0171163082123, "time_total_s": 2288.454779624939, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 2288.454779624939, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 10.811959287531808, "ram_util_percent": 13.90814249363868}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.061524130403995514, "cur_lr": 0.01}, "td_error": [1.6747803688049316, 2.1472229957580566, 2.6853179931640625, 3.207367420196533, 2.038288116455078, 1.7723501920700073, 2.0651614665985107, 2.0382885932922363, 1.1420412063598633, 1.3310414552688599, 1.332542896270752, 2.0382611751556396, 2.0781915187835693, 2.081864356994629, 2.0387473106384277, 2.038358688354492, 1.5320838689804077, 0.34722796082496643, 2.0382583141326904, 2.0653138160705566, 2.0382776260375977, 2.0684211254119873, 2.0751521587371826, 1.6747777462005615, 2.0382943153381348, 0.34722796082496643, 1.527471661567688, 2.0385489463806152, 0.9640371799468994, 2.0387096405029297, 2.064710855484009, 2.1304121017456055, 2.065288782119751, 2.9645252227783203, 2.0652129650115967, 1.1447594165802002, 0.9709914326667786, 2.038311719894409, 2.0385892391204834, 2.0382909774780273, 1.3279659748077393, 1.772202968597412, 0.9897258877754211, 2.038257122039795, 1.5275015830993652, 2.0382909774780273, 0.34722796082496643, 2.0973987579345703, 2.038273572921753, 2.0382561683654785, 0.34722796082496643, 2.095684289932251, 1.3334321975708008, 1.5378015041351318, 2.0653886795043945, 1.5274913311004639, 1.5366679430007935, 0.3998899757862091, 2.0382723808288574, 2.0387587547302246, 2.038299083709717, 1.527479648590088, 0.9788506031036377, 2.066145658493042, 1.358805537223816, 2.0665252208709717, 1.3452857732772827, 2.0386123657226562, 2.0383517742156982, 2.094663143157959, 1.3332936763763428, 2.065448045730591, 2.0382943153381348, 2.8324339389801025, 2.1043782234191895, 2.093205451965332, 0.3998899757862091, 1.6508586406707764], "mean_td_error": 1.7593752145767212, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 274.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 21450, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 21450, "last_target_update_ts": 11960, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": 3.204996100565248, "episode_reward_min": -19.997473737794238, "episode_reward_mean": -2.548437763712651, "episode_len_mean": 25.27, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.027695924313595147, 0.1300119241976806, 0.029935459906037507, -19.978460161892652, 0.012654460189382525, -9.983730326409452, -15.474551573925766, -19.83540688814628, -9.953419791006734, -9.913125530618599, 0.1910723412560223, 0.03404912044869369, 0.024316334445239812, -9.981311866535284, -9.985957409983993, -9.935183764438971, 0.06308646338764856, 0.7116905994220141, 0.2118069619326092, -9.97316158792855, 0.015790671631093593, -9.984024163984655, 0.05454758602184321, 0.013520497716166188, -9.990668206725822, -9.986967556204677, 0.013565947862749256, -9.993046036042271, 0.009011405102864063, 0.006001908592091782, 0.020856809126751592, 0.012951367813528541, -9.537605429758708, 0.010760131735059792, 0.00690387455834439, 0.016095929011391653, 0.014536620663174224, 0.01334576745640758, 0.009847004713705632, 0.009946679086875682, 0.010272224148989392, 0.01699220548062575, 0.009545783444809554, 0.009273143679413022, 0.004100038377032981, 0.01975835581039967, 0.017252289019762796, 0.5539018601546474, 0.010720293423389895, 0.005443610757852175, -9.986527105819658, 0.00849099786886337, 0.22860390637286018, 0.009829450118450893, -9.993482704479474, -9.982133820871805, 0.7235139108966856, 0.016536131881367013, 0.010124254515095969, 0.009184721501479911, 0.0038942937407420745, 2.2442218457390735, -9.997350496601618, -19.997473737794238, 0.002404247486428814, 0.002758179409810016, 0.0026500815293491763, 0.5234843281799978, 0.0038005645607028056, 0.0023260282369073466, 0.004002901572732287, -9.996065623406047, 0.003957675889675517, 0.005106565984443518, 0.0025320071366368426, 0.006902640498418699, 0.0027692124788677728, 0.0026528863817922377, 0.004380380102006958, 0.008763172081870238, 0.00395306865370266, 0.003845541224429055, 0.1890442729181713, 0.0027392796611574372, 0.0046730802503677235, 0.005491109803050707, -9.997106766383931, 0.0027745023939848364, 0.002657740664463572, -9.995632192441166, 0.00407142870748644, 0.004792641406388323, 0.002948507891571767, 0.002816982746840828, 0.00376586571482766, 0.005720866176334401, 0.0030201226845636823, 3.204996100565248, 0.004525959677044075, 0.0026273199434905794], "episode_lengths": [25, 25, 25, 27, 25, 26, 27, 27, 26, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 25, 26, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 357.9983495576448, "mean_inference_ms": 2.082718406327127, "mean_action_processing_ms": 0.1448319986758881, "mean_env_wait_ms": 7.7397930404300315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011413812637329102, "StateBufferConnector_ms": 0.006540775299072266, "ViewRequirementAgentConnector_ms": 0.17648625373840332}}, "episode_reward_max": 3.204996100565248, "episode_reward_min": -19.997473737794238, "episode_reward_mean": -2.548437763712651, "episode_len_mean": 25.27, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.027695924313595147, 0.1300119241976806, 0.029935459906037507, -19.978460161892652, 0.012654460189382525, -9.983730326409452, -15.474551573925766, -19.83540688814628, -9.953419791006734, -9.913125530618599, 0.1910723412560223, 0.03404912044869369, 0.024316334445239812, -9.981311866535284, -9.985957409983993, -9.935183764438971, 0.06308646338764856, 0.7116905994220141, 0.2118069619326092, -9.97316158792855, 0.015790671631093593, -9.984024163984655, 0.05454758602184321, 0.013520497716166188, -9.990668206725822, -9.986967556204677, 0.013565947862749256, -9.993046036042271, 0.009011405102864063, 0.006001908592091782, 0.020856809126751592, 0.012951367813528541, -9.537605429758708, 0.010760131735059792, 0.00690387455834439, 0.016095929011391653, 0.014536620663174224, 0.01334576745640758, 0.009847004713705632, 0.009946679086875682, 0.010272224148989392, 0.01699220548062575, 0.009545783444809554, 0.009273143679413022, 0.004100038377032981, 0.01975835581039967, 0.017252289019762796, 0.5539018601546474, 0.010720293423389895, 0.005443610757852175, -9.986527105819658, 0.00849099786886337, 0.22860390637286018, 0.009829450118450893, -9.993482704479474, -9.982133820871805, 0.7235139108966856, 0.016536131881367013, 0.010124254515095969, 0.009184721501479911, 0.0038942937407420745, 2.2442218457390735, -9.997350496601618, -19.997473737794238, 0.002404247486428814, 0.002758179409810016, 0.0026500815293491763, 0.5234843281799978, 0.0038005645607028056, 0.0023260282369073466, 0.004002901572732287, -9.996065623406047, 0.003957675889675517, 0.005106565984443518, 0.0025320071366368426, 0.006902640498418699, 0.0027692124788677728, 0.0026528863817922377, 0.004380380102006958, 0.008763172081870238, 0.00395306865370266, 0.003845541224429055, 0.1890442729181713, 0.0027392796611574372, 0.0046730802503677235, 0.005491109803050707, -9.997106766383931, 0.0027745023939848364, 0.002657740664463572, -9.995632192441166, 0.00407142870748644, 0.004792641406388323, 0.002948507891571767, 0.002816982746840828, 0.00376586571482766, 0.005720866176334401, 0.0030201226845636823, 3.204996100565248, 0.004525959677044075, 0.0026273199434905794], "episode_lengths": [25, 25, 25, 27, 25, 26, 27, 27, 26, 26, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 25, 26, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 357.9983495576448, "mean_inference_ms": 2.082718406327127, "mean_action_processing_ms": 0.1448319986758881, "mean_env_wait_ms": 7.7397930404300315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011413812637329102, "StateBufferConnector_ms": 0.006540775299072266, "ViewRequirementAgentConnector_ms": 0.17648625373840332}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 21450, "num_env_steps_sampled": 12000, "num_env_steps_trained": 21450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.6345349519781363, "num_env_steps_trained_throughput_per_sec": 7.087343156357366, "timesteps_total": 12000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11057.416, "sample_time_ms": 10998.295, "load_time_ms": 0.233, "load_throughput": 334241.635, "learn_time_ms": 12.9, "learn_throughput": 6046.279, "synch_weights_time_ms": 10.84}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 21450, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 21450, "last_target_update_ts": 11960, "num_target_updates": 22}, "done": false, "episodes_total": 404, "training_iteration": 12, "trial_id": "2058a_00000", "date": "2024-04-17_06-03-09", "timestamp": 1713333789, "time_this_iter_s": 275.1466510295868, "time_total_s": 2563.6014306545258, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 2563.6014306545258, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 10.864450127877237, "ram_util_percent": 13.992327365728901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.031842879951000214, "cur_lr": 0.01}, "td_error": [2.019625186920166, 2.0246095657348633, 1.7387220859527588, 1.320904016494751, 2.0197043418884277, 1.3133020401000977, 2.0107781887054443, 2.010789155960083, 2.0119433403015137, 2.0107882022857666, 2.0107808113098145, 3.2959718704223633, 0.8950743675231934, 2.0110576152801514, 2.019716262817383, 2.0107674598693848, 2.0234780311584473, 2.0208592414855957, 1.0549029111862183, 1.3248094320297241, 2.0577616691589355, 2.0347092151641846, 1.4717063903808594, 2.0215156078338623, 2.0108182430267334, 1.3927172422409058, 2.0108277797698975, 2.0107922554016113, 2.1841368675231934, 2.023850440979004, 3.40714693069458, 2.0113606452941895, 2.221832275390625, 0.8977386951446533, 1.4721086025238037, 2.0949156284332275, 2.0113697052001953, 2.0110061168670654, 2.012239694595337, 2.0107717514038086, 2.1434361934661865, 2.010836362838745, 1.4323257207870483, 2.0115113258361816, 0.9084481596946716, 2.010812759399414, 1.4320659637451172, 1.7130573987960815, 2.0107884407043457, 1.4717339277267456, 2.05810546875, 2.0110623836517334, 2.0703201293945312, 3.0587105751037598, 2.010793924331665, 0.8972628116607666, 2.0556375980377197, 2.0116260051727295, 1.925821304321289, 2.0202138423919678, 2.020221710205078, 3.089921712875366, 2.095554828643799, 2.0108909606933594, 0.8960431814193726, 0.8898491263389587, 2.0107812881469727, 2.0220773220062256, 2.0581533908843994, 2.0214836597442627, 2.0623342990875244, 2.1328892707824707, 2.010769844055176, 2.01336669921875, 2.0207417011260986, 0.348201721906662, 2.0107922554016113, 1.3197251558303833], "mean_td_error": 1.8822600841522217, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 300.0, "diff_num_grad_updates_vs_sampler_policy": 299.0}}, "num_env_steps_sampled": 13000, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 23400, "last_target_update_ts": 13000, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": 3.204996100565248, "episode_reward_min": -19.997473737794238, "episode_reward_mean": -1.2969843621735364, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.010272224148989392, 0.01699220548062575, 0.009545783444809554, 0.009273143679413022, 0.004100038377032981, 0.01975835581039967, 0.017252289019762796, 0.5539018601546474, 0.010720293423389895, 0.005443610757852175, -9.986527105819658, 0.00849099786886337, 0.22860390637286018, 0.009829450118450893, -9.993482704479474, -9.982133820871805, 0.7235139108966856, 0.016536131881367013, 0.010124254515095969, 0.009184721501479911, 0.0038942937407420745, 2.2442218457390735, -9.997350496601618, -19.997473737794238, 0.002404247486428814, 0.002758179409810016, 0.0026500815293491763, 0.5234843281799978, 0.0038005645607028056, 0.0023260282369073466, 0.004002901572732287, -9.996065623406047, 0.003957675889675517, 0.005106565984443518, 0.0025320071366368426, 0.006902640498418699, 0.0027692124788677728, 0.0026528863817922377, 0.004380380102006958, 0.008763172081870238, 0.00395306865370266, 0.003845541224429055, 0.1890442729181713, 0.0027392796611574372, 0.0046730802503677235, 0.005491109803050707, -9.997106766383931, 0.0027745023939848364, 0.002657740664463572, -9.995632192441166, 0.00407142870748644, 0.004792641406388323, 0.002948507891571767, 0.002816982746840828, 0.00376586571482766, 0.005720866176334401, 0.0030201226845636823, 3.204996100565248, 0.004525959677044075, 0.0026273199434905794, -9.997707065915295, 0.002195366033505545, 0.008330086667678576, -9.995572241345048, 0.0046943577082346755, 0.002221591051960983, 0.0041135453172500185, 0.004300198226106473, 0.001985927002284806, 0.004850483080884712, -9.997591366163986, 0.0023013957449337587, -8.129094935337957, 0.005907468098011043, 0.002056349905198789, 0.15009924961220206, 0.004841449175147329, 0.01193619331945785, 0.005621241957886676, 0.0019827714922031445, 0.002479951091900406, 0.002366287398811055, 0.0022858170292986337, 0.0036841354910279803, 0.0021029905361250305, 0.002416316052917438, 0.0023038161298955043, 0.010570734475042497, 0.008539345351112754, 0.0020610665259614344, 0.0036828685328043945, 0.002433275122434815, 0.005024601049502527, 0.006706810967851626, 0.002157096845412996, -9.997494079060237, 0.002385975707281802, 0.07459863549602834, 0.06481270829295845, 0.0021312322331830617], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 364.378773417254, "mean_inference_ms": 2.0837911526514965, "mean_action_processing_ms": 0.14478766327759618, "mean_env_wait_ms": 7.112064395924103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01063227653503418, "StateBufferConnector_ms": 0.0061872005462646484, "ViewRequirementAgentConnector_ms": 0.17272162437438965}}, "episode_reward_max": 3.204996100565248, "episode_reward_min": -19.997473737794238, "episode_reward_mean": -1.2969843621735364, "episode_len_mean": 25.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.010272224148989392, 0.01699220548062575, 0.009545783444809554, 0.009273143679413022, 0.004100038377032981, 0.01975835581039967, 0.017252289019762796, 0.5539018601546474, 0.010720293423389895, 0.005443610757852175, -9.986527105819658, 0.00849099786886337, 0.22860390637286018, 0.009829450118450893, -9.993482704479474, -9.982133820871805, 0.7235139108966856, 0.016536131881367013, 0.010124254515095969, 0.009184721501479911, 0.0038942937407420745, 2.2442218457390735, -9.997350496601618, -19.997473737794238, 0.002404247486428814, 0.002758179409810016, 0.0026500815293491763, 0.5234843281799978, 0.0038005645607028056, 0.0023260282369073466, 0.004002901572732287, -9.996065623406047, 0.003957675889675517, 0.005106565984443518, 0.0025320071366368426, 0.006902640498418699, 0.0027692124788677728, 0.0026528863817922377, 0.004380380102006958, 0.008763172081870238, 0.00395306865370266, 0.003845541224429055, 0.1890442729181713, 0.0027392796611574372, 0.0046730802503677235, 0.005491109803050707, -9.997106766383931, 0.0027745023939848364, 0.002657740664463572, -9.995632192441166, 0.00407142870748644, 0.004792641406388323, 0.002948507891571767, 0.002816982746840828, 0.00376586571482766, 0.005720866176334401, 0.0030201226845636823, 3.204996100565248, 0.004525959677044075, 0.0026273199434905794, -9.997707065915295, 0.002195366033505545, 0.008330086667678576, -9.995572241345048, 0.0046943577082346755, 0.002221591051960983, 0.0041135453172500185, 0.004300198226106473, 0.001985927002284806, 0.004850483080884712, -9.997591366163986, 0.0023013957449337587, -8.129094935337957, 0.005907468098011043, 0.002056349905198789, 0.15009924961220206, 0.004841449175147329, 0.01193619331945785, 0.005621241957886676, 0.0019827714922031445, 0.002479951091900406, 0.002366287398811055, 0.0022858170292986337, 0.0036841354910279803, 0.0021029905361250305, 0.002416316052917438, 0.0023038161298955043, 0.010570734475042497, 0.008539345351112754, 0.0020610665259614344, 0.0036828685328043945, 0.002433275122434815, 0.005024601049502527, 0.006706810967851626, 0.002157096845412996, -9.997494079060237, 0.002385975707281802, 0.07459863549602834, 0.06481270829295845, 0.0021312322331830617], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 364.378773417254, "mean_inference_ms": 2.0837911526514965, "mean_action_processing_ms": 0.14478766327759618, "mean_env_wait_ms": 7.112064395924103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01063227653503418, "StateBufferConnector_ms": 0.0061872005462646484, "ViewRequirementAgentConnector_ms": 0.17272162437438965}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 23400, "num_env_steps_sampled": 13000, "num_env_steps_trained": 23400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.6369822395703473, "num_env_steps_trained_throughput_per_sec": 7.092115367162177, "timesteps_total": 13000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 13000, "timers": {"training_iteration_time_ms": 11018.182, "sample_time_ms": 10959.535, "load_time_ms": 0.252, "load_throughput": 309045.638, "learn_time_ms": 12.412, "learn_throughput": 6284.133, "synch_weights_time_ms": 10.845}, "counters": {"num_env_steps_sampled": 13000, "num_env_steps_trained": 23400, "num_agent_steps_sampled": 13000, "num_agent_steps_trained": 23400, "last_target_update_ts": 13000, "num_target_updates": 24}, "done": false, "episodes_total": 444, "training_iteration": 13, "trial_id": "2058a_00000", "date": "2024-04-17_06-07-44", "timestamp": 1713334064, "time_this_iter_s": 274.9621467590332, "time_total_s": 2838.563577413559, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 2838.563577413559, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 10.802046035805628, "ram_util_percent": 14.083631713554983}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04991276189684868, "cur_lr": 0.01}, "td_error": [2.0472309589385986, 1.9872595071792603, 1.9872678518295288, 2.002129316329956, 1.9872556924819946, 3.3270702362060547, 2.0022857189178467, 1.6237025260925293, 2.009571075439453, 2.0028648376464844, 1.987247347831726, 1.987257480621338, 1.9872552156448364, 1.70809006690979, 2.00276517868042, 0.37401282787323, 1.9872604608535767, 2.181934356689453, 1.9872812032699585, 1.9872915744781494, 1.98729407787323, 1.9872640371322632, 0.8389419913291931, 1.9872690439224243, 1.4144082069396973, 1.9872705936431885, 3.4288744926452637, 1.9872819185256958, 2.1880877017974854, 2.965622901916504, 1.9875516891479492, 1.7080923318862915, 2.0461041927337646, 2.002324104309082, 2.0029826164245605, 1.987350344657898, 1.9872596263885498, 1.4500383138656616, 2.0033438205718994, 0.8404346108436584, 3.509702682495117, 1.622126817703247, 2.0031521320343018, 1.3339914083480835, 1.5562514066696167, 1.4140267372131348, 1.9875264167785645, 2.048153877258301, 2.0046768188476562, 1.987450122833252, 0.8601289987564087, 3.4815120697021484, 1.3289231061935425, 1.9872781038284302, 1.414330244064331, 1.623633861541748, 2.047480344772339, 1.9872922897338867, 1.9872596263885498, 1.623708963394165, 1.0757908821105957, 1.987298846244812, 2.0029494762420654, 2.072403907775879, 1.8660423755645752, 1.9873051643371582, 2.002230644226074, 1.9873026609420776, 1.9872779846191406, 2.0019729137420654, 3.434297561645508, 2.0049972534179688, 1.9872595071792603, 1.9872909784317017, 1.9872617721557617, 2.009322166442871, 1.9872491359710693, 1.9874578714370728], "mean_td_error": 1.9502456188201904, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 325.0, "diff_num_grad_updates_vs_sampler_policy": 324.0}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 25350, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 25350, "last_target_update_ts": 13520, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": 3.204996100565248, "episode_reward_min": -19.998251638901113, "episode_reward_mean": -1.504802570040869, "episode_len_mean": 25.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00395306865370266, 0.003845541224429055, 0.1890442729181713, 0.0027392796611574372, 0.0046730802503677235, 0.005491109803050707, -9.997106766383931, 0.0027745023939848364, 0.002657740664463572, -9.995632192441166, 0.00407142870748644, 0.004792641406388323, 0.002948507891571767, 0.002816982746840828, 0.00376586571482766, 0.005720866176334401, 0.0030201226845636823, 3.204996100565248, 0.004525959677044075, 0.0026273199434905794, -9.997707065915295, 0.002195366033505545, 0.008330086667678576, -9.995572241345048, 0.0046943577082346755, 0.002221591051960983, 0.0041135453172500185, 0.004300198226106473, 0.001985927002284806, 0.004850483080884712, -9.997591366163986, 0.0023013957449337587, -8.129094935337957, 0.005907468098011043, 0.002056349905198789, 0.15009924961220206, 0.004841449175147329, 0.01193619331945785, 0.005621241957886676, 0.0019827714922031445, 0.002479951091900406, 0.002366287398811055, 0.0022858170292986337, 0.0036841354910279803, 0.0021029905361250305, 0.002416316052917438, 0.0023038161298955043, 0.010570734475042497, 0.008539345351112754, 0.0020610665259614344, 0.0036828685328043945, 0.002433275122434815, 0.005024601049502527, 0.006706810967851626, 0.002157096845412996, -9.997494079060237, 0.002385975707281802, 0.07459863549602834, 0.06481270829295845, 0.0021312322331830617, 0.0019127914877328552, 1.4548587979687988, 0.0018003684175923174, 0.0017413797276506964, 0.0016855878752662322, 0.001854847897037298, 0.001804866091929811, -19.998251638901113, 0.0016926708019458791, 0.11980758481211994, 0.004413295800453705, 0.001933768113854081, 0.005374012192711806, 0.005724314626036381, -9.998252543426489, 0.001919148989736205, 0.001865690809433877, 0.8369831300828048, 0.0017528598990279043, -9.998303653390005, 0.003735727733274986, 0.003921327761591097, 0.0019116377532533194, 0.0018452632537265925, 0.0017827364843641246, 0.0019827524986113197, 0.0019191311955456512, -9.998134320508862, -9.998194640976282, 0.0017460432264122868, 0.0020714575069448356, 0.0020021155586844148, 0.0019440041391688271, 0.001878605584293751, 0.0018144676211823063, -9.997956019215701, 1.2631550816880528, 0.0019060233911319688, -9.998146710287234, -9.998206051529577], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 369.8627312428268, "mean_inference_ms": 2.0865601024209974, "mean_action_processing_ms": 0.1448223143969008, "mean_env_wait_ms": 6.578869469077555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911537170410156, "StateBufferConnector_ms": 0.006274223327636719, "ViewRequirementAgentConnector_ms": 0.17127776145935059}}, "episode_reward_max": 3.204996100565248, "episode_reward_min": -19.998251638901113, "episode_reward_mean": -1.504802570040869, "episode_len_mean": 25.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00395306865370266, 0.003845541224429055, 0.1890442729181713, 0.0027392796611574372, 0.0046730802503677235, 0.005491109803050707, -9.997106766383931, 0.0027745023939848364, 0.002657740664463572, -9.995632192441166, 0.00407142870748644, 0.004792641406388323, 0.002948507891571767, 0.002816982746840828, 0.00376586571482766, 0.005720866176334401, 0.0030201226845636823, 3.204996100565248, 0.004525959677044075, 0.0026273199434905794, -9.997707065915295, 0.002195366033505545, 0.008330086667678576, -9.995572241345048, 0.0046943577082346755, 0.002221591051960983, 0.0041135453172500185, 0.004300198226106473, 0.001985927002284806, 0.004850483080884712, -9.997591366163986, 0.0023013957449337587, -8.129094935337957, 0.005907468098011043, 0.002056349905198789, 0.15009924961220206, 0.004841449175147329, 0.01193619331945785, 0.005621241957886676, 0.0019827714922031445, 0.002479951091900406, 0.002366287398811055, 0.0022858170292986337, 0.0036841354910279803, 0.0021029905361250305, 0.002416316052917438, 0.0023038161298955043, 0.010570734475042497, 0.008539345351112754, 0.0020610665259614344, 0.0036828685328043945, 0.002433275122434815, 0.005024601049502527, 0.006706810967851626, 0.002157096845412996, -9.997494079060237, 0.002385975707281802, 0.07459863549602834, 0.06481270829295845, 0.0021312322331830617, 0.0019127914877328552, 1.4548587979687988, 0.0018003684175923174, 0.0017413797276506964, 0.0016855878752662322, 0.001854847897037298, 0.001804866091929811, -19.998251638901113, 0.0016926708019458791, 0.11980758481211994, 0.004413295800453705, 0.001933768113854081, 0.005374012192711806, 0.005724314626036381, -9.998252543426489, 0.001919148989736205, 0.001865690809433877, 0.8369831300828048, 0.0017528598990279043, -9.998303653390005, 0.003735727733274986, 0.003921327761591097, 0.0019116377532533194, 0.0018452632537265925, 0.0017827364843641246, 0.0019827524986113197, 0.0019191311955456512, -9.998134320508862, -9.998194640976282, 0.0017460432264122868, 0.0020714575069448356, 0.0020021155586844148, 0.0019440041391688271, 0.001878605584293751, 0.0018144676211823063, -9.997956019215701, 1.2631550816880528, 0.0019060233911319688, -9.998146710287234, -9.998206051529577], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 369.8627312428268, "mean_inference_ms": 2.0865601024209974, "mean_action_processing_ms": 0.1448223143969008, "mean_env_wait_ms": 6.578869469077555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911537170410156, "StateBufferConnector_ms": 0.006274223327636719, "ViewRequirementAgentConnector_ms": 0.17127776145935059}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 25350, "num_env_steps_sampled": 14000, "num_env_steps_trained": 25350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7673149117267886, "num_env_steps_trained_throughput_per_sec": 7.346264077867238, "timesteps_total": 14000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 9910.716, "sample_time_ms": 9850.667, "load_time_ms": 0.237, "load_throughput": 328799.711, "learn_time_ms": 12.712, "learn_throughput": 6136.141, "synch_weights_time_ms": 11.687}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 25350, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 25350, "last_target_update_ts": 13520, "num_target_updates": 25}, "done": false, "episodes_total": 484, "training_iteration": 14, "trial_id": "2058a_00000", "date": "2024-04-17_06-12-09", "timestamp": 1713334329, "time_this_iter_s": 265.4506137371063, "time_total_s": 3104.0141911506653, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3104.0141911506653, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.301587301587302, "ram_util_percent": 14.187830687830688}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03531358018517494, "cur_lr": 0.01}, "td_error": [2.865189552307129, 1.952010154724121, 1.9519095420837402, 1.9656375646591187, 1.5263214111328125, 1.9518835544586182, 1.970306634902954, 1.5849695205688477, 0.8499042391777039, 1.970137596130371, 1.9521698951721191, 1.5054789781570435, 1.9518965482711792, 1.8349308967590332, 1.9700133800506592, 0.8363165855407715, 1.498415231704712, 1.3114395141601562, 2.021054983139038, 1.839524269104004, 1.5894464254379272, 1.9519116878509521, 1.9538259506225586, 0.37389394640922546, 1.9518895149230957, 1.4978705644607544, 1.9519870281219482, 1.6030611991882324, 1.9519212245941162, 1.9699506759643555, 1.9705473184585571, 1.951880931854248, 1.9518812894821167, 1.9520483016967773, 1.9519059658050537, 1.9518877267837524, 2.0209593772888184, 1.9519277811050415, 2.002561330795288, 0.8363165855407715, 0.8364508152008057, 1.3120150566101074, 2.323178291320801, 1.4492857456207275, 1.9519028663635254, 1.9520083665847778, 1.9520906209945679, 1.9518818855285645, 1.951940655708313, 1.5894317626953125, 0.3573298454284668, 3.0698137283325195, 1.9519026279449463, 1.9518872499465942, 1.454667568206787, 1.9526667594909668, 1.9699734449386597, 2.4124021530151367, 1.9519351720809937, 1.9520235061645508, 1.9519137144088745, 1.970332145690918, 1.9518911838531494, 0.8382310271263123, 1.953965663909912, 0.8370810747146606, 1.9519257545471191, 2.9937469959259033, 2.0212864875793457, 1.526320219039917, 1.4980205297470093, 1.9518964290618896, 1.9560586214065552, 1.957443118095398, 1.9519470930099487, 2.1458733081817627, 1.9519402980804443, 1.951906681060791], "mean_td_error": 1.7987658977508545, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 350.0, "diff_num_grad_updates_vs_sampler_policy": 349.0}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 27300, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 27300, "last_target_update_ts": 14560, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": 1.8686442280330653, "episode_reward_min": -19.99840543665376, "episode_reward_mean": -1.6988046354315598, "episode_len_mean": 25.18, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.002479951091900406, 0.002366287398811055, 0.0022858170292986337, 0.0036841354910279803, 0.0021029905361250305, 0.002416316052917438, 0.0023038161298955043, 0.010570734475042497, 0.008539345351112754, 0.0020610665259614344, 0.0036828685328043945, 0.002433275122434815, 0.005024601049502527, 0.006706810967851626, 0.002157096845412996, -9.997494079060237, 0.002385975707281802, 0.07459863549602834, 0.06481270829295845, 0.0021312322331830617, 0.0019127914877328552, 1.4548587979687988, 0.0018003684175923174, 0.0017413797276506964, 0.0016855878752662322, 0.001854847897037298, 0.001804866091929811, -19.998251638901113, 0.0016926708019458791, 0.11980758481211994, 0.004413295800453705, 0.001933768113854081, 0.005374012192711806, 0.005724314626036381, -9.998252543426489, 0.001919148989736205, 0.001865690809433877, 0.8369831300828048, 0.0017528598990279043, -9.998303653390005, 0.003735727733274986, 0.003921327761591097, 0.0019116377532533194, 0.0018452632537265925, 0.0017827364843641246, 0.0019827524986113197, 0.0019191311955456512, -9.998134320508862, -9.998194640976282, 0.0017460432264122868, 0.0020714575069448356, 0.0020021155586844148, 0.0019440041391688271, 0.001878605584293751, 0.0018144676211823063, -9.997956019215701, 1.2631550816880528, 0.0019060233911319688, -9.998146710287234, -9.998206051529577, 0.0016341714001217634, -19.99840543665376, 0.0015390565422346578, 0.0014804482023423615, 0.0014382762886639767, 0.0015947775574355885, 0.06837629485017382, 0.0015067133791286404, 0.0014504980995007498, 0.001409991942424371, 0.001692249123911272, 0.0016498082895248945, 0.06397223282862359, 0.39505487795646616, 0.19956727209257397, 1.8686442280330653, 0.00160432517288177, 0.0015481561045209344, 0.00148886584225281, 0.0014462198897483775, -7.770714754736478, 0.0016819627031388837, 0.0016203289166469791, 0.0015554958621492548, 0.0015090069603637423, -9.998310038571109, 0.0016382774197162533, 0.001598464700319852, -9.850362943402395, 0.39501082410918487, -9.998246076305785, 0.0016983667061091917, -9.998344372840918, 0.0015958704535323127, 0.3826722286848868, -9.99826474214675, 0.0016797843526909922, 0.0016287163407038576, 0.0015893606730955977, 0.35906217199865836], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 374.5942366366337, "mean_inference_ms": 2.090425580589251, "mean_action_processing_ms": 0.14497932224268353, "mean_env_wait_ms": 6.121512405913307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010072469711303711, "StateBufferConnector_ms": 0.006315946578979492, "ViewRequirementAgentConnector_ms": 0.1740260124206543}}, "episode_reward_max": 1.8686442280330653, "episode_reward_min": -19.99840543665376, "episode_reward_mean": -1.6988046354315598, "episode_len_mean": 25.18, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.002479951091900406, 0.002366287398811055, 0.0022858170292986337, 0.0036841354910279803, 0.0021029905361250305, 0.002416316052917438, 0.0023038161298955043, 0.010570734475042497, 0.008539345351112754, 0.0020610665259614344, 0.0036828685328043945, 0.002433275122434815, 0.005024601049502527, 0.006706810967851626, 0.002157096845412996, -9.997494079060237, 0.002385975707281802, 0.07459863549602834, 0.06481270829295845, 0.0021312322331830617, 0.0019127914877328552, 1.4548587979687988, 0.0018003684175923174, 0.0017413797276506964, 0.0016855878752662322, 0.001854847897037298, 0.001804866091929811, -19.998251638901113, 0.0016926708019458791, 0.11980758481211994, 0.004413295800453705, 0.001933768113854081, 0.005374012192711806, 0.005724314626036381, -9.998252543426489, 0.001919148989736205, 0.001865690809433877, 0.8369831300828048, 0.0017528598990279043, -9.998303653390005, 0.003735727733274986, 0.003921327761591097, 0.0019116377532533194, 0.0018452632537265925, 0.0017827364843641246, 0.0019827524986113197, 0.0019191311955456512, -9.998134320508862, -9.998194640976282, 0.0017460432264122868, 0.0020714575069448356, 0.0020021155586844148, 0.0019440041391688271, 0.001878605584293751, 0.0018144676211823063, -9.997956019215701, 1.2631550816880528, 0.0019060233911319688, -9.998146710287234, -9.998206051529577, 0.0016341714001217634, -19.99840543665376, 0.0015390565422346578, 0.0014804482023423615, 0.0014382762886639767, 0.0015947775574355885, 0.06837629485017382, 0.0015067133791286404, 0.0014504980995007498, 0.001409991942424371, 0.001692249123911272, 0.0016498082895248945, 0.06397223282862359, 0.39505487795646616, 0.19956727209257397, 1.8686442280330653, 0.00160432517288177, 0.0015481561045209344, 0.00148886584225281, 0.0014462198897483775, -7.770714754736478, 0.0016819627031388837, 0.0016203289166469791, 0.0015554958621492548, 0.0015090069603637423, -9.998310038571109, 0.0016382774197162533, 0.001598464700319852, -9.850362943402395, 0.39501082410918487, -9.998246076305785, 0.0016983667061091917, -9.998344372840918, 0.0015958704535323127, 0.3826722286848868, -9.99826474214675, 0.0016797843526909922, 0.0016287163407038576, 0.0015893606730955977, 0.35906217199865836], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 374.5942366366337, "mean_inference_ms": 2.090425580589251, "mean_action_processing_ms": 0.14497932224268353, "mean_env_wait_ms": 6.121512405913307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010072469711303711, "StateBufferConnector_ms": 0.006315946578979492, "ViewRequirementAgentConnector_ms": 0.1740260124206543}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 27300, "num_env_steps_sampled": 15000, "num_env_steps_trained": 27300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.521621757337945, "num_env_steps_trained_throughput_per_sec": 8.817162426808993, "timesteps_total": 15000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 8855.138, "sample_time_ms": 8793.935, "load_time_ms": 0.246, "load_throughput": 316735.126, "learn_time_ms": 13.076, "learn_throughput": 5965.194, "synch_weights_time_ms": 11.776}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 27300, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 27300, "last_target_update_ts": 14560, "num_target_updates": 27}, "done": false, "episodes_total": 524, "training_iteration": 15, "trial_id": "2058a_00000", "date": "2024-04-17_06-15-51", "timestamp": 1713334551, "time_this_iter_s": 221.16796398162842, "time_total_s": 3325.1821551322937, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3325.1821551322937, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.313968253968254, "ram_util_percent": 14.275238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0542980432510376, "cur_lr": 0.01}, "td_error": [3.2367281913757324, 0.8286277055740356, 1.8465170860290527, 1.9320534467697144, 1.932046890258789, 1.9322733879089355, 1.932190179824829, 1.9320653676986694, 1.932049036026001, 2.0450732707977295, 0.3391859233379364, 2.0234732627868652, 2.6976208686828613, 1.9320526123046875, 1.9554896354675293, 1.9320528507232666, 1.956685185432434, 1.5062788724899292, 1.9585117101669312, 1.9323638677597046, 1.932059645652771, 1.9320627450942993, 1.961275339126587, 0.8144344091415405, 1.9726756811141968, 1.9322837591171265, 1.986717700958252, 2.027812957763672, 1.9325894117355347, 1.304304838180542, 3.0971033573150635, 1.9327389001846313, 2.1154234409332275, 1.9565699100494385, 1.9320628643035889, 1.935939073562622, 1.9320650100708008, 1.956792950630188, 1.9320803880691528, 1.9320553541183472, 1.57481050491333, 1.9320642948150635, 2.0067951679229736, 1.6102410554885864, 1.5070433616638184, 2.0034594535827637, 0.805634081363678, 2.0051140785217285, 1.50704026222229, 1.9561675786972046, 1.9320844411849976, 1.9553405046463013, 2.0132439136505127, 3.377784013748169, 1.9320636987686157, 0.3391859233379364, 1.9320539236068726, 2.0203351974487305, 1.9554635286331177, 1.9320822954177856, 1.573917269706726, 1.9323477745056152, 1.932064414024353, 1.9555623531341553, 1.9561841487884521, 1.506828784942627, 1.9554579257965088, 1.932059645652771, 1.9323655366897583, 1.9578698873519897, 1.3348811864852905, 1.9320683479309082, 1.9322314262390137, 1.9325504302978516, 1.932050347328186, 1.6039546728134155, 1.9554383754730225, 1.3065495491027832], "mean_td_error": 1.8610869646072388, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 375.0, "diff_num_grad_updates_vs_sampler_policy": 374.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 29250, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 29250, "last_target_update_ts": 15600, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": 3.8499636105417006, "episode_reward_min": -19.99840543665376, "episode_reward_mean": -1.2533824725420468, "episode_len_mean": 25.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.003735727733274986, 0.003921327761591097, 0.0019116377532533194, 0.0018452632537265925, 0.0017827364843641246, 0.0019827524986113197, 0.0019191311955456512, -9.998134320508862, -9.998194640976282, 0.0017460432264122868, 0.0020714575069448356, 0.0020021155586844148, 0.0019440041391688271, 0.001878605584293751, 0.0018144676211823063, -9.997956019215701, 1.2631550816880528, 0.0019060233911319688, -9.998146710287234, -9.998206051529577, 0.0016341714001217634, -19.99840543665376, 0.0015390565422346578, 0.0014804482023423615, 0.0014382762886639767, 0.0015947775574355885, 0.06837629485017382, 0.0015067133791286404, 0.0014504980995007498, 0.001409991942424371, 0.001692249123911272, 0.0016498082895248945, 0.06397223282862359, 0.39505487795646616, 0.19956727209257397, 1.8686442280330653, 0.00160432517288177, 0.0015481561045209344, 0.00148886584225281, 0.0014462198897483775, -7.770714754736478, 0.0016819627031388837, 0.0016203289166469791, 0.0015554958621492548, 0.0015090069603637423, -9.998310038571109, 0.0016382774197162533, 0.001598464700319852, -9.850362943402395, 0.39501082410918487, -9.998246076305785, 0.0016983667061091917, -9.998344372840918, 0.0015958704535323127, 0.3826722286848868, -9.99826474214675, 0.0016797843526909922, 0.0016287163407038576, 0.0015893606730955977, 0.35906217199865836, 2.359740934539874, 0.47076620915396095, 0.7179545273720334, -9.786765838557349, 1.624764859656225, 0.040716945307676645, -9.30290865077149, 0.6846314479637803, 0.47627226496487696, 0.12129317218905035, 1.444535489628757, 0.09445364822653177, 0.2263131874299608, -9.887367070224878, 0.43821497193453535, 0.3034029441161841, 0.23056300087417478, 3.8499636105417006, 0.1689381648735411, 0.0013021426261440728, 0.24008462890737103, 0.5089923033008248, 0.9312758691670538, 0.659892165680189, 0.1808526138089157, 2.4315519608642298, 0.06419667433103804, 1.451415035004905, 0.20466322623086622, 0.22659664704140137, 0.0014903486564173435, 0.24517381126967303, 0.14680790774066377, 0.17186419535361305, 0.0013651676325379884, 0.6671117154572948, 0.22237635359911972, 2.8049971164460943, 1.4407705623740528, 0.3215188893856064], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 378.82189035731676, "mean_inference_ms": 2.0920370625418276, "mean_action_processing_ms": 0.14502724239756623, "mean_env_wait_ms": 5.7247858534786795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010022640228271484, "StateBufferConnector_ms": 0.0062313079833984375, "ViewRequirementAgentConnector_ms": 0.17471909523010254}}, "episode_reward_max": 3.8499636105417006, "episode_reward_min": -19.99840543665376, "episode_reward_mean": -1.2533824725420468, "episode_len_mean": 25.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.003735727733274986, 0.003921327761591097, 0.0019116377532533194, 0.0018452632537265925, 0.0017827364843641246, 0.0019827524986113197, 0.0019191311955456512, -9.998134320508862, -9.998194640976282, 0.0017460432264122868, 0.0020714575069448356, 0.0020021155586844148, 0.0019440041391688271, 0.001878605584293751, 0.0018144676211823063, -9.997956019215701, 1.2631550816880528, 0.0019060233911319688, -9.998146710287234, -9.998206051529577, 0.0016341714001217634, -19.99840543665376, 0.0015390565422346578, 0.0014804482023423615, 0.0014382762886639767, 0.0015947775574355885, 0.06837629485017382, 0.0015067133791286404, 0.0014504980995007498, 0.001409991942424371, 0.001692249123911272, 0.0016498082895248945, 0.06397223282862359, 0.39505487795646616, 0.19956727209257397, 1.8686442280330653, 0.00160432517288177, 0.0015481561045209344, 0.00148886584225281, 0.0014462198897483775, -7.770714754736478, 0.0016819627031388837, 0.0016203289166469791, 0.0015554958621492548, 0.0015090069603637423, -9.998310038571109, 0.0016382774197162533, 0.001598464700319852, -9.850362943402395, 0.39501082410918487, -9.998246076305785, 0.0016983667061091917, -9.998344372840918, 0.0015958704535323127, 0.3826722286848868, -9.99826474214675, 0.0016797843526909922, 0.0016287163407038576, 0.0015893606730955977, 0.35906217199865836, 2.359740934539874, 0.47076620915396095, 0.7179545273720334, -9.786765838557349, 1.624764859656225, 0.040716945307676645, -9.30290865077149, 0.6846314479637803, 0.47627226496487696, 0.12129317218905035, 1.444535489628757, 0.09445364822653177, 0.2263131874299608, -9.887367070224878, 0.43821497193453535, 0.3034029441161841, 0.23056300087417478, 3.8499636105417006, 0.1689381648735411, 0.0013021426261440728, 0.24008462890737103, 0.5089923033008248, 0.9312758691670538, 0.659892165680189, 0.1808526138089157, 2.4315519608642298, 0.06419667433103804, 1.451415035004905, 0.20466322623086622, 0.22659664704140137, 0.0014903486564173435, 0.24517381126967303, 0.14680790774066377, 0.17186419535361305, 0.0013651676325379884, 0.6671117154572948, 0.22237635359911972, 2.8049971164460943, 1.4407705623740528, 0.3215188893856064], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 378.82189035731676, "mean_inference_ms": 2.0920370625418276, "mean_action_processing_ms": 0.14502724239756623, "mean_env_wait_ms": 5.7247858534786795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010022640228271484, "StateBufferConnector_ms": 0.0062313079833984375, "ViewRequirementAgentConnector_ms": 0.17471909523010254}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 29250, "num_env_steps_sampled": 16000, "num_env_steps_trained": 29250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.464075159785332, "num_env_steps_trained_throughput_per_sec": 8.704946561581396, "timesteps_total": 16000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8923.273, "sample_time_ms": 8861.377, "load_time_ms": 0.247, "load_throughput": 315452.427, "learn_time_ms": 13.259, "learn_throughput": 5882.985, "synch_weights_time_ms": 11.641}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 29250, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 29250, "last_target_update_ts": 15600, "num_target_updates": 29}, "done": false, "episodes_total": 564, "training_iteration": 16, "trial_id": "2058a_00000", "date": "2024-04-17_06-19-35", "timestamp": 1713334775, "time_this_iter_s": 224.01975989341736, "time_total_s": 3549.201915025711, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3549.201915025711, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.264779874213836, "ram_util_percent": 14.384905660377363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0304573904722929, "cur_lr": 0.01}, "td_error": [1.8907830715179443, 1.8908798694610596, 1.8907853364944458, 1.8907800912857056, 1.523391842842102, 1.5253067016601562, 1.9608842134475708, 1.8910181522369385, 1.7123204469680786, 1.5359961986541748, 1.4360758066177368, 1.9239368438720703, 1.924180030822754, 3.6440930366516113, 1.8908092975616455, 1.7120455503463745, 1.8913218975067139, 1.8907854557037354, 1.890794038772583, 1.5158272981643677, 1.890804409980774, 0.810477077960968, 1.8907928466796875, 1.9239685535430908, 1.8907756805419922, 1.8907783031463623, 1.4362332820892334, 1.890966534614563, 0.3538970947265625, 1.4362492561340332, 1.7120710611343384, 1.4362473487854004, 1.5244220495224, 1.8907883167266846, 1.8907757997512817, 1.9239953756332397, 1.890798807144165, 2.0136961936950684, 1.8907769918441772, 1.99391508102417, 1.8907893896102905, 1.8909871578216553, 1.8914635181427002, 1.9938831329345703, 1.8907804489135742, 1.92360520362854, 0.824309766292572, 1.890790581703186, 1.9048621654510498, 1.8907852172851562, 1.8907886743545532, 1.8907811641693115, 1.8907873630523682, 1.89079749584198, 1.8909885883331299, 1.9236642122268677, 0.7974410057067871, 1.8907924890518188, 1.9239588975906372, 1.8907796144485474, 1.3489559888839722, 1.890777349472046, 1.8907852172851562, 1.4362504482269287, 1.960537314414978, 1.8907805681228638, 1.8907809257507324, 1.8907819986343384, 1.8907824754714966, 1.8909785747528076, 1.9043889045715332, 1.890838861465454, 1.923700213432312, 1.9985694885253906, 1.890816330909729, 1.890796422958374, 0.806349515914917, 1.5228102207183838], "mean_td_error": 1.7781686782836914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 400.0, "diff_num_grad_updates_vs_sampler_policy": 399.0}}, "num_env_steps_sampled": 17000, "num_env_steps_trained": 31200, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 31200, "last_target_update_ts": 16640, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": 3.8499636105417006, "episode_reward_min": -9.99881596345512, "episode_reward_mean": -1.137837763503005, "episode_len_mean": 25.15, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.770714754736478, 0.0016819627031388837, 0.0016203289166469791, 0.0015554958621492548, 0.0015090069603637423, -9.998310038571109, 0.0016382774197162533, 0.001598464700319852, -9.850362943402395, 0.39501082410918487, -9.998246076305785, 0.0016983667061091917, -9.998344372840918, 0.0015958704535323127, 0.3826722286848868, -9.99826474214675, 0.0016797843526909922, 0.0016287163407038576, 0.0015893606730955977, 0.35906217199865836, 2.359740934539874, 0.47076620915396095, 0.7179545273720334, -9.786765838557349, 1.624764859656225, 0.040716945307676645, -9.30290865077149, 0.6846314479637803, 0.47627226496487696, 0.12129317218905035, 1.444535489628757, 0.09445364822653177, 0.2263131874299608, -9.887367070224878, 0.43821497193453535, 0.3034029441161841, 0.23056300087417478, 3.8499636105417006, 0.1689381648735411, 0.0013021426261440728, 0.24008462890737103, 0.5089923033008248, 0.9312758691670538, 0.659892165680189, 0.1808526138089157, 2.4315519608642298, 0.06419667433103804, 1.451415035004905, 0.20466322623086622, 0.22659664704140137, 0.0014903486564173435, 0.24517381126967303, 0.14680790774066377, 0.17186419535361305, 0.0013651676325379884, 0.6671117154572948, 0.22237635359911972, 2.8049971164460943, 1.4407705623740528, 0.3215188893856064, -9.998746971693631, 0.0012224401649890942, 0.5345956424136812, 0.0011722298177972844, 0.04148030264532562, 0.0012365887574348686, -9.998793225101933, 0.001180878663148044, 0.0011575239775049777, 0.0011324661306677934, 0.0012979550413146908, 0.0012651454711636368, 0.0012367158901893751, -9.62053763247845, -9.99881596345512, 0.08081389033141557, 0.0012442793332176057, 0.001216769462912631, -9.998808009760383, 0.3672356149904936, 0.001314956002715167, 0.0012812924782309061, 0.0012521410518102174, 1.4014762943639532, 0.0011979439002158677, 2.288311140649071, 0.0012675164547219936, 0.0012362090844328037, 0.0012090509594346042, 0.001184579799734998, 0.001330977431702506, 0.0013012114078489502, 0.0012682390989258363, 0.08719826499424148, 0.001216072882830318, 0.0013239447278114412, 0.0012917636853861409, 0.059370746514398394, 0.0012343645697053224, -9.800910786934347], "episode_lengths": [26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 382.56535998339126, "mean_inference_ms": 2.091664030521778, "mean_action_processing_ms": 0.14496119201375707, "mean_env_wait_ms": 5.377277415378452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009732484817504883, "StateBufferConnector_ms": 0.006308555603027344, "ViewRequirementAgentConnector_ms": 0.1760425567626953}}, "episode_reward_max": 3.8499636105417006, "episode_reward_min": -9.99881596345512, "episode_reward_mean": -1.137837763503005, "episode_len_mean": 25.15, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.770714754736478, 0.0016819627031388837, 0.0016203289166469791, 0.0015554958621492548, 0.0015090069603637423, -9.998310038571109, 0.0016382774197162533, 0.001598464700319852, -9.850362943402395, 0.39501082410918487, -9.998246076305785, 0.0016983667061091917, -9.998344372840918, 0.0015958704535323127, 0.3826722286848868, -9.99826474214675, 0.0016797843526909922, 0.0016287163407038576, 0.0015893606730955977, 0.35906217199865836, 2.359740934539874, 0.47076620915396095, 0.7179545273720334, -9.786765838557349, 1.624764859656225, 0.040716945307676645, -9.30290865077149, 0.6846314479637803, 0.47627226496487696, 0.12129317218905035, 1.444535489628757, 0.09445364822653177, 0.2263131874299608, -9.887367070224878, 0.43821497193453535, 0.3034029441161841, 0.23056300087417478, 3.8499636105417006, 0.1689381648735411, 0.0013021426261440728, 0.24008462890737103, 0.5089923033008248, 0.9312758691670538, 0.659892165680189, 0.1808526138089157, 2.4315519608642298, 0.06419667433103804, 1.451415035004905, 0.20466322623086622, 0.22659664704140137, 0.0014903486564173435, 0.24517381126967303, 0.14680790774066377, 0.17186419535361305, 0.0013651676325379884, 0.6671117154572948, 0.22237635359911972, 2.8049971164460943, 1.4407705623740528, 0.3215188893856064, -9.998746971693631, 0.0012224401649890942, 0.5345956424136812, 0.0011722298177972844, 0.04148030264532562, 0.0012365887574348686, -9.998793225101933, 0.001180878663148044, 0.0011575239775049777, 0.0011324661306677934, 0.0012979550413146908, 0.0012651454711636368, 0.0012367158901893751, -9.62053763247845, -9.99881596345512, 0.08081389033141557, 0.0012442793332176057, 0.001216769462912631, -9.998808009760383, 0.3672356149904936, 0.001314956002715167, 0.0012812924782309061, 0.0012521410518102174, 1.4014762943639532, 0.0011979439002158677, 2.288311140649071, 0.0012675164547219936, 0.0012362090844328037, 0.0012090509594346042, 0.001184579799734998, 0.001330977431702506, 0.0013012114078489502, 0.0012682390989258363, 0.08719826499424148, 0.001216072882830318, 0.0013239447278114412, 0.0012917636853861409, 0.059370746514398394, 0.0012343645697053224, -9.800910786934347], "episode_lengths": [26, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 382.56535998339126, "mean_inference_ms": 2.091664030521778, "mean_action_processing_ms": 0.14496119201375707, "mean_env_wait_ms": 5.377277415378452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009732484817504883, "StateBufferConnector_ms": 0.006308555603027344, "ViewRequirementAgentConnector_ms": 0.1760425567626953}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 31200, "num_env_steps_sampled": 17000, "num_env_steps_trained": 31200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.491117534076333, "num_env_steps_trained_throughput_per_sec": 8.757679191448851, "timesteps_total": 17000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 17000, "timers": {"training_iteration_time_ms": 8949.173, "sample_time_ms": 8887.186, "load_time_ms": 0.271, "load_throughput": 287786.517, "learn_time_ms": 13.271, "learn_throughput": 5877.658, "synch_weights_time_ms": 11.321}, "counters": {"num_env_steps_sampled": 17000, "num_env_steps_trained": 31200, "num_agent_steps_sampled": 17000, "num_agent_steps_trained": 31200, "last_target_update_ts": 16640, "num_target_updates": 31}, "done": false, "episodes_total": 604, "training_iteration": 17, "trial_id": "2058a_00000", "date": "2024-04-17_06-23-17", "timestamp": 1713334997, "time_this_iter_s": 222.67312121391296, "time_total_s": 3771.875036239624, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3771.875036239624, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.297476340694008, "ram_util_percent": 14.481703470031546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.08228743076324463, "cur_lr": 0.01}, "td_error": [1.4513964653015137, 1.3708035945892334, 1.8681044578552246, 1.8681707382202148, 0.8161460757255554, 1.9001761674880981, 1.9662206172943115, 1.8680996894836426, 1.9637668132781982, 1.687447190284729, 1.868117332458496, 1.868104100227356, 1.7488210201263428, 0.8039571046829224, 0.8174007534980774, 1.37044358253479, 1.8681588172912598, 1.9000102281570435, 1.8681042194366455, 1.766554355621338, 1.4043225049972534, 1.900681734085083, 1.8688138723373413, 1.3293466567993164, 0.854939877986908, 1.0689375400543213, 1.8681137561798096, 0.7803871035575867, 1.8681106567382812, 1.3748747110366821, 1.8681073188781738, 1.8681936264038086, 0.8161460757255554, 1.9002286195755005, 1.8681700229644775, 1.8681241273880005, 1.8682368993759155, 1.868110179901123, 1.8967100381851196, 1.868113398551941, 1.8681066036224365, 1.5691304206848145, 2.908536434173584, 1.689934492111206, 1.8681305646896362, 1.8681182861328125, 0.3688511848449707, 1.8681256771087646, 1.8687641620635986, 1.8682926893234253, 1.5654985904693604, 1.8683397769927979, 0.31933170557022095, 0.7816587686538696, 1.868127465248108, 1.8681122064590454, 1.3293468952178955, 0.31933170557022095, 1.8681676387786865, 1.868099570274353, 1.868119716644287, 1.9001743793487549, 1.868180751800537, 1.8265975713729858, 1.9769489765167236, 1.8680996894836426, 1.8335994482040405, 1.8267816305160522, 1.8681201934814453, 0.8185393810272217, 1.8681623935699463, 1.8681061267852783, 1.9001295566558838, 1.8683195114135742, 1.868105411529541, 1.8681228160858154, 1.900323510169983, 1.8681039810180664], "mean_td_error": 1.6501950025558472, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 425.0, "diff_num_grad_updates_vs_sampler_policy": 424.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 33150, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 33150, "last_target_update_ts": 17680, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": 3.5432602813190313, "episode_reward_min": -19.998841645142992, "episode_reward_mean": -1.0584785433149124, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.24008462890737103, 0.5089923033008248, 0.9312758691670538, 0.659892165680189, 0.1808526138089157, 2.4315519608642298, 0.06419667433103804, 1.451415035004905, 0.20466322623086622, 0.22659664704140137, 0.0014903486564173435, 0.24517381126967303, 0.14680790774066377, 0.17186419535361305, 0.0013651676325379884, 0.6671117154572948, 0.22237635359911972, 2.8049971164460943, 1.4407705623740528, 0.3215188893856064, -9.998746971693631, 0.0012224401649890942, 0.5345956424136812, 0.0011722298177972844, 0.04148030264532562, 0.0012365887574348686, -9.998793225101933, 0.001180878663148044, 0.0011575239775049777, 0.0011324661306677934, 0.0012979550413146908, 0.0012651454711636368, 0.0012367158901893751, -9.62053763247845, -9.99881596345512, 0.08081389033141557, 0.0012442793332176057, 0.001216769462912631, -9.998808009760383, 0.3672356149904936, 0.001314956002715167, 0.0012812924782309061, 0.0012521410518102174, 1.4014762943639532, 0.0011979439002158677, 2.288311140649071, 0.0012675164547219936, 0.0012362090844328037, 0.0012090509594346042, 0.001184579799734998, 0.001330977431702506, 0.0013012114078489502, 0.0012682390989258363, 0.08719826499424148, 0.001216072882830318, 0.0013239447278114412, 0.0012917636853861409, 0.059370746514398394, 0.0012343645697053224, -9.800910786934347, 0.001121861717850342, 0.0010979180682247492, -9.998922458738473, 0.741895722693633, 0.5347648437327117, 0.0011059362564748824, 0.0010826606786760846, 0.20187030954808852, 3.5432602813190313, 0.0010280732021941876, 0.0011550643310857978, 0.06433986367520453, 0.0011094844843837904, -9.998912344157047, 0.00107107429598004, 0.0011394529899656225, 0.04616916396851522, 0.0010955227852352534, 0.0010742329592689337, 0.4083756334008113, 0.0011682977970978276, 0.0011423533677942259, 0.0011203192867975872, 0.10147947007957528, 2.4575183939140137, -19.998841645142992, 0.0011306088858255962, 0.0011062943562165635, -9.998914429827293, 3.507858241800806, 0.0011884470337322087, 0.001159263367876254, 0.0011337143565201195, 0.0011120092546461242, -9.998909917863969, -9.998814041543085, 0.001159666534070355, 0.07748884029442057, 0.0011086068731932866, -5.963310877504723], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 385.9468120199542, "mean_inference_ms": 2.092851655222655, "mean_action_processing_ms": 0.14495188970699338, "mean_env_wait_ms": 5.070521149406999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010038137435913086, "StateBufferConnector_ms": 0.006224870681762695, "ViewRequirementAgentConnector_ms": 0.1741626262664795}}, "episode_reward_max": 3.5432602813190313, "episode_reward_min": -19.998841645142992, "episode_reward_mean": -1.0584785433149124, "episode_len_mean": 25.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.24008462890737103, 0.5089923033008248, 0.9312758691670538, 0.659892165680189, 0.1808526138089157, 2.4315519608642298, 0.06419667433103804, 1.451415035004905, 0.20466322623086622, 0.22659664704140137, 0.0014903486564173435, 0.24517381126967303, 0.14680790774066377, 0.17186419535361305, 0.0013651676325379884, 0.6671117154572948, 0.22237635359911972, 2.8049971164460943, 1.4407705623740528, 0.3215188893856064, -9.998746971693631, 0.0012224401649890942, 0.5345956424136812, 0.0011722298177972844, 0.04148030264532562, 0.0012365887574348686, -9.998793225101933, 0.001180878663148044, 0.0011575239775049777, 0.0011324661306677934, 0.0012979550413146908, 0.0012651454711636368, 0.0012367158901893751, -9.62053763247845, -9.99881596345512, 0.08081389033141557, 0.0012442793332176057, 0.001216769462912631, -9.998808009760383, 0.3672356149904936, 0.001314956002715167, 0.0012812924782309061, 0.0012521410518102174, 1.4014762943639532, 0.0011979439002158677, 2.288311140649071, 0.0012675164547219936, 0.0012362090844328037, 0.0012090509594346042, 0.001184579799734998, 0.001330977431702506, 0.0013012114078489502, 0.0012682390989258363, 0.08719826499424148, 0.001216072882830318, 0.0013239447278114412, 0.0012917636853861409, 0.059370746514398394, 0.0012343645697053224, -9.800910786934347, 0.001121861717850342, 0.0010979180682247492, -9.998922458738473, 0.741895722693633, 0.5347648437327117, 0.0011059362564748824, 0.0010826606786760846, 0.20187030954808852, 3.5432602813190313, 0.0010280732021941876, 0.0011550643310857978, 0.06433986367520453, 0.0011094844843837904, -9.998912344157047, 0.00107107429598004, 0.0011394529899656225, 0.04616916396851522, 0.0010955227852352534, 0.0010742329592689337, 0.4083756334008113, 0.0011682977970978276, 0.0011423533677942259, 0.0011203192867975872, 0.10147947007957528, 2.4575183939140137, -19.998841645142992, 0.0011306088858255962, 0.0011062943562165635, -9.998914429827293, 3.507858241800806, 0.0011884470337322087, 0.001159263367876254, 0.0011337143565201195, 0.0011120092546461242, -9.998909917863969, -9.998814041543085, 0.001159666534070355, 0.07748884029442057, 0.0011086068731932866, -5.963310877504723], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 385.9468120199542, "mean_inference_ms": 2.092851655222655, "mean_action_processing_ms": 0.14495188970699338, "mean_env_wait_ms": 5.070521149406999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010038137435913086, "StateBufferConnector_ms": 0.006224870681762695, "ViewRequirementAgentConnector_ms": 0.1741626262664795}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 33150, "num_env_steps_sampled": 18000, "num_env_steps_trained": 33150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.48088459797357, "num_env_steps_trained_throughput_per_sec": 8.737724966048463, "timesteps_total": 18000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 8928.054, "sample_time_ms": 8865.974, "load_time_ms": 0.259, "load_throughput": 300611.699, "learn_time_ms": 13.201, "learn_throughput": 5908.697, "synch_weights_time_ms": 10.789}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 33150, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 33150, "last_target_update_ts": 17680, "num_target_updates": 33}, "done": false, "episodes_total": 644, "training_iteration": 18, "trial_id": "2058a_00000", "date": "2024-04-17_06-27-01", "timestamp": 1713335221, "time_this_iter_s": 223.1792914867401, "time_total_s": 3995.054327726364, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 3995.054327726364, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.290851735015774, "ram_util_percent": 14.591167192429019}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03205348551273346, "cur_lr": 0.01}, "td_error": [1.9372563362121582, 1.9364094734191895, 1.8273906707763672, 0.8023167848587036, 1.8667097091674805, 1.8668935298919678, 0.8218216896057129, 1.867502212524414, 1.827394723892212, 1.4139200448989868, 1.827397108078003, 1.2648892402648926, 1.2648894786834717, 1.827390432357788, 1.4549134969711304, 1.8273847103118896, 1.8273892402648926, 1.827430009841919, 1.8667267560958862, 1.827401041984558, 1.4287203550338745, 1.827394962310791, 2.3171608448028564, 1.827397108078003, 1.9460735321044922, 1.866773009300232, 1.6040374040603638, 1.8275189399719238, 1.6048368215560913, 1.8276877403259277, 1.9445141553878784, 1.8273886442184448, 1.8273985385894775, 1.8671209812164307, 1.45505952835083, 1.8273941278457642, 1.8273993730545044, 1.866957426071167, 1.8274273872375488, 1.628849983215332, 1.8675663471221924, 1.6150542497634888, 1.8274016380310059, 1.265052318572998, 1.8671691417694092, 0.3665619492530823, 1.9363981485366821, 0.8283615112304688, 1.9591214656829834, 1.8273903131484985, 1.8668142557144165, 1.831383228302002, 1.9593791961669922, 1.827393651008606, 1.8273848295211792, 1.8273942470550537, 1.827620029449463, 1.8273967504501343, 1.9373173713684082, 1.827409267425537, 1.829289197921753, 2.108687400817871, 1.8274034261703491, 1.8273898363113403, 1.8665882349014282, 1.866985559463501, 1.8274649381637573, 1.8766299486160278, 1.827390432357788, 1.827414870262146, 1.8273967504501343, 1.8668895959854126, 1.8274551630020142, 1.8273991346359253, 1.2648894786834717, 1.8351949453353882, 1.827393651008606, 1.8669407367706299], "mean_td_error": 1.739857792854309, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 450.0, "diff_num_grad_updates_vs_sampler_policy": 449.0}}, "num_env_steps_sampled": 19000, "num_env_steps_trained": 35100, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 35100, "last_target_update_ts": 18720, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": 3.5432602813190313, "episode_reward_min": -19.998841645142992, "episode_reward_mean": -1.1355352714537867, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.001314956002715167, 0.0012812924782309061, 0.0012521410518102174, 1.4014762943639532, 0.0011979439002158677, 2.288311140649071, 0.0012675164547219936, 0.0012362090844328037, 0.0012090509594346042, 0.001184579799734998, 0.001330977431702506, 0.0013012114078489502, 0.0012682390989258363, 0.08719826499424148, 0.001216072882830318, 0.0013239447278114412, 0.0012917636853861409, 0.059370746514398394, 0.0012343645697053224, -9.800910786934347, 0.001121861717850342, 0.0010979180682247492, -9.998922458738473, 0.741895722693633, 0.5347648437327117, 0.0011059362564748824, 0.0010826606786760846, 0.20187030954808852, 3.5432602813190313, 0.0010280732021941876, 0.0011550643310857978, 0.06433986367520453, 0.0011094844843837904, -9.998912344157047, 0.00107107429598004, 0.0011394529899656225, 0.04616916396851522, 0.0010955227852352534, 0.0010742329592689337, 0.4083756334008113, 0.0011682977970978276, 0.0011423533677942259, 0.0011203192867975872, 0.10147947007957528, 2.4575183939140137, -19.998841645142992, 0.0011306088858255962, 0.0011062943562165635, -9.998914429827293, 3.507858241800806, 0.0011884470337322087, 0.001159263367876254, 0.0011337143565201195, 0.0011120092546461242, -9.998909917863969, -9.998814041543085, 0.001159666534070355, 0.07748884029442057, 0.0011086068731932866, -5.963310877504723, 0.0010261770322969232, 0.0010116266483777138, 0.0009940403364290498, 0.0009749088983199011, 0.0009561635900416915, -9.909880697457163, -9.875253020532403, 0.000986722282469052, 0.0009678688379734405, 0.040430967008457955, 0.0010548532670315654, 0.0010394840547617865, -9.998979070304653, 0.0010007555154441128, 0.0009810132427808664, -9.99895751458622, 0.0010274815931549872, 0.0010093450044397789, 2.2929999368478575, -9.999029639404661, 0.0010657306244388192, 0.0010500450356831987, 0.0010311110060332983, 0.0010105407160197223, 0.0009904144008901841, 0.0010488519614898046, 0.0010332920076941284, 0.0010185405234193982, 0.0010007152746514627, 0.9750634393502293, 0.0010734270648715346, 0.5576556411155505, 0.0010418414905093367, 0.0680480828609225, 0.0010041031897256264, 0.0010668900377513993, 2.4574883456209733, 0.0010353738087298292, 0.0010205632261798877, 0.0010026677756818704], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 388.93998747476917, "mean_inference_ms": 2.0953429327642024, "mean_action_processing_ms": 0.14500813531834136, "mean_env_wait_ms": 4.79768138112349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010487794876098633, "StateBufferConnector_ms": 0.006253957748413086, "ViewRequirementAgentConnector_ms": 0.17315006256103516}}, "episode_reward_max": 3.5432602813190313, "episode_reward_min": -19.998841645142992, "episode_reward_mean": -1.1355352714537867, "episode_len_mean": 25.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.001314956002715167, 0.0012812924782309061, 0.0012521410518102174, 1.4014762943639532, 0.0011979439002158677, 2.288311140649071, 0.0012675164547219936, 0.0012362090844328037, 0.0012090509594346042, 0.001184579799734998, 0.001330977431702506, 0.0013012114078489502, 0.0012682390989258363, 0.08719826499424148, 0.001216072882830318, 0.0013239447278114412, 0.0012917636853861409, 0.059370746514398394, 0.0012343645697053224, -9.800910786934347, 0.001121861717850342, 0.0010979180682247492, -9.998922458738473, 0.741895722693633, 0.5347648437327117, 0.0011059362564748824, 0.0010826606786760846, 0.20187030954808852, 3.5432602813190313, 0.0010280732021941876, 0.0011550643310857978, 0.06433986367520453, 0.0011094844843837904, -9.998912344157047, 0.00107107429598004, 0.0011394529899656225, 0.04616916396851522, 0.0010955227852352534, 0.0010742329592689337, 0.4083756334008113, 0.0011682977970978276, 0.0011423533677942259, 0.0011203192867975872, 0.10147947007957528, 2.4575183939140137, -19.998841645142992, 0.0011306088858255962, 0.0011062943562165635, -9.998914429827293, 3.507858241800806, 0.0011884470337322087, 0.001159263367876254, 0.0011337143565201195, 0.0011120092546461242, -9.998909917863969, -9.998814041543085, 0.001159666534070355, 0.07748884029442057, 0.0011086068731932866, -5.963310877504723, 0.0010261770322969232, 0.0010116266483777138, 0.0009940403364290498, 0.0009749088983199011, 0.0009561635900416915, -9.909880697457163, -9.875253020532403, 0.000986722282469052, 0.0009678688379734405, 0.040430967008457955, 0.0010548532670315654, 0.0010394840547617865, -9.998979070304653, 0.0010007555154441128, 0.0009810132427808664, -9.99895751458622, 0.0010274815931549872, 0.0010093450044397789, 2.2929999368478575, -9.999029639404661, 0.0010657306244388192, 0.0010500450356831987, 0.0010311110060332983, 0.0010105407160197223, 0.0009904144008901841, 0.0010488519614898046, 0.0010332920076941284, 0.0010185405234193982, 0.0010007152746514627, 0.9750634393502293, 0.0010734270648715346, 0.5576556411155505, 0.0010418414905093367, 0.0680480828609225, 0.0010041031897256264, 0.0010668900377513993, 2.4574883456209733, 0.0010353738087298292, 0.0010205632261798877, 0.0010026677756818704], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 388.93998747476917, "mean_inference_ms": 2.0953429327642024, "mean_action_processing_ms": 0.14500813531834136, "mean_env_wait_ms": 4.79768138112349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010487794876098633, "StateBufferConnector_ms": 0.006253957748413086, "ViewRequirementAgentConnector_ms": 0.17315006256103516}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 35100, "num_env_steps_sampled": 19000, "num_env_steps_trained": 35100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.727667537904151, "num_env_steps_trained_throughput_per_sec": 9.218951698913093, "timesteps_total": 19000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 19000, "timers": {"training_iteration_time_ms": 7769.263, "sample_time_ms": 7707.878, "load_time_ms": 0.243, "load_throughput": 321465.768, "learn_time_ms": 12.937, "learn_throughput": 6029.42, "synch_weights_time_ms": 11.885}, "counters": {"num_env_steps_sampled": 19000, "num_env_steps_trained": 35100, "num_agent_steps_sampled": 19000, "num_agent_steps_trained": 35100, "last_target_update_ts": 18720, "num_target_updates": 35}, "done": false, "episodes_total": 684, "training_iteration": 19, "trial_id": "2058a_00000", "date": "2024-04-17_06-30-32", "timestamp": 1713335432, "time_this_iter_s": 211.52928590774536, "time_total_s": 4206.5836136341095, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 4206.5836136341095, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.973754152823922, "ram_util_percent": 14.700000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04160839691758156, "cur_lr": 0.01}, "td_error": [1.791643738746643, 0.9605579376220703, 1.8409371376037598, 0.8086357116699219, 0.3154148757457733, 1.7916399240493774, 1.7916362285614014, 1.893723726272583, 1.2535943984985352, 2.08455228805542, 1.8395106792449951, 1.7916383743286133, 1.7916415929794312, 1.7916415929794312, 1.2535946369171143, 1.8392268419265747, 1.5923537015914917, 1.5490455627441406, 1.7916404008865356, 1.7916384935379028, 1.8925817012786865, 1.7916409969329834, 1.8392473459243774, 0.7751064300537109, 1.7916531562805176, 1.791648268699646, 1.2535946369171143, 1.8544483184814453, 2.9553704261779785, 0.8077868819236755, 1.79163658618927, 1.7916374206542969, 2.408836603164673, 1.4193507432937622, 1.7916347980499268, 1.7916510105133057, 1.791643500328064, 1.7916475534439087, 1.791637897491455, 1.9387139081954956, 1.4123644828796387, 3.227796792984009, 1.7916477918624878, 1.8916347026824951, 1.7916345596313477, 1.7916295528411865, 1.839806079864502, 1.839499831199646, 1.839451789855957, 1.7918214797973633, 1.9400262832641602, 1.5903005599975586, 1.8946146965026855, 1.7916390895843506, 1.7916427850723267, 1.839415192604065, 1.7924703359603882, 0.7750341892242432, 1.7916334867477417, 1.7916847467422485, 1.7916373014450073, 1.792568325996399, 1.8917127847671509, 1.8394136428833008, 1.8392173051834106, 1.8983012437820435, 1.7916446924209595, 1.8392845392227173, 1.791640043258667, 1.7916345596313477, 1.791672706604004, 1.7916604280471802, 3.9675211906433105, 1.791650414466858, 1.7916369438171387, 1.8392318487167358, 2.5185701847076416, 1.8251992464065552], "mean_td_error": 1.7746881246566772, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 475.0, "diff_num_grad_updates_vs_sampler_policy": 474.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 37050, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 37050, "last_target_update_ts": 19760, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": 3.507858241800806, "episode_reward_min": -19.998841645142992, "episode_reward_mean": -1.3788860697696668, "episode_len_mean": 25.16, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4083756334008113, 0.0011682977970978276, 0.0011423533677942259, 0.0011203192867975872, 0.10147947007957528, 2.4575183939140137, -19.998841645142992, 0.0011306088858255962, 0.0011062943562165635, -9.998914429827293, 3.507858241800806, 0.0011884470337322087, 0.001159263367876254, 0.0011337143565201195, 0.0011120092546461242, -9.998909917863969, -9.998814041543085, 0.001159666534070355, 0.07748884029442057, 0.0011086068731932866, -5.963310877504723, 0.0010261770322969232, 0.0010116266483777138, 0.0009940403364290498, 0.0009749088983199011, 0.0009561635900416915, -9.909880697457163, -9.875253020532403, 0.000986722282469052, 0.0009678688379734405, 0.040430967008457955, 0.0010548532670315654, 0.0010394840547617865, -9.998979070304653, 0.0010007555154441128, 0.0009810132427808664, -9.99895751458622, 0.0010274815931549872, 0.0010093450044397789, 2.2929999368478575, -9.999029639404661, 0.0010657306244388192, 0.0010500450356831987, 0.0010311110060332983, 0.0010105407160197223, 0.0009904144008901841, 0.0010488519614898046, 0.0010332920076941284, 0.0010185405234193982, 0.0010007152746514627, 0.9750634393502293, 0.0010734270648715346, 0.5576556411155505, 0.0010418414905093367, 0.0680480828609225, 0.0010041031897256264, 0.0010668900377513993, 2.4574883456209733, 0.0010353738087298292, 0.0010205632261798877, 0.0010026677756818704, -9.564052527027075, 0.0009247366153078296, 0.0009085861316924849, 0.4054929821711732, 0.0009361140910870633, 0.0009202620541023888, 0.4647354102408368, 0.0008895741322461391, 0.0008748125357245904, 0.0009645797418459462, 0.0009477577562678307, 0.7966546356791947, 0.0009151907210556797, 0.0008995735502630741, 0.0009542777853501902, 0.041197081614096034, -9.863818841995654, 0.04210499408248122, 0.9572685731342302, -19.394438212157354, 0.0009567239398718611, 0.0009394468019937132, 0.0009234147644108184, 0.0009075178869565334, 0.06019677815509083, 0.1712890418933673, 0.000932371457945021, 0.0009159554534446572, 0.0009007081234118916, 0.2914768966343792, 0.3858108589584266, 0.0009530403580556539, 0.0009358948647055014, 0.0009199827165373903, 0.04871623208502476, 0.000966330944430482, 0.0009503818348611049, 0.0009340471708487153, -9.99908242955484], "episode_lengths": [25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 391.38643011797643, "mean_inference_ms": 2.097553082266919, "mean_action_processing_ms": 0.14504873512654828, "mean_env_wait_ms": 4.558180875951463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01031494140625, "StateBufferConnector_ms": 0.0063288211822509766, "ViewRequirementAgentConnector_ms": 0.17504429817199707}}, "episode_reward_max": 3.507858241800806, "episode_reward_min": -19.998841645142992, "episode_reward_mean": -1.3788860697696668, "episode_len_mean": 25.16, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.4083756334008113, 0.0011682977970978276, 0.0011423533677942259, 0.0011203192867975872, 0.10147947007957528, 2.4575183939140137, -19.998841645142992, 0.0011306088858255962, 0.0011062943562165635, -9.998914429827293, 3.507858241800806, 0.0011884470337322087, 0.001159263367876254, 0.0011337143565201195, 0.0011120092546461242, -9.998909917863969, -9.998814041543085, 0.001159666534070355, 0.07748884029442057, 0.0011086068731932866, -5.963310877504723, 0.0010261770322969232, 0.0010116266483777138, 0.0009940403364290498, 0.0009749088983199011, 0.0009561635900416915, -9.909880697457163, -9.875253020532403, 0.000986722282469052, 0.0009678688379734405, 0.040430967008457955, 0.0010548532670315654, 0.0010394840547617865, -9.998979070304653, 0.0010007555154441128, 0.0009810132427808664, -9.99895751458622, 0.0010274815931549872, 0.0010093450044397789, 2.2929999368478575, -9.999029639404661, 0.0010657306244388192, 0.0010500450356831987, 0.0010311110060332983, 0.0010105407160197223, 0.0009904144008901841, 0.0010488519614898046, 0.0010332920076941284, 0.0010185405234193982, 0.0010007152746514627, 0.9750634393502293, 0.0010734270648715346, 0.5576556411155505, 0.0010418414905093367, 0.0680480828609225, 0.0010041031897256264, 0.0010668900377513993, 2.4574883456209733, 0.0010353738087298292, 0.0010205632261798877, 0.0010026677756818704, -9.564052527027075, 0.0009247366153078296, 0.0009085861316924849, 0.4054929821711732, 0.0009361140910870633, 0.0009202620541023888, 0.4647354102408368, 0.0008895741322461391, 0.0008748125357245904, 0.0009645797418459462, 0.0009477577562678307, 0.7966546356791947, 0.0009151907210556797, 0.0008995735502630741, 0.0009542777853501902, 0.041197081614096034, -9.863818841995654, 0.04210499408248122, 0.9572685731342302, -19.394438212157354, 0.0009567239398718611, 0.0009394468019937132, 0.0009234147644108184, 0.0009075178869565334, 0.06019677815509083, 0.1712890418933673, 0.000932371457945021, 0.0009159554534446572, 0.0009007081234118916, 0.2914768966343792, 0.3858108589584266, 0.0009530403580556539, 0.0009358948647055014, 0.0009199827165373903, 0.04871623208502476, 0.000966330944430482, 0.0009503818348611049, 0.0009340471708487153, -9.99908242955484], "episode_lengths": [25, 25, 25, 25, 25, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 391.38643011797643, "mean_inference_ms": 2.097553082266919, "mean_action_processing_ms": 0.14504873512654828, "mean_env_wait_ms": 4.558180875951463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01031494140625, "StateBufferConnector_ms": 0.0063288211822509766, "ViewRequirementAgentConnector_ms": 0.17504429817199707}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 37050, "num_env_steps_sampled": 20000, "num_env_steps_trained": 37050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.9149562873701185, "num_env_steps_trained_throughput_per_sec": 7.634164760371731, "timesteps_total": 20000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 10030.338, "sample_time_ms": 9969.967, "load_time_ms": 0.24, "load_throughput": 324817.029, "learn_time_ms": 12.893, "learn_throughput": 6049.6, "synch_weights_time_ms": 11.077}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 37050, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 37050, "last_target_update_ts": 19760, "num_target_updates": 37}, "done": false, "episodes_total": 723, "training_iteration": 20, "trial_id": "2058a_00000", "date": "2024-04-17_06-34-48", "timestamp": 1713335688, "time_this_iter_s": 255.44078040122986, "time_total_s": 4462.024394035339, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 4462.024394035339, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 11.43956043956044, "ram_util_percent": 14.800274725274726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03210984170436859, "cur_lr": 0.01}, "td_error": [2.133169174194336, 1.7759209871292114, 1.7759244441986084, 4.2182841300964355, 1.7759509086608887, 1.7761082649230957, 1.7759406566619873, 1.775925636291504, 1.7759263515472412, 1.2453755140304565, 1.2453761100769043, 1.8140432834625244, 1.7759313583374023, 1.7760586738586426, 3.613736152648926, 1.6405731439590454, 1.7759255170822144, 1.9366413354873657, 1.776415467262268, 1.8136711120605469, 1.7759246826171875, 1.775921106338501, 1.8158808946609497, 1.7759208679199219, 0.9730480909347534, 0.788694441318512, 1.8704912662506104, 1.2454285621643066, 1.81398344039917, 1.7759276628494263, 1.7759236097335815, 0.33192622661590576, 1.8691610097885132, 1.815969467163086, 1.7759416103363037, 1.8729249238967896, 1.7759194374084473, 1.8246147632598877, 1.7759277820587158, 1.8152328729629517, 1.245375633239746, 1.2453761100769043, 1.7759321928024292, 1.813706636428833, 1.7759329080581665, 1.7759262323379517, 1.9439853429794312, 1.7759358882904053, 1.7759220600128174, 1.7759345769882202, 0.39061295986175537, 1.7759455442428589, 1.489885926246643, 0.8242428302764893, 3.3992106914520264, 1.8139793872833252, 1.2453761100769043, 0.4030108153820038, 0.8249999284744263, 1.8139971494674683, 1.7759281396865845, 1.8730512857437134, 1.7759201526641846, 1.7759394645690918, 1.2607773542404175, 1.7759332656860352, 0.8230707049369812, 2.0321221351623535, 1.6401011943817139, 1.775928020477295, 1.3797993659973145, 1.7761247158050537, 1.775956153869629, 0.778020977973938, 1.7759705781936646, 1.775920033454895, 0.7780481576919556, 1.775922417640686], "mean_td_error": 1.6750191450119019, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 499.0}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 39000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 39000, "last_target_update_ts": 20800, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": 2.4574883456209733, "episode_reward_min": -19.394438212157354, "episode_reward_mean": -0.8875846021141682, "episode_len_mean": 25.1, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999029639404661, 0.0010657306244388192, 0.0010500450356831987, 0.0010311110060332983, 0.0010105407160197223, 0.0009904144008901841, 0.0010488519614898046, 0.0010332920076941284, 0.0010185405234193982, 0.0010007152746514627, 0.9750634393502293, 0.0010734270648715346, 0.5576556411155505, 0.0010418414905093367, 0.0680480828609225, 0.0010041031897256264, 0.0010668900377513993, 2.4574883456209733, 0.0010353738087298292, 0.0010205632261798877, 0.0010026677756818704, -9.564052527027075, 0.0009247366153078296, 0.0009085861316924849, 0.4054929821711732, 0.0009361140910870633, 0.0009202620541023888, 0.4647354102408368, 0.0008895741322461391, 0.0008748125357245904, 0.0009645797418459462, 0.0009477577562678307, 0.7966546356791947, 0.0009151907210556797, 0.0008995735502630741, 0.0009542777853501902, 0.041197081614096034, -9.863818841995654, 0.04210499408248122, 0.9572685731342302, -19.394438212157354, 0.0009567239398718611, 0.0009394468019937132, 0.0009234147644108184, 0.0009075178869565334, 0.06019677815509083, 0.1712890418933673, 0.000932371457945021, 0.0009159554534446572, 0.0009007081234118916, 0.2914768966343792, 0.3858108589584266, 0.0009530403580556539, 0.0009358948647055014, 0.0009199827165373903, 0.04871623208502476, 0.000966330944430482, 0.0009503818348611049, 0.0009340471708487153, -9.99908242955484, 0.000878931505153153, 0.000862976722876622, 0.5680241380842351, 0.0008362136818393131, 0.1215723020232195, 0.000859005510590439, 0.0008443216862537104, -9.99916761481693, 0.047223339983661954, 0.0008082822940589016, 0.11217608046020729, 0.0008680298128288613, 0.5203525263552123, 0.1751659694535638, -9.999170869825454, 0.0008780587107396628, 0.08978962732656305, 0.0008512269522121928, 0.0008390714926020398, -9.999175298482456, 0.00089051908332534, 0.0008747475511345951, 0.0008619152147141697, -9.999150536856206, 0.05895832023164836, 0.0008855775756470634, 0.0008693829621365176, 0.0008543451747651137, 0.0008421004399352493, 0.17791002213510795, 0.0009042028630191747, 0.000887326791534511, 0.0008716671819752652, 0.0008589244323672314, 0.07560186604223544, 0.0009022718744957237, 0.3282874079463305, 0.0008710522898230421, 0.0008559571765121224, 0.0008436665091055814], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 393.60851774086024, "mean_inference_ms": 2.0999245211348256, "mean_action_processing_ms": 0.14513321719500055, "mean_env_wait_ms": 4.335753691868519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010003805160522461, "StateBufferConnector_ms": 0.0065267086029052734, "ViewRequirementAgentConnector_ms": 0.17667698860168457}}, "episode_reward_max": 2.4574883456209733, "episode_reward_min": -19.394438212157354, "episode_reward_mean": -0.8875846021141682, "episode_len_mean": 25.1, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999029639404661, 0.0010657306244388192, 0.0010500450356831987, 0.0010311110060332983, 0.0010105407160197223, 0.0009904144008901841, 0.0010488519614898046, 0.0010332920076941284, 0.0010185405234193982, 0.0010007152746514627, 0.9750634393502293, 0.0010734270648715346, 0.5576556411155505, 0.0010418414905093367, 0.0680480828609225, 0.0010041031897256264, 0.0010668900377513993, 2.4574883456209733, 0.0010353738087298292, 0.0010205632261798877, 0.0010026677756818704, -9.564052527027075, 0.0009247366153078296, 0.0009085861316924849, 0.4054929821711732, 0.0009361140910870633, 0.0009202620541023888, 0.4647354102408368, 0.0008895741322461391, 0.0008748125357245904, 0.0009645797418459462, 0.0009477577562678307, 0.7966546356791947, 0.0009151907210556797, 0.0008995735502630741, 0.0009542777853501902, 0.041197081614096034, -9.863818841995654, 0.04210499408248122, 0.9572685731342302, -19.394438212157354, 0.0009567239398718611, 0.0009394468019937132, 0.0009234147644108184, 0.0009075178869565334, 0.06019677815509083, 0.1712890418933673, 0.000932371457945021, 0.0009159554534446572, 0.0009007081234118916, 0.2914768966343792, 0.3858108589584266, 0.0009530403580556539, 0.0009358948647055014, 0.0009199827165373903, 0.04871623208502476, 0.000966330944430482, 0.0009503818348611049, 0.0009340471708487153, -9.99908242955484, 0.000878931505153153, 0.000862976722876622, 0.5680241380842351, 0.0008362136818393131, 0.1215723020232195, 0.000859005510590439, 0.0008443216862537104, -9.99916761481693, 0.047223339983661954, 0.0008082822940589016, 0.11217608046020729, 0.0008680298128288613, 0.5203525263552123, 0.1751659694535638, -9.999170869825454, 0.0008780587107396628, 0.08978962732656305, 0.0008512269522121928, 0.0008390714926020398, -9.999175298482456, 0.00089051908332534, 0.0008747475511345951, 0.0008619152147141697, -9.999150536856206, 0.05895832023164836, 0.0008855775756470634, 0.0008693829621365176, 0.0008543451747651137, 0.0008421004399352493, 0.17791002213510795, 0.0009042028630191747, 0.000887326791534511, 0.0008716671819752652, 0.0008589244323672314, 0.07560186604223544, 0.0009022718744957237, 0.3282874079463305, 0.0008710522898230421, 0.0008559571765121224, 0.0008436665091055814], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 393.60851774086024, "mean_inference_ms": 2.0999245211348256, "mean_action_processing_ms": 0.14513321719500055, "mean_env_wait_ms": 4.335753691868519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010003805160522461, "StateBufferConnector_ms": 0.0065267086029052734, "ViewRequirementAgentConnector_ms": 0.17667698860168457}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 39000, "num_env_steps_sampled": 21000, "num_env_steps_trained": 39000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.493982855950157, "num_env_steps_trained_throughput_per_sec": 8.763266569102806, "timesteps_total": 21000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 21000, "timers": {"training_iteration_time_ms": 8912.366, "sample_time_ms": 8852.489, "load_time_ms": 0.235, "load_throughput": 331666.375, "learn_time_ms": 12.477, "learn_throughput": 6251.662, "synch_weights_time_ms": 10.979}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 39000, "num_agent_steps_sampled": 21000, "num_agent_steps_trained": 39000, "last_target_update_ts": 20800, "num_target_updates": 39}, "done": false, "episodes_total": 763, "training_iteration": 21, "trial_id": "2058a_00000", "date": "2024-04-17_06-38-30", "timestamp": 1713335910, "time_this_iter_s": 222.52786445617676, "time_total_s": 4684.552258491516, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 4684.552258491516, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.327760252365929, "ram_util_percent": 14.8801261829653}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.026205679401755333, "cur_lr": 0.01}, "td_error": [1.2162010669708252, 1.7637794017791748, 1.763775110244751, 1.7637782096862793, 1.2591209411621094, 0.7641850113868713, 1.8182615041732788, 1.76377272605896, 1.2162020206451416, 1.7763601541519165, 1.7637760639190674, 1.7637875080108643, 1.7637760639190674, 1.9927997589111328, 1.8317053318023682, 1.763929009437561, 1.868789792060852, 1.7637759447097778, 1.763816237449646, 1.8159512281417847, 1.76417076587677, 1.8143984079360962, 1.814337968826294, 1.503599762916565, 1.7638072967529297, 1.6155885457992554, 1.7639498710632324, 1.8141350746154785, 1.7730371952056885, 1.8686624765396118, 1.7659121751785278, 1.814166784286499, 1.635402798652649, 1.8140418529510498, 1.7640905380249023, 1.8140908479690552, 1.8142069578170776, 1.7637708187103271, 1.7637814283370972, 2.001929759979248, 1.2591209411621094, 1.8141719102859497, 1.7637752294540405, 1.8688089847564697, 1.763775110244751, 1.7637819051742554, 1.7637704610824585, 1.7637728452682495, 1.5348694324493408, 1.7637965679168701, 2.519928216934204, 1.7637907266616821, 3.6825435161590576, 1.8146740198135376, 0.7986300587654114, 1.7637789249420166, 1.7637797594070435, 1.7637708187103271, 0.7641659379005432, 1.2162033319473267, 1.7637770175933838, 1.763788104057312, 1.8683141469955444, 1.763777256011963, 1.7637736797332764, 1.7637940645217896, 1.2162036895751953, 0.33865824341773987, 1.2162034511566162, 1.7637815475463867, 1.5345730781555176, 1.6498327255249023, 1.7637743949890137, 2.3272016048431396, 1.7637746334075928, 1.7637789249420166, 1.7637832164764404, 1.7637776136398315], "mean_td_error": 1.7065142393112183, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 525.0, "diff_num_grad_updates_vs_sampler_policy": 524.0}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 40950, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 40950, "last_target_update_ts": 21840, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": 0.5911751614414134, "episode_reward_min": -19.99923325638618, "episode_reward_mean": -1.246587505747727, "episode_len_mean": 25.13, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.394438212157354, 0.0009567239398718611, 0.0009394468019937132, 0.0009234147644108184, 0.0009075178869565334, 0.06019677815509083, 0.1712890418933673, 0.000932371457945021, 0.0009159554534446572, 0.0009007081234118916, 0.2914768966343792, 0.3858108589584266, 0.0009530403580556539, 0.0009358948647055014, 0.0009199827165373903, 0.04871623208502476, 0.000966330944430482, 0.0009503818348611049, 0.0009340471708487153, -9.99908242955484, 0.000878931505153153, 0.000862976722876622, 0.5680241380842351, 0.0008362136818393131, 0.1215723020232195, 0.000859005510590439, 0.0008443216862537104, -9.99916761481693, 0.047223339983661954, 0.0008082822940589016, 0.11217608046020729, 0.0008680298128288613, 0.5203525263552123, 0.1751659694535638, -9.999170869825454, 0.0008780587107396628, 0.08978962732656305, 0.0008512269522121928, 0.0008390714926020398, -9.999175298482456, 0.00089051908332534, 0.0008747475511345951, 0.0008619152147141697, -9.999150536856206, 0.05895832023164836, 0.0008855775756470634, 0.0008693829621365176, 0.0008543451747651137, 0.0008421004399352493, 0.17791002213510795, 0.0009042028630191747, 0.000887326791534511, 0.0008716671819752652, 0.0008589244323672314, 0.07560186604223544, 0.0009022718744957237, 0.3282874079463305, 0.0008710522898230421, 0.0008559571765121224, 0.0008436665091055814, 0.0008111245516816969, 0.0007993406665738514, 0.0007873451545029744, 0.0007747379954407622, 0.0007617856333871936, 0.0007965802449665261, 0.0007846668062278366, 0.0007721445895289432, 0.0007592780995378982, 0.0007465264328322254, -9.999183173719427, 0.0008043034174548502, 0.0007911518815925116, 0.0007776495137457188, 0.0007642789413585523, -9.999187530777451, 0.0008001305387182397, 0.24277348448390915, 0.0007739808803187485, 0.000760735049776776, 0.0008230458704497055, 0.0008103341372036694, 0.0007969862818391107, 0.0007832857026708728, 0.0007697223685909535, 0.17789686915006267, 0.0008048275998980425, -9.999207313049443, 0.0007798913130478554, -19.99923325638618, 0.06964267760879951, 0.0008214006475272506, 0.0008087392824852718, 0.0007954434839378275, 0.0007817954561589804, 0.5911751614414134, 0.0008177116536808751, 0.0008057370287726407, -9.643975607739227, 0.0007813951087889726], "episode_lengths": [27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 395.820288248046, "mean_inference_ms": 2.102714990784036, "mean_action_processing_ms": 0.14522076530323147, "mean_env_wait_ms": 4.134384998742444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009914398193359375, "StateBufferConnector_ms": 0.006621837615966797, "ViewRequirementAgentConnector_ms": 0.1802980899810791}}, "episode_reward_max": 0.5911751614414134, "episode_reward_min": -19.99923325638618, "episode_reward_mean": -1.246587505747727, "episode_len_mean": 25.13, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.394438212157354, 0.0009567239398718611, 0.0009394468019937132, 0.0009234147644108184, 0.0009075178869565334, 0.06019677815509083, 0.1712890418933673, 0.000932371457945021, 0.0009159554534446572, 0.0009007081234118916, 0.2914768966343792, 0.3858108589584266, 0.0009530403580556539, 0.0009358948647055014, 0.0009199827165373903, 0.04871623208502476, 0.000966330944430482, 0.0009503818348611049, 0.0009340471708487153, -9.99908242955484, 0.000878931505153153, 0.000862976722876622, 0.5680241380842351, 0.0008362136818393131, 0.1215723020232195, 0.000859005510590439, 0.0008443216862537104, -9.99916761481693, 0.047223339983661954, 0.0008082822940589016, 0.11217608046020729, 0.0008680298128288613, 0.5203525263552123, 0.1751659694535638, -9.999170869825454, 0.0008780587107396628, 0.08978962732656305, 0.0008512269522121928, 0.0008390714926020398, -9.999175298482456, 0.00089051908332534, 0.0008747475511345951, 0.0008619152147141697, -9.999150536856206, 0.05895832023164836, 0.0008855775756470634, 0.0008693829621365176, 0.0008543451747651137, 0.0008421004399352493, 0.17791002213510795, 0.0009042028630191747, 0.000887326791534511, 0.0008716671819752652, 0.0008589244323672314, 0.07560186604223544, 0.0009022718744957237, 0.3282874079463305, 0.0008710522898230421, 0.0008559571765121224, 0.0008436665091055814, 0.0008111245516816969, 0.0007993406665738514, 0.0007873451545029744, 0.0007747379954407622, 0.0007617856333871936, 0.0007965802449665261, 0.0007846668062278366, 0.0007721445895289432, 0.0007592780995378982, 0.0007465264328322254, -9.999183173719427, 0.0008043034174548502, 0.0007911518815925116, 0.0007776495137457188, 0.0007642789413585523, -9.999187530777451, 0.0008001305387182397, 0.24277348448390915, 0.0007739808803187485, 0.000760735049776776, 0.0008230458704497055, 0.0008103341372036694, 0.0007969862818391107, 0.0007832857026708728, 0.0007697223685909535, 0.17789686915006267, 0.0008048275998980425, -9.999207313049443, 0.0007798913130478554, -19.99923325638618, 0.06964267760879951, 0.0008214006475272506, 0.0008087392824852718, 0.0007954434839378275, 0.0007817954561589804, 0.5911751614414134, 0.0008177116536808751, 0.0008057370287726407, -9.643975607739227, 0.0007813951087889726], "episode_lengths": [27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 395.820288248046, "mean_inference_ms": 2.102714990784036, "mean_action_processing_ms": 0.14522076530323147, "mean_env_wait_ms": 4.134384998742444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009914398193359375, "StateBufferConnector_ms": 0.006621837615966797, "ViewRequirementAgentConnector_ms": 0.1802980899810791}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 40950, "num_env_steps_sampled": 22000, "num_env_steps_trained": 40950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.4858082517118625, "num_env_steps_trained_throughput_per_sec": 8.747326090838133, "timesteps_total": 22000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 8894.45, "sample_time_ms": 8832.106, "load_time_ms": 0.25, "load_throughput": 311547.197, "learn_time_ms": 12.763, "learn_throughput": 6111.519, "synch_weights_time_ms": 13.317}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 40950, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 40950, "last_target_update_ts": 21840, "num_target_updates": 41}, "done": false, "episodes_total": 803, "training_iteration": 22, "trial_id": "2058a_00000", "date": "2024-04-17_06-42-13", "timestamp": 1713336133, "time_this_iter_s": 222.9345896244049, "time_total_s": 4907.486848115921, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 4907.486848115921, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.489589905362775, "ram_util_percent": 15.022082018927446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.058429915457963943, "cur_lr": 0.01}, "td_error": [0.3842495083808899, 1.7518911361694336, 1.751887559890747, 1.7519532442092896, 1.8116084337234497, 1.751888632774353, 1.8203061819076538, 1.751889705657959, 1.8115897178649902, 0.7899326682090759, 1.7518906593322754, 1.7518894672393799, 3.144104242324829, 1.7518879175186157, 1.7519429922103882, 2.0417258739471436, 0.787583589553833, 1.7518876791000366, 1.7518876791000366, 1.2001965045928955, 1.7518868446350098, 1.879239559173584, 1.7518895864486694, 1.8795475959777832, 1.2002034187316895, 1.751888632774353, 1.7518893480300903, 0.7874847650527954, 1.879469633102417, 0.3842495083808899, 1.7518874406814575, 1.7518868446350098, 1.7518877983093262, 1.7518916130065918, 1.7518939971923828, 1.885202169418335, 1.4334644079208374, 1.7518900632858276, 1.8118517398834229, 1.752558708190918, 1.879355788230896, 1.7518893480300903, 1.751890778541565, 0.7874847650527954, 1.7518930435180664, 1.7527161836624146, 1.7518892288208008, 2.0729446411132812, 1.8117835521697998, 1.751927137374878, 3.4453282356262207, 1.7518877983093262, 1.7518870830535889, 1.7518880367279053, 1.3894131183624268, 1.8713569641113281, 1.2001452445983887, 1.751992106437683, 1.3893191814422607, 1.200199842453003, 1.751888632774353, 1.751888394355774, 1.8637213706970215, 1.7518892288208008, 1.443200945854187, 1.751889705657959, 0.3842495083808899, 0.7512866854667664, 1.7518895864486694, 1.9975179433822632, 1.8115756511688232, 1.7518889904022217, 1.7518887519836426, 1.7518894672393799, 1.8126227855682373, 1.8463668823242188, 3.4933416843414307, 2.0450479984283447], "mean_td_error": 1.6859689950942993, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 550.0, "diff_num_grad_updates_vs_sampler_policy": 549.0}}, "num_env_steps_sampled": 23000, "num_env_steps_trained": 42900, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 42900, "last_target_update_ts": 22880, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": 0.6148116003611938, "episode_reward_min": -19.99923325638618, "episode_reward_mean": -1.5441767989950625, "episode_len_mean": 25.16, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999175298482456, 0.00089051908332534, 0.0008747475511345951, 0.0008619152147141697, -9.999150536856206, 0.05895832023164836, 0.0008855775756470634, 0.0008693829621365176, 0.0008543451747651137, 0.0008421004399352493, 0.17791002213510795, 0.0009042028630191747, 0.000887326791534511, 0.0008716671819752652, 0.0008589244323672314, 0.07560186604223544, 0.0009022718744957237, 0.3282874079463305, 0.0008710522898230421, 0.0008559571765121224, 0.0008436665091055814, 0.0008111245516816969, 0.0007993406665738514, 0.0007873451545029744, 0.0007747379954407622, 0.0007617856333871936, 0.0007965802449665261, 0.0007846668062278366, 0.0007721445895289432, 0.0007592780995378982, 0.0007465264328322254, -9.999183173719427, 0.0008043034174548502, 0.0007911518815925116, 0.0007776495137457188, 0.0007642789413585523, -9.999187530777451, 0.0008001305387182397, 0.24277348448390915, 0.0007739808803187485, 0.000760735049776776, 0.0008230458704497055, 0.0008103341372036694, 0.0007969862818391107, 0.0007832857026708728, 0.0007697223685909535, 0.17789686915006267, 0.0008048275998980425, -9.999207313049443, 0.0007798913130478554, -19.99923325638618, 0.06964267760879951, 0.0008214006475272506, 0.0008087392824852718, 0.0007954434839378275, 0.0007817954561589804, 0.5911751614414134, 0.0008177116536808751, 0.0008057370287726407, -9.643975607739227, 0.0007813951087889726, 0.08469520287233227, 0.0007373350423928783, -9.999273439126046, 0.0007167581691762678, 0.0007072164983660536, 0.0007344666675662968, 0.000723744617064083, 0.000714047372797274, 0.0007045772821330423, 0.0006956746846506241, 0.0007516435041157913, 0.04193463671499963, 0.0007313515800997142, 0.0007214199915407355, 0.4825069859280281, 0.0007482155876063411, 0.0007370913333256793, 0.0007270356250811595, 0.00071722015605794, 0.0007079973947021238, 0.35495238601377266, -9.999254332116605, -9.3251843275323, 0.0007263724817446142, -9.940039536836288, -9.999246233840806, 0.0007414723405691943, 0.0007305462616923494, 0.6148116003611938, 0.0007111439194288476, -9.99923171581508, 0.0007555161096470798, 0.0007441753239696693, -8.922098300410374, -9.999231778028566, 0.0007551698910459258, 0.0007428314886624271, 0.0007318656074032331, 0.04811123789634704], "episode_lengths": [26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 397.6417192628464, "mean_inference_ms": 2.1055984214723784, "mean_action_processing_ms": 0.14525824439217833, "mean_env_wait_ms": 3.9562741511078308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010002851486206055, "StateBufferConnector_ms": 0.006554126739501953, "ViewRequirementAgentConnector_ms": 0.18132996559143066}}, "episode_reward_max": 0.6148116003611938, "episode_reward_min": -19.99923325638618, "episode_reward_mean": -1.5441767989950625, "episode_len_mean": 25.16, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999175298482456, 0.00089051908332534, 0.0008747475511345951, 0.0008619152147141697, -9.999150536856206, 0.05895832023164836, 0.0008855775756470634, 0.0008693829621365176, 0.0008543451747651137, 0.0008421004399352493, 0.17791002213510795, 0.0009042028630191747, 0.000887326791534511, 0.0008716671819752652, 0.0008589244323672314, 0.07560186604223544, 0.0009022718744957237, 0.3282874079463305, 0.0008710522898230421, 0.0008559571765121224, 0.0008436665091055814, 0.0008111245516816969, 0.0007993406665738514, 0.0007873451545029744, 0.0007747379954407622, 0.0007617856333871936, 0.0007965802449665261, 0.0007846668062278366, 0.0007721445895289432, 0.0007592780995378982, 0.0007465264328322254, -9.999183173719427, 0.0008043034174548502, 0.0007911518815925116, 0.0007776495137457188, 0.0007642789413585523, -9.999187530777451, 0.0008001305387182397, 0.24277348448390915, 0.0007739808803187485, 0.000760735049776776, 0.0008230458704497055, 0.0008103341372036694, 0.0007969862818391107, 0.0007832857026708728, 0.0007697223685909535, 0.17789686915006267, 0.0008048275998980425, -9.999207313049443, 0.0007798913130478554, -19.99923325638618, 0.06964267760879951, 0.0008214006475272506, 0.0008087392824852718, 0.0007954434839378275, 0.0007817954561589804, 0.5911751614414134, 0.0008177116536808751, 0.0008057370287726407, -9.643975607739227, 0.0007813951087889726, 0.08469520287233227, 0.0007373350423928783, -9.999273439126046, 0.0007167581691762678, 0.0007072164983660536, 0.0007344666675662968, 0.000723744617064083, 0.000714047372797274, 0.0007045772821330423, 0.0006956746846506241, 0.0007516435041157913, 0.04193463671499963, 0.0007313515800997142, 0.0007214199915407355, 0.4825069859280281, 0.0007482155876063411, 0.0007370913333256793, 0.0007270356250811595, 0.00071722015605794, 0.0007079973947021238, 0.35495238601377266, -9.999254332116605, -9.3251843275323, 0.0007263724817446142, -9.940039536836288, -9.999246233840806, 0.0007414723405691943, 0.0007305462616923494, 0.6148116003611938, 0.0007111439194288476, -9.99923171581508, 0.0007555161096470798, 0.0007441753239696693, -8.922098300410374, -9.999231778028566, 0.0007551698910459258, 0.0007428314886624271, 0.0007318656074032331, 0.04811123789634704], "episode_lengths": [26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 397.6417192628464, "mean_inference_ms": 2.1055984214723784, "mean_action_processing_ms": 0.14525824439217833, "mean_env_wait_ms": 3.9562741511078308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010002851486206055, "StateBufferConnector_ms": 0.006554126739501953, "ViewRequirementAgentConnector_ms": 0.18132996559143066}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 42900, "num_env_steps_sampled": 23000, "num_env_steps_trained": 42900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.49524286605407, "num_env_steps_trained_throughput_per_sec": 8.765723588805438, "timesteps_total": 23000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 23000, "timers": {"training_iteration_time_ms": 8924.351, "sample_time_ms": 8861.792, "load_time_ms": 0.244, "load_throughput": 319332.076, "learn_time_ms": 13.203, "learn_throughput": 5907.972, "synch_weights_time_ms": 11.004}, "counters": {"num_env_steps_sampled": 23000, "num_env_steps_trained": 42900, "num_agent_steps_sampled": 23000, "num_agent_steps_trained": 42900, "last_target_update_ts": 22880, "num_target_updates": 43}, "done": false, "episodes_total": 842, "training_iteration": 23, "trial_id": "2058a_00000", "date": "2024-04-17_06-45-56", "timestamp": 1713336356, "time_this_iter_s": 222.46549582481384, "time_total_s": 5129.952343940735, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5129.952343940735, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.763722397476341, "ram_util_percent": 15.203470031545741}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.034179747104644775, "cur_lr": 0.01}, "td_error": [1.8162925243377686, 1.7645773887634277, 1.7645759582519531, 1.8146706819534302, 1.973901391029358, 0.7479593753814697, 3.047374963760376, 3.5007429122924805, 1.7645624876022339, 1.7645623683929443, 1.815414547920227, 1.7645667791366577, 1.764573097229004, 1.7645710706710815, 1.8144266605377197, 0.7588006258010864, 1.8157280683517456, 1.1933039426803589, 0.7524303793907166, 1.193303108215332, 1.6204371452331543, 1.7645617723464966, 1.7645732164382935, 1.1933016777038574, 1.7645691633224487, 1.8146135807037354, 1.7651710510253906, 1.7752578258514404, 1.7646273374557495, 1.7645739316940308, 1.8908588886260986, 1.1933016777038574, 1.764567494392395, 1.764586091041565, 1.7646129131317139, 1.764632225036621, 1.7645690441131592, 1.7645766735076904, 1.764562726020813, 1.7645747661590576, 1.7645665407180786, 1.7645657062530518, 1.7649216651916504, 1.8144224882125854, 0.7479593753814697, 1.764564037322998, 2.010423183441162, 1.764568567276001, 1.7648478746414185, 1.1933056116104126, 1.193302035331726, 1.7645668983459473, 1.7645800113677979, 1.878855586051941, 1.7646788358688354, 0.340596079826355, 0.340596079826355, 1.7645692825317383, 1.7645868062973022, 1.7645680904388428, 1.7645680904388428, 1.7646064758300781, 1.7645623683929443, 1.8842175006866455, 1.8681820631027222, 1.7645697593688965, 1.764564871788025, 1.7646139860153198, 1.1933014392852783, 1.7645628452301025, 1.4289860725402832, 1.7645626068115234, 1.764567494392395, 1.7645725011825562, 1.814555287361145, 1.7645683288574219, 1.764575719833374, 1.6035951375961304], "mean_td_error": 1.672456979751587, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 575.0, "diff_num_grad_updates_vs_sampler_policy": 574.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 44850, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 44850, "last_target_update_ts": 23920, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": 0.6148116003611938, "episode_reward_min": -29.99931274212638, "episode_reward_mean": -2.241627014974839, "episode_len_mean": 25.19, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.000760735049776776, 0.0008230458704497055, 0.0008103341372036694, 0.0007969862818391107, 0.0007832857026708728, 0.0007697223685909535, 0.17789686915006267, 0.0008048275998980425, -9.999207313049443, 0.0007798913130478554, -19.99923325638618, 0.06964267760879951, 0.0008214006475272506, 0.0008087392824852718, 0.0007954434839378275, 0.0007817954561589804, 0.5911751614414134, 0.0008177116536808751, 0.0008057370287726407, -9.643975607739227, 0.0007813951087889726, 0.08469520287233227, 0.0007373350423928783, -9.999273439126046, 0.0007167581691762678, 0.0007072164983660536, 0.0007344666675662968, 0.000723744617064083, 0.000714047372797274, 0.0007045772821330423, 0.0006956746846506241, 0.0007516435041157913, 0.04193463671499963, 0.0007313515800997142, 0.0007214199915407355, 0.4825069859280281, 0.0007482155876063411, 0.0007370913333256793, 0.0007270356250811595, 0.00071722015605794, 0.0007079973947021238, 0.35495238601377266, -9.999254332116605, -9.3251843275323, 0.0007263724817446142, -9.940039536836288, -9.999246233840806, 0.0007414723405691943, 0.0007305462616923494, 0.6148116003611938, 0.0007111439194288476, -9.99923171581508, 0.0007555161096470798, 0.0007441753239696693, -8.922098300410374, -9.999231778028566, 0.0007551698910459258, 0.0007428314886624271, 0.0007318656074032331, 0.04811123789634704, 0.09101252776792775, -29.99931274212638, 0.0006779332532172602, 0.0006690209641239883, 0.0006601255621046252, -9.957802271298641, 0.11020797743831692, 0.0006674636676006924, -9.918359561930032, 0.0006250784743339726, 0.0007001833984417901, 0.0006905038538804783, 0.0006812603630677875, -9.999327953895232, 0.0006373326646036687, 0.0006961140291324293, -19.99931345250783, 0.0006774074135654508, 0.0006682890535286382, 0.0006338195941197746, -9.999294487158743, 0.000695685523281718, 0.0006863037757026539, -9.446145400360876, 0.0006420074237244479, 0.0007020757270670005, 0.0006903885902690303, 0.0006809763364009163, 0.040044127126894036, 0.12340370610056386, 0.0007241876852280734, 0.0007147860962347095, 0.0007026757965406683, -9.999307071579873, 0.0006836196107422299, 0.0007132912816662177, 0.0007041686113392101, 0.0006924123051375954, 0.0006829451290477355, 0.10318619173415731], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 28, 25, 25, 25, 26, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 27, 25, 25, 24, 26, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 399.29612916573257, "mean_inference_ms": 2.1076245960146376, "mean_action_processing_ms": 0.14528449412207625, "mean_env_wait_ms": 3.7889439848230877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009850502014160156, "StateBufferConnector_ms": 0.006324052810668945, "ViewRequirementAgentConnector_ms": 0.17771387100219727}}, "episode_reward_max": 0.6148116003611938, "episode_reward_min": -29.99931274212638, "episode_reward_mean": -2.241627014974839, "episode_len_mean": 25.19, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.000760735049776776, 0.0008230458704497055, 0.0008103341372036694, 0.0007969862818391107, 0.0007832857026708728, 0.0007697223685909535, 0.17789686915006267, 0.0008048275998980425, -9.999207313049443, 0.0007798913130478554, -19.99923325638618, 0.06964267760879951, 0.0008214006475272506, 0.0008087392824852718, 0.0007954434839378275, 0.0007817954561589804, 0.5911751614414134, 0.0008177116536808751, 0.0008057370287726407, -9.643975607739227, 0.0007813951087889726, 0.08469520287233227, 0.0007373350423928783, -9.999273439126046, 0.0007167581691762678, 0.0007072164983660536, 0.0007344666675662968, 0.000723744617064083, 0.000714047372797274, 0.0007045772821330423, 0.0006956746846506241, 0.0007516435041157913, 0.04193463671499963, 0.0007313515800997142, 0.0007214199915407355, 0.4825069859280281, 0.0007482155876063411, 0.0007370913333256793, 0.0007270356250811595, 0.00071722015605794, 0.0007079973947021238, 0.35495238601377266, -9.999254332116605, -9.3251843275323, 0.0007263724817446142, -9.940039536836288, -9.999246233840806, 0.0007414723405691943, 0.0007305462616923494, 0.6148116003611938, 0.0007111439194288476, -9.99923171581508, 0.0007555161096470798, 0.0007441753239696693, -8.922098300410374, -9.999231778028566, 0.0007551698910459258, 0.0007428314886624271, 0.0007318656074032331, 0.04811123789634704, 0.09101252776792775, -29.99931274212638, 0.0006779332532172602, 0.0006690209641239883, 0.0006601255621046252, -9.957802271298641, 0.11020797743831692, 0.0006674636676006924, -9.918359561930032, 0.0006250784743339726, 0.0007001833984417901, 0.0006905038538804783, 0.0006812603630677875, -9.999327953895232, 0.0006373326646036687, 0.0006961140291324293, -19.99931345250783, 0.0006774074135654508, 0.0006682890535286382, 0.0006338195941197746, -9.999294487158743, 0.000695685523281718, 0.0006863037757026539, -9.446145400360876, 0.0006420074237244479, 0.0007020757270670005, 0.0006903885902690303, 0.0006809763364009163, 0.040044127126894036, 0.12340370610056386, 0.0007241876852280734, 0.0007147860962347095, 0.0007026757965406683, -9.999307071579873, 0.0006836196107422299, 0.0007132912816662177, 0.0007041686113392101, 0.0006924123051375954, 0.0006829451290477355, 0.10318619173415731], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 28, 25, 25, 25, 26, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 27, 25, 25, 24, 26, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 399.29612916573257, "mean_inference_ms": 2.1076245960146376, "mean_action_processing_ms": 0.14528449412207625, "mean_env_wait_ms": 3.7889439848230877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009850502014160156, "StateBufferConnector_ms": 0.006324052810668945, "ViewRequirementAgentConnector_ms": 0.17771387100219727}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 44850, "num_env_steps_sampled": 24000, "num_env_steps_trained": 44850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.094315145335793, "num_env_steps_trained_throughput_per_sec": 7.983914533404797, "timesteps_total": 24000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9977.889, "sample_time_ms": 9918.055, "load_time_ms": 0.255, "load_throughput": 305610.193, "learn_time_ms": 12.443, "learn_throughput": 6268.612, "synch_weights_time_ms": 11.044}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 44850, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 44850, "last_target_update_ts": 23920, "num_target_updates": 45}, "done": false, "episodes_total": 882, "training_iteration": 24, "trial_id": "2058a_00000", "date": "2024-04-17_06-50-00", "timestamp": 1713336600, "time_this_iter_s": 244.24934577941895, "time_total_s": 5374.201689720154, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5374.201689720154, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 12.222190201729108, "ram_util_percent": 15.228818443804034}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03463862091302872, "cur_lr": 0.01}, "td_error": [1.7150697708129883, 1.349363088607788, 1.714510202407837, 3.8757872581481934, 0.850578248500824, 1.8428291082382202, 2.068885326385498, 1.7145109176635742, 1.7775498628616333, 1.8303606510162354, 1.7145122289657593, 1.7145426273345947, 1.714514136314392, 2.1363043785095215, 1.72890043258667, 1.7145133018493652, 1.714514136314392, 1.7145106792449951, 3.294515609741211, 1.3023630380630493, 1.7145957946777344, 1.714514970779419, 1.7145131826400757, 1.7145147323608398, 1.7145124673843384, 1.714516043663025, 1.714511752128601, 1.8182973861694336, 1.7145624160766602, 1.777587652206421, 1.1645159721374512, 1.7788845300674438, 1.714524269104004, 1.8584880828857422, 1.164516806602478, 1.7145254611968994, 1.4938225746154785, 1.7145241498947144, 1.714514970779419, 1.7145118713378906, 1.1645164489746094, 1.7145198583602905, 2.379603385925293, 1.7145156860351562, 2.052558422088623, 1.714518666267395, 3.2980690002441406, 1.1643195152282715, 2.1387851238250732, 1.7145212888717651, 1.7145111560821533, 2.134455442428589, 1.1645166873931885, 1.7145116329193115, 1.8193577527999878, 1.7145110368728638, 1.714526891708374, 1.1645184755325317, 1.7145135402679443, 0.7701540589332581, 1.1645182371139526, 1.714511752128601, 1.6541749238967896, 1.7147022485733032, 1.7145146131515503, 3.0403435230255127, 1.6627479791641235, 1.714510202407837, 1.778273582458496, 1.7924290895462036, 2.135854959487915, 1.714512825012207, 1.7801610231399536, 1.7145142555236816, 1.7145122289657593, 1.7147088050842285, 1.662899136543274, 1.7145109176635742], "mean_td_error": 1.7643266916275024, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 600.0, "diff_num_grad_updates_vs_sampler_policy": 599.0}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 46800, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 46800, "last_target_update_ts": 24960, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": 1.6947305750749102, "episode_reward_min": -29.99931274212638, "episode_reward_mean": -2.2298545994473407, "episode_len_mean": 25.15, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00071722015605794, 0.0007079973947021238, 0.35495238601377266, -9.999254332116605, -9.3251843275323, 0.0007263724817446142, -9.940039536836288, -9.999246233840806, 0.0007414723405691943, 0.0007305462616923494, 0.6148116003611938, 0.0007111439194288476, -9.99923171581508, 0.0007555161096470798, 0.0007441753239696693, -8.922098300410374, -9.999231778028566, 0.0007551698910459258, 0.0007428314886624271, 0.0007318656074032331, 0.04811123789634704, 0.09101252776792775, -29.99931274212638, 0.0006779332532172602, 0.0006690209641239883, 0.0006601255621046252, -9.957802271298641, 0.11020797743831692, 0.0006674636676006924, -9.918359561930032, 0.0006250784743339726, 0.0007001833984417901, 0.0006905038538804783, 0.0006812603630677875, -9.999327953895232, 0.0006373326646036687, 0.0006961140291324293, -19.99931345250783, 0.0006774074135654508, 0.0006682890535286382, 0.0006338195941197746, -9.999294487158743, 0.000695685523281718, 0.0006863037757026539, -9.446145400360876, 0.0006420074237244479, 0.0007020757270670005, 0.0006903885902690303, 0.0006809763364009163, 0.040044127126894036, 0.12340370610056386, 0.0007241876852280734, 0.0007147860962347095, 0.0007026757965406683, -9.999307071579873, 0.0006836196107422299, 0.0007132912816662177, 0.0007041686113392101, 0.0006924123051375954, 0.0006829451290477355, 0.10318619173415731, 0.0006261694286108741, -9.999356050759358, 0.0006378091514609764, 0.06986252411915489, 0.0006254003212596649, 0.0006428409124761551, 0.0006367224981690365, 0.0006288035479190109, 0.0006237562846510561, 0.0006163934092451839, 0.0006552798934578159, 0.0006489235570100194, -9.999359299120533, 0.0006354608921525664, -19.114849155729836, 0.0006457348525692085, 0.0006375916161682799, 0.000632402815144963, 0.000624835668400172, 0.0006600235123926635, 0.000653575260280226, 0.0006452343893621602, 0.000639920917013869, 1.6947305750749102, 0.0006303074447963915, 0.0006481494936880823, -9.99935807673435, 0.0006338819192018593, 0.21918700890565207, 0.08165552668674504, 0.0006398292074047649, 0.0006578133229498968, 0.0006514079783135941, 0.0006431219723170816, 0.03380056065875745, 0.0006317708718153495, 0.000649634998930587, 0.0006433871902726514, 0.0006353026767804459], "episode_lengths": [25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 28, 25, 25, 25, 26, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 27, 25, 25, 24, 26, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 400.63070108760076, "mean_inference_ms": 2.1072679003183628, "mean_action_processing_ms": 0.1451888312394071, "mean_env_wait_ms": 3.6385379314820843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009804487228393555, "StateBufferConnector_ms": 0.006191730499267578, "ViewRequirementAgentConnector_ms": 0.17443346977233887}}, "episode_reward_max": 1.6947305750749102, "episode_reward_min": -29.99931274212638, "episode_reward_mean": -2.2298545994473407, "episode_len_mean": 25.15, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00071722015605794, 0.0007079973947021238, 0.35495238601377266, -9.999254332116605, -9.3251843275323, 0.0007263724817446142, -9.940039536836288, -9.999246233840806, 0.0007414723405691943, 0.0007305462616923494, 0.6148116003611938, 0.0007111439194288476, -9.99923171581508, 0.0007555161096470798, 0.0007441753239696693, -8.922098300410374, -9.999231778028566, 0.0007551698910459258, 0.0007428314886624271, 0.0007318656074032331, 0.04811123789634704, 0.09101252776792775, -29.99931274212638, 0.0006779332532172602, 0.0006690209641239883, 0.0006601255621046252, -9.957802271298641, 0.11020797743831692, 0.0006674636676006924, -9.918359561930032, 0.0006250784743339726, 0.0007001833984417901, 0.0006905038538804783, 0.0006812603630677875, -9.999327953895232, 0.0006373326646036687, 0.0006961140291324293, -19.99931345250783, 0.0006774074135654508, 0.0006682890535286382, 0.0006338195941197746, -9.999294487158743, 0.000695685523281718, 0.0006863037757026539, -9.446145400360876, 0.0006420074237244479, 0.0007020757270670005, 0.0006903885902690303, 0.0006809763364009163, 0.040044127126894036, 0.12340370610056386, 0.0007241876852280734, 0.0007147860962347095, 0.0007026757965406683, -9.999307071579873, 0.0006836196107422299, 0.0007132912816662177, 0.0007041686113392101, 0.0006924123051375954, 0.0006829451290477355, 0.10318619173415731, 0.0006261694286108741, -9.999356050759358, 0.0006378091514609764, 0.06986252411915489, 0.0006254003212596649, 0.0006428409124761551, 0.0006367224981690365, 0.0006288035479190109, 0.0006237562846510561, 0.0006163934092451839, 0.0006552798934578159, 0.0006489235570100194, -9.999359299120533, 0.0006354608921525664, -19.114849155729836, 0.0006457348525692085, 0.0006375916161682799, 0.000632402815144963, 0.000624835668400172, 0.0006600235123926635, 0.000653575260280226, 0.0006452343893621602, 0.000639920917013869, 1.6947305750749102, 0.0006303074447963915, 0.0006481494936880823, -9.99935807673435, 0.0006338819192018593, 0.21918700890565207, 0.08165552668674504, 0.0006398292074047649, 0.0006578133229498968, 0.0006514079783135941, 0.0006431219723170816, 0.03380056065875745, 0.0006317708718153495, 0.000649634998930587, 0.0006433871902726514, 0.0006353026767804459], "episode_lengths": [25, 25, 25, 26, 26, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 26, 26, 25, 25, 25, 25, 25, 28, 25, 25, 25, 26, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 27, 25, 25, 24, 26, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 400.63070108760076, "mean_inference_ms": 2.1072679003183628, "mean_action_processing_ms": 0.1451888312394071, "mean_env_wait_ms": 3.6385379314820843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009804487228393555, "StateBufferConnector_ms": 0.006191730499267578, "ViewRequirementAgentConnector_ms": 0.17443346977233887}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 46800, "num_env_steps_sampled": 25000, "num_env_steps_trained": 46800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.496139695299081, "num_env_steps_trained_throughput_per_sec": 8.767472405833207, "timesteps_total": 25000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 25000, "timers": {"training_iteration_time_ms": 8896.833, "sample_time_ms": 8835.081, "load_time_ms": 0.243, "load_throughput": 321244.808, "learn_time_ms": 12.922, "learn_throughput": 6036.161, "synch_weights_time_ms": 11.502}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 46800, "num_agent_steps_sampled": 25000, "num_agent_steps_trained": 46800, "last_target_update_ts": 24960, "num_target_updates": 47}, "done": false, "episodes_total": 921, "training_iteration": 25, "trial_id": "2058a_00000", "date": "2024-04-17_06-53-42", "timestamp": 1713336822, "time_this_iter_s": 222.4233841896057, "time_total_s": 5596.6250739097595, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5596.6250739097595, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.010725552050472, "ram_util_percent": 15.350157728706627}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.031654100865125656, "cur_lr": 0.01}, "td_error": [1.7292141914367676, 1.6757546663284302, 1.8192059993743896, 1.6757656335830688, 1.67575204372406, 3.6964521408081055, 1.6757643222808838, 1.729177713394165, 1.6757597923278809, 1.6757503747940063, 1.7314589023590088, 1.6757527589797974, 1.5135191679000854, 1.6757465600967407, 1.1129543781280518, 2.235717296600342, 2.2348368167877197, 1.112958312034607, 1.1129546165466309, 1.675748348236084, 1.6757484674453735, 1.729299783706665, 2.210503339767456, 1.6757469177246094, 1.7312182188034058, 1.6757489442825317, 1.6757493019104004, 1.6757551431655884, 1.675753116607666, 2.2369260787963867, 1.675748348236084, 1.7292810678482056, 1.6757489442825317, 1.6757571697235107, 1.6757490634918213, 1.675750494003296, 1.7307898998260498, 1.6760382652282715, 1.6757580041885376, 1.112955093383789, 1.6757479906082153, 2.234642267227173, 1.6757477521896362, 0.923076331615448, 1.6757524013519287, 1.6757493019104004, 1.675749659538269, 1.506870150566101, 1.6757489442825317, 1.6757642030715942, 0.7716267108917236, 1.675748348236084, 1.6757463216781616, 1.675774335861206, 1.11295485496521, 1.6757560968399048, 1.7295621633529663, 1.675769329071045, 0.927102267742157, 1.6759055852890015, 1.6757463216781616, 1.6757481098175049, 1.6757465600967407, 1.6757476329803467, 1.675749659538269, 1.6757516860961914, 1.675747275352478, 1.6759042739868164, 1.837730884552002, 0.3274874687194824, 1.675748586654663, 1.6758731603622437, 1.7294926643371582, 1.675825595855713, 1.675763726234436, 1.6757532358169556, 1.6757482290267944, 1.6757464408874512], "mean_td_error": 1.6589535474777222, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 625.0, "diff_num_grad_updates_vs_sampler_policy": 624.0}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 48750, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 48750, "last_target_update_ts": 26000, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": 1.6947305750749102, "episode_reward_min": -19.114849155729836, "episode_reward_mean": -1.3444762764413392, "episode_len_mean": 25.08, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0006682890535286382, 0.0006338195941197746, -9.999294487158743, 0.000695685523281718, 0.0006863037757026539, -9.446145400360876, 0.0006420074237244479, 0.0007020757270670005, 0.0006903885902690303, 0.0006809763364009163, 0.040044127126894036, 0.12340370610056386, 0.0007241876852280734, 0.0007147860962347095, 0.0007026757965406683, -9.999307071579873, 0.0006836196107422299, 0.0007132912816662177, 0.0007041686113392101, 0.0006924123051375954, 0.0006829451290477355, 0.10318619173415731, 0.0006261694286108741, -9.999356050759358, 0.0006378091514609764, 0.06986252411915489, 0.0006254003212596649, 0.0006428409124761551, 0.0006367224981690365, 0.0006288035479190109, 0.0006237562846510561, 0.0006163934092451839, 0.0006552798934578159, 0.0006489235570100194, -9.999359299120533, 0.0006354608921525664, -19.114849155729836, 0.0006457348525692085, 0.0006375916161682799, 0.000632402815144963, 0.000624835668400172, 0.0006600235123926635, 0.000653575260280226, 0.0006452343893621602, 0.000639920917013869, 1.6947305750749102, 0.0006303074447963915, 0.0006481494936880823, -9.99935807673435, 0.0006338819192018593, 0.21918700890565207, 0.08165552668674504, 0.0006398292074047649, 0.0006578133229498968, 0.0006514079783135941, 0.0006431219723170816, 0.03380056065875745, 0.0006317708718153495, 0.000649634998930587, 0.0006433871902726514, 0.0006353026767804459, 0.0006179988186172332, 0.0006103785453420674, 0.0006018872926367245, -9.999406183388999, 0.000586435733029739, 0.0006088124280546869, 0.0006003643896790265, 0.0005923194259976862, 0.08891738179573946, 0.0006278208386022049, 0.0006199579901278095, 0.0006112000437117882, 0.0006028640832621608, 0.000595272915321378, 0.0006170469418131648, 0.0006083704695459431, 0.0006001109906209884, -9.999407410852525, -9.999414757055858, 0.3548250526955281, -9.918401046169928, 0.0006072881562260781, 0.08209224579854055, 0.0005924390465609859, 0.09298776698742933, 0.0006142144878465574, -9.592058859179328, 0.04211425660785748, 0.0005908868590402414, 0.0006378431052806321, 0.0006301460188318308, 0.000622225195978116, 0.0006134035352483764, 0.000605007775116468, 0.0006301509277772988, 0.000622637246967723, 0.4580037692680194, -9.912745395028502, 0.0005986536193722383], "episode_lengths": [25, 24, 26, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 401.82500672568784, "mean_inference_ms": 2.105403563073253, "mean_action_processing_ms": 0.14505728191406342, "mean_env_wait_ms": 3.500276338765966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009626150131225586, "StateBufferConnector_ms": 0.006205320358276367, "ViewRequirementAgentConnector_ms": 0.17230749130249023}}, "episode_reward_max": 1.6947305750749102, "episode_reward_min": -19.114849155729836, "episode_reward_mean": -1.3444762764413392, "episode_len_mean": 25.08, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0006682890535286382, 0.0006338195941197746, -9.999294487158743, 0.000695685523281718, 0.0006863037757026539, -9.446145400360876, 0.0006420074237244479, 0.0007020757270670005, 0.0006903885902690303, 0.0006809763364009163, 0.040044127126894036, 0.12340370610056386, 0.0007241876852280734, 0.0007147860962347095, 0.0007026757965406683, -9.999307071579873, 0.0006836196107422299, 0.0007132912816662177, 0.0007041686113392101, 0.0006924123051375954, 0.0006829451290477355, 0.10318619173415731, 0.0006261694286108741, -9.999356050759358, 0.0006378091514609764, 0.06986252411915489, 0.0006254003212596649, 0.0006428409124761551, 0.0006367224981690365, 0.0006288035479190109, 0.0006237562846510561, 0.0006163934092451839, 0.0006552798934578159, 0.0006489235570100194, -9.999359299120533, 0.0006354608921525664, -19.114849155729836, 0.0006457348525692085, 0.0006375916161682799, 0.000632402815144963, 0.000624835668400172, 0.0006600235123926635, 0.000653575260280226, 0.0006452343893621602, 0.000639920917013869, 1.6947305750749102, 0.0006303074447963915, 0.0006481494936880823, -9.99935807673435, 0.0006338819192018593, 0.21918700890565207, 0.08165552668674504, 0.0006398292074047649, 0.0006578133229498968, 0.0006514079783135941, 0.0006431219723170816, 0.03380056065875745, 0.0006317708718153495, 0.000649634998930587, 0.0006433871902726514, 0.0006353026767804459, 0.0006179988186172332, 0.0006103785453420674, 0.0006018872926367245, -9.999406183388999, 0.000586435733029739, 0.0006088124280546869, 0.0006003643896790265, 0.0005923194259976862, 0.08891738179573946, 0.0006278208386022049, 0.0006199579901278095, 0.0006112000437117882, 0.0006028640832621608, 0.000595272915321378, 0.0006170469418131648, 0.0006083704695459431, 0.0006001109906209884, -9.999407410852525, -9.999414757055858, 0.3548250526955281, -9.918401046169928, 0.0006072881562260781, 0.08209224579854055, 0.0005924390465609859, 0.09298776698742933, 0.0006142144878465574, -9.592058859179328, 0.04211425660785748, 0.0005908868590402414, 0.0006378431052806321, 0.0006301460188318308, 0.000622225195978116, 0.0006134035352483764, 0.000605007775116468, 0.0006301509277772988, 0.000622637246967723, 0.4580037692680194, -9.912745395028502, 0.0005986536193722383], "episode_lengths": [25, 24, 26, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 401.82500672568784, "mean_inference_ms": 2.105403563073253, "mean_action_processing_ms": 0.14505728191406342, "mean_env_wait_ms": 3.500276338765966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009626150131225586, "StateBufferConnector_ms": 0.006205320358276367, "ViewRequirementAgentConnector_ms": 0.17230749130249023}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 48750, "num_env_steps_sampled": 26000, "num_env_steps_trained": 48750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.103403698361364, "num_env_steps_trained_throughput_per_sec": 8.00163721180466, "timesteps_total": 26000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 11113.745, "sample_time_ms": 11052.011, "load_time_ms": 0.255, "load_throughput": 306010.394, "learn_time_ms": 12.798, "learn_throughput": 6094.748, "synch_weights_time_ms": 11.1}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 48750, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 48750, "last_target_update_ts": 26000, "num_target_updates": 49}, "done": false, "episodes_total": 960, "training_iteration": 26, "trial_id": "2058a_00000", "date": "2024-04-17_06-57-46", "timestamp": 1713337066, "time_this_iter_s": 243.70820784568787, "time_total_s": 5840.333281755447, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5840.333281755447, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 11.876657060518731, "ram_util_percent": 15.473487031700289}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.027900677174329758, "cur_lr": 0.01}, "td_error": [2.114102840423584, 2.6783461570739746, 1.6621079444885254, 1.6621131896972656, 1.7139445543289185, 1.6882219314575195, 1.6621111631393433, 1.662110686302185, 1.662107229232788, 1.813367486000061, 1.5101784467697144, 1.66218101978302, 1.662107229232788, 1.6621190309524536, 1.6621063947677612, 3.1527600288391113, 1.662117600440979, 1.6621073484420776, 1.6621116399765015, 1.662110686302185, 1.0884678363800049, 0.33400434255599976, 1.6621109247207642, 1.0884662866592407, 1.807361364364624, 1.6621075868606567, 1.496424674987793, 1.662114143371582, 1.6621074676513672, 1.6621084213256836, 1.6621098518371582, 2.0881450176239014, 1.6621103286743164, 1.2497918605804443, 2.068272829055786, 1.6621079444885254, 1.6621081829071045, 3.978609085083008, 1.6621063947677612, 0.771440327167511, 1.6621078252792358, 1.6621097326278687, 1.7762160301208496, 1.8403332233428955, 1.6621381044387817, 1.6621062755584717, 1.6621172428131104, 1.662116289138794, 2.2499256134033203, 1.6621067523956299, 1.088468313217163, 1.7140032052993774, 2.293705701828003, 1.662107229232788, 1.6621073484420776, 1.6621075868606567, 1.7147932052612305, 1.662106990814209, 1.6621062755584717, 1.6621099710464478, 1.6621090173721313, 1.6621073484420776, 1.7143161296844482, 1.6621074676513672, 1.7140214443206787, 1.7139593362808228, 1.6621075868606567, 2.287808895111084, 1.6621124744415283, 1.7143447399139404, 1.662109613418579, 1.662108302116394, 1.6623570919036865, 1.7140032052993774, 1.6621068716049194, 1.6621088981628418, 1.6621488332748413, 1.6621090173721313], "mean_td_error": 1.7174289226531982, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 650.0, "diff_num_grad_updates_vs_sampler_policy": 649.0}}, "num_env_steps_sampled": 27000, "num_env_steps_trained": 50700, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 50700, "last_target_update_ts": 26520, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": 1.7716804014234067, "episode_reward_min": -19.999437999115212, "episode_reward_mean": -1.2936265167244076, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.000624835668400172, 0.0006600235123926635, 0.000653575260280226, 0.0006452343893621602, 0.000639920917013869, 1.6947305750749102, 0.0006303074447963915, 0.0006481494936880823, -9.99935807673435, 0.0006338819192018593, 0.21918700890565207, 0.08165552668674504, 0.0006398292074047649, 0.0006578133229498968, 0.0006514079783135941, 0.0006431219723170816, 0.03380056065875745, 0.0006317708718153495, 0.000649634998930587, 0.0006433871902726514, 0.0006353026767804459, 0.0006179988186172332, 0.0006103785453420674, 0.0006018872926367245, -9.999406183388999, 0.000586435733029739, 0.0006088124280546869, 0.0006003643896790265, 0.0005923194259976862, 0.08891738179573946, 0.0006278208386022049, 0.0006199579901278095, 0.0006112000437117882, 0.0006028640832621608, 0.000595272915321378, 0.0006170469418131648, 0.0006083704695459431, 0.0006001109906209884, -9.999407410852525, -9.999414757055858, 0.3548250526955281, -9.918401046169928, 0.0006072881562260781, 0.08209224579854055, 0.0005924390465609859, 0.09298776698742933, 0.0006142144878465574, -9.592058859179328, 0.04211425660785748, 0.0005908868590402414, 0.0006378431052806321, 0.0006301460188318308, 0.000622225195978116, 0.0006134035352483764, 0.000605007775116468, 0.0006301509277772988, 0.000622637246967723, 0.4580037692680194, -9.912745395028502, 0.0005986536193722383, 0.2620651511628289, 1.7716804014234067, 0.0005676139498546985, 0.0005631705990927675, 0.0005354657184116088, -9.999421860562963, 0.00057287772358665, 0.0005664205096195671, -19.999437999115212, 0.0005343593403048446, 0.0005878487697890386, 0.18644236159589606, -9.999423411945804, 0.13263350007844585, 0.0005440709142920486, 0.0005798404085886546, 0.0005732261670068654, 0.5215874375881276, 0.0005407321735808353, 0.000558064150359737, -9.485809060952645, 0.16383601701028266, 0.000576683141221468, 0.0005481875830330662, -9.999434312962844, 0.0005835710593767207, 0.09467343362242937, 0.0005721416564033985, 0.0005676274159629395, 0.0005396623933478479, 0.0005973628554781531, 0.0005898868067992656, -7.363581769439402, 0.0005777060553166719, 0.0005731039315195979, 0.000591167480780211, 0.000583844772660508, 0.0005784797271499141, 0.5824915291628785, 0.0005674458160644733], "episode_lengths": [25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 26, 25, 25, 27, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 26, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 403.059646108255, "mean_inference_ms": 2.105615840870836, "mean_action_processing_ms": 0.14500152835782307, "mean_env_wait_ms": 3.3681820497353265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009499788284301758, "StateBufferConnector_ms": 0.006311655044555664, "ViewRequirementAgentConnector_ms": 0.17566609382629395}}, "episode_reward_max": 1.7716804014234067, "episode_reward_min": -19.999437999115212, "episode_reward_mean": -1.2936265167244076, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.000624835668400172, 0.0006600235123926635, 0.000653575260280226, 0.0006452343893621602, 0.000639920917013869, 1.6947305750749102, 0.0006303074447963915, 0.0006481494936880823, -9.99935807673435, 0.0006338819192018593, 0.21918700890565207, 0.08165552668674504, 0.0006398292074047649, 0.0006578133229498968, 0.0006514079783135941, 0.0006431219723170816, 0.03380056065875745, 0.0006317708718153495, 0.000649634998930587, 0.0006433871902726514, 0.0006353026767804459, 0.0006179988186172332, 0.0006103785453420674, 0.0006018872926367245, -9.999406183388999, 0.000586435733029739, 0.0006088124280546869, 0.0006003643896790265, 0.0005923194259976862, 0.08891738179573946, 0.0006278208386022049, 0.0006199579901278095, 0.0006112000437117882, 0.0006028640832621608, 0.000595272915321378, 0.0006170469418131648, 0.0006083704695459431, 0.0006001109906209884, -9.999407410852525, -9.999414757055858, 0.3548250526955281, -9.918401046169928, 0.0006072881562260781, 0.08209224579854055, 0.0005924390465609859, 0.09298776698742933, 0.0006142144878465574, -9.592058859179328, 0.04211425660785748, 0.0005908868590402414, 0.0006378431052806321, 0.0006301460188318308, 0.000622225195978116, 0.0006134035352483764, 0.000605007775116468, 0.0006301509277772988, 0.000622637246967723, 0.4580037692680194, -9.912745395028502, 0.0005986536193722383, 0.2620651511628289, 1.7716804014234067, 0.0005676139498546985, 0.0005631705990927675, 0.0005354657184116088, -9.999421860562963, 0.00057287772358665, 0.0005664205096195671, -19.999437999115212, 0.0005343593403048446, 0.0005878487697890386, 0.18644236159589606, -9.999423411945804, 0.13263350007844585, 0.0005440709142920486, 0.0005798404085886546, 0.0005732261670068654, 0.5215874375881276, 0.0005407321735808353, 0.000558064150359737, -9.485809060952645, 0.16383601701028266, 0.000576683141221468, 0.0005481875830330662, -9.999434312962844, 0.0005835710593767207, 0.09467343362242937, 0.0005721416564033985, 0.0005676274159629395, 0.0005396623933478479, 0.0005973628554781531, 0.0005898868067992656, -7.363581769439402, 0.0005777060553166719, 0.0005731039315195979, 0.000591167480780211, 0.000583844772660508, 0.0005784797271499141, 0.5824915291628785, 0.0005674458160644733], "episode_lengths": [25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 26, 25, 25, 27, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 26, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 403.059646108255, "mean_inference_ms": 2.105615840870836, "mean_action_processing_ms": 0.14500152835782307, "mean_env_wait_ms": 3.3681820497353265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009499788284301758, "StateBufferConnector_ms": 0.006311655044555664, "ViewRequirementAgentConnector_ms": 0.17566609382629395}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 50700, "num_env_steps_sampled": 27000, "num_env_steps_trained": 50700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.767667167185123, "num_env_steps_trained_throughput_per_sec": 7.34695097601099, "timesteps_total": 27000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 27000, "timers": {"training_iteration_time_ms": 9888.164, "sample_time_ms": 9826.406, "load_time_ms": 0.247, "load_throughput": 315209.28, "learn_time_ms": 12.87, "learn_throughput": 6060.762, "synch_weights_time_ms": 11.446}, "counters": {"num_env_steps_sampled": 27000, "num_env_steps_trained": 50700, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 50700, "last_target_update_ts": 26520, "num_target_updates": 50}, "done": false, "episodes_total": 1000, "training_iteration": 27, "trial_id": "2058a_00000", "date": "2024-04-17_07-02-12", "timestamp": 1713337332, "time_this_iter_s": 265.4244923591614, "time_total_s": 6105.757774114609, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 6105.757774114609, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 11.293899204244033, "ram_util_percent": 15.554376657824932}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03631984442472458, "cur_lr": 0.01}, "td_error": [1.6155805587768555, 1.3549814224243164, 1.6155803203582764, 1.6155823469161987, 1.6155810356140137, 1.615580439567566, 1.6155791282653809, 0.8170045614242554, 1.615622639656067, 1.6155799627304077, 1.0644848346710205, 1.6155788898468018, 1.0644750595092773, 1.615582823753357, 3.348602771759033, 1.6156723499298096, 1.6156868934631348, 1.615581750869751, 1.6791963577270508, 2.2738287448883057, 1.2534384727478027, 1.6155823469161987, 1.6155798435211182, 1.6155837774276733, 1.6156349182128906, 1.6155794858932495, 1.3036257028579712, 1.6155823469161987, 1.6155810356140137, 1.3035873174667358, 1.6155818700790405, 1.6157609224319458, 1.0644843578338623, 1.064483404159546, 1.6155911684036255, 1.0644841194152832, 1.615580439567566, 1.6155798435211182, 1.0644831657409668, 1.615580439567566, 1.6155794858932495, 3.673588514328003, 1.6788756847381592, 1.6155787706375122, 1.6155813932418823, 1.6156281232833862, 1.6155810356140137, 1.7832860946655273, 1.6155787706375122, 1.7915987968444824, 1.544015645980835, 1.6155833005905151, 1.6155787706375122, 0.35508912801742554, 1.6155791282653809, 1.615580677986145, 1.61557936668396, 1.6155799627304077, 1.7967162132263184, 1.6155812740325928, 1.615580677986145, 1.6155825853347778, 1.6786550283432007, 1.0644841194152832, 1.61557936668396, 1.6155799627304077, 1.615579605102539, 1.6155825853347778, 1.0644841194152832, 2.29978084564209, 2.2986433506011963, 1.615581750869751, 2.3044514656066895, 1.6780285835266113, 1.6155930757522583, 1.615584135055542, 1.6792395114898682, 1.615586280822754], "mean_td_error": 1.6099501848220825, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 675.0, "diff_num_grad_updates_vs_sampler_policy": 674.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 52650, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 52650, "last_target_update_ts": 27560, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": 1.7716804014234067, "episode_reward_min": -19.999437999115212, "episode_reward_mean": -1.2812646917848114, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3548250526955281, -9.918401046169928, 0.0006072881562260781, 0.08209224579854055, 0.0005924390465609859, 0.09298776698742933, 0.0006142144878465574, -9.592058859179328, 0.04211425660785748, 0.0005908868590402414, 0.0006378431052806321, 0.0006301460188318308, 0.000622225195978116, 0.0006134035352483764, 0.000605007775116468, 0.0006301509277772988, 0.000622637246967723, 0.4580037692680194, -9.912745395028502, 0.0005986536193722383, 0.2620651511628289, 1.7716804014234067, 0.0005676139498546985, 0.0005631705990927675, 0.0005354657184116088, -9.999421860562963, 0.00057287772358665, 0.0005664205096195671, -19.999437999115212, 0.0005343593403048446, 0.0005878487697890386, 0.18644236159589606, -9.999423411945804, 0.13263350007844585, 0.0005440709142920486, 0.0005798404085886546, 0.0005732261670068654, 0.5215874375881276, 0.0005407321735808353, 0.000558064150359737, -9.485809060952645, 0.16383601701028266, 0.000576683141221468, 0.0005481875830330662, -9.999434312962844, 0.0005835710593767207, 0.09467343362242937, 0.0005721416564033985, 0.0005676274159629395, 0.0005396623933478479, 0.0005973628554781531, 0.0005898868067992656, -7.363581769439402, 0.0005777060553166719, 0.0005731039315195979, 0.000591167480780211, 0.000583844772660508, 0.0005784797271499141, 0.5824915291628785, 0.0005674458160644733, 0.0005526785846936341, 0.34521533188252207, 0.13581652879580264, 0.7006666102764525, 0.0005324577495433558, 0.000551547060674761, -9.999452894215985, 0.0005423839392932554, 0.0005372618951142569, 0.14839630400582832, 0.0005614779010473655, 0.0005568754049031824, 0.0005519846768887841, 0.0005466806102684647, -9.999459711415106, 0.8772403559599752, 0.0005487243185622918, -9.999456517110834, 0.0005371659654357319, 0.0005327847551825411, 0.27885892952115465, 0.0005561719379182686, 0.0005507874987581874, 0.0005443011088680034, 0.0005398032209660189, 0.10416477442301539, 0.000552733883122952, 0.0005479153092324526, 0.6093466686593187, 0.09067529525574987, 0.0005448183772458301, 0.0005622421035823287, 0.0005576271207589263, 0.0005527232392742315, 0.0005474050397539834, 0.06945515622639019, -9.999442703435072, 0.0005527808108249758, 0.0005479614223308178, 0.000542734016495224], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 26, 25, 25, 27, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 26, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 404.333821158982, "mean_inference_ms": 2.1063355037660543, "mean_action_processing_ms": 0.14498564090188348, "mean_env_wait_ms": 3.247450166772442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010029077529907227, "StateBufferConnector_ms": 0.006265878677368164, "ViewRequirementAgentConnector_ms": 0.17669153213500977}}, "episode_reward_max": 1.7716804014234067, "episode_reward_min": -19.999437999115212, "episode_reward_mean": -1.2812646917848114, "episode_len_mean": 25.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.3548250526955281, -9.918401046169928, 0.0006072881562260781, 0.08209224579854055, 0.0005924390465609859, 0.09298776698742933, 0.0006142144878465574, -9.592058859179328, 0.04211425660785748, 0.0005908868590402414, 0.0006378431052806321, 0.0006301460188318308, 0.000622225195978116, 0.0006134035352483764, 0.000605007775116468, 0.0006301509277772988, 0.000622637246967723, 0.4580037692680194, -9.912745395028502, 0.0005986536193722383, 0.2620651511628289, 1.7716804014234067, 0.0005676139498546985, 0.0005631705990927675, 0.0005354657184116088, -9.999421860562963, 0.00057287772358665, 0.0005664205096195671, -19.999437999115212, 0.0005343593403048446, 0.0005878487697890386, 0.18644236159589606, -9.999423411945804, 0.13263350007844585, 0.0005440709142920486, 0.0005798404085886546, 0.0005732261670068654, 0.5215874375881276, 0.0005407321735808353, 0.000558064150359737, -9.485809060952645, 0.16383601701028266, 0.000576683141221468, 0.0005481875830330662, -9.999434312962844, 0.0005835710593767207, 0.09467343362242937, 0.0005721416564033985, 0.0005676274159629395, 0.0005396623933478479, 0.0005973628554781531, 0.0005898868067992656, -7.363581769439402, 0.0005777060553166719, 0.0005731039315195979, 0.000591167480780211, 0.000583844772660508, 0.0005784797271499141, 0.5824915291628785, 0.0005674458160644733, 0.0005526785846936341, 0.34521533188252207, 0.13581652879580264, 0.7006666102764525, 0.0005324577495433558, 0.000551547060674761, -9.999452894215985, 0.0005423839392932554, 0.0005372618951142569, 0.14839630400582832, 0.0005614779010473655, 0.0005568754049031824, 0.0005519846768887841, 0.0005466806102684647, -9.999459711415106, 0.8772403559599752, 0.0005487243185622918, -9.999456517110834, 0.0005371659654357319, 0.0005327847551825411, 0.27885892952115465, 0.0005561719379182686, 0.0005507874987581874, 0.0005443011088680034, 0.0005398032209660189, 0.10416477442301539, 0.000552733883122952, 0.0005479153092324526, 0.6093466686593187, 0.09067529525574987, 0.0005448183772458301, 0.0005622421035823287, 0.0005576271207589263, 0.0005527232392742315, 0.0005474050397539834, 0.06945515622639019, -9.999442703435072, 0.0005527808108249758, 0.0005479614223308178, 0.000542734016495224], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 24, 26, 25, 25, 27, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 26, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 404.333821158982, "mean_inference_ms": 2.1063355037660543, "mean_action_processing_ms": 0.14498564090188348, "mean_env_wait_ms": 3.247450166772442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010029077529907227, "StateBufferConnector_ms": 0.006265878677368164, "ViewRequirementAgentConnector_ms": 0.17669153213500977}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 52650, "num_env_steps_sampled": 28000, "num_env_steps_trained": 52650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.5083722945432045, "num_env_steps_trained_throughput_per_sec": 8.79132597435925, "timesteps_total": 28000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8902.727, "sample_time_ms": 8841.878, "load_time_ms": 0.238, "load_throughput": 327188.431, "learn_time_ms": 12.867, "learn_throughput": 6062.211, "synch_weights_time_ms": 11.511}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 52650, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 52650, "last_target_update_ts": 27560, "num_target_updates": 52}, "done": false, "episodes_total": 1040, "training_iteration": 28, "trial_id": "2058a_00000", "date": "2024-04-17_07-05-53", "timestamp": 1713337553, "time_this_iter_s": 221.8190634250641, "time_total_s": 6327.576837539673, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 6327.576837539673, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 13.349841269841269, "ram_util_percent": 15.665079365079364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.08920276165008545, "cur_lr": 0.01}, "td_error": [1.825074315071106, 2.358588695526123, 1.5968997478485107, 1.596907138824463, 1.8207896947860718, 1.596907615661621, 1.5969070196151733, 1.2232117652893066, 1.5969074964523315, 1.5858848094940186, 1.6564180850982666, 1.5969072580337524, 1.5969065427780151, 1.596907615661621, 0.776564359664917, 1.5969077348709106, 1.5504744052886963, 1.596907138824463, 1.596907138824463, 1.596906304359436, 1.8084027767181396, 1.5503044128417969, 1.656516432762146, 1.5969065427780151, 1.5969066619873047, 1.596907615661621, 1.5968844890594482, 1.5969074964523315, 1.5969078540802002, 0.7861694693565369, 1.6564565896987915, 1.5969077348709106, 1.5982844829559326, 1.6563570499420166, 1.6565179824829102, 0.34880226850509644, 1.596907138824463, 1.596907138824463, 1.596907615661621, 1.8196382522583008, 1.5969065427780151, 1.596907377243042, 1.596907615661621, 1.5969047546386719, 1.5969065427780151, 2.36197829246521, 2.3634541034698486, 1.6564826965332031, 1.5969077348709106, 1.596907615661621, 1.7671772241592407, 1.9823906421661377, 2.321627378463745, 1.5969064235687256, 1.596907615661621, 1.596907615661621, 1.5969074964523315, 1.596907377243042, 1.596907377243042, 1.5969069004058838, 1.807263731956482, 1.5969074964523315, 1.0520790815353394, 1.5969077348709106, 2.3609211444854736, 1.5969078540802002, 1.5969074964523315, 1.0520836114883423, 1.5416990518569946, 1.5969072580337524, 1.5969077348709106, 1.0520603656768799, 1.596907138824463, 0.7739115357398987, 1.65652596950531, 1.596907377243042, 1.5968836545944214, 1.5480374097824097], "mean_td_error": 1.5960630178451538, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 700.0, "diff_num_grad_updates_vs_sampler_policy": 699.0}}, "num_env_steps_sampled": 29000, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 54600, "last_target_update_ts": 28600, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": 2.037300385796029, "episode_reward_min": -19.897198677978142, "episode_reward_mean": -1.5905322313996462, "episode_len_mean": 25.13, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.485809060952645, 0.16383601701028266, 0.000576683141221468, 0.0005481875830330662, -9.999434312962844, 0.0005835710593767207, 0.09467343362242937, 0.0005721416564033985, 0.0005676274159629395, 0.0005396623933478479, 0.0005973628554781531, 0.0005898868067992656, -7.363581769439402, 0.0005777060553166719, 0.0005731039315195979, 0.000591167480780211, 0.000583844772660508, 0.0005784797271499141, 0.5824915291628785, 0.0005674458160644733, 0.0005526785846936341, 0.34521533188252207, 0.13581652879580264, 0.7006666102764525, 0.0005324577495433558, 0.000551547060674761, -9.999452894215985, 0.0005423839392932554, 0.0005372618951142569, 0.14839630400582832, 0.0005614779010473655, 0.0005568754049031824, 0.0005519846768887841, 0.0005466806102684647, -9.999459711415106, 0.8772403559599752, 0.0005487243185622918, -9.999456517110834, 0.0005371659654357319, 0.0005327847551825411, 0.27885892952115465, 0.0005561719379182686, 0.0005507874987581874, 0.0005443011088680034, 0.0005398032209660189, 0.10416477442301539, 0.000552733883122952, 0.0005479153092324526, 0.6093466686593187, 0.09067529525574987, 0.0005448183772458301, 0.0005622421035823287, 0.0005576271207589263, 0.0005527232392742315, 0.0005474050397539834, 0.06945515622639019, -9.999442703435072, 0.0005527808108249758, 0.0005479614223308178, 0.000542734016495224, 0.17762000396781968, 2.037300385796029, -19.897198677978142, 0.0005125196349268641, 0.06178611333457862, 0.0005270031924080943, 0.0005214651224385817, 0.0005156154682891874, 0.0005109397206996312, 0.11840553592339272, 0.0005358579230171788, -9.99946986631614, -9.999475914965984, 0.0005192586215200705, 0.05527316264709136, 0.0005271251800927544, -9.99947885099954, 0.0005163723866269979, -9.417566963423063, 0.0005062778395867643, 0.0005339943939935602, 0.0005278618811217134, 0.0005229624340960104, 0.0005174871411662101, 0.08287027667705095, 0.0005324140744559572, 0.33555370527618716, 0.0005208993903217812, -9.999483871813371, -9.999489211272119, 0.0005409976125218246, 0.0005365539341921205, 0.0005308144440560036, 0.0005247543465021885, 0.0005199121536927108, 0.0005364348473186046, -9.999467931149775, -9.999473578435632, 0.0005204603680353269, 0.0005156967401572035], "episode_lengths": [26, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 405.566554662868, "mean_inference_ms": 2.1113043856963323, "mean_action_processing_ms": 0.14497095693947545, "mean_env_wait_ms": 3.1364105863943323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010093212127685547, "StateBufferConnector_ms": 0.006194353103637695, "ViewRequirementAgentConnector_ms": 0.17424464225769043}}, "episode_reward_max": 2.037300385796029, "episode_reward_min": -19.897198677978142, "episode_reward_mean": -1.5905322313996462, "episode_len_mean": 25.13, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.485809060952645, 0.16383601701028266, 0.000576683141221468, 0.0005481875830330662, -9.999434312962844, 0.0005835710593767207, 0.09467343362242937, 0.0005721416564033985, 0.0005676274159629395, 0.0005396623933478479, 0.0005973628554781531, 0.0005898868067992656, -7.363581769439402, 0.0005777060553166719, 0.0005731039315195979, 0.000591167480780211, 0.000583844772660508, 0.0005784797271499141, 0.5824915291628785, 0.0005674458160644733, 0.0005526785846936341, 0.34521533188252207, 0.13581652879580264, 0.7006666102764525, 0.0005324577495433558, 0.000551547060674761, -9.999452894215985, 0.0005423839392932554, 0.0005372618951142569, 0.14839630400582832, 0.0005614779010473655, 0.0005568754049031824, 0.0005519846768887841, 0.0005466806102684647, -9.999459711415106, 0.8772403559599752, 0.0005487243185622918, -9.999456517110834, 0.0005371659654357319, 0.0005327847551825411, 0.27885892952115465, 0.0005561719379182686, 0.0005507874987581874, 0.0005443011088680034, 0.0005398032209660189, 0.10416477442301539, 0.000552733883122952, 0.0005479153092324526, 0.6093466686593187, 0.09067529525574987, 0.0005448183772458301, 0.0005622421035823287, 0.0005576271207589263, 0.0005527232392742315, 0.0005474050397539834, 0.06945515622639019, -9.999442703435072, 0.0005527808108249758, 0.0005479614223308178, 0.000542734016495224, 0.17762000396781968, 2.037300385796029, -19.897198677978142, 0.0005125196349268641, 0.06178611333457862, 0.0005270031924080943, 0.0005214651224385817, 0.0005156154682891874, 0.0005109397206996312, 0.11840553592339272, 0.0005358579230171788, -9.99946986631614, -9.999475914965984, 0.0005192586215200705, 0.05527316264709136, 0.0005271251800927544, -9.99947885099954, 0.0005163723866269979, -9.417566963423063, 0.0005062778395867643, 0.0005339943939935602, 0.0005278618811217134, 0.0005229624340960104, 0.0005174871411662101, 0.08287027667705095, 0.0005324140744559572, 0.33555370527618716, 0.0005208993903217812, -9.999483871813371, -9.999489211272119, 0.0005409976125218246, 0.0005365539341921205, 0.0005308144440560036, 0.0005247543465021885, 0.0005199121536927108, 0.0005364348473186046, -9.999467931149775, -9.999473578435632, 0.0005204603680353269, 0.0005156967401572035], "episode_lengths": [26, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 405.566554662868, "mean_inference_ms": 2.1113043856963323, "mean_action_processing_ms": 0.14497095693947545, "mean_env_wait_ms": 3.1364105863943323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010093212127685547, "StateBufferConnector_ms": 0.006194353103637695, "ViewRequirementAgentConnector_ms": 0.17424464225769043}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 54600, "num_env_steps_sampled": 29000, "num_env_steps_trained": 54600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.083891262406963, "num_env_steps_trained_throughput_per_sec": 7.9635879616935785, "timesteps_total": 29000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 29000, "timers": {"training_iteration_time_ms": 10045.814, "sample_time_ms": 9984.794, "load_time_ms": 0.23, "load_throughput": 339232.385, "learn_time_ms": 12.528, "learn_throughput": 6225.952, "synch_weights_time_ms": 12.121}, "counters": {"num_env_steps_sampled": 29000, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 29000, "num_agent_steps_trained": 54600, "last_target_update_ts": 28600, "num_target_updates": 54}, "done": false, "episodes_total": 1080, "training_iteration": 29, "trial_id": "2058a_00000", "date": "2024-04-17_07-09-58", "timestamp": 1713337798, "time_this_iter_s": 244.8733425140381, "time_total_s": 6572.450180053711, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 6572.450180053711, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 12.279083094555872, "ram_util_percent": 15.837249283667624}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03322984278202057, "cur_lr": 0.01}, "td_error": [1.589723825454712, 1.5897235870361328, 1.6491751670837402, 1.0574278831481934, 1.5897213220596313, 1.5897208452224731, 1.5897207260131836, 1.5897226333618164, 1.5897210836410522, 1.5897223949432373, 1.6288560628890991, 1.0574703216552734, 1.2125616073608398, 3.2416791915893555, 1.5897291898727417, 1.589721441268921, 1.8495328426361084, 1.5897209644317627, 1.5897213220596313, 1.057471752166748, 1.5897221565246582, 1.5897213220596313, 1.6489412784576416, 0.7561187744140625, 1.736401081085205, 1.5897215604782104, 1.6488704681396484, 1.5897208452224731, 0.7558096051216125, 1.6488162279129028, 1.5897207260131836, 1.2126996517181396, 1.5897217988967896, 1.589728832244873, 1.5897212028503418, 1.0574705600738525, 1.589728832244873, 1.589721918106079, 1.5897207260131836, 1.5897223949432373, 2.3053970336914062, 1.589723825454712, 1.819616675376892, 1.5897216796875, 1.057471752166748, 1.5897213220596313, 1.5897210836410522, 1.0574731826782227, 1.589721441268921, 1.5897250175476074, 1.6289554834365845, 1.0574498176574707, 1.5897209644317627, 1.5897231101989746, 2.2669668197631836, 1.0574698448181152, 1.5897204875946045, 1.589722752571106, 1.6488537788391113, 2.266981363296509, 1.5897493362426758, 1.5897207260131836, 2.308117389678955, 0.7485451102256775, 1.5897204875946045, 1.5897226333618164, 1.5897215604782104, 1.7634961605072021, 0.7484080791473389, 1.5897233486175537, 1.6492453813552856, 1.5897225141525269, 1.5903016328811646, 1.5897209644317627, 1.8768937587738037, 1.5897212028503418, 1.736552119255066, 4.5886616706848145], "mean_td_error": 1.5994133949279785, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 725.0, "diff_num_grad_updates_vs_sampler_policy": 724.0}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 56550, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 56550, "last_target_update_ts": 29640, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": 2.037300385796029, "episode_reward_min": -19.999513450062217, "episode_reward_mean": -1.7209980901514967, "episode_len_mean": 25.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.27885892952115465, 0.0005561719379182686, 0.0005507874987581874, 0.0005443011088680034, 0.0005398032209660189, 0.10416477442301539, 0.000552733883122952, 0.0005479153092324526, 0.6093466686593187, 0.09067529525574987, 0.0005448183772458301, 0.0005622421035823287, 0.0005576271207589263, 0.0005527232392742315, 0.0005474050397539834, 0.06945515622639019, -9.999442703435072, 0.0005527808108249758, 0.0005479614223308178, 0.000542734016495224, 0.17762000396781968, 2.037300385796029, -19.897198677978142, 0.0005125196349268641, 0.06178611333457862, 0.0005270031924080943, 0.0005214651224385817, 0.0005156154682891874, 0.0005109397206996312, 0.11840553592339272, 0.0005358579230171788, -9.99946986631614, -9.999475914965984, 0.0005192586215200705, 0.05527316264709136, 0.0005271251800927544, -9.99947885099954, 0.0005163723866269979, -9.417566963423063, 0.0005062778395867643, 0.0005339943939935602, 0.0005278618811217134, 0.0005229624340960104, 0.0005174871411662101, 0.08287027667705095, 0.0005324140744559572, 0.33555370527618716, 0.0005208993903217812, -9.999483871813371, -9.999489211272119, 0.0005409976125218246, 0.0005365539341921205, 0.0005308144440560036, 0.0005247543465021885, 0.0005199121536927108, 0.0005364348473186046, -9.999467931149775, -9.999473578435632, 0.0005204603680353269, 0.0005156967401572035, 0.0005029180453367587, 0.37875857197696067, 0.0004958601122780987, 0.0004910498336508055, -19.999513450062217, 0.0005012267157739884, 0.0004774845569792666, -9.999505849828646, 0.0004893724587802525, 0.0004848901678097489, 0.0005095319398051033, 0.6092907626420351, 0.0005022622639764505, 0.0004973276238007053, 0.000492699090410409, 0.11179039865123261, -9.999500704581624, 0.0004944023516324711, 0.0004898278649364291, 0.0004857221134567307, 0.0004884240325008016, 0.0005053958446878871, 0.0005003997623559126, -9.999504286520029, 0.05201273966889307, 0.0005059950571090609, 0.00048199183695436614, 0.9071710102711109, -19.999505942022935, 0.0004894890648012176, 0.0005145002167269038, 0.0005096317914381779, 0.00048542902173526024, 0.0005023172288434899, 0.0004973815141773006, 0.8579757338432905, 0.0005057772058787043, 0.00048178592718415496, 0.0004985720997717187, 0.23580421321014725], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 24, 25, 25, 27, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 26, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 406.7070459870236, "mean_inference_ms": 2.115044249878458, "mean_action_processing_ms": 0.14487306922633789, "mean_env_wait_ms": 3.032900537196525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00970911979675293, "StateBufferConnector_ms": 0.006275177001953125, "ViewRequirementAgentConnector_ms": 0.17399168014526367}}, "episode_reward_max": 2.037300385796029, "episode_reward_min": -19.999513450062217, "episode_reward_mean": -1.7209980901514967, "episode_len_mean": 25.08, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.27885892952115465, 0.0005561719379182686, 0.0005507874987581874, 0.0005443011088680034, 0.0005398032209660189, 0.10416477442301539, 0.000552733883122952, 0.0005479153092324526, 0.6093466686593187, 0.09067529525574987, 0.0005448183772458301, 0.0005622421035823287, 0.0005576271207589263, 0.0005527232392742315, 0.0005474050397539834, 0.06945515622639019, -9.999442703435072, 0.0005527808108249758, 0.0005479614223308178, 0.000542734016495224, 0.17762000396781968, 2.037300385796029, -19.897198677978142, 0.0005125196349268641, 0.06178611333457862, 0.0005270031924080943, 0.0005214651224385817, 0.0005156154682891874, 0.0005109397206996312, 0.11840553592339272, 0.0005358579230171788, -9.99946986631614, -9.999475914965984, 0.0005192586215200705, 0.05527316264709136, 0.0005271251800927544, -9.99947885099954, 0.0005163723866269979, -9.417566963423063, 0.0005062778395867643, 0.0005339943939935602, 0.0005278618811217134, 0.0005229624340960104, 0.0005174871411662101, 0.08287027667705095, 0.0005324140744559572, 0.33555370527618716, 0.0005208993903217812, -9.999483871813371, -9.999489211272119, 0.0005409976125218246, 0.0005365539341921205, 0.0005308144440560036, 0.0005247543465021885, 0.0005199121536927108, 0.0005364348473186046, -9.999467931149775, -9.999473578435632, 0.0005204603680353269, 0.0005156967401572035, 0.0005029180453367587, 0.37875857197696067, 0.0004958601122780987, 0.0004910498336508055, -19.999513450062217, 0.0005012267157739884, 0.0004774845569792666, -9.999505849828646, 0.0004893724587802525, 0.0004848901678097489, 0.0005095319398051033, 0.6092907626420351, 0.0005022622639764505, 0.0004973276238007053, 0.000492699090410409, 0.11179039865123261, -9.999500704581624, 0.0004944023516324711, 0.0004898278649364291, 0.0004857221134567307, 0.0004884240325008016, 0.0005053958446878871, 0.0005003997623559126, -9.999504286520029, 0.05201273966889307, 0.0005059950571090609, 0.00048199183695436614, 0.9071710102711109, -19.999505942022935, 0.0004894890648012176, 0.0005145002167269038, 0.0005096317914381779, 0.00048542902173526024, 0.0005023172288434899, 0.0004973815141773006, 0.8579757338432905, 0.0005057772058787043, 0.00048178592718415496, 0.0004985720997717187, 0.23580421321014725], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 24, 25, 25, 27, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 26, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 406.7070459870236, "mean_inference_ms": 2.115044249878458, "mean_action_processing_ms": 0.14487306922633789, "mean_env_wait_ms": 3.032900537196525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00970911979675293, "StateBufferConnector_ms": 0.006275177001953125, "ViewRequirementAgentConnector_ms": 0.17399168014526367}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 56550, "num_env_steps_sampled": 30000, "num_env_steps_trained": 56550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.925264021341961, "num_env_steps_trained_throughput_per_sec": 7.654264841616824, "timesteps_total": 30000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 8856.38, "sample_time_ms": 8794.566, "load_time_ms": 0.263, "load_throughput": 296659.151, "learn_time_ms": 13.076, "learn_throughput": 5964.977, "synch_weights_time_ms": 11.552}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 56550, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 56550, "last_target_update_ts": 29640, "num_target_updates": 56}, "done": false, "episodes_total": 1120, "training_iteration": 30, "trial_id": "2058a_00000", "date": "2024-04-17_07-14-13", "timestamp": 1713338053, "time_this_iter_s": 254.76722383499146, "time_total_s": 6827.217403888702, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 6827.217403888702, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 11.760497237569059, "ram_util_percent": 15.913535911602212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.018659284338355064, "cur_lr": 0.01}, "td_error": [1.5544134378433228, 1.8525880575180054, 1.6289310455322266, 1.6289043426513672, 1.5544196367263794, 1.6289124488830566, 2.357191324234009, 1.554413914680481, 1.5544172525405884, 1.7857623100280762, 1.5544164180755615, 1.554416537284851, 1.5544143915176392, 1.5544593334197998, 1.5544143915176392, 1.5544174909591675, 1.5544140338897705, 1.5544624328613281, 1.5544146299362183, 1.0298813581466675, 1.554416537284851, 1.5546197891235352, 1.3296490907669067, 1.6290441751480103, 1.554537057876587, 1.5544145107269287, 1.6289048194885254, 1.62892746925354, 2.3598034381866455, 1.554415225982666, 1.5544151067733765, 1.554413914680481, 1.7020081281661987, 1.5544143915176392, 1.6300910711288452, 1.766562581062317, 1.5544133186340332, 1.0298800468444824, 1.5544179677963257, 0.7632198333740234, 1.5544147491455078, 1.5544134378433228, 1.5544154644012451, 1.554419755935669, 1.5544143915176392, 1.0298819541931152, 1.5544220209121704, 2.356187105178833, 1.5544166564941406, 1.5544145107269287, 1.6289336681365967, 1.5544133186340332, 1.5544157028198242, 1.5544167757034302, 1.6291191577911377, 1.5544172525405884, 1.554417610168457, 1.0298815965652466, 0.7710005044937134, 1.554416537284851, 1.554465413093567, 0.7630526423454285, 1.5544146299362183, 1.554589033126831, 1.55442214012146, 1.6104261875152588, 1.554419755935669, 1.0298821926116943, 1.554416298866272, 1.6296989917755127, 1.7008806467056274, 1.7032334804534912, 1.5544154644012451, 0.7699669599533081, 1.0298829078674316, 1.5489617586135864, 1.701621174812317, 1.628832221031189], "mean_td_error": 1.5299570560455322, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 750.0, "diff_num_grad_updates_vs_sampler_policy": 749.0}}, "num_env_steps_sampled": 31000, "num_env_steps_trained": 58500, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 58500, "last_target_update_ts": 30680, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": 0.9071710102711109, "episode_reward_min": -19.999513450062217, "episode_reward_mean": -1.9258904716925045, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0005339943939935602, 0.0005278618811217134, 0.0005229624340960104, 0.0005174871411662101, 0.08287027667705095, 0.0005324140744559572, 0.33555370527618716, 0.0005208993903217812, -9.999483871813371, -9.999489211272119, 0.0005409976125218246, 0.0005365539341921205, 0.0005308144440560036, 0.0005247543465021885, 0.0005199121536927108, 0.0005364348473186046, -9.999467931149775, -9.999473578435632, 0.0005204603680353269, 0.0005156967401572035, 0.0005029180453367587, 0.37875857197696067, 0.0004958601122780987, 0.0004910498336508055, -19.999513450062217, 0.0005012267157739884, 0.0004774845569792666, -9.999505849828646, 0.0004893724587802525, 0.0004848901678097489, 0.0005095319398051033, 0.6092907626420351, 0.0005022622639764505, 0.0004973276238007053, 0.000492699090410409, 0.11179039865123261, -9.999500704581624, 0.0004944023516324711, 0.0004898278649364291, 0.0004857221134567307, 0.0004884240325008016, 0.0005053958446878871, 0.0005003997623559126, -9.999504286520029, 0.05201273966889307, 0.0005059950571090609, 0.00048199183695436614, 0.9071710102711109, -19.999505942022935, 0.0004894890648012176, 0.0005145002167269038, 0.0005096317914381779, 0.00048542902173526024, 0.0005023172288434899, 0.0004973815141773006, 0.8579757338432905, 0.0005057772058787043, 0.00048178592718415496, 0.0004985720997717187, 0.23580421321014725, 0.0004824859126698911, -9.999522122982752, 0.00047353385159112986, 0.00046934412056162233, 0.00044685933455499165, 0.0004808664456866778, 0.0004762879175584081, 0.00047197382161536417, 0.00046781153221847556, 0.00044541214617097437, 0.0004885452621277563, 0.11084655598378607, 0.0004795656630067243, 0.00047526898886596355, 0.0004524533211943501, 0.00048105112582567223, 0.0004766506967871054, -9.99952757654052, -9.999550254250602, 0.00046389747678575704, -9.999512984600607, 0.00048250991557624074, -7.002245259650426, 0.0004551897592617694, 0.11888494734532302, 0.0004853889680005239, 0.00048072435321145496, 0.0004763298740061937, -9.652185760202007, -9.999550481876849, 0.0004927519821695099, 0.11165918368163212, -9.99951591182745, 0.000479631886342683, 0.0004753340306581729, -9.999510527571532, 0.0004853722292898002, 0.00048070793458706353, 0.00047631375422472273, 0.11083526490199856], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 24, 25, 25, 27, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 26, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 407.76343253695006, "mean_inference_ms": 2.114120114482644, "mean_action_processing_ms": 0.1448151869297039, "mean_env_wait_ms": 2.9362482107465877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00951695442199707, "StateBufferConnector_ms": 0.00634312629699707, "ViewRequirementAgentConnector_ms": 0.1743011474609375}}, "episode_reward_max": 0.9071710102711109, "episode_reward_min": -19.999513450062217, "episode_reward_mean": -1.9258904716925045, "episode_len_mean": 25.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0005339943939935602, 0.0005278618811217134, 0.0005229624340960104, 0.0005174871411662101, 0.08287027667705095, 0.0005324140744559572, 0.33555370527618716, 0.0005208993903217812, -9.999483871813371, -9.999489211272119, 0.0005409976125218246, 0.0005365539341921205, 0.0005308144440560036, 0.0005247543465021885, 0.0005199121536927108, 0.0005364348473186046, -9.999467931149775, -9.999473578435632, 0.0005204603680353269, 0.0005156967401572035, 0.0005029180453367587, 0.37875857197696067, 0.0004958601122780987, 0.0004910498336508055, -19.999513450062217, 0.0005012267157739884, 0.0004774845569792666, -9.999505849828646, 0.0004893724587802525, 0.0004848901678097489, 0.0005095319398051033, 0.6092907626420351, 0.0005022622639764505, 0.0004973276238007053, 0.000492699090410409, 0.11179039865123261, -9.999500704581624, 0.0004944023516324711, 0.0004898278649364291, 0.0004857221134567307, 0.0004884240325008016, 0.0005053958446878871, 0.0005003997623559126, -9.999504286520029, 0.05201273966889307, 0.0005059950571090609, 0.00048199183695436614, 0.9071710102711109, -19.999505942022935, 0.0004894890648012176, 0.0005145002167269038, 0.0005096317914381779, 0.00048542902173526024, 0.0005023172288434899, 0.0004973815141773006, 0.8579757338432905, 0.0005057772058787043, 0.00048178592718415496, 0.0004985720997717187, 0.23580421321014725, 0.0004824859126698911, -9.999522122982752, 0.00047353385159112986, 0.00046934412056162233, 0.00044685933455499165, 0.0004808664456866778, 0.0004762879175584081, 0.00047197382161536417, 0.00046781153221847556, 0.00044541214617097437, 0.0004885452621277563, 0.11084655598378607, 0.0004795656630067243, 0.00047526898886596355, 0.0004524533211943501, 0.00048105112582567223, 0.0004766506967871054, -9.99952757654052, -9.999550254250602, 0.00046389747678575704, -9.999512984600607, 0.00048250991557624074, -7.002245259650426, 0.0004551897592617694, 0.11888494734532302, 0.0004853889680005239, 0.00048072435321145496, 0.0004763298740061937, -9.652185760202007, -9.999550481876849, 0.0004927519821695099, 0.11165918368163212, -9.99951591182745, 0.000479631886342683, 0.0004753340306581729, -9.999510527571532, 0.0004853722292898002, 0.00048070793458706353, 0.00047631375422472273, 0.11083526490199856], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 24, 25, 25, 27, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 26, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 407.76343253695006, "mean_inference_ms": 2.114120114482644, "mean_action_processing_ms": 0.1448151869297039, "mean_env_wait_ms": 2.9362482107465877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00951695442199707, "StateBufferConnector_ms": 0.00634312629699707, "ViewRequirementAgentConnector_ms": 0.1743011474609375}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 58500, "num_env_steps_sampled": 31000, "num_env_steps_trained": 58500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.50971495679381, "num_env_steps_trained_throughput_per_sec": 8.793944165747929, "timesteps_total": 31000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 31000, "timers": {"training_iteration_time_ms": 8902.704, "sample_time_ms": 8841.512, "load_time_ms": 0.235, "load_throughput": 331464.754, "learn_time_ms": 12.477, "learn_throughput": 6251.399, "synch_weights_time_ms": 10.675}, "counters": {"num_env_steps_sampled": 31000, "num_env_steps_trained": 58500, "num_agent_steps_sampled": 31000, "num_agent_steps_trained": 58500, "last_target_update_ts": 30680, "num_target_updates": 58}, "done": false, "episodes_total": 1160, "training_iteration": 31, "trial_id": "2058a_00000", "date": "2024-04-17_07-17-55", "timestamp": 1713338275, "time_this_iter_s": 221.75174689292908, "time_total_s": 7048.9691507816315, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7048.9691507816315, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 13.289556962025317, "ram_util_percent": 16.03544303797468}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.016832029446959496, "cur_lr": 0.01}, "td_error": [1.6022119522094727, 1.04972505569458, 1.5789432525634766, 1.5789440870285034, 1.0497241020202637, 1.654617190361023, 1.5789413452148438, 1.5789475440979004, 1.5789583921432495, 1.5789412260055542, 0.7494180202484131, 1.578945517539978, 1.5789445638656616, 1.5789417028427124, 1.5789457559585571, 1.5792157649993896, 1.714680552482605, 1.5789968967437744, 1.5789406299591064, 1.5789422988891602, 1.6545964479446411, 1.049724817276001, 1.5789436101913452, 1.5789421796798706, 1.661045789718628, 1.5789424180984497, 1.583543300628662, 1.5789412260055542, 1.578943133354187, 1.5789475440979004, 1.5790197849273682, 1.5789471864700317, 1.5789463520050049, 1.7146921157836914, 1.578940749168396, 1.654639720916748, 1.578942894935608, 1.578945279121399, 1.578945279121399, 1.5789408683776855, 2.3199284076690674, 1.5789440870285034, 1.0497255325317383, 1.0497255325317383, 1.5789415836334229, 1.5789412260055542, 1.6544464826583862, 2.3127310276031494, 1.04972505569458, 1.5789446830749512, 1.6070070266723633, 1.661262035369873, 1.5851517915725708, 1.5789408683776855, 1.049723744392395, 1.7149819135665894, 1.5789406299591064, 1.7068119049072266, 1.5789439678192139, 1.5789414644241333, 2.312711715698242, 1.5789432525634766, 1.5789412260055542, 1.6551051139831543, 1.5789436101913452, 1.578943133354187, 3.1440627574920654, 1.5789436101913452, 1.5789427757263184, 1.5789411067962646, 1.578942060470581, 1.578940987586975, 1.5789426565170288, 1.5789421796798706, 1.5789414644241333, 1.04972243309021, 1.578942060470581, 1.5789471864700317], "mean_td_error": 1.5770386457443237, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 775.0, "diff_num_grad_updates_vs_sampler_policy": 774.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 60450, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 60450, "last_target_update_ts": 31720, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": 0.9248972553006957, "episode_reward_min": -19.999505942022935, "episode_reward_mean": -1.6003622286008552, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0004857221134567307, 0.0004884240325008016, 0.0005053958446878871, 0.0005003997623559126, -9.999504286520029, 0.05201273966889307, 0.0005059950571090609, 0.00048199183695436614, 0.9071710102711109, -19.999505942022935, 0.0004894890648012176, 0.0005145002167269038, 0.0005096317914381779, 0.00048542902173526024, 0.0005023172288434899, 0.0004973815141773006, 0.8579757338432905, 0.0005057772058787043, 0.00048178592718415496, 0.0004985720997717187, 0.23580421321014725, 0.0004824859126698911, -9.999522122982752, 0.00047353385159112986, 0.00046934412056162233, 0.00044685933455499165, 0.0004808664456866778, 0.0004762879175584081, 0.00047197382161536417, 0.00046781153221847556, 0.00044541214617097437, 0.0004885452621277563, 0.11084655598378607, 0.0004795656630067243, 0.00047526898886596355, 0.0004524533211943501, 0.00048105112582567223, 0.0004766506967871054, -9.99952757654052, -9.999550254250602, 0.00046389747678575704, -9.999512984600607, 0.00048250991557624074, -7.002245259650426, 0.0004551897592617694, 0.11888494734532302, 0.0004853889680005239, 0.00048072435321145496, 0.0004763298740061937, -9.652185760202007, -9.999550481876849, 0.0004927519821695099, 0.11165918368163212, -9.99951591182745, 0.000479631886342683, 0.0004753340306581729, -9.999510527571532, 0.0004853722292898002, 0.00048070793458706353, 0.00047631375422472273, 0.11083526490199856, 0.000460944664025947, 0.0004567644029405647, 0.9248972553006957, 0.18483356238754828, 0.00044491275529153385, 0.0004594663468327469, 0.0004553127401081919, 0.000451457006828304, 0.0004480867972880785, 0.00044293077430381943, -9.811316028924375, 0.10808175442646452, 0.0004586893030709359, 0.0004552106788301662, -9.999550109277791, 0.0004596637229268257, -9.999544260064361, 0.000452300136997181, 0.0004470472741489609, 0.0004435048698016851, 0.8661585588987792, 0.7624715183424577, 0.00045826201847865185, 0.0004528706061800835, 0.00044923565272047877, 0.00046366004420827383, 0.0004594306041104428, 0.00045550510746801884, 0.35465981973548666, 0.00044687645103526146, 0.0004525147241928779, 0.00046672080672945814, 0.0004624355905549774, 0.18112394290212214, 0.0004551176970835117, 0.00044961774540076116, 0.0004637621498071625, -9.999540469972107, -9.49608432039446], "episode_lengths": [25, 24, 25, 25, 26, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 408.7334127237807, "mean_inference_ms": 2.114906715296626, "mean_action_processing_ms": 0.14484040910034726, "mean_env_wait_ms": 2.847681747389633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009473562240600586, "StateBufferConnector_ms": 0.006470680236816406, "ViewRequirementAgentConnector_ms": 0.17517733573913574}}, "episode_reward_max": 0.9248972553006957, "episode_reward_min": -19.999505942022935, "episode_reward_mean": -1.6003622286008552, "episode_len_mean": 25.05, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0004857221134567307, 0.0004884240325008016, 0.0005053958446878871, 0.0005003997623559126, -9.999504286520029, 0.05201273966889307, 0.0005059950571090609, 0.00048199183695436614, 0.9071710102711109, -19.999505942022935, 0.0004894890648012176, 0.0005145002167269038, 0.0005096317914381779, 0.00048542902173526024, 0.0005023172288434899, 0.0004973815141773006, 0.8579757338432905, 0.0005057772058787043, 0.00048178592718415496, 0.0004985720997717187, 0.23580421321014725, 0.0004824859126698911, -9.999522122982752, 0.00047353385159112986, 0.00046934412056162233, 0.00044685933455499165, 0.0004808664456866778, 0.0004762879175584081, 0.00047197382161536417, 0.00046781153221847556, 0.00044541214617097437, 0.0004885452621277563, 0.11084655598378607, 0.0004795656630067243, 0.00047526898886596355, 0.0004524533211943501, 0.00048105112582567223, 0.0004766506967871054, -9.99952757654052, -9.999550254250602, 0.00046389747678575704, -9.999512984600607, 0.00048250991557624074, -7.002245259650426, 0.0004551897592617694, 0.11888494734532302, 0.0004853889680005239, 0.00048072435321145496, 0.0004763298740061937, -9.652185760202007, -9.999550481876849, 0.0004927519821695099, 0.11165918368163212, -9.99951591182745, 0.000479631886342683, 0.0004753340306581729, -9.999510527571532, 0.0004853722292898002, 0.00048070793458706353, 0.00047631375422472273, 0.11083526490199856, 0.000460944664025947, 0.0004567644029405647, 0.9248972553006957, 0.18483356238754828, 0.00044491275529153385, 0.0004594663468327469, 0.0004553127401081919, 0.000451457006828304, 0.0004480867972880785, 0.00044293077430381943, -9.811316028924375, 0.10808175442646452, 0.0004586893030709359, 0.0004552106788301662, -9.999550109277791, 0.0004596637229268257, -9.999544260064361, 0.000452300136997181, 0.0004470472741489609, 0.0004435048698016851, 0.8661585588987792, 0.7624715183424577, 0.00045826201847865185, 0.0004528706061800835, 0.00044923565272047877, 0.00046366004420827383, 0.0004594306041104428, 0.00045550510746801884, 0.35465981973548666, 0.00044687645103526146, 0.0004525147241928779, 0.00046672080672945814, 0.0004624355905549774, 0.18112394290212214, 0.0004551176970835117, 0.00044961774540076116, 0.0004637621498071625, -9.999540469972107, -9.49608432039446], "episode_lengths": [25, 24, 25, 25, 26, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 408.7334127237807, "mean_inference_ms": 2.114906715296626, "mean_action_processing_ms": 0.14484040910034726, "mean_env_wait_ms": 2.847681747389633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009473562240600586, "StateBufferConnector_ms": 0.006470680236816406, "ViewRequirementAgentConnector_ms": 0.17517733573913574}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 60450, "num_env_steps_sampled": 32000, "num_env_steps_trained": 60450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.972747801862437, "num_env_steps_trained_throughput_per_sec": 9.696858213631753, "timesteps_total": 32000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 6713.879, "sample_time_ms": 6654.408, "load_time_ms": 0.234, "load_throughput": 333288.215, "learn_time_ms": 12.558, "learn_throughput": 6211.082, "synch_weights_time_ms": 11.151}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 60450, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 60450, "last_target_update_ts": 31720, "num_target_updates": 60}, "done": false, "episodes_total": 1199, "training_iteration": 32, "trial_id": "2058a_00000", "date": "2024-04-17_07-21-16", "timestamp": 1713338476, "time_this_iter_s": 201.10501718521118, "time_total_s": 7250.074167966843, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7250.074167966843, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 14.374825174825178, "ram_util_percent": 16.13881118881119}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.024222707375884056, "cur_lr": 0.01}, "td_error": [1.5666831731796265, 1.5666863918304443, 1.5232419967651367, 1.6303377151489258, 1.5713322162628174, 1.5666860342025757, 1.5666831731796265, 0.35273054242134094, 1.7857249975204468, 1.6516259908676147, 1.6302669048309326, 1.6302752494812012, 1.5666829347610474, 1.566685676574707, 1.5666849613189697, 1.5666838884353638, 1.5666838884353638, 1.5666834115982056, 2.3256680965423584, 1.5666836500167847, 1.4068281650543213, 1.5666837692260742, 1.5666834115982056, 0.7631936073303223, 1.5666836500167847, 1.6303139925003052, 3.705664873123169, 1.5666835308074951, 1.566683292388916, 1.5666948556900024, 1.6309772729873657, 0.8944158554077148, 1.0427578687667847, 0.7604272961616516, 1.566685438156128, 0.7622685432434082, 1.0427554845809937, 1.5666834115982056, 1.6414165496826172, 2.328676462173462, 1.566685676574707, 1.7275912761688232, 1.566683053970337, 1.5666835308074951, 1.5666834115982056, 3.269106388092041, 1.5666855573654175, 1.6825213432312012, 1.5666837692260742, 1.5666835308074951, 1.9614989757537842, 1.5666834115982056, 1.5666959285736084, 1.5971100330352783, 1.5666831731796265, 1.7870709896087646, 1.5670394897460938, 1.042750597000122, 1.566685676574707, 1.5666834115982056, 1.8229864835739136, 0.323732852935791, 1.0427523851394653, 1.226588249206543, 2.33366322517395, 1.5666841268539429, 1.5666831731796265, 1.5666860342025757, 1.5482944250106812, 1.5666836500167847, 1.0427594184875488, 1.5666834115982056, 1.042757272720337, 1.5666831731796265, 1.5666834115982056, 1.566683053970337, 1.750432014465332, 1.6301279067993164], "mean_td_error": 1.5539792776107788, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 800.0, "diff_num_grad_updates_vs_sampler_policy": 799.0}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 62400, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 62400, "last_target_update_ts": 32760, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": 0.9580033328586223, "episode_reward_min": -19.999559608882223, "episode_reward_mean": -2.206338741322387, "episode_len_mean": 25.12, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999512984600607, 0.00048250991557624074, -7.002245259650426, 0.0004551897592617694, 0.11888494734532302, 0.0004853889680005239, 0.00048072435321145496, 0.0004763298740061937, -9.652185760202007, -9.999550481876849, 0.0004927519821695099, 0.11165918368163212, -9.99951591182745, 0.000479631886342683, 0.0004753340306581729, -9.999510527571532, 0.0004853722292898002, 0.00048070793458706353, 0.00047631375422472273, 0.11083526490199856, 0.000460944664025947, 0.0004567644029405647, 0.9248972553006957, 0.18483356238754828, 0.00044491275529153385, 0.0004594663468327469, 0.0004553127401081919, 0.000451457006828304, 0.0004480867972880785, 0.00044293077430381943, -9.811316028924375, 0.10808175442646452, 0.0004586893030709359, 0.0004552106788301662, -9.999550109277791, 0.0004596637229268257, -9.999544260064361, 0.000452300136997181, 0.0004470472741489609, 0.0004435048698016851, 0.8661585588987792, 0.7624715183424577, 0.00045826201847865185, 0.0004528706061800835, 0.00044923565272047877, 0.00046366004420827383, 0.0004594306041104428, 0.00045550510746801884, 0.35465981973548666, 0.00044687645103526146, 0.0004525147241928779, 0.00046672080672945814, 0.0004624355905549774, 0.18112394290212214, 0.0004551176970835117, 0.00044961774540076116, 0.0004637621498071625, -9.999540469972107, -9.49608432039446, 0.05673144619930804, 0.00043868102659606813, 0.00043565194008886017, -9.999567574432852, -9.999588134706736, 0.00043945307784089543, -9.999563526043167, 0.0004334748621232954, 0.0004302797370408757, 0.9580033328586223, 0.06749366339636727, -9.59948878895128, 0.0004404121426839731, 0.00043711432458543985, 0.0004162966312113115, 0.0004404704320782279, 0.00043741667366696595, 0.0004341633954479947, 0.00041350841872981464, -9.999572185168368, 0.00044612255556322273, 0.0004429902145935256, 0.0004396538223115113, 0.00041869585946893397, 0.043903650191419126, -19.999556662625306, 0.00044030459850076786, 0.0004372531307407091, -9.999565992359994, -9.99958664352895, 0.04166472433943923, 0.00044661359428932923, 0.0004435366109863025, 0.0004404403458777057, 0.0004371421069954487, 0.0004163228802549722, 0.00045221001583669305, -9.999553040446777, 0.0004434182194323196, -19.999559608882223, 0.00043733238564949966], "episode_lengths": [26, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 27, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 409.7177502190457, "mean_inference_ms": 2.1124270785602977, "mean_action_processing_ms": 0.14473013381292069, "mean_env_wait_ms": 2.7605751435078547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009253263473510742, "StateBufferConnector_ms": 0.006329536437988281, "ViewRequirementAgentConnector_ms": 0.1714491844177246}}, "episode_reward_max": 0.9580033328586223, "episode_reward_min": -19.999559608882223, "episode_reward_mean": -2.206338741322387, "episode_len_mean": 25.12, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999512984600607, 0.00048250991557624074, -7.002245259650426, 0.0004551897592617694, 0.11888494734532302, 0.0004853889680005239, 0.00048072435321145496, 0.0004763298740061937, -9.652185760202007, -9.999550481876849, 0.0004927519821695099, 0.11165918368163212, -9.99951591182745, 0.000479631886342683, 0.0004753340306581729, -9.999510527571532, 0.0004853722292898002, 0.00048070793458706353, 0.00047631375422472273, 0.11083526490199856, 0.000460944664025947, 0.0004567644029405647, 0.9248972553006957, 0.18483356238754828, 0.00044491275529153385, 0.0004594663468327469, 0.0004553127401081919, 0.000451457006828304, 0.0004480867972880785, 0.00044293077430381943, -9.811316028924375, 0.10808175442646452, 0.0004586893030709359, 0.0004552106788301662, -9.999550109277791, 0.0004596637229268257, -9.999544260064361, 0.000452300136997181, 0.0004470472741489609, 0.0004435048698016851, 0.8661585588987792, 0.7624715183424577, 0.00045826201847865185, 0.0004528706061800835, 0.00044923565272047877, 0.00046366004420827383, 0.0004594306041104428, 0.00045550510746801884, 0.35465981973548666, 0.00044687645103526146, 0.0004525147241928779, 0.00046672080672945814, 0.0004624355905549774, 0.18112394290212214, 0.0004551176970835117, 0.00044961774540076116, 0.0004637621498071625, -9.999540469972107, -9.49608432039446, 0.05673144619930804, 0.00043868102659606813, 0.00043565194008886017, -9.999567574432852, -9.999588134706736, 0.00043945307784089543, -9.999563526043167, 0.0004334748621232954, 0.0004302797370408757, 0.9580033328586223, 0.06749366339636727, -9.59948878895128, 0.0004404121426839731, 0.00043711432458543985, 0.0004162966312113115, 0.0004404704320782279, 0.00043741667366696595, 0.0004341633954479947, 0.00041350841872981464, -9.999572185168368, 0.00044612255556322273, 0.0004429902145935256, 0.0004396538223115113, 0.00041869585946893397, 0.043903650191419126, -19.999556662625306, 0.00044030459850076786, 0.0004372531307407091, -9.999565992359994, -9.99958664352895, 0.04166472433943923, 0.00044661359428932923, 0.0004435366109863025, 0.0004404403458777057, 0.0004371421069954487, 0.0004163228802549722, 0.00045221001583669305, -9.999553040446777, 0.0004434182194323196, -19.999559608882223, 0.00043733238564949966], "episode_lengths": [26, 25, 26, 24, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 27, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 409.7177502190457, "mean_inference_ms": 2.1124270785602977, "mean_action_processing_ms": 0.14473013381292069, "mean_env_wait_ms": 2.7605751435078547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009253263473510742, "StateBufferConnector_ms": 0.006329536437988281, "ViewRequirementAgentConnector_ms": 0.1714491844177246}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 62400, "num_env_steps_sampled": 33000, "num_env_steps_trained": 62400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.268719492969661, "num_env_steps_trained_throughput_per_sec": 10.274003011290837, "timesteps_total": 33000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 8915.943, "sample_time_ms": 8855.618, "load_time_ms": 0.244, "load_throughput": 319332.076, "learn_time_ms": 12.621, "learn_throughput": 6180.306, "synch_weights_time_ms": 11.348}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 62400, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 62400, "last_target_update_ts": 32760, "num_target_updates": 62}, "done": false, "episodes_total": 1240, "training_iteration": 33, "trial_id": "2058a_00000", "date": "2024-04-17_07-24-26", "timestamp": 1713338666, "time_this_iter_s": 189.8075976371765, "time_total_s": 7439.881765604019, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7439.881765604019, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 15.792222222222223, "ram_util_percent": 16.264444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.031692024320364, "cur_lr": 0.01}, "td_error": [1.5390762090682983, 1.5390428304672241, 1.5390424728393555, 1.5390424728393555, 1.6631035804748535, 1.0142954587936401, 1.0143020153045654, 1.5390433073043823, 1.539042592048645, 1.0143030881881714, 1.5973364114761353, 1.539042353630066, 2.4607040882110596, 1.5390424728393555, 1.5390422344207764, 1.539042592048645, 1.7279828786849976, 1.5390428304672241, 1.6166397333145142, 0.9689998030662537, 3.399244546890259, 1.5390434265136719, 1.6166386604309082, 1.0143015384674072, 1.5390424728393555, 1.0141743421554565, 1.5390428304672241, 1.539042592048645, 1.5390429496765137, 1.539042353630066, 1.5390424728393555, 1.5390424728393555, 1.539043664932251, 1.5390424728393555, 1.5390429496765137, 1.014298677444458, 1.014301061630249, 1.5195173025131226, 1.561880111694336, 1.0143033266067505, 1.5390461683273315, 1.0142844915390015, 1.539042353630066, 1.014302372932434, 2.0612924098968506, 1.539042353630066, 1.539042353630066, 1.539042592048645, 2.440910577774048, 1.616595983505249, 1.7994093894958496, 1.5390433073043823, 1.5390428304672241, 1.5390470027923584, 1.5390433073043823, 2.4617691040039062, 1.5391322374343872, 0.8006926774978638, 2.4617693424224854, 1.5390422344207764, 1.5390428304672241, 1.5390427112579346, 1.616527795791626, 1.5390424728393555, 1.6879582405090332, 2.4607038497924805, 1.5390427112579346, 1.5390424728393555, 1.5390503406524658, 1.539042592048645, 1.539046049118042, 1.5390427112579346, 1.6164841651916504, 1.539042353630066, 1.539042592048645, 1.539144515991211, 1.539042592048645, 1.0143011808395386], "mean_td_error": 1.552686333656311, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 825.0, "diff_num_grad_updates_vs_sampler_policy": 824.0}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 64350, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 64350, "last_target_update_ts": 33800, "num_target_updates": 64}, "sampler_results": {"episode_reward_max": 0.9580033328586223, "episode_reward_min": -19.99958009443683, "episode_reward_mean": -1.9422577815980577, "episode_len_mean": 25.1, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0004435048698016851, 0.8661585588987792, 0.7624715183424577, 0.00045826201847865185, 0.0004528706061800835, 0.00044923565272047877, 0.00046366004420827383, 0.0004594306041104428, 0.00045550510746801884, 0.35465981973548666, 0.00044687645103526146, 0.0004525147241928779, 0.00046672080672945814, 0.0004624355905549774, 0.18112394290212214, 0.0004551176970835117, 0.00044961774540076116, 0.0004637621498071625, -9.999540469972107, -9.49608432039446, 0.05673144619930804, 0.00043868102659606813, 0.00043565194008886017, -9.999567574432852, -9.999588134706736, 0.00043945307784089543, -9.999563526043167, 0.0004334748621232954, 0.0004302797370408757, 0.9580033328586223, 0.06749366339636727, -9.59948878895128, 0.0004404121426839731, 0.00043711432458543985, 0.0004162966312113115, 0.0004404704320782279, 0.00043741667366696595, 0.0004341633954479947, 0.00041350841872981464, -9.999572185168368, 0.00044612255556322273, 0.0004429902145935256, 0.0004396538223115113, 0.00041869585946893397, 0.043903650191419126, -19.999556662625306, 0.00044030459850076786, 0.0004372531307407091, -9.999565992359994, -9.99958664352895, 0.04166472433943923, 0.00044661359428932923, 0.0004435366109863025, 0.0004404403458777057, 0.0004371421069954487, 0.0004163228802549722, 0.00045221001583669305, -9.999553040446777, 0.0004434182194323196, -19.999559608882223, 0.00043733238564949966, 0.000426126282260422, 0.0004229629011698297, -9.999580677544596, 0.0004155432548510372, 0.00041226192040585784, 0.08141515788906087, 0.0004210800294558689, 0.00041747150083192177, 0.0004137257192861899, 0.045492426349514, 0.00043067950778713434, 0.09514524919034663, 0.06386768244022706, 0.00042026368322005343, 0.14855560073504245, 0.00042462613521940804, 0.00042095684710044686, -9.999582851184373, 0.00041384190638891344, 0.0004102523595612776, 0.0004302316868957218, -9.999573540643299, 0.0004225571496192708, 0.000419164575632789, 0.21687025883378852, 0.00042765809478488283, 0.07713634786486508, 0.00042106730848175323, 0.00041725700945424536, 0.0004139486648459799, 0.000430706478203871, 0.00042747498741274045, 0.00042375652250257524, -19.99958009443683, -9.999565919341354, 0.0004134299541659984, 0.00042773390925677135, 0.7739743313511009, 0.00042090787979642326], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 27, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 410.4970746245647, "mean_inference_ms": 2.1119631481468524, "mean_action_processing_ms": 0.14463852449279418, "mean_env_wait_ms": 2.6821224777578645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009417533874511719, "StateBufferConnector_ms": 0.006478309631347656, "ViewRequirementAgentConnector_ms": 0.16989612579345703}}, "episode_reward_max": 0.9580033328586223, "episode_reward_min": -19.99958009443683, "episode_reward_mean": -1.9422577815980577, "episode_len_mean": 25.1, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0004435048698016851, 0.8661585588987792, 0.7624715183424577, 0.00045826201847865185, 0.0004528706061800835, 0.00044923565272047877, 0.00046366004420827383, 0.0004594306041104428, 0.00045550510746801884, 0.35465981973548666, 0.00044687645103526146, 0.0004525147241928779, 0.00046672080672945814, 0.0004624355905549774, 0.18112394290212214, 0.0004551176970835117, 0.00044961774540076116, 0.0004637621498071625, -9.999540469972107, -9.49608432039446, 0.05673144619930804, 0.00043868102659606813, 0.00043565194008886017, -9.999567574432852, -9.999588134706736, 0.00043945307784089543, -9.999563526043167, 0.0004334748621232954, 0.0004302797370408757, 0.9580033328586223, 0.06749366339636727, -9.59948878895128, 0.0004404121426839731, 0.00043711432458543985, 0.0004162966312113115, 0.0004404704320782279, 0.00043741667366696595, 0.0004341633954479947, 0.00041350841872981464, -9.999572185168368, 0.00044612255556322273, 0.0004429902145935256, 0.0004396538223115113, 0.00041869585946893397, 0.043903650191419126, -19.999556662625306, 0.00044030459850076786, 0.0004372531307407091, -9.999565992359994, -9.99958664352895, 0.04166472433943923, 0.00044661359428932923, 0.0004435366109863025, 0.0004404403458777057, 0.0004371421069954487, 0.0004163228802549722, 0.00045221001583669305, -9.999553040446777, 0.0004434182194323196, -19.999559608882223, 0.00043733238564949966, 0.000426126282260422, 0.0004229629011698297, -9.999580677544596, 0.0004155432548510372, 0.00041226192040585784, 0.08141515788906087, 0.0004210800294558689, 0.00041747150083192177, 0.0004137257192861899, 0.045492426349514, 0.00043067950778713434, 0.09514524919034663, 0.06386768244022706, 0.00042026368322005343, 0.14855560073504245, 0.00042462613521940804, 0.00042095684710044686, -9.999582851184373, 0.00041384190638891344, 0.0004102523595612776, 0.0004302316868957218, -9.999573540643299, 0.0004225571496192708, 0.000419164575632789, 0.21687025883378852, 0.00042765809478488283, 0.07713634786486508, 0.00042106730848175323, 0.00041725700945424536, 0.0004139486648459799, 0.000430706478203871, 0.00042747498741274045, 0.00042375652250257524, -19.99958009443683, -9.999565919341354, 0.0004134299541659984, 0.00042773390925677135, 0.7739743313511009, 0.00042090787979642326], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 27, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 410.4970746245647, "mean_inference_ms": 2.1119631481468524, "mean_action_processing_ms": 0.14463852449279418, "mean_env_wait_ms": 2.6821224777578645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009417533874511719, "StateBufferConnector_ms": 0.006478309631347656, "ViewRequirementAgentConnector_ms": 0.16989612579345703}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 64350, "num_env_steps_sampled": 34000, "num_env_steps_trained": 64350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.512827861007827, "num_env_steps_trained_throughput_per_sec": 8.800014328965263, "timesteps_total": 34000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 8899.033, "sample_time_ms": 8836.777, "load_time_ms": 0.259, "load_throughput": 300666.953, "learn_time_ms": 12.875, "learn_throughput": 6058.215, "synch_weights_time_ms": 11.866}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 64350, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 64350, "last_target_update_ts": 33800, "num_target_updates": 64}, "done": false, "episodes_total": 1279, "training_iteration": 34, "trial_id": "2058a_00000", "date": "2024-04-17_07-28-07", "timestamp": 1713338887, "time_this_iter_s": 221.59942054748535, "time_total_s": 7661.4811861515045, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7661.4811861515045, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 12.993650793650794, "ram_util_percent": 16.374920634920638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03531293570995331, "cur_lr": 0.01}, "td_error": [2.055816650390625, 1.7310404777526855, 1.5675556659698486, 1.6262259483337402, 1.5675550699234009, 1.6261906623840332, 1.7324528694152832, 1.5675554275512695, 1.5675591230392456, 2.437201976776123, 1.5675556659698486, 1.567556381225586, 1.5675605535507202, 1.3005627393722534, 1.2176764011383057, 1.5675595998764038, 1.5675578117370605, 1.6664596796035767, 1.6262249946594238, 1.5675570964813232, 1.0465723276138306, 1.56755793094635, 1.045487642288208, 1.567605972290039, 1.5675575733184814, 1.5675699710845947, 1.5675612688064575, 1.5675597190856934, 1.045487642288208, 1.5675567388534546, 1.5675638914108276, 1.5675580501556396, 1.0454877614974976, 1.6263459920883179, 1.6631219387054443, 0.7474425435066223, 3.1833431720733643, 3.2646799087524414, 1.5676255226135254, 1.5675626993179321, 1.5675548315048218, 1.045487642288208, 1.5675586462020874, 1.0454882383346558, 2.3347198963165283, 1.045487642288208, 1.5675647258758545, 1.5676342248916626, 2.307842969894409, 1.8280422687530518, 0.3147182762622833, 1.567560076713562, 1.5675606727600098, 1.5675715208053589, 2.3347208499908447, 1.045487642288208, 1.5675570964813232, 1.5675556659698486, 1.567563533782959, 1.045492172241211, 1.5675580501556396, 1.7317934036254883, 1.5675569772720337, 1.5675575733184814, 1.5675570964813232, 1.5675569772720337, 1.5675550699234009, 1.567557454109192, 1.5675623416900635, 1.6263868808746338, 1.5291221141815186, 1.5675550699234009, 1.5675561428070068, 1.0478496551513672, 1.731349229812622, 1.571306824684143, 1.567555546760559, 1.7310802936553955], "mean_td_error": 1.5748957395553589, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 850.0, "diff_num_grad_updates_vs_sampler_policy": 849.0}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 66300, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 66300, "last_target_update_ts": 34840, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": 0.7739743313511009, "episode_reward_min": -19.99958009443683, "episode_reward_mean": -2.24194053554752, "episode_len_mean": 24.97, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0004396538223115113, 0.00041869585946893397, 0.043903650191419126, -19.999556662625306, 0.00044030459850076786, 0.0004372531307407091, -9.999565992359994, -9.99958664352895, 0.04166472433943923, 0.00044661359428932923, 0.0004435366109863025, 0.0004404403458777057, 0.0004371421069954487, 0.0004163228802549722, 0.00045221001583669305, -9.999553040446777, 0.0004434182194323196, -19.999559608882223, 0.00043733238564949966, 0.000426126282260422, 0.0004229629011698297, -9.999580677544596, 0.0004155432548510372, 0.00041226192040585784, 0.08141515788906087, 0.0004210800294558689, 0.00041747150083192177, 0.0004137257192861899, 0.045492426349514, 0.00043067950778713434, 0.09514524919034663, 0.06386768244022706, 0.00042026368322005343, 0.14855560073504245, 0.00042462613521940804, 0.00042095684710044686, -9.999582851184373, 0.00041384190638891344, 0.0004102523595612776, 0.0004302316868957218, -9.999573540643299, 0.0004225571496192708, 0.000419164575632789, 0.21687025883378852, 0.00042765809478488283, 0.07713634786486508, 0.00042106730848175323, 0.00041725700945424536, 0.0004139486648459799, 0.000430706478203871, 0.00042747498741274045, 0.00042375652250257524, -19.99958009443683, -9.999565919341354, 0.0004134299541659984, 0.00042773390925677135, 0.7739743313511009, 0.00042090787979642326, -9.999591300114277, 0.0003898343888235627, 0.0004034576705246057, 0.00040072255334471093, 0.0003821473288588611, 0.0004071838789876175, -9.999611601879828, 0.00040198049461098533, 0.00039926530102357845, -9.999619232956427, 0.048118827399466386, 0.00041337845813303005, 0.0003942682924685398, 0.0004080165866045343, 0.0004052195244163806, 0.00038640714750104476, 0.00036840365426373033, 0.00039130591692864954, -9.999595019610101, 0.0004022151618531999, -6.233030886713955, 0.00036570915815046574, -9.959323613093776, 0.0004105424310984907, 0.00040771075205403253, -9.999611233011013, 0.0003706416577047781, -9.999589642458247, 0.159415313638587, 0.0004051562397220703, 0.13247060515410064, -9.999616121326898, 0.00041654743798135276, 0.0004129109995752749, 0.03541792582464711, -9.99959205021396, 0.00040515337563522524, 0.0004171004528727775, 0.0004137945802806703, 0.0004102058510113433, 0.0003912618419731135, 0.0004049254432471383], "episode_lengths": [25, 24, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 27, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 25, 25, 25, 26, 24, 25, 25, 24, 25, 25, 25, 25, 25, 23, 25, 24, 25, 25, 24, 23, 24, 26, 25, 25, 23, 25, 25, 25, 25, 23, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 411.5901329289224, "mean_inference_ms": 2.11052973848832, "mean_action_processing_ms": 0.14452784663314053, "mean_env_wait_ms": 2.6044289628841453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00966644287109375, "StateBufferConnector_ms": 0.00635981559753418, "ViewRequirementAgentConnector_ms": 0.17168784141540527}}, "episode_reward_max": 0.7739743313511009, "episode_reward_min": -19.99958009443683, "episode_reward_mean": -2.24194053554752, "episode_len_mean": 24.97, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0004396538223115113, 0.00041869585946893397, 0.043903650191419126, -19.999556662625306, 0.00044030459850076786, 0.0004372531307407091, -9.999565992359994, -9.99958664352895, 0.04166472433943923, 0.00044661359428932923, 0.0004435366109863025, 0.0004404403458777057, 0.0004371421069954487, 0.0004163228802549722, 0.00045221001583669305, -9.999553040446777, 0.0004434182194323196, -19.999559608882223, 0.00043733238564949966, 0.000426126282260422, 0.0004229629011698297, -9.999580677544596, 0.0004155432548510372, 0.00041226192040585784, 0.08141515788906087, 0.0004210800294558689, 0.00041747150083192177, 0.0004137257192861899, 0.045492426349514, 0.00043067950778713434, 0.09514524919034663, 0.06386768244022706, 0.00042026368322005343, 0.14855560073504245, 0.00042462613521940804, 0.00042095684710044686, -9.999582851184373, 0.00041384190638891344, 0.0004102523595612776, 0.0004302316868957218, -9.999573540643299, 0.0004225571496192708, 0.000419164575632789, 0.21687025883378852, 0.00042765809478488283, 0.07713634786486508, 0.00042106730848175323, 0.00041725700945424536, 0.0004139486648459799, 0.000430706478203871, 0.00042747498741274045, 0.00042375652250257524, -19.99958009443683, -9.999565919341354, 0.0004134299541659984, 0.00042773390925677135, 0.7739743313511009, 0.00042090787979642326, -9.999591300114277, 0.0003898343888235627, 0.0004034576705246057, 0.00040072255334471093, 0.0003821473288588611, 0.0004071838789876175, -9.999611601879828, 0.00040198049461098533, 0.00039926530102357845, -9.999619232956427, 0.048118827399466386, 0.00041337845813303005, 0.0003942682924685398, 0.0004080165866045343, 0.0004052195244163806, 0.00038640714750104476, 0.00036840365426373033, 0.00039130591692864954, -9.999595019610101, 0.0004022151618531999, -6.233030886713955, 0.00036570915815046574, -9.959323613093776, 0.0004105424310984907, 0.00040771075205403253, -9.999611233011013, 0.0003706416577047781, -9.999589642458247, 0.159415313638587, 0.0004051562397220703, 0.13247060515410064, -9.999616121326898, 0.00041654743798135276, 0.0004129109995752749, 0.03541792582464711, -9.99959205021396, 0.00040515337563522524, 0.0004171004528727775, 0.0004137945802806703, 0.0004102058510113433, 0.0003912618419731135, 0.0004049254432471383], "episode_lengths": [25, 24, 25, 27, 25, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 27, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 25, 25, 25, 26, 24, 25, 25, 24, 25, 25, 25, 25, 25, 23, 25, 24, 25, 25, 24, 23, 24, 26, 25, 25, 23, 25, 25, 25, 25, 23, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 411.5901329289224, "mean_inference_ms": 2.11052973848832, "mean_action_processing_ms": 0.14452784663314053, "mean_env_wait_ms": 2.6044289628841453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00966644287109375, "StateBufferConnector_ms": 0.00635981559753418, "ViewRequirementAgentConnector_ms": 0.17168784141540527}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 66300, "num_env_steps_sampled": 35000, "num_env_steps_trained": 66300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.471396318044297, "num_env_steps_trained_throughput_per_sec": 8.71922282018638, "timesteps_total": 35000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 35000, "timers": {"training_iteration_time_ms": 8891.55, "sample_time_ms": 8830.79, "load_time_ms": 0.243, "load_throughput": 320992.653, "learn_time_ms": 12.362, "learn_throughput": 6309.547, "synch_weights_time_ms": 11.877}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 66300, "num_agent_steps_sampled": 35000, "num_agent_steps_trained": 66300, "last_target_update_ts": 34840, "num_target_updates": 66}, "done": false, "episodes_total": 1321, "training_iteration": 35, "trial_id": "2058a_00000", "date": "2024-04-17_07-31-51", "timestamp": 1713339111, "time_this_iter_s": 223.65424871444702, "time_total_s": 7885.1354348659515, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7885.1354348659515, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 13.967398119122258, "ram_util_percent": 16.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.022310448810458183, "cur_lr": 0.01}, "td_error": [1.517545223236084, 0.9994779825210571, 1.5175470113754272, 1.5175460577011108, 1.5175490379333496, 1.5175449848175049, 1.5175451040267944, 1.5175514221191406, 0.9994782209396362, 1.5175503492355347, 1.5175464153289795, 1.5175470113754272, 1.5175490379333496, 1.5175455808639526, 1.5175460577011108, 1.6115946769714355, 1.5175461769104004, 1.5175451040267944, 1.5175451040267944, 1.5175566673278809, 1.5175492763519287, 1.8175547122955322, 0.9994782209396362, 1.5175447463989258, 1.5175461769104004, 1.5179818868637085, 0.9994784593582153, 1.51754629611969, 1.51754629611969, 0.9994769096374512, 2.494264841079712, 0.7504794597625732, 0.7580642700195312, 1.517546534538269, 1.5175459384918213, 1.517545223236084, 1.5175448656082153, 1.5436161756515503, 1.5175449848175049, 2.4822874069213867, 1.5175467729568481, 1.5175467729568481, 1.518207311630249, 1.5175464153289795, 1.5175451040267944, 1.5175453424453735, 1.5175493955612183, 1.5175514221191406, 1.5175468921661377, 1.6112089157104492, 1.2298518419265747, 1.517547607421875, 1.5175449848175049, 1.5584437847137451, 0.7503995299339294, 1.7134947776794434, 2.482630491256714, 1.5175492763519287, 2.485065460205078, 1.7035685777664185, 1.6368768215179443, 1.517545461654663, 0.9994784593582153, 2.2164647579193115, 1.9123601913452148, 0.7579624056816101, 1.5175458192825317, 1.5175461769104004, 1.5175470113754272, 1.5175580978393555, 1.5175467729568481, 1.5175457000732422, 1.5175457000732422, 1.5175458192825317, 1.5175493955612183, 1.5175484418869019, 1.5175449848175049, 1.517549753189087], "mean_td_error": 1.5121043920516968, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 875.0, "diff_num_grad_updates_vs_sampler_policy": 874.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 68250, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 68250, "last_target_update_ts": 35880, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": 3.041517449307566, "episode_reward_min": -19.99958009443683, "episode_reward_mean": -1.8266563290955091, "episode_len_mean": 24.79, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.000419164575632789, 0.21687025883378852, 0.00042765809478488283, 0.07713634786486508, 0.00042106730848175323, 0.00041725700945424536, 0.0004139486648459799, 0.000430706478203871, 0.00042747498741274045, 0.00042375652250257524, -19.99958009443683, -9.999565919341354, 0.0004134299541659984, 0.00042773390925677135, 0.7739743313511009, 0.00042090787979642326, -9.999591300114277, 0.0003898343888235627, 0.0004034576705246057, 0.00040072255334471093, 0.0003821473288588611, 0.0004071838789876175, -9.999611601879828, 0.00040198049461098533, 0.00039926530102357845, -9.999619232956427, 0.048118827399466386, 0.00041337845813303005, 0.0003942682924685398, 0.0004080165866045343, 0.0004052195244163806, 0.00038640714750104476, 0.00036840365426373033, 0.00039130591692864954, -9.999595019610101, 0.0004022151618531999, -6.233030886713955, 0.00036570915815046574, -9.959323613093776, 0.0004105424310984907, 0.00040771075205403253, -9.999611233011013, 0.0003706416577047781, -9.999589642458247, 0.159415313638587, 0.0004051562397220703, 0.13247060515410064, -9.999616121326898, 0.00041654743798135276, 0.0004129109995752749, 0.03541792582464711, -9.99959205021396, 0.00040515337563522524, 0.0004171004528727775, 0.0004137945802806703, 0.0004102058510113433, 0.0003912618419731135, 0.0004049254432471383, 0.00036436296167167466, -6.798938305620852, 0.3769265428810859, 0.00037260889072287916, 0.0003850076896957551, -6.798939314274212, 3.041517449307566, 0.15225302720610942, 0.0003841264951813711, 0.0003816124503589811, 0.00039822348885799387, 0.7437878169063075, -9.999623361445758, 0.00038913729184308194, 0.00038655744144992706, 0.000395326889043137, 0.00039253328507583016, 0.12113891282098883, 0.00038646215006428935, -9.999616082228071, 0.00040062917801044764, 0.000397760436429449, 0.00037885192858883097, 0.0003914056469569525, 0.09238479031693993, 1.1205893704535987, 0.00039566352386048395, 0.00039286517892127943, 0.0003742255585856959, 0.00038666464042791594, 0.00038634449172874453, 0.0003683442248392492, -9.999601836416913, -9.999604683959612, 0.0003765513058496446, 0.000389048135742325, 0.00040217045765934454, -9.999616480797537, 0.00036566407205435703, 0.0003952784192192757, 0.0003924854975447717, 0.0003738666950050621], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 25, 25, 25, 26, 24, 25, 25, 24, 25, 25, 25, 25, 25, 23, 25, 24, 25, 25, 24, 23, 24, 26, 25, 25, 23, 25, 25, 25, 25, 23, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 23, 26, 25, 24, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 24, 23, 26, 26, 24, 25, 25, 25, 23, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 412.7634073461345, "mean_inference_ms": 2.1088555773812807, "mean_action_processing_ms": 0.14441450305169995, "mean_env_wait_ms": 2.5317470154080497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009798765182495117, "StateBufferConnector_ms": 0.0063860416412353516, "ViewRequirementAgentConnector_ms": 0.17370223999023438}}, "episode_reward_max": 3.041517449307566, "episode_reward_min": -19.99958009443683, "episode_reward_mean": -1.8266563290955091, "episode_len_mean": 24.79, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.000419164575632789, 0.21687025883378852, 0.00042765809478488283, 0.07713634786486508, 0.00042106730848175323, 0.00041725700945424536, 0.0004139486648459799, 0.000430706478203871, 0.00042747498741274045, 0.00042375652250257524, -19.99958009443683, -9.999565919341354, 0.0004134299541659984, 0.00042773390925677135, 0.7739743313511009, 0.00042090787979642326, -9.999591300114277, 0.0003898343888235627, 0.0004034576705246057, 0.00040072255334471093, 0.0003821473288588611, 0.0004071838789876175, -9.999611601879828, 0.00040198049461098533, 0.00039926530102357845, -9.999619232956427, 0.048118827399466386, 0.00041337845813303005, 0.0003942682924685398, 0.0004080165866045343, 0.0004052195244163806, 0.00038640714750104476, 0.00036840365426373033, 0.00039130591692864954, -9.999595019610101, 0.0004022151618531999, -6.233030886713955, 0.00036570915815046574, -9.959323613093776, 0.0004105424310984907, 0.00040771075205403253, -9.999611233011013, 0.0003706416577047781, -9.999589642458247, 0.159415313638587, 0.0004051562397220703, 0.13247060515410064, -9.999616121326898, 0.00041654743798135276, 0.0004129109995752749, 0.03541792582464711, -9.99959205021396, 0.00040515337563522524, 0.0004171004528727775, 0.0004137945802806703, 0.0004102058510113433, 0.0003912618419731135, 0.0004049254432471383, 0.00036436296167167466, -6.798938305620852, 0.3769265428810859, 0.00037260889072287916, 0.0003850076896957551, -6.798939314274212, 3.041517449307566, 0.15225302720610942, 0.0003841264951813711, 0.0003816124503589811, 0.00039822348885799387, 0.7437878169063075, -9.999623361445758, 0.00038913729184308194, 0.00038655744144992706, 0.000395326889043137, 0.00039253328507583016, 0.12113891282098883, 0.00038646215006428935, -9.999616082228071, 0.00040062917801044764, 0.000397760436429449, 0.00037885192858883097, 0.0003914056469569525, 0.09238479031693993, 1.1205893704535987, 0.00039566352386048395, 0.00039286517892127943, 0.0003742255585856959, 0.00038666464042791594, 0.00038634449172874453, 0.0003683442248392492, -9.999601836416913, -9.999604683959612, 0.0003765513058496446, 0.000389048135742325, 0.00040217045765934454, -9.999616480797537, 0.00036566407205435703, 0.0003952784192192757, 0.0003924854975447717, 0.0003738666950050621], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 26, 24, 25, 25, 25, 26, 24, 25, 25, 24, 25, 25, 25, 25, 25, 23, 25, 24, 25, 25, 24, 23, 24, 26, 25, 25, 23, 25, 25, 25, 25, 23, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 23, 26, 25, 24, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 24, 23, 26, 26, 24, 25, 25, 25, 23, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 412.7634073461345, "mean_inference_ms": 2.1088555773812807, "mean_action_processing_ms": 0.14441450305169995, "mean_env_wait_ms": 2.5317470154080497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009798765182495117, "StateBufferConnector_ms": 0.0063860416412353516, "ViewRequirementAgentConnector_ms": 0.17370223999023438}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 68250, "num_env_steps_sampled": 36000, "num_env_steps_trained": 68250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.483433176503968, "num_env_steps_trained_throughput_per_sec": 8.742694694182736, "timesteps_total": 36000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8944.634, "sample_time_ms": 8875.599, "load_time_ms": 0.298, "load_throughput": 261389.99, "learn_time_ms": 15.14, "learn_throughput": 5152.058, "synch_weights_time_ms": 13.542}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 68250, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 68250, "last_target_update_ts": 35880, "num_target_updates": 68}, "done": false, "episodes_total": 1363, "training_iteration": 36, "trial_id": "2058a_00000", "date": "2024-04-17_07-35-34", "timestamp": 1713339334, "time_this_iter_s": 223.0544035434723, "time_total_s": 8108.189838409424, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 8108.189838409424, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 14.027760252365931, "ram_util_percent": 16.624921135646687}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02757677063345909, "cur_lr": 0.01}, "td_error": [1.4981820583343506, 2.531296730041504, 3.067218542098999, 1.5803667306900024, 1.5807418823242188, 1.4992512464523315, 1.4981811046600342, 1.4981815814971924, 1.498180627822876, 1.4981815814971924, 1.4981886148452759, 1.498183012008667, 1.4981805086135864, 1.5811089277267456, 1.4981812238693237, 0.7414875626564026, 0.9874259829521179, 2.875753879547119, 1.498185396194458, 4.408591270446777, 1.498185157775879, 1.5804743766784668, 1.4981825351715088, 1.4981802701950073, 0.9874264001846313, 1.4981814622879028, 1.4981799125671387, 2.53013014793396, 1.4981807470321655, 1.498192548751831, 1.4987174272537231, 1.4981801509857178, 0.7414875626564026, 1.4981799125671387, 1.4981825351715088, 1.4981814622879028, 0.7414875626564026, 1.4982914924621582, 1.4981831312179565, 1.498189091682434, 0.9874262809753418, 1.4982144832611084, 1.498183250427246, 1.498180866241455, 1.4981811046600342, 1.4981826543807983, 1.4983866214752197, 1.4981852769851685, 0.36540091037750244, 1.4981968402862549, 1.657524585723877, 1.4981821775436401, 1.4982212781906128, 1.499161720275879, 1.609503149986267, 0.9874264001846313, 0.7414875626564026, 1.498182773590088, 1.4981803894042969, 1.498180627822876, 1.498180866241455, 1.4981811046600342, 1.4982041120529175, 1.4981814622879028, 1.498183250427246, 1.4981813430786133, 1.4981821775436401, 1.4982129335403442, 1.4981831312179565, 0.9874212741851807, 1.498189926147461, 1.5803954601287842, 0.315358430147171, 1.498182773590088, 1.3768069744110107, 0.9874156713485718, 0.9874264001846313, 1.4981845617294312], "mean_td_error": 1.4926553964614868, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 900.0, "diff_num_grad_updates_vs_sampler_policy": 899.0}}, "num_env_steps_sampled": 37000, "num_env_steps_trained": 70200, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 70200, "last_target_update_ts": 36920, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": 3.041517449307566, "episode_reward_min": -19.999629313470905, "episode_reward_mean": -1.9563485732354664, "episode_len_mean": 24.88, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0004105424310984907, 0.00040771075205403253, -9.999611233011013, 0.0003706416577047781, -9.999589642458247, 0.159415313638587, 0.0004051562397220703, 0.13247060515410064, -9.999616121326898, 0.00041654743798135276, 0.0004129109995752749, 0.03541792582464711, -9.99959205021396, 0.00040515337563522524, 0.0004171004528727775, 0.0004137945802806703, 0.0004102058510113433, 0.0003912618419731135, 0.0004049254432471383, 0.00036436296167167466, -6.798938305620852, 0.3769265428810859, 0.00037260889072287916, 0.0003850076896957551, -6.798939314274212, 3.041517449307566, 0.15225302720610942, 0.0003841264951813711, 0.0003816124503589811, 0.00039822348885799387, 0.7437878169063075, -9.999623361445758, 0.00038913729184308194, 0.00038655744144992706, 0.000395326889043137, 0.00039253328507583016, 0.12113891282098883, 0.00038646215006428935, -9.999616082228071, 0.00040062917801044764, 0.000397760436429449, 0.00037885192858883097, 0.0003914056469569525, 0.09238479031693993, 1.1205893704535987, 0.00039566352386048395, 0.00039286517892127943, 0.0003742255585856959, 0.00038666464042791594, 0.00038634449172874453, 0.0003683442248392492, -9.999601836416913, -9.999604683959612, 0.0003765513058496446, 0.000389048135742325, 0.00040217045765934454, -9.999616480797537, 0.00036566407205435703, 0.0003952784192192757, 0.0003924854975447717, 0.0003738666950050621, 0.0003824821335784216, 0.10710234489785543, 0.000377182558658429, 0.00037452875729859455, 0.00037216411064638975, 0.0003636566870970434, -9.648713185937968, 0.08458728390677873, -19.999628554443337, 0.00036833394826950804, 0.00038102200587132124, 0.00037831410104603003, 0.6144806924319598, 0.00037348565821394543, 0.07890885348173599, 0.04906962777579678, 0.0003761484953808725, 0.00037376341407248837, 0.00037134151564341796, -19.999629313470905, 0.00038343816096478913, 0.05634951879601794, -9.999621445508144, 0.00037607009031905225, 0.0003841173683388232, 0.0003660260959599955, 0.0003786511009473168, -19.999624003411295, -9.999626401209778, -9.999613530298353, 0.00036825074145745433, 0.0003809365293534402, 0.0003782298349167143, 0.6144806125618812, 0.0003862968449636145, 0.00038375440117290727, 0.0003656827784623582, 0.0003782983861025129, 0.00037562891696001815], "episode_lengths": [25, 25, 25, 23, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 23, 26, 25, 24, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 24, 23, 26, 26, 24, 25, 25, 25, 23, 25, 25, 24, 25, 24, 25, 25, 25, 24, 26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 25, 27, 26, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 413.5484455882158, "mean_inference_ms": 2.1047286166742243, "mean_action_processing_ms": 0.14424982536552794, "mean_env_wait_ms": 2.468848649008219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009446144104003906, "StateBufferConnector_ms": 0.0062732696533203125, "ViewRequirementAgentConnector_ms": 0.17282414436340332}}, "episode_reward_max": 3.041517449307566, "episode_reward_min": -19.999629313470905, "episode_reward_mean": -1.9563485732354664, "episode_len_mean": 24.88, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0004105424310984907, 0.00040771075205403253, -9.999611233011013, 0.0003706416577047781, -9.999589642458247, 0.159415313638587, 0.0004051562397220703, 0.13247060515410064, -9.999616121326898, 0.00041654743798135276, 0.0004129109995752749, 0.03541792582464711, -9.99959205021396, 0.00040515337563522524, 0.0004171004528727775, 0.0004137945802806703, 0.0004102058510113433, 0.0003912618419731135, 0.0004049254432471383, 0.00036436296167167466, -6.798938305620852, 0.3769265428810859, 0.00037260889072287916, 0.0003850076896957551, -6.798939314274212, 3.041517449307566, 0.15225302720610942, 0.0003841264951813711, 0.0003816124503589811, 0.00039822348885799387, 0.7437878169063075, -9.999623361445758, 0.00038913729184308194, 0.00038655744144992706, 0.000395326889043137, 0.00039253328507583016, 0.12113891282098883, 0.00038646215006428935, -9.999616082228071, 0.00040062917801044764, 0.000397760436429449, 0.00037885192858883097, 0.0003914056469569525, 0.09238479031693993, 1.1205893704535987, 0.00039566352386048395, 0.00039286517892127943, 0.0003742255585856959, 0.00038666464042791594, 0.00038634449172874453, 0.0003683442248392492, -9.999601836416913, -9.999604683959612, 0.0003765513058496446, 0.000389048135742325, 0.00040217045765934454, -9.999616480797537, 0.00036566407205435703, 0.0003952784192192757, 0.0003924854975447717, 0.0003738666950050621, 0.0003824821335784216, 0.10710234489785543, 0.000377182558658429, 0.00037452875729859455, 0.00037216411064638975, 0.0003636566870970434, -9.648713185937968, 0.08458728390677873, -19.999628554443337, 0.00036833394826950804, 0.00038102200587132124, 0.00037831410104603003, 0.6144806924319598, 0.00037348565821394543, 0.07890885348173599, 0.04906962777579678, 0.0003761484953808725, 0.00037376341407248837, 0.00037134151564341796, -19.999629313470905, 0.00038343816096478913, 0.05634951879601794, -9.999621445508144, 0.00037607009031905225, 0.0003841173683388232, 0.0003660260959599955, 0.0003786511009473168, -19.999624003411295, -9.999626401209778, -9.999613530298353, 0.00036825074145745433, 0.0003809365293534402, 0.0003782298349167143, 0.6144806125618812, 0.0003862968449636145, 0.00038375440117290727, 0.0003656827784623582, 0.0003782983861025129, 0.00037562891696001815], "episode_lengths": [25, 25, 25, 23, 26, 24, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 24, 25, 23, 26, 25, 24, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 23, 25, 25, 24, 25, 24, 23, 26, 26, 24, 25, 25, 25, 23, 25, 25, 24, 25, 24, 25, 25, 25, 24, 26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 25, 27, 26, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 413.5484455882158, "mean_inference_ms": 2.1047286166742243, "mean_action_processing_ms": 0.14424982536552794, "mean_env_wait_ms": 2.468848649008219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009446144104003906, "StateBufferConnector_ms": 0.0062732696533203125, "ViewRequirementAgentConnector_ms": 0.17282414436340332}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 70200, "num_env_steps_sampled": 37000, "num_env_steps_trained": 70200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.273486803241048, "num_env_steps_trained_throughput_per_sec": 10.283299266320043, "timesteps_total": 37000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 37000, "timers": {"training_iteration_time_ms": 7779.392, "sample_time_ms": 7718.902, "load_time_ms": 0.237, "load_throughput": 328832.759, "learn_time_ms": 12.52, "learn_throughput": 6229.971, "synch_weights_time_ms": 10.897}, "counters": {"num_env_steps_sampled": 37000, "num_env_steps_trained": 70200, "num_agent_steps_sampled": 37000, "num_agent_steps_trained": 70200, "last_target_update_ts": 36920, "num_target_updates": 70}, "done": false, "episodes_total": 1402, "training_iteration": 37, "trial_id": "2058a_00000", "date": "2024-04-17_07-38-44", "timestamp": 1713339524, "time_this_iter_s": 189.63799405097961, "time_total_s": 8297.827832460403, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 8297.827832460403, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 15.13259259259259, "ram_util_percent": 16.747407407407405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.05507620796561241, "cur_lr": 0.01}, "td_error": [1.5286402702331543, 1.5286399126052856, 1.8407278060913086, 1.5286401510238647, 1.5286394357681274, 1.528639316558838, 0.32294565439224243, 0.7570443749427795, 1.5286400318145752, 2.0813848972320557, 1.528639554977417, 1.5286396741867065, 1.8637571334838867, 0.7612409591674805, 0.3645443916320801, 2.431150197982788, 4.310102939605713, 1.5288370847702026, 1.5286401510238647, 1.836258888244629, 1.5286427736282349, 1.5286391973495483, 1.5286401510238647, 1.597283959388733, 1.5286403894424438, 1.0084679126739502, 1.008482813835144, 2.42647647857666, 1.528658151626587, 1.5286394357681274, 1.5286409854888916, 1.528639554977417, 1.5340713262557983, 1.5286400318145752, 1.5286391973495483, 1.5286394357681274, 1.8352034091949463, 1.5286407470703125, 1.528639554977417, 1.5286418199539185, 1.5286411046981812, 1.5286405086517334, 1.5972920656204224, 1.5286414623260498, 1.5286394357681274, 1.528639316558838, 1.5286391973495483, 1.5286399126052856, 2.4264540672302246, 1.528644323348999, 1.5286424160003662, 3.8237075805664062, 1.597139835357666, 1.5926918983459473, 4.700221538543701, 1.5972086191177368, 1.5286394357681274, 1.5286691188812256, 1.5286399126052856, 1.5286433696746826, 1.5286394357681274, 1.5286405086517334, 0.7306565642356873, 1.5286405086517334, 1.528639316558838, 1.0084705352783203, 1.597145438194275, 1.5980547666549683, 1.5286400318145752, 1.5286396741867065, 2.4265220165252686, 1.528639316558838, 1.5286402702331543, 1.5975067615509033, 1.528639793395996, 1.5286402702331543, 1.528639316558838, 1.529154896736145], "mean_td_error": 1.6304657459259033, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 925.0, "diff_num_grad_updates_vs_sampler_policy": 924.0}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 72150, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 72150, "last_target_update_ts": 37960, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": 1.1205893704535987, "episode_reward_min": -19.999636521967126, "episode_reward_mean": -1.9887114242975932, "episode_len_mean": 24.85, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.000397760436429449, 0.00037885192858883097, 0.0003914056469569525, 0.09238479031693993, 1.1205893704535987, 0.00039566352386048395, 0.00039286517892127943, 0.0003742255585856959, 0.00038666464042791594, 0.00038634449172874453, 0.0003683442248392492, -9.999601836416913, -9.999604683959612, 0.0003765513058496446, 0.000389048135742325, 0.00040217045765934454, -9.999616480797537, 0.00036566407205435703, 0.0003952784192192757, 0.0003924854975447717, 0.0003738666950050621, 0.0003824821335784216, 0.10710234489785543, 0.000377182558658429, 0.00037452875729859455, 0.00037216411064638975, 0.0003636566870970434, -9.648713185937968, 0.08458728390677873, -19.999628554443337, 0.00036833394826950804, 0.00038102200587132124, 0.00037831410104603003, 0.6144806924319598, 0.00037348565821394543, 0.07890885348173599, 0.04906962777579678, 0.0003761484953808725, 0.00037376341407248837, 0.00037134151564341796, -19.999629313470905, 0.00038343816096478913, 0.05634951879601794, -9.999621445508144, 0.00037607009031905225, 0.0003841173683388232, 0.0003660260959599955, 0.0003786511009473168, -19.999624003411295, -9.999626401209778, -9.999613530298353, 0.00036825074145745433, 0.0003809365293534402, 0.0003782298349167143, 0.6144806125618812, 0.0003862968449636145, 0.00038375440117290727, 0.0003656827784623582, 0.0003782983861025129, 0.00037562891696001815, 0.00036976282602883966, 0.0003668856321461014, 0.00033543067231567536, 0.00036196494188650227, 0.00035970480768099204, 0.00036904797011725964, -9.828339269319805, 0.0003349242970275755, 0.0003614224507457118, 0.0003591690649058119, 0.00037055047378317153, 0.0003387602077145904, 0.00036553165281511305, 0.0003632269005563988, 0.00036076843163724236, 0.00036843980060127655, 0.0003368426963771605, -19.999636521967126, -9.999638801184073, 0.10537100065272877, 0.00037309431072495746, 0.00034107105823186147, 0.00036800681342574407, 0.00036567084325463985, -9.999636816975276, 0.00037117405269281793, 0.0003682749436796534, 0.0003366929208229069, 0.00036331716536820274, 0.0003610401664195161, 0.3679513445027532, -9.999629495624305, 0.6287892077869822, 0.0003655097704992164, 0.0003632052933002177, -3.598274496028351, -9.953586171617268, 0.0003682518773851115, 0.00033667196460188077, 0.20684452198987507], "episode_lengths": [25, 24, 25, 25, 23, 25, 25, 24, 25, 24, 23, 26, 26, 24, 25, 25, 25, 23, 25, 25, 24, 25, 24, 25, 25, 25, 24, 26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 25, 27, 26, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 23, 25, 25, 25, 25, 23, 27, 26, 25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 26, 26, 25, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 414.37261016574774, "mean_inference_ms": 2.103460466478226, "mean_action_processing_ms": 0.1441663435499699, "mean_env_wait_ms": 2.40625770697289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010024070739746094, "StateBufferConnector_ms": 0.006299495697021484, "ViewRequirementAgentConnector_ms": 0.17148327827453613}}, "episode_reward_max": 1.1205893704535987, "episode_reward_min": -19.999636521967126, "episode_reward_mean": -1.9887114242975932, "episode_len_mean": 24.85, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.000397760436429449, 0.00037885192858883097, 0.0003914056469569525, 0.09238479031693993, 1.1205893704535987, 0.00039566352386048395, 0.00039286517892127943, 0.0003742255585856959, 0.00038666464042791594, 0.00038634449172874453, 0.0003683442248392492, -9.999601836416913, -9.999604683959612, 0.0003765513058496446, 0.000389048135742325, 0.00040217045765934454, -9.999616480797537, 0.00036566407205435703, 0.0003952784192192757, 0.0003924854975447717, 0.0003738666950050621, 0.0003824821335784216, 0.10710234489785543, 0.000377182558658429, 0.00037452875729859455, 0.00037216411064638975, 0.0003636566870970434, -9.648713185937968, 0.08458728390677873, -19.999628554443337, 0.00036833394826950804, 0.00038102200587132124, 0.00037831410104603003, 0.6144806924319598, 0.00037348565821394543, 0.07890885348173599, 0.04906962777579678, 0.0003761484953808725, 0.00037376341407248837, 0.00037134151564341796, -19.999629313470905, 0.00038343816096478913, 0.05634951879601794, -9.999621445508144, 0.00037607009031905225, 0.0003841173683388232, 0.0003660260959599955, 0.0003786511009473168, -19.999624003411295, -9.999626401209778, -9.999613530298353, 0.00036825074145745433, 0.0003809365293534402, 0.0003782298349167143, 0.6144806125618812, 0.0003862968449636145, 0.00038375440117290727, 0.0003656827784623582, 0.0003782983861025129, 0.00037562891696001815, 0.00036976282602883966, 0.0003668856321461014, 0.00033543067231567536, 0.00036196494188650227, 0.00035970480768099204, 0.00036904797011725964, -9.828339269319805, 0.0003349242970275755, 0.0003614224507457118, 0.0003591690649058119, 0.00037055047378317153, 0.0003387602077145904, 0.00036553165281511305, 0.0003632269005563988, 0.00036076843163724236, 0.00036843980060127655, 0.0003368426963771605, -19.999636521967126, -9.999638801184073, 0.10537100065272877, 0.00037309431072495746, 0.00034107105823186147, 0.00036800681342574407, 0.00036567084325463985, -9.999636816975276, 0.00037117405269281793, 0.0003682749436796534, 0.0003366929208229069, 0.00036331716536820274, 0.0003610401664195161, 0.3679513445027532, -9.999629495624305, 0.6287892077869822, 0.0003655097704992164, 0.0003632052933002177, -3.598274496028351, -9.953586171617268, 0.0003682518773851115, 0.00033667196460188077, 0.20684452198987507], "episode_lengths": [25, 24, 25, 25, 23, 25, 25, 24, 25, 24, 23, 26, 26, 24, 25, 25, 25, 23, 25, 25, 24, 25, 24, 25, 25, 25, 24, 26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 25, 27, 26, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 23, 25, 25, 25, 25, 23, 27, 26, 25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 26, 26, 25, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 414.37261016574774, "mean_inference_ms": 2.103460466478226, "mean_action_processing_ms": 0.1441663435499699, "mean_env_wait_ms": 2.40625770697289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010024070739746094, "StateBufferConnector_ms": 0.006299495697021484, "ViewRequirementAgentConnector_ms": 0.17148327827453613}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 72150, "num_env_steps_sampled": 38000, "num_env_steps_trained": 72150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.9707642709584094, "num_env_steps_trained_throughput_per_sec": 9.692990328368898, "timesteps_total": 38000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 6692.467, "sample_time_ms": 6631.882, "load_time_ms": 0.243, "load_throughput": 321244.808, "learn_time_ms": 13.112, "learn_throughput": 5948.772, "synch_weights_time_ms": 10.392}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 72150, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 72150, "last_target_update_ts": 37960, "num_target_updates": 72}, "done": false, "episodes_total": 1442, "training_iteration": 38, "trial_id": "2058a_00000", "date": "2024-04-17_07-42-05", "timestamp": 1713339725, "time_this_iter_s": 201.18515849113464, "time_total_s": 8499.012990951538, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 8499.012990951538, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 14.760839160839161, "ram_util_percent": 16.863636363636367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01664399541914463, "cur_lr": 0.01}, "td_error": [1.5432246923446655, 1.5432713031768799, 1.0428639650344849, 1.584033489227295, 1.6379951238632202, 0.7265950441360474, 4.204631805419922, 1.5432270765304565, 1.6111769676208496, 1.5432208776474, 2.347771406173706, 1.5432184934616089, 1.5432196855545044, 1.5525858402252197, 1.5432186126708984, 1.5432202816009521, 1.7228535413742065, 1.5432195663452148, 1.5432180166244507, 1.5433690547943115, 1.5432322025299072, 1.5432184934616089, 1.6151752471923828, 1.5432181358337402, 1.5432193279266357, 1.5432194471359253, 1.5432192087173462, 1.809104323387146, 1.5432177782058716, 1.5432184934616089, 1.5432244539260864, 0.7603372931480408, 1.5432281494140625, 1.5432206392288208, 1.5432195663452148, 1.0428640842437744, 2.3434181213378906, 1.5432181358337402, 1.543220043182373, 1.5432215929031372, 1.5433311462402344, 1.543222188949585, 1.5432178974151611, 1.5432193279266357, 1.543220043182373, 1.5432366132736206, 1.5432186126708984, 1.5432192087173462, 1.5432194471359253, 1.5432180166244507, 0.7388834357261658, 1.5432192087173462, 1.1670783758163452, 0.7265950441360474, 1.56768000125885, 1.5432227849960327, 1.5432238578796387, 1.5432193279266357, 1.0428637266159058, 1.5432214736938477, 1.0428613424301147, 2.3439688682556152, 1.7149174213409424, 1.5432223081588745, 1.5432181358337402, 1.5432182550430298, 1.5432196855545044, 0.33341184258461, 1.5432188510894775, 1.5238864421844482, 1.5432227849960327, 1.042864203453064, 1.5432184934616089, 1.5432205200195312, 1.5432184934616089, 1.6111109256744385, 1.5432212352752686, 1.5432205200195312], "mean_td_error": 1.526991367340088, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 950.0, "diff_num_grad_updates_vs_sampler_policy": 949.0}}, "num_env_steps_sampled": 39000, "num_env_steps_trained": 74100, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 74100, "last_target_update_ts": 39000, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": 2.987644174487529, "episode_reward_min": -19.99964192642023, "episode_reward_mean": -1.855565673659929, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00037134151564341796, -19.999629313470905, 0.00038343816096478913, 0.05634951879601794, -9.999621445508144, 0.00037607009031905225, 0.0003841173683388232, 0.0003660260959599955, 0.0003786511009473168, -19.999624003411295, -9.999626401209778, -9.999613530298353, 0.00036825074145745433, 0.0003809365293534402, 0.0003782298349167143, 0.6144806125618812, 0.0003862968449636145, 0.00038375440117290727, 0.0003656827784623582, 0.0003782983861025129, 0.00037562891696001815, 0.00036976282602883966, 0.0003668856321461014, 0.00033543067231567536, 0.00036196494188650227, 0.00035970480768099204, 0.00036904797011725964, -9.828339269319805, 0.0003349242970275755, 0.0003614224507457118, 0.0003591690649058119, 0.00037055047378317153, 0.0003387602077145904, 0.00036553165281511305, 0.0003632269005563988, 0.00036076843163724236, 0.00036843980060127655, 0.0003368426963771605, -19.999636521967126, -9.999638801184073, 0.10537100065272877, 0.00037309431072495746, 0.00034107105823186147, 0.00036800681342574407, 0.00036567084325463985, -9.999636816975276, 0.00037117405269281793, 0.0003682749436796534, 0.0003366929208229069, 0.00036331716536820274, 0.0003610401664195161, 0.3679513445027532, -9.999629495624305, 0.6287892077869822, 0.0003655097704992164, 0.0003632052933002177, -3.598274496028351, -9.953586171617268, 0.0003682518773851115, 0.00033667196460188077, 0.20684452198987507, 0.00035729363006351146, 0.0003544829138602846, 0.1375384554185201, 0.0003503625166924226, 0.00034853111559728046, -9.999643234754544, 0.000353962601992023, 0.09702477368323446, 0.5997950112644008, 0.0003480643996927786, 0.0003579030003652576, 0.00035572650805192757, 2.987644174487529, 0.00035174441084030494, 0.0003492348914106506, 0.00035603458223331405, 0.0003538806869910939, 0.00035178136812321557, 0.0003499351439424084, 0.0003474512805508599, 0.00036027559063461176, -19.99964192642023, 0.0003559210580371795, 0.0003540312459133596, 0.0003514891111529463, 0.05299954574943217, 0.00035591704593779743, 0.00035376456828764465, 0.00035166662300836695, 0.11841115878866068, -9.999639254506635, 1.4871599896674286, 0.00035571892605661685, -9.999646399484712, 0.33327412724346855, 0.000358716008412232, 0.00035588295834773235, 0.00035373089173741055, 0.00035163334474036447], "episode_lengths": [25, 26, 25, 25, 26, 25, 25, 24, 25, 27, 26, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 23, 25, 25, 25, 25, 23, 27, 26, 25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 26, 26, 25, 23, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 414.93546746279407, "mean_inference_ms": 2.1054063200003146, "mean_action_processing_ms": 0.14415539741239258, "mean_env_wait_ms": 2.346273982703016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010048866271972656, "StateBufferConnector_ms": 0.006136417388916016, "ViewRequirementAgentConnector_ms": 0.1676487922668457}}, "episode_reward_max": 2.987644174487529, "episode_reward_min": -19.99964192642023, "episode_reward_mean": -1.855565673659929, "episode_len_mean": 25.0, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00037134151564341796, -19.999629313470905, 0.00038343816096478913, 0.05634951879601794, -9.999621445508144, 0.00037607009031905225, 0.0003841173683388232, 0.0003660260959599955, 0.0003786511009473168, -19.999624003411295, -9.999626401209778, -9.999613530298353, 0.00036825074145745433, 0.0003809365293534402, 0.0003782298349167143, 0.6144806125618812, 0.0003862968449636145, 0.00038375440117290727, 0.0003656827784623582, 0.0003782983861025129, 0.00037562891696001815, 0.00036976282602883966, 0.0003668856321461014, 0.00033543067231567536, 0.00036196494188650227, 0.00035970480768099204, 0.00036904797011725964, -9.828339269319805, 0.0003349242970275755, 0.0003614224507457118, 0.0003591690649058119, 0.00037055047378317153, 0.0003387602077145904, 0.00036553165281511305, 0.0003632269005563988, 0.00036076843163724236, 0.00036843980060127655, 0.0003368426963771605, -19.999636521967126, -9.999638801184073, 0.10537100065272877, 0.00037309431072495746, 0.00034107105823186147, 0.00036800681342574407, 0.00036567084325463985, -9.999636816975276, 0.00037117405269281793, 0.0003682749436796534, 0.0003366929208229069, 0.00036331716536820274, 0.0003610401664195161, 0.3679513445027532, -9.999629495624305, 0.6287892077869822, 0.0003655097704992164, 0.0003632052933002177, -3.598274496028351, -9.953586171617268, 0.0003682518773851115, 0.00033667196460188077, 0.20684452198987507, 0.00035729363006351146, 0.0003544829138602846, 0.1375384554185201, 0.0003503625166924226, 0.00034853111559728046, -9.999643234754544, 0.000353962601992023, 0.09702477368323446, 0.5997950112644008, 0.0003480643996927786, 0.0003579030003652576, 0.00035572650805192757, 2.987644174487529, 0.00035174441084030494, 0.0003492348914106506, 0.00035603458223331405, 0.0003538806869910939, 0.00035178136812321557, 0.0003499351439424084, 0.0003474512805508599, 0.00036027559063461176, -19.99964192642023, 0.0003559210580371795, 0.0003540312459133596, 0.0003514891111529463, 0.05299954574943217, 0.00035591704593779743, 0.00035376456828764465, 0.00035166662300836695, 0.11841115878866068, -9.999639254506635, 1.4871599896674286, 0.00035571892605661685, -9.999646399484712, 0.33327412724346855, 0.000358716008412232, 0.00035588295834773235, 0.00035373089173741055, 0.00035163334474036447], "episode_lengths": [25, 26, 25, 25, 26, 25, 25, 24, 25, 27, 26, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 23, 25, 25, 25, 25, 23, 27, 26, 25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 26, 26, 25, 23, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 414.93546746279407, "mean_inference_ms": 2.1054063200003146, "mean_action_processing_ms": 0.14415539741239258, "mean_env_wait_ms": 2.346273982703016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010048866271972656, "StateBufferConnector_ms": 0.006136417388916016, "ViewRequirementAgentConnector_ms": 0.1676487922668457}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 74100, "num_env_steps_sampled": 39000, "num_env_steps_trained": 74100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.946937676471606, "num_env_steps_trained_throughput_per_sec": 11.596528469119631, "timesteps_total": 39000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 39000, "timers": {"training_iteration_time_ms": 6737.559, "sample_time_ms": 6676.843, "load_time_ms": 0.233, "load_throughput": 335200.525, "learn_time_ms": 12.789, "learn_throughput": 6098.963, "synch_weights_time_ms": 11.571}, "counters": {"num_env_steps_sampled": 39000, "num_env_steps_trained": 74100, "num_agent_steps_sampled": 39000, "num_agent_steps_trained": 74100, "last_target_update_ts": 39000, "num_target_updates": 74}, "done": false, "episodes_total": 1481, "training_iteration": 39, "trial_id": "2058a_00000", "date": "2024-04-17_07-44-53", "timestamp": 1713339893, "time_this_iter_s": 168.16171264648438, "time_total_s": 8667.174703598022, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 8667.174703598022, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 16.986666666666668, "ram_util_percent": 16.973333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04497722163796425, "cur_lr": 0.01}, "td_error": [1.5112990140914917, 3.902775287628174, 1.5113062858581543, 1.5113003253936768, 0.9962644577026367, 1.5113011598587036, 1.1750593185424805, 1.511299729347229, 1.635335087776184, 1.5335716009140015, 1.511298656463623, 1.511303424835205, 1.7152049541473389, 0.9962612986564636, 1.5113035440444946, 1.5112996101379395, 0.9962612390518188, 1.5113005638122559, 1.5112996101379395, 1.5113040208816528, 2.489129066467285, 1.511299967765808, 1.5112985372543335, 1.5113164186477661, 1.8921509981155396, 1.511299967765808, 1.5113525390625, 0.9962612390518188, 1.5113099813461304, 1.5113006830215454, 1.511300802230835, 1.5112987756729126, 1.667896032333374, 1.5113015174865723, 1.5112987756729126, 1.5112991333007812, 0.7437566518783569, 1.5112990140914917, 1.5113003253936768, 2.4855904579162598, 1.51253342628479, 2.485520362854004, 1.5122783184051514, 0.9962615966796875, 1.511300802230835, 1.7153419256210327, 2.4576470851898193, 1.5113005638122559, 1.511299967765808, 0.9144219160079956, 0.3678329288959503, 1.511299729347229, 1.5113043785095215, 1.511345624923706, 1.5113002061843872, 1.5113496780395508, 1.5112987756729126, 0.9962612390518188, 1.7156444787979126, 1.5495994091033936, 1.5112998485565186, 1.5112996101379395, 1.5113002061843872, 1.5113948583602905, 1.5113039016723633, 1.511303186416626, 1.5113015174865723, 1.5758912563323975, 2.4876139163970947, 1.5112991333007812, 1.5112991333007812, 1.5113009214401245, 1.511306881904602, 1.5112980604171753, 1.5112991333007812, 1.575954794883728, 1.5112996101379395, 1.5113111734390259], "mean_td_error": 1.5468413829803467, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 975.0, "diff_num_grad_updates_vs_sampler_policy": 974.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 76050, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 76050, "last_target_update_ts": 39520, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": 4.34640823751289, "episode_reward_min": -19.99964192642023, "episode_reward_mean": -1.2797027049094118, "episode_len_mean": 25.07, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.10537100065272877, 0.00037309431072495746, 0.00034107105823186147, 0.00036800681342574407, 0.00036567084325463985, -9.999636816975276, 0.00037117405269281793, 0.0003682749436796534, 0.0003366929208229069, 0.00036331716536820274, 0.0003610401664195161, 0.3679513445027532, -9.999629495624305, 0.6287892077869822, 0.0003655097704992164, 0.0003632052933002177, -3.598274496028351, -9.953586171617268, 0.0003682518773851115, 0.00033667196460188077, 0.20684452198987507, 0.00035729363006351146, 0.0003544829138602846, 0.1375384554185201, 0.0003503625166924226, 0.00034853111559728046, -9.999643234754544, 0.000353962601992023, 0.09702477368323446, 0.5997950112644008, 0.0003480643996927786, 0.0003579030003652576, 0.00035572650805192757, 2.987644174487529, 0.00035174441084030494, 0.0003492348914106506, 0.00035603458223331405, 0.0003538806869910939, 0.00035178136812321557, 0.0003499351439424084, 0.0003474512805508599, 0.00036027559063461176, -19.99964192642023, 0.0003559210580371795, 0.0003540312459133596, 0.0003514891111529463, 0.05299954574943217, 0.00035591704593779743, 0.00035376456828764465, 0.00035166662300836695, 0.11841115878866068, -9.999639254506635, 1.4871599896674286, 0.00035571892605661685, -9.999646399484712, 0.33327412724346855, 0.000358716008412232, 0.00035588295834773235, 0.00035373089173741055, 0.00035163334474036447, 0.04337711181636159, 0.0003442644051113516, 0.00034237774087703127, 0.0003403953376995661, 0.0003383175938409049, -9.76910697140076, -9.999656348591806, -9.99965822971607, 0.0003397958458951697, 0.26539119783036064, 0.0003471826947107681, -9.923266853856981, 0.0003433548815000665, 0.0003412409679840637, 0.00033865414161928864, 0.00034541993444144856, 0.00034352061824405376, 0.00034152499688843487, 0.0003394334836500266, 0.00033687387326431526, -8.65604927278885, 0.0003474755368055578, 0.0003454338370676987, 0.0003432943304606002, 0.0003406764127027165, 0.000347435534853301, 0.0003454043723412299, 0.9072700842142565, 0.00034152584210193806, 0.556966504144784, -9.999648267573962, 0.00034922316482480985, 0.00034717110555563657, 0.00034525253552762956, 4.34640823751289, 0.0003497886697721946, 0.00034730687770992956, 0.6607525352875291, 0.00034339911644762057, 0.000341404902419802], "episode_lengths": [25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 26, 26, 25, 23, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 415.4614101183431, "mean_inference_ms": 2.1038218348614457, "mean_action_processing_ms": 0.14406696836764854, "mean_env_wait_ms": 2.288700746597579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009449005126953125, "StateBufferConnector_ms": 0.006216764450073242, "ViewRequirementAgentConnector_ms": 0.16862058639526367}}, "episode_reward_max": 4.34640823751289, "episode_reward_min": -19.99964192642023, "episode_reward_mean": -1.2797027049094118, "episode_len_mean": 25.07, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.10537100065272877, 0.00037309431072495746, 0.00034107105823186147, 0.00036800681342574407, 0.00036567084325463985, -9.999636816975276, 0.00037117405269281793, 0.0003682749436796534, 0.0003366929208229069, 0.00036331716536820274, 0.0003610401664195161, 0.3679513445027532, -9.999629495624305, 0.6287892077869822, 0.0003655097704992164, 0.0003632052933002177, -3.598274496028351, -9.953586171617268, 0.0003682518773851115, 0.00033667196460188077, 0.20684452198987507, 0.00035729363006351146, 0.0003544829138602846, 0.1375384554185201, 0.0003503625166924226, 0.00034853111559728046, -9.999643234754544, 0.000353962601992023, 0.09702477368323446, 0.5997950112644008, 0.0003480643996927786, 0.0003579030003652576, 0.00035572650805192757, 2.987644174487529, 0.00035174441084030494, 0.0003492348914106506, 0.00035603458223331405, 0.0003538806869910939, 0.00035178136812321557, 0.0003499351439424084, 0.0003474512805508599, 0.00036027559063461176, -19.99964192642023, 0.0003559210580371795, 0.0003540312459133596, 0.0003514891111529463, 0.05299954574943217, 0.00035591704593779743, 0.00035376456828764465, 0.00035166662300836695, 0.11841115878866068, -9.999639254506635, 1.4871599896674286, 0.00035571892605661685, -9.999646399484712, 0.33327412724346855, 0.000358716008412232, 0.00035588295834773235, 0.00035373089173741055, 0.00035163334474036447, 0.04337711181636159, 0.0003442644051113516, 0.00034237774087703127, 0.0003403953376995661, 0.0003383175938409049, -9.76910697140076, -9.999656348591806, -9.99965822971607, 0.0003397958458951697, 0.26539119783036064, 0.0003471826947107681, -9.923266853856981, 0.0003433548815000665, 0.0003412409679840637, 0.00033865414161928864, 0.00034541993444144856, 0.00034352061824405376, 0.00034152499688843487, 0.0003394334836500266, 0.00033687387326431526, -8.65604927278885, 0.0003474755368055578, 0.0003454338370676987, 0.0003432943304606002, 0.0003406764127027165, 0.000347435534853301, 0.0003454043723412299, 0.9072700842142565, 0.00034152584210193806, 0.556966504144784, -9.999648267573962, 0.00034922316482480985, 0.00034717110555563657, 0.00034525253552762956, 4.34640823751289, 0.0003497886697721946, 0.00034730687770992956, 0.6607525352875291, 0.00034339911644762057, 0.000341404902419802], "episode_lengths": [25, 25, 23, 25, 25, 26, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 26, 26, 25, 23, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 415.4614101183431, "mean_inference_ms": 2.1038218348614457, "mean_action_processing_ms": 0.14406696836764854, "mean_env_wait_ms": 2.288700746597579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009449005126953125, "StateBufferConnector_ms": 0.006216764450073242, "ViewRequirementAgentConnector_ms": 0.16862058639526367}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 76050, "num_env_steps_sampled": 40000, "num_env_steps_trained": 76050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.956483447253899, "num_env_steps_trained_throughput_per_sec": 11.615142722145105, "timesteps_total": 40000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 6723.191, "sample_time_ms": 6661.737, "load_time_ms": 0.247, "load_throughput": 315848.341, "learn_time_ms": 12.982, "learn_throughput": 6008.237, "synch_weights_time_ms": 12.075}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 76050, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 76050, "last_target_update_ts": 39520, "num_target_updates": 75}, "done": false, "episodes_total": 1521, "training_iteration": 40, "trial_id": "2058a_00000", "date": "2024-04-17_07-47-41", "timestamp": 1713340061, "time_this_iter_s": 167.89122343063354, "time_total_s": 8835.065927028656, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 8835.065927028656, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.405020920502093, "ram_util_percent": 17.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04329416900873184, "cur_lr": 0.01}, "td_error": [1.5091527700424194, 1.5091408491134644, 1.5691792964935303, 1.509145736694336, 1.5091431140899658, 1.509139060974121, 1.5091389417648315, 1.5091415643692017, 1.5091415643692017, 1.509141445159912, 1.5094780921936035, 1.509140133857727, 1.509139895439148, 0.9833202362060547, 1.5091437101364136, 1.509140968322754, 1.5091426372528076, 1.509141206741333, 2.516566038131714, 1.5091462135314941, 1.5091660022735596, 1.5091438293457031, 1.5091392993927002, 0.7102376222610474, 1.5091406106948853, 1.5091392993927002, 0.9833201169967651, 1.5091410875320435, 1.509143590927124, 1.569261074066162, 1.5697214603424072, 0.9835262894630432, 1.5091512203216553, 1.5091392993927002, 1.5091389417648315, 1.5091431140899658, 1.5091429948806763, 1.509140968322754, 1.5692403316497803, 1.5091575384140015, 1.5091429948806763, 1.5091402530670166, 1.5111618041992188, 1.509522557258606, 1.5091408491134644, 0.9833781123161316, 1.5691345930099487, 0.9833203554153442, 1.571307897567749, 1.509140968322754, 1.5091402530670166, 1.5091421604156494, 1.509142279624939, 1.5091407299041748, 1.509140133857727, 1.8068238496780396, 1.5091416835784912, 0.9844087362289429, 1.5692836046218872, 0.9833208322525024, 3.8731069564819336, 1.6772550344467163, 1.5091396570205688, 1.5091408491134644, 1.6769336462020874, 1.6771607398986816, 1.5091404914855957, 1.5091439485549927, 0.3713352084159851, 1.6766585111618042, 1.6239084005355835, 1.5091419219970703, 0.9833235144615173, 1.5091397762298584, 1.5091437101364136, 1.5091474056243896, 1.5091392993927002, 1.5091453790664673], "mean_td_error": 1.4929786920547485, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 999.0}}, "num_env_steps_sampled": 41000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 78000, "last_target_update_ts": 40560, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": 4.34640823751289, "episode_reward_min": -19.99964192642023, "episode_reward_mean": -1.5490060795431377, "episode_len_mean": 25.09, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0003474512805508599, 0.00036027559063461176, -19.99964192642023, 0.0003559210580371795, 0.0003540312459133596, 0.0003514891111529463, 0.05299954574943217, 0.00035591704593779743, 0.00035376456828764465, 0.00035166662300836695, 0.11841115878866068, -9.999639254506635, 1.4871599896674286, 0.00035571892605661685, -9.999646399484712, 0.33327412724346855, 0.000358716008412232, 0.00035588295834773235, 0.00035373089173741055, 0.00035163334474036447, 0.04337711181636159, 0.0003442644051113516, 0.00034237774087703127, 0.0003403953376995661, 0.0003383175938409049, -9.76910697140076, -9.999656348591806, -9.99965822971607, 0.0003397958458951697, 0.26539119783036064, 0.0003471826947107681, -9.923266853856981, 0.0003433548815000665, 0.0003412409679840637, 0.00033865414161928864, 0.00034541993444144856, 0.00034352061824405376, 0.00034152499688843487, 0.0003394334836500266, 0.00033687387326431526, -8.65604927278885, 0.0003474755368055578, 0.0003454338370676987, 0.0003432943304606002, 0.0003406764127027165, 0.000347435534853301, 0.0003454043723412299, 0.9072700842142565, 0.00034152584210193806, 0.556966504144784, -9.999648267573962, 0.00034922316482480985, 0.00034717110555563657, 0.00034525253552762956, 4.34640823751289, 0.0003497886697721946, 0.00034730687770992956, 0.6607525352875291, 0.00034339911644762057, 0.000341404902419802, 0.0003357747145813005, 0.00033283877534515246, 0.00033075292074508783, 0.0003154313828188326, -9.999673884100023, 0.00033522936716421763, 0.0003323029189875341, 0.0003302237548693381, -9.999685069779098, 0.0003256012858856467, 0.06103987334075451, 0.09265416546962027, 0.00031836499921655684, 0.0003291258109112225, 0.0003274878547934234, 0.48214393082352247, -9.999668157659785, 0.00031646541324178507, 0.0003271767603787072, 2.609078412075, 0.0003376544816731435, -9.255547410635977, 0.0003199949118477203, 0.00033079802590053154, 0.0003291434194440802, 0.0003368894987135822, 0.000333934110690454, 0.00033183454695203155, 0.0003164560899268536, 0.00032716719385474634, 0.2556796451288019, -9.9996614029539, 0.0003356115627109458, -9.999666508905143, 0.050315558064226724, 0.0003393148551554736, 0.17070192178345608, -9.999666121839555, 0.18321474840671478, 0.00031645648950973706], "episode_lengths": [25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 26, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 415.96034376348194, "mean_inference_ms": 2.1028386700304726, "mean_action_processing_ms": 0.14400399328232694, "mean_env_wait_ms": 2.2340484589936307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009379863739013672, "StateBufferConnector_ms": 0.0062448978424072266, "ViewRequirementAgentConnector_ms": 0.1703205108642578}}, "episode_reward_max": 4.34640823751289, "episode_reward_min": -19.99964192642023, "episode_reward_mean": -1.5490060795431377, "episode_len_mean": 25.09, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0003474512805508599, 0.00036027559063461176, -19.99964192642023, 0.0003559210580371795, 0.0003540312459133596, 0.0003514891111529463, 0.05299954574943217, 0.00035591704593779743, 0.00035376456828764465, 0.00035166662300836695, 0.11841115878866068, -9.999639254506635, 1.4871599896674286, 0.00035571892605661685, -9.999646399484712, 0.33327412724346855, 0.000358716008412232, 0.00035588295834773235, 0.00035373089173741055, 0.00035163334474036447, 0.04337711181636159, 0.0003442644051113516, 0.00034237774087703127, 0.0003403953376995661, 0.0003383175938409049, -9.76910697140076, -9.999656348591806, -9.99965822971607, 0.0003397958458951697, 0.26539119783036064, 0.0003471826947107681, -9.923266853856981, 0.0003433548815000665, 0.0003412409679840637, 0.00033865414161928864, 0.00034541993444144856, 0.00034352061824405376, 0.00034152499688843487, 0.0003394334836500266, 0.00033687387326431526, -8.65604927278885, 0.0003474755368055578, 0.0003454338370676987, 0.0003432943304606002, 0.0003406764127027165, 0.000347435534853301, 0.0003454043723412299, 0.9072700842142565, 0.00034152584210193806, 0.556966504144784, -9.999648267573962, 0.00034922316482480985, 0.00034717110555563657, 0.00034525253552762956, 4.34640823751289, 0.0003497886697721946, 0.00034730687770992956, 0.6607525352875291, 0.00034339911644762057, 0.000341404902419802, 0.0003357747145813005, 0.00033283877534515246, 0.00033075292074508783, 0.0003154313828188326, -9.999673884100023, 0.00033522936716421763, 0.0003323029189875341, 0.0003302237548693381, -9.999685069779098, 0.0003256012858856467, 0.06103987334075451, 0.09265416546962027, 0.00031836499921655684, 0.0003291258109112225, 0.0003274878547934234, 0.48214393082352247, -9.999668157659785, 0.00031646541324178507, 0.0003271767603787072, 2.609078412075, 0.0003376544816731435, -9.255547410635977, 0.0003199949118477203, 0.00033079802590053154, 0.0003291434194440802, 0.0003368894987135822, 0.000333934110690454, 0.00033183454695203155, 0.0003164560899268536, 0.00032716719385474634, 0.2556796451288019, -9.9996614029539, 0.0003356115627109458, -9.999666508905143, 0.050315558064226724, 0.0003393148551554736, 0.17070192178345608, -9.999666121839555, 0.18321474840671478, 0.00031645648950973706], "episode_lengths": [25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 26, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 415.96034376348194, "mean_inference_ms": 2.1028386700304726, "mean_action_processing_ms": 0.14400399328232694, "mean_env_wait_ms": 2.2340484589936307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009379863739013672, "StateBufferConnector_ms": 0.0062448978424072266, "ViewRequirementAgentConnector_ms": 0.1703205108642578}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 78000, "num_env_steps_sampled": 41000, "num_env_steps_trained": 78000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.927353755754045, "num_env_steps_trained_throughput_per_sec": 11.558339823720388, "timesteps_total": 41000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 41000, "timers": {"training_iteration_time_ms": 6688.821, "sample_time_ms": 6627.286, "load_time_ms": 0.253, "load_throughput": 308230.367, "learn_time_ms": 12.656, "learn_throughput": 6163.191, "synch_weights_time_ms": 11.689}, "counters": {"num_env_steps_sampled": 41000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 41000, "num_agent_steps_trained": 78000, "last_target_update_ts": 40560, "num_target_updates": 77}, "done": false, "episodes_total": 1561, "training_iteration": 41, "trial_id": "2058a_00000", "date": "2024-04-17_07-50-30", "timestamp": 1713340230, "time_this_iter_s": 168.719496011734, "time_total_s": 9003.78542304039, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 9003.78542304039, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.41166666666667, "ram_util_percent": 17.220416666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03794289752840996, "cur_lr": 0.01}, "td_error": [1.17603600025177, 1.5018041133880615, 1.5648152828216553, 1.501806378364563, 1.5018041133880615, 1.501807689666748, 1.5586061477661133, 1.501820683479309, 1.5018082857131958, 1.501804232597351, 1.5777385234832764, 1.176042079925537, 1.5027929544448853, 0.9694521427154541, 1.501803994178772, 1.5018035173416138, 1.501805305480957, 1.5018086433410645, 1.5018054246902466, 1.5018043518066406, 4.0623955726623535, 1.1692183017730713, 1.5018121004104614, 1.5018035173416138, 1.5018068552017212, 1.501807451248169, 1.501804232597351, 2.5662968158721924, 1.501806378364563, 0.9694521427154541, 1.5777662992477417, 1.501805067062378, 1.5018121004104614, 1.5018059015274048, 1.5018043518066406, 1.5853426456451416, 1.5018054246902466, 1.5018056631088257, 1.5018055438995361, 1.5018044710159302, 1.5018055438995361, 1.5018548965454102, 1.5018059015274048, 1.3527182340621948, 1.5018140077590942, 1.5018072128295898, 1.5018668174743652, 1.5776814222335815, 1.5018038749694824, 0.7311246395111084, 1.501804232597351, 1.5018035173416138, 0.7290934324264526, 1.578034520149231, 1.5018061399459839, 1.501955270767212, 1.5018041133880615, 1.501805305480957, 1.5776454210281372, 1.577797532081604, 1.5018035173416138, 2.5883595943450928, 1.501808524131775, 0.7057257294654846, 1.501805305480957, 1.5022906064987183, 1.5018044710159302, 0.9694522023200989, 1.5018049478530884, 0.9694520235061646, 1.5018078088760376, 1.5018048286437988, 1.5018062591552734, 1.577673316001892, 0.7290934324264526, 1.5018041133880615, 1.688113808631897, 1.5018059015274048], "mean_td_error": 1.492317795753479, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1025.0, "diff_num_grad_updates_vs_sampler_policy": 1024.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 79950, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 79950, "last_target_update_ts": 41600, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": 4.34640823751289, "episode_reward_min": -9.999685069779098, "episode_reward_mean": -1.224537607179646, "episode_len_mean": 24.9, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.65604927278885, 0.0003474755368055578, 0.0003454338370676987, 0.0003432943304606002, 0.0003406764127027165, 0.000347435534853301, 0.0003454043723412299, 0.9072700842142565, 0.00034152584210193806, 0.556966504144784, -9.999648267573962, 0.00034922316482480985, 0.00034717110555563657, 0.00034525253552762956, 4.34640823751289, 0.0003497886697721946, 0.00034730687770992956, 0.6607525352875291, 0.00034339911644762057, 0.000341404902419802, 0.0003357747145813005, 0.00033283877534515246, 0.00033075292074508783, 0.0003154313828188326, -9.999673884100023, 0.00033522936716421763, 0.0003323029189875341, 0.0003302237548693381, -9.999685069779098, 0.0003256012858856467, 0.06103987334075451, 0.09265416546962027, 0.00031836499921655684, 0.0003291258109112225, 0.0003274878547934234, 0.48214393082352247, -9.999668157659785, 0.00031646541324178507, 0.0003271767603787072, 2.609078412075, 0.0003376544816731435, -9.255547410635977, 0.0003199949118477203, 0.00033079802590053154, 0.0003291434194440802, 0.0003368894987135822, 0.000333934110690454, 0.00033183454695203155, 0.0003164560899268536, 0.00032716719385474634, 0.2556796451288019, -9.9996614029539, 0.0003356115627109458, -9.999666508905143, 0.050315558064226724, 0.0003393148551554736, 0.17070192178345608, -9.999666121839555, 0.18321474840671478, 0.00031645648950973706, 0.0003245075344650556, 0.00032265897356372603, 0.0002943667211676104, 0.0003177924855114029, 0.0003152197258534968, 0.00032399814907425374, -9.999677844465294, 0.0002939111055999993, 0.0003173039465459817, 0.11837745602841249, 2.3977834858628415, 0.0002971455918356669, 0.00032077193872943974, 0.0003181509149769014, 0.00031629738182047806, -9.999676124976105, 0.00029546669116843974, -9.999681027939529, 0.0003163800867350705, 0.0003145470760068311, 0.00032724183488621846, 0.2067812526574676, 2.0371080302724103, 0.00031965149015376003, 0.0003177804776275434, 0.06506636868427385, 0.0003238424272242276, 0.0002954373554058725, 0.0003189404447943462, 0.0003163491420409374, 0.00032898489151916344, 0.0003273483347133922, 0.00032546737010307174, 0.0002969072845964534, 0.1774206513597513, 0.00032716760386127994, -9.999674450790952, -9.999676307834376, 0.0002952982241670227, 0.05327251457317173], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 26, 25, 24, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 26, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 26, 26, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 416.5457944444621, "mean_inference_ms": 2.1018946752822427, "mean_action_processing_ms": 0.1439931353299929, "mean_env_wait_ms": 2.1829213177199396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009294509887695312, "StateBufferConnector_ms": 0.006262540817260742, "ViewRequirementAgentConnector_ms": 0.1741478443145752}}, "episode_reward_max": 4.34640823751289, "episode_reward_min": -9.999685069779098, "episode_reward_mean": -1.224537607179646, "episode_len_mean": 24.9, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.65604927278885, 0.0003474755368055578, 0.0003454338370676987, 0.0003432943304606002, 0.0003406764127027165, 0.000347435534853301, 0.0003454043723412299, 0.9072700842142565, 0.00034152584210193806, 0.556966504144784, -9.999648267573962, 0.00034922316482480985, 0.00034717110555563657, 0.00034525253552762956, 4.34640823751289, 0.0003497886697721946, 0.00034730687770992956, 0.6607525352875291, 0.00034339911644762057, 0.000341404902419802, 0.0003357747145813005, 0.00033283877534515246, 0.00033075292074508783, 0.0003154313828188326, -9.999673884100023, 0.00033522936716421763, 0.0003323029189875341, 0.0003302237548693381, -9.999685069779098, 0.0003256012858856467, 0.06103987334075451, 0.09265416546962027, 0.00031836499921655684, 0.0003291258109112225, 0.0003274878547934234, 0.48214393082352247, -9.999668157659785, 0.00031646541324178507, 0.0003271767603787072, 2.609078412075, 0.0003376544816731435, -9.255547410635977, 0.0003199949118477203, 0.00033079802590053154, 0.0003291434194440802, 0.0003368894987135822, 0.000333934110690454, 0.00033183454695203155, 0.0003164560899268536, 0.00032716719385474634, 0.2556796451288019, -9.9996614029539, 0.0003356115627109458, -9.999666508905143, 0.050315558064226724, 0.0003393148551554736, 0.17070192178345608, -9.999666121839555, 0.18321474840671478, 0.00031645648950973706, 0.0003245075344650556, 0.00032265897356372603, 0.0002943667211676104, 0.0003177924855114029, 0.0003152197258534968, 0.00032399814907425374, -9.999677844465294, 0.0002939111055999993, 0.0003173039465459817, 0.11837745602841249, 2.3977834858628415, 0.0002971455918356669, 0.00032077193872943974, 0.0003181509149769014, 0.00031629738182047806, -9.999676124976105, 0.00029546669116843974, -9.999681027939529, 0.0003163800867350705, 0.0003145470760068311, 0.00032724183488621846, 0.2067812526574676, 2.0371080302724103, 0.00031965149015376003, 0.0003177804776275434, 0.06506636868427385, 0.0003238424272242276, 0.0002954373554058725, 0.0003189404447943462, 0.0003163491420409374, 0.00032898489151916344, 0.0003273483347133922, 0.00032546737010307174, 0.0002969072845964534, 0.1774206513597513, 0.00032716760386127994, -9.999674450790952, -9.999676307834376, 0.0002952982241670227, 0.05327251457317173], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 26, 25, 24, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 26, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 26, 26, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 416.5457944444621, "mean_inference_ms": 2.1018946752822427, "mean_action_processing_ms": 0.1439931353299929, "mean_env_wait_ms": 2.1829213177199396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009294509887695312, "StateBufferConnector_ms": 0.006262540817260742, "ViewRequirementAgentConnector_ms": 0.1741478443145752}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 79950, "num_env_steps_sampled": 42000, "num_env_steps_trained": 79950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.948528854082301, "num_env_steps_trained_throughput_per_sec": 9.649631265460489, "timesteps_total": 42000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 8932.619, "sample_time_ms": 8869.606, "load_time_ms": 0.257, "load_throughput": 303963.311, "learn_time_ms": 12.909, "learn_throughput": 6042.125, "synch_weights_time_ms": 11.901}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 79950, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 79950, "last_target_update_ts": 41600, "num_target_updates": 79}, "done": false, "episodes_total": 1601, "training_iteration": 42, "trial_id": "2058a_00000", "date": "2024-04-17_07-53-52", "timestamp": 1713340432, "time_this_iter_s": 202.08876276016235, "time_total_s": 9205.874185800552, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 9205.874185800552, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 14.72891986062718, "ram_util_percent": 17.344250871080142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.05501915514469147, "cur_lr": 0.01}, "td_error": [1.6505801677703857, 1.4494141340255737, 1.4494149684906006, 1.4494144916534424, 1.4494163990020752, 1.449436068534851, 0.9638710021972656, 1.5173323154449463, 2.5744757652282715, 1.449417233467102, 1.4494143724441528, 1.449414610862732, 1.4495841264724731, 2.214430332183838, 1.5178738832473755, 1.4494149684906006, 1.449417233467102, 1.449414610862732, 1.449416995048523, 2.580414295196533, 1.4494153261184692, 1.4494160413742065, 1.4494142532348633, 0.371849000453949, 1.4494144916534424, 1.2937644720077515, 1.5179615020751953, 1.4494141340255737, 1.4494150876998901, 1.6506649255752563, 2.577479124069214, 1.4494154453277588, 1.449422836303711, 1.1352465152740479, 1.4494141340255737, 1.4494178295135498, 1.4494141340255737, 0.963873028755188, 1.4494147300720215, 0.963873028755188, 0.7387290596961975, 2.5774571895599365, 1.4494187831878662, 1.4494152069091797, 1.4494147300720215, 1.449416995048523, 2.5776867866516113, 1.449416995048523, 1.4494357109069824, 1.4494142532348633, 1.4494149684906006, 1.4494166374206543, 1.4494154453277588, 1.4494154453277588, 1.4494143724441528, 1.4494160413742065, 2.574472427368164, 1.1512393951416016, 1.4494152069091797, 1.4494280815124512, 1.449415683746338, 1.4494174718856812, 1.1355386972427368, 1.4494181871414185, 1.449414610862732, 1.4494140148162842, 1.6509779691696167, 1.4494150876998901, 1.4494165182113647, 0.7389199733734131, 1.5181103944778442, 1.4494141340255737, 1.4494202136993408, 1.449414610862732, 1.4494212865829468, 1.5173370838165283, 1.4494178295135498, 1.4494153261184692], "mean_td_error": 1.4935053586959839, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1050.0, "diff_num_grad_updates_vs_sampler_policy": 1049.0}}, "num_env_steps_sampled": 43000, "num_env_steps_trained": 81900, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 81900, "last_target_update_ts": 42640, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": 4.48125577282963, "episode_reward_min": -19.999688715685316, "episode_reward_mean": -1.6293724574219075, "episode_len_mean": 24.95, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0003376544816731435, -9.255547410635977, 0.0003199949118477203, 0.00033079802590053154, 0.0003291434194440802, 0.0003368894987135822, 0.000333934110690454, 0.00033183454695203155, 0.0003164560899268536, 0.00032716719385474634, 0.2556796451288019, -9.9996614029539, 0.0003356115627109458, -9.999666508905143, 0.050315558064226724, 0.0003393148551554736, 0.17070192178345608, -9.999666121839555, 0.18321474840671478, 0.00031645648950973706, 0.0003245075344650556, 0.00032265897356372603, 0.0002943667211676104, 0.0003177924855114029, 0.0003152197258534968, 0.00032399814907425374, -9.999677844465294, 0.0002939111055999993, 0.0003173039465459817, 0.11837745602841249, 2.3977834858628415, 0.0002971455918356669, 0.00032077193872943974, 0.0003181509149769014, 0.00031629738182047806, -9.999676124976105, 0.00029546669116843974, -9.999681027939529, 0.0003163800867350705, 0.0003145470760068311, 0.00032724183488621846, 0.2067812526574676, 2.0371080302724103, 0.00031965149015376003, 0.0003177804776275434, 0.06506636868427385, 0.0003238424272242276, 0.0002954373554058725, 0.0003189404447943462, 0.0003163491420409374, 0.00032898489151916344, 0.0003273483347133922, 0.00032546737010307174, 0.0002969072845964534, 0.1774206513597513, 0.00032716760386127994, -9.999674450790952, -9.999676307834376, 0.0002952982241670227, 0.05327251457317173, 0.00031340010110946, 0.45337868442543006, -9.999689789682751, 0.8095659566866166, 0.0003067544799390851, -9.99968700288292, 4.48125577282963, -9.999690196098463, 0.000308064066615458, 0.000306343460627737, 0.0003144174328773391, 0.00031302837630556996, 0.00031125240102004517, -9.999690502820384, 0.0002953393409528353, 0.0003126878127460731, -9.99968868504655, 4.3463759203731405, 0.00030782325957077946, 0.0671614999560405, 0.00031588291196435643, 0.0003144809033893422, 0.0003126884577280257, 0.0003109159627847499, 0.378583780872971, 0.00031451648892566204, 0.00031265758614178966, -19.999688715685316, 0.0003095277085997093, 0.0003077907623968573, 0.0003179484064675917, 0.04059986491399668, 0.0003144504353747061, 0.00031306108778345423, -9.999688715102266, 0.00031643004274652234, 0.00031459645462742045, -9.999687263233584, 0.00031136233431380876, 0.0003096051574281178], "episode_lengths": [25, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 26, 25, 24, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 26, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 26, 26, 23, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 417.1405749657929, "mean_inference_ms": 2.102676495734013, "mean_action_processing_ms": 0.144036031046405, "mean_env_wait_ms": 2.134023527843015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009691476821899414, "StateBufferConnector_ms": 0.0064699649810791016, "ViewRequirementAgentConnector_ms": 0.18191123008728027}}, "episode_reward_max": 4.48125577282963, "episode_reward_min": -19.999688715685316, "episode_reward_mean": -1.6293724574219075, "episode_len_mean": 24.95, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0003376544816731435, -9.255547410635977, 0.0003199949118477203, 0.00033079802590053154, 0.0003291434194440802, 0.0003368894987135822, 0.000333934110690454, 0.00033183454695203155, 0.0003164560899268536, 0.00032716719385474634, 0.2556796451288019, -9.9996614029539, 0.0003356115627109458, -9.999666508905143, 0.050315558064226724, 0.0003393148551554736, 0.17070192178345608, -9.999666121839555, 0.18321474840671478, 0.00031645648950973706, 0.0003245075344650556, 0.00032265897356372603, 0.0002943667211676104, 0.0003177924855114029, 0.0003152197258534968, 0.00032399814907425374, -9.999677844465294, 0.0002939111055999993, 0.0003173039465459817, 0.11837745602841249, 2.3977834858628415, 0.0002971455918356669, 0.00032077193872943974, 0.0003181509149769014, 0.00031629738182047806, -9.999676124976105, 0.00029546669116843974, -9.999681027939529, 0.0003163800867350705, 0.0003145470760068311, 0.00032724183488621846, 0.2067812526574676, 2.0371080302724103, 0.00031965149015376003, 0.0003177804776275434, 0.06506636868427385, 0.0003238424272242276, 0.0002954373554058725, 0.0003189404447943462, 0.0003163491420409374, 0.00032898489151916344, 0.0003273483347133922, 0.00032546737010307174, 0.0002969072845964534, 0.1774206513597513, 0.00032716760386127994, -9.999674450790952, -9.999676307834376, 0.0002952982241670227, 0.05327251457317173, 0.00031340010110946, 0.45337868442543006, -9.999689789682751, 0.8095659566866166, 0.0003067544799390851, -9.99968700288292, 4.48125577282963, -9.999690196098463, 0.000308064066615458, 0.000306343460627737, 0.0003144174328773391, 0.00031302837630556996, 0.00031125240102004517, -9.999690502820384, 0.0002953393409528353, 0.0003126878127460731, -9.99968868504655, 4.3463759203731405, 0.00030782325957077946, 0.0671614999560405, 0.00031588291196435643, 0.0003144809033893422, 0.0003126884577280257, 0.0003109159627847499, 0.378583780872971, 0.00031451648892566204, 0.00031265758614178966, -19.999688715685316, 0.0003095277085997093, 0.0003077907623968573, 0.0003179484064675917, 0.04059986491399668, 0.0003144504353747061, 0.00031306108778345423, -9.999688715102266, 0.00031643004274652234, 0.00031459645462742045, -9.999687263233584, 0.00031136233431380876, 0.0003096051574281178], "episode_lengths": [25, 26, 24, 25, 25, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 26, 25, 24, 25, 25, 23, 25, 25, 25, 26, 23, 25, 25, 25, 23, 25, 25, 25, 26, 23, 26, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 26, 26, 23, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 417.1405749657929, "mean_inference_ms": 2.102676495734013, "mean_action_processing_ms": 0.144036031046405, "mean_env_wait_ms": 2.134023527843015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009691476821899414, "StateBufferConnector_ms": 0.0064699649810791016, "ViewRequirementAgentConnector_ms": 0.18191123008728027}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 81900, "num_env_steps_sampled": 43000, "num_env_steps_trained": 81900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.472303995055991, "num_env_steps_trained_throughput_per_sec": 8.720992790359182, "timesteps_total": 43000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 43000, "timers": {"training_iteration_time_ms": 8919.362, "sample_time_ms": 8857.7, "load_time_ms": 0.23, "load_throughput": 338916.101, "learn_time_ms": 12.614, "learn_throughput": 6183.728, "synch_weights_time_ms": 11.397}, "counters": {"num_env_steps_sampled": 43000, "num_env_steps_trained": 81900, "num_agent_steps_sampled": 43000, "num_agent_steps_trained": 81900, "last_target_update_ts": 42640, "num_target_updates": 81}, "done": false, "episodes_total": 1641, "training_iteration": 43, "trial_id": "2058a_00000", "date": "2024-04-17_07-57-36", "timestamp": 1713340656, "time_this_iter_s": 223.6077573299408, "time_total_s": 9429.481943130493, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 9429.481943130493, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 13.316614420062695, "ram_util_percent": 17.462068965517243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.046658895909786224, "cur_lr": 0.01}, "td_error": [0.717484176158905, 1.4941562414169312, 1.4941552877426147, 1.5527597665786743, 1.4941529035568237, 1.4941532611846924, 1.4941531419754028, 0.9885367155075073, 1.4941567182540894, 1.4941527843475342, 1.4941518306732178, 1.4941554069519043, 1.4941531419754028, 1.4941551685333252, 1.4941540956497192, 1.4941538572311401, 0.717829704284668, 1.2679383754730225, 1.4941524267196655, 1.2679383754730225, 0.9885362386703491, 1.4941540956497192, 1.4941530227661133, 1.4941538572311401, 1.9797362089157104, 1.4941540956497192, 1.4941532611846924, 1.4941532611846924, 1.4941530227661133, 0.7478373050689697, 1.494152307510376, 1.4941537380218506, 1.4941511154174805, 1.49415123462677, 1.4941526651382446, 1.494153380393982, 1.4941556453704834, 1.4941538572311401, 1.4941563606262207, 1.4941668510437012, 1.4941537380218506, 1.4941556453704834, 1.49415123462677, 1.6847243309020996, 1.4941596984863281, 1.4941539764404297, 1.4941515922546387, 0.7190307378768921, 1.494158387184143, 1.931884527206421, 0.9885361194610596, 1.4941513538360596, 1.4941604137420654, 1.494158148765564, 1.4941534996032715, 1.4941545724868774, 1.4941511154174805, 1.4941515922546387, 1.494150996208191, 1.4941519498825073, 1.9359650611877441, 1.494153618812561, 1.4941538572311401, 4.450586318969727, 2.082488536834717, 1.552861213684082, 1.4941514730453491, 1.4944413900375366, 1.4941530227661133, 1.4941530227661133, 1.494157314300537, 2.507742166519165, 2.5057427883148193, 1.4941550493240356, 1.4941519498825073, 1.4941542148590088, 1.7222639322280884, 1.4941540956497192], "mean_td_error": 1.5252774953842163, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1075.0, "diff_num_grad_updates_vs_sampler_policy": 1074.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 83850, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 83850, "last_target_update_ts": 43680, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": 4.48125577282963, "episode_reward_min": -19.999688715685316, "episode_reward_mean": -1.8598667190511804, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00032724183488621846, 0.2067812526574676, 2.0371080302724103, 0.00031965149015376003, 0.0003177804776275434, 0.06506636868427385, 0.0003238424272242276, 0.0002954373554058725, 0.0003189404447943462, 0.0003163491420409374, 0.00032898489151916344, 0.0003273483347133922, 0.00032546737010307174, 0.0002969072845964534, 0.1774206513597513, 0.00032716760386127994, -9.999674450790952, -9.999676307834376, 0.0002952982241670227, 0.05327251457317173, 0.00031340010110946, 0.45337868442543006, -9.999689789682751, 0.8095659566866166, 0.0003067544799390851, -9.99968700288292, 4.48125577282963, -9.999690196098463, 0.000308064066615458, 0.000306343460627737, 0.0003144174328773391, 0.00031302837630556996, 0.00031125240102004517, -9.999690502820384, 0.0002953393409528353, 0.0003126878127460731, -9.99968868504655, 4.3463759203731405, 0.00030782325957077946, 0.0671614999560405, 0.00031588291196435643, 0.0003144809033893422, 0.0003126884577280257, 0.0003109159627847499, 0.378583780872971, 0.00031451648892566204, 0.00031265758614178966, -19.999688715685316, 0.0003095277085997093, 0.0003077907623968573, 0.0003179484064675917, 0.04059986491399668, 0.0003144504353747061, 0.00031306108778345423, -9.999688715102266, 0.00031643004274652234, 0.00031459645462742045, -9.999687263233584, 0.00031136233431380876, 0.0003096051574281178, 0.3545063991790514, -9.907317909835362, -9.999698128045369, -9.999699950343297, 0.00029863613411661616, -9.046324718012833, 3.7576149741049507, 0.12795193326334892, 2.7121807167918965, -9.999701751998455, 2.4567730130638736, 0.00030439931854822123, 0.00030254666645309025, -9.999698891863641, 0.00029960025755262155, 0.0387191812436214, -9.99969694825259, 0.0003012152635343946, 0.000299790903217173, 0.00029829460773866256, 0.00030737134611375026, -9.999694206939747, 0.0003039187340517667, 0.0003024687448265081, 0.0003009456683334226, 0.0002937216908234397, 0.05203830451643533, 0.11130173346194572, -9.999698897195765, 0.00029967936148845247, -9.999690471767776, 0.0002953696731034366, 0.05030455955859442, 0.0003046029444728332, 0.0003027478211102554, 0.06459403173079152, 0.0002939168763385393, 0.10123754965600668, 0.0003030359809630474, 0.00030119983260372613], "episode_lengths": [25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 26, 26, 23, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 26, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 417.7204400033133, "mean_inference_ms": 2.1032449554414954, "mean_action_processing_ms": 0.14405455051993998, "mean_env_wait_ms": 2.087405403036271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010787725448608398, "StateBufferConnector_ms": 0.0064792633056640625, "ViewRequirementAgentConnector_ms": 0.18279695510864258}}, "episode_reward_max": 4.48125577282963, "episode_reward_min": -19.999688715685316, "episode_reward_mean": -1.8598667190511804, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00032724183488621846, 0.2067812526574676, 2.0371080302724103, 0.00031965149015376003, 0.0003177804776275434, 0.06506636868427385, 0.0003238424272242276, 0.0002954373554058725, 0.0003189404447943462, 0.0003163491420409374, 0.00032898489151916344, 0.0003273483347133922, 0.00032546737010307174, 0.0002969072845964534, 0.1774206513597513, 0.00032716760386127994, -9.999674450790952, -9.999676307834376, 0.0002952982241670227, 0.05327251457317173, 0.00031340010110946, 0.45337868442543006, -9.999689789682751, 0.8095659566866166, 0.0003067544799390851, -9.99968700288292, 4.48125577282963, -9.999690196098463, 0.000308064066615458, 0.000306343460627737, 0.0003144174328773391, 0.00031302837630556996, 0.00031125240102004517, -9.999690502820384, 0.0002953393409528353, 0.0003126878127460731, -9.99968868504655, 4.3463759203731405, 0.00030782325957077946, 0.0671614999560405, 0.00031588291196435643, 0.0003144809033893422, 0.0003126884577280257, 0.0003109159627847499, 0.378583780872971, 0.00031451648892566204, 0.00031265758614178966, -19.999688715685316, 0.0003095277085997093, 0.0003077907623968573, 0.0003179484064675917, 0.04059986491399668, 0.0003144504353747061, 0.00031306108778345423, -9.999688715102266, 0.00031643004274652234, 0.00031459645462742045, -9.999687263233584, 0.00031136233431380876, 0.0003096051574281178, 0.3545063991790514, -9.907317909835362, -9.999698128045369, -9.999699950343297, 0.00029863613411661616, -9.046324718012833, 3.7576149741049507, 0.12795193326334892, 2.7121807167918965, -9.999701751998455, 2.4567730130638736, 0.00030439931854822123, 0.00030254666645309025, -9.999698891863641, 0.00029960025755262155, 0.0387191812436214, -9.99969694825259, 0.0003012152635343946, 0.000299790903217173, 0.00029829460773866256, 0.00030737134611375026, -9.999694206939747, 0.0003039187340517667, 0.0003024687448265081, 0.0003009456683334226, 0.0002937216908234397, 0.05203830451643533, 0.11130173346194572, -9.999698897195765, 0.00029967936148845247, -9.999690471767776, 0.0002953696731034366, 0.05030455955859442, 0.0003046029444728332, 0.0003027478211102554, 0.06459403173079152, 0.0002939168763385393, 0.10123754965600668, 0.0003030359809630474, 0.00030119983260372613], "episode_lengths": [25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 25, 25, 26, 26, 23, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 26, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 417.7204400033133, "mean_inference_ms": 2.1032449554414954, "mean_action_processing_ms": 0.14405455051993998, "mean_env_wait_ms": 2.087405403036271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010787725448608398, "StateBufferConnector_ms": 0.0064792633056640625, "ViewRequirementAgentConnector_ms": 0.18279695510864258}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 83850, "num_env_steps_sampled": 44000, "num_env_steps_trained": 83850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.465234838700963, "num_env_steps_trained_throughput_per_sec": 8.707207935466878, "timesteps_total": 44000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 8985.075, "sample_time_ms": 8921.436, "load_time_ms": 0.244, "load_throughput": 319332.076, "learn_time_ms": 13.523, "learn_throughput": 5767.918, "synch_weights_time_ms": 12.173}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 83850, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 83850, "last_target_update_ts": 43680, "num_target_updates": 83}, "done": false, "episodes_total": 1681, "training_iteration": 44, "trial_id": "2058a_00000", "date": "2024-04-17_08-01-20", "timestamp": 1713340880, "time_this_iter_s": 223.96108961105347, "time_total_s": 9653.443032741547, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 9653.443032741547, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 13.418867924528303, "ram_util_percent": 17.555031446540877}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01990036852657795, "cur_lr": 0.01}, "td_error": [1.560054063796997, 1.5600651502609253, 1.4918200969696045, 1.4918268918991089, 1.491820216178894, 1.4918204545974731, 1.4918209314346313, 1.4918200969696045, 1.4918204545974731, 1.491820216178894, 1.000542402267456, 1.8804099559783936, 1.4918205738067627, 1.4918214082717896, 1.4918208122253418, 1.4918208122253418, 1.491837739944458, 2.494262456893921, 1.4918205738067627, 1.5600627660751343, 1.4918200969696045, 1.4918222427368164, 1.4918200969696045, 1.4918200969696045, 1.4918200969696045, 1.4918200969696045, 1.4918209314346313, 1.4918200969696045, 1.491820216178894, 1.0005428791046143, 1.491820216178894, 1.4918239116668701, 1.491820216178894, 1.491821050643921, 1.4918204545974731, 1.491820216178894, 1.5600544214248657, 1.8735997676849365, 1.560511827468872, 1.4918783903121948, 1.4918373823165894, 3.78489351272583, 1.491820216178894, 1.4918208122253418, 1.4918203353881836, 1.4918208122253418, 1.4918198585510254, 1.4918211698532104, 1.491820216178894, 1.4918200969696045, 1.5600247383117676, 1.4918200969696045, 1.4918198585510254, 1.491820216178894, 1.4918203353881836, 2.466522216796875, 1.4918206930160522, 1.4918206930160522, 1.4918200969696045, 1.491820216178894, 1.4918205738067627, 1.4918204545974731, 0.35619327425956726, 1.491820216178894, 1.4918209314346313, 0.8839297294616699, 1.491820216178894, 1.4918203353881836, 0.35619327425956726, 1.4918200969696045, 1.4918200969696045, 1.4918200969696045, 1.491820216178894, 1.4918200969696045, 1.0005428791046143, 1.6708202362060547, 1.4918200969696045, 1.4918200969696045], "mean_td_error": 1.5081866979599, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1100.0, "diff_num_grad_updates_vs_sampler_policy": 1099.0}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 85800, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 85800, "last_target_update_ts": 44720, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": 3.7576149741049507, "episode_reward_min": -19.999688715685316, "episode_reward_mean": -2.0166501986986827, "episode_len_mean": 25.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00031588291196435643, 0.0003144809033893422, 0.0003126884577280257, 0.0003109159627847499, 0.378583780872971, 0.00031451648892566204, 0.00031265758614178966, -19.999688715685316, 0.0003095277085997093, 0.0003077907623968573, 0.0003179484064675917, 0.04059986491399668, 0.0003144504353747061, 0.00031306108778345423, -9.999688715102266, 0.00031643004274652234, 0.00031459645462742045, -9.999687263233584, 0.00031136233431380876, 0.0003096051574281178, 0.3545063991790514, -9.907317909835362, -9.999698128045369, -9.999699950343297, 0.00029863613411661616, -9.046324718012833, 3.7576149741049507, 0.12795193326334892, 2.7121807167918965, -9.999701751998455, 2.4567730130638736, 0.00030439931854822123, 0.00030254666645309025, -9.999698891863641, 0.00029960025755262155, 0.0387191812436214, -9.99969694825259, 0.0003012152635343946, 0.000299790903217173, 0.00029829460773866256, 0.00030737134611375026, -9.999694206939747, 0.0003039187340517667, 0.0003024687448265081, 0.0003009456683334226, 0.0002937216908234397, 0.05203830451643533, 0.11130173346194572, -9.999698897195765, 0.00029967936148845247, -9.999690471767776, 0.0002953696731034366, 0.05030455955859442, 0.0003046029444728332, 0.0003027478211102554, 0.06459403173079152, 0.0002939168763385393, 0.10123754965600668, 0.0003030359809630474, 0.00030119983260372613, 3.224933700404486, -9.999704870532705, -9.999706953643052, 0.00029177235162851405, 0.26079958883223986, 0.00029676688800704914, -9.946413573292503, -9.999707290327821, 0.000291437401799341, 0.0002901180662333888, 0.00029744509106699446, -9.999704664647426, 0.0002940355237901511, 0.0002926926239514409, 0.0002910095146579367, 0.0002961581154009846, 0.00029406171874039937, 0.00029277782557155473, 0.00029144635862595527, 0.00028977751391996844, -9.999701228682275, 0.11836009231396523, 0.00029540084952867904, 0.00029404548339827415, 0.00029234682110992346, 0.00029818417640834486, 0.000296049259823162, 0.0002939543984985213, 0.00029267144062654056, 0.11871390225670816, -9.999698690894398, 0.00029979751157274774, 0.0002976395168349965, 0.032169944145211286, 0.0002944230409725035, -9.999700224500486, 0.00029827947462952333, 0.0002961431982613715, 0.0002940470120301948, 3.21015906691521], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 26, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 418.2907517025217, "mean_inference_ms": 2.103612546546203, "mean_action_processing_ms": 0.1440648803324766, "mean_env_wait_ms": 2.042913670868022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010711908340454102, "StateBufferConnector_ms": 0.006266355514526367, "ViewRequirementAgentConnector_ms": 0.1768178939819336}}, "episode_reward_max": 3.7576149741049507, "episode_reward_min": -19.999688715685316, "episode_reward_mean": -2.0166501986986827, "episode_len_mean": 25.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00031588291196435643, 0.0003144809033893422, 0.0003126884577280257, 0.0003109159627847499, 0.378583780872971, 0.00031451648892566204, 0.00031265758614178966, -19.999688715685316, 0.0003095277085997093, 0.0003077907623968573, 0.0003179484064675917, 0.04059986491399668, 0.0003144504353747061, 0.00031306108778345423, -9.999688715102266, 0.00031643004274652234, 0.00031459645462742045, -9.999687263233584, 0.00031136233431380876, 0.0003096051574281178, 0.3545063991790514, -9.907317909835362, -9.999698128045369, -9.999699950343297, 0.00029863613411661616, -9.046324718012833, 3.7576149741049507, 0.12795193326334892, 2.7121807167918965, -9.999701751998455, 2.4567730130638736, 0.00030439931854822123, 0.00030254666645309025, -9.999698891863641, 0.00029960025755262155, 0.0387191812436214, -9.99969694825259, 0.0003012152635343946, 0.000299790903217173, 0.00029829460773866256, 0.00030737134611375026, -9.999694206939747, 0.0003039187340517667, 0.0003024687448265081, 0.0003009456683334226, 0.0002937216908234397, 0.05203830451643533, 0.11130173346194572, -9.999698897195765, 0.00029967936148845247, -9.999690471767776, 0.0002953696731034366, 0.05030455955859442, 0.0003046029444728332, 0.0003027478211102554, 0.06459403173079152, 0.0002939168763385393, 0.10123754965600668, 0.0003030359809630474, 0.00030119983260372613, 3.224933700404486, -9.999704870532705, -9.999706953643052, 0.00029177235162851405, 0.26079958883223986, 0.00029676688800704914, -9.946413573292503, -9.999707290327821, 0.000291437401799341, 0.0002901180662333888, 0.00029744509106699446, -9.999704664647426, 0.0002940355237901511, 0.0002926926239514409, 0.0002910095146579367, 0.0002961581154009846, 0.00029406171874039937, 0.00029277782557155473, 0.00029144635862595527, 0.00028977751391996844, -9.999701228682275, 0.11836009231396523, 0.00029540084952867904, 0.00029404548339827415, 0.00029234682110992346, 0.00029818417640834486, 0.000296049259823162, 0.0002939543984985213, 0.00029267144062654056, 0.11871390225670816, -9.999698690894398, 0.00029979751157274774, 0.0002976395168349965, 0.032169944145211286, 0.0002944230409725035, -9.999700224500486, 0.00029827947462952333, 0.0002961431982613715, 0.0002940470120301948, 3.21015906691521], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 26, 26, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 418.2907517025217, "mean_inference_ms": 2.103612546546203, "mean_action_processing_ms": 0.1440648803324766, "mean_env_wait_ms": 2.042913670868022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010711908340454102, "StateBufferConnector_ms": 0.006266355514526367, "ViewRequirementAgentConnector_ms": 0.1768178939819336}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 85800, "num_env_steps_sampled": 45000, "num_env_steps_trained": 85800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.431735051865066, "num_env_steps_trained_throughput_per_sec": 8.641883351136878, "timesteps_total": 45000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 9067.309, "sample_time_ms": 9001.62, "load_time_ms": 0.254, "load_throughput": 306785.176, "learn_time_ms": 13.362, "learn_throughput": 5837.386, "synch_weights_time_ms": 12.054}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 85800, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 85800, "last_target_update_ts": 44720, "num_target_updates": 85}, "done": false, "episodes_total": 1721, "training_iteration": 45, "trial_id": "2058a_00000", "date": "2024-04-17_08-05-05", "timestamp": 1713341105, "time_this_iter_s": 225.65657830238342, "time_total_s": 9879.09961104393, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 9879.09961104393, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 13.307165109034269, "ram_util_percent": 17.675077881619934}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02320740558207035, "cur_lr": 0.01}, "td_error": [1.48990797996521, 1.4899131059646606, 0.9699841141700745, 1.489908218383789, 1.4899089336395264, 1.4899083375930786, 1.4899089336395264, 1.48990797996521, 1.4899085760116577, 1.602454423904419, 1.566043734550476, 1.489909291267395, 1.4899088144302368, 0.7263906598091125, 1.4899085760116577, 1.489909291267395, 1.4899111986160278, 1.4899080991744995, 1.4899110794067383, 1.4899089336395264, 1.4899085760116577, 1.4899094104766846, 1.489910364151001, 1.4899088144302368, 1.4899078607559204, 1.4899077415466309, 1.4899077415466309, 1.4899089336395264, 0.9699851870536804, 1.489909052848816, 1.4899085760116577, 1.4899085760116577, 1.4899080991744995, 1.489908218383789, 1.4899088144302368, 1.4899108409881592, 1.48990797996521, 1.4899089336395264, 1.4899107217788696, 1.4899154901504517, 2.6233913898468018, 1.4899078607559204, 0.7174088358879089, 1.4899084568023682, 1.489908218383789, 1.4899084568023682, 1.4899078607559204, 1.6285287141799927, 1.566107988357544, 1.6135175228118896, 1.4899096488952637, 2.1671035289764404, 1.4899095296859741, 2.0302438735961914, 2.623429536819458, 1.4899104833602905, 0.9699840545654297, 1.3219099044799805, 2.6233913898468018, 1.4899084568023682, 1.489909291267395, 1.489908218383789, 1.4899158477783203, 1.4899083375930786, 1.4899088144302368, 0.9699815511703491, 1.4899089336395264, 1.4899077415466309, 1.489908218383789, 1.4899083375930786, 0.9699851274490356, 1.5660037994384766, 1.4899085760116577, 0.9699833393096924, 0.9699850082397461, 1.5915840864181519, 1.4899078607559204, 1.4899085760116577], "mean_td_error": 1.489645004272461, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1125.0, "diff_num_grad_updates_vs_sampler_policy": 1124.0}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 87750, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 87750, "last_target_update_ts": 45760, "num_target_updates": 87}, "sampler_results": {"episode_reward_max": 3.224933700404486, "episode_reward_min": -19.999714307775587, "episode_reward_mean": -1.9140908524940272, "episode_len_mean": 25.17, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00029829460773866256, 0.00030737134611375026, -9.999694206939747, 0.0003039187340517667, 0.0003024687448265081, 0.0003009456683334226, 0.0002937216908234397, 0.05203830451643533, 0.11130173346194572, -9.999698897195765, 0.00029967936148845247, -9.999690471767776, 0.0002953696731034366, 0.05030455955859442, 0.0003046029444728332, 0.0003027478211102554, 0.06459403173079152, 0.0002939168763385393, 0.10123754965600668, 0.0003030359809630474, 0.00030119983260372613, 3.224933700404486, -9.999704870532705, -9.999706953643052, 0.00029177235162851405, 0.26079958883223986, 0.00029676688800704914, -9.946413573292503, -9.999707290327821, 0.000291437401799341, 0.0002901180662333888, 0.00029744509106699446, -9.999704664647426, 0.0002940355237901511, 0.0002926926239514409, 0.0002910095146579367, 0.0002961581154009846, 0.00029406171874039937, 0.00029277782557155473, 0.00029144635862595527, 0.00028977751391996844, -9.999701228682275, 0.11836009231396523, 0.00029540084952867904, 0.00029404548339827415, 0.00029234682110992346, 0.00029818417640834486, 0.000296049259823162, 0.0002939543984985213, 0.00029267144062654056, 0.11871390225670816, -9.999698690894398, 0.00029979751157274774, 0.0002976395168349965, 0.032169944145211286, 0.0002944230409725035, -9.999700224500486, 0.00029827947462952333, 0.0002961431982613715, 0.0002940470120301948, 3.21015906691521, -9.999711171296543, 0.00028740654285250473, 0.00028626646184541627, 0.0002851646337764738, 0.0002837604310859514, 0.0002884643585112856, 0.0002870459066831489, 0.00028590867934403174, 0.0002848095982933341, 0.00028340888123553937, 0.00028956598201222185, 0.0002884087391265227, 0.000287290391426962, -9.99971413709802, -9.999715588045282, 0.0002883461491374031, 0.6977945336810828, 0.0002861054320641703, 0.00028469197205437043, 0.0002832533084130792, 0.00029089002253558616, 0.00028972219385106857, 0.00028859365723612774, 0.00028715556759631173, -19.999714307775587, 0.00028973877889542824, 0.0002883077958484761, 0.0002871605677693365, 0.0002860518599139665, -9.999715359303956, 0.4697373372668072, -9.999708604618851, 0.0002899478921762481, 0.0002887876008175739, 0.000287666318881511, 0.0002914979860540139, -9.999710171313835, 0.00028839668378709873, -9.999712751118501], "episode_lengths": [25, 25, 26, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 418.8335506670618, "mean_inference_ms": 2.1055021697801575, "mean_action_processing_ms": 0.1441529274944664, "mean_env_wait_ms": 2.001348169873464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010368585586547852, "StateBufferConnector_ms": 0.006182193756103516, "ViewRequirementAgentConnector_ms": 0.17593765258789062}}, "episode_reward_max": 3.224933700404486, "episode_reward_min": -19.999714307775587, "episode_reward_mean": -1.9140908524940272, "episode_len_mean": 25.17, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00029829460773866256, 0.00030737134611375026, -9.999694206939747, 0.0003039187340517667, 0.0003024687448265081, 0.0003009456683334226, 0.0002937216908234397, 0.05203830451643533, 0.11130173346194572, -9.999698897195765, 0.00029967936148845247, -9.999690471767776, 0.0002953696731034366, 0.05030455955859442, 0.0003046029444728332, 0.0003027478211102554, 0.06459403173079152, 0.0002939168763385393, 0.10123754965600668, 0.0003030359809630474, 0.00030119983260372613, 3.224933700404486, -9.999704870532705, -9.999706953643052, 0.00029177235162851405, 0.26079958883223986, 0.00029676688800704914, -9.946413573292503, -9.999707290327821, 0.000291437401799341, 0.0002901180662333888, 0.00029744509106699446, -9.999704664647426, 0.0002940355237901511, 0.0002926926239514409, 0.0002910095146579367, 0.0002961581154009846, 0.00029406171874039937, 0.00029277782557155473, 0.00029144635862595527, 0.00028977751391996844, -9.999701228682275, 0.11836009231396523, 0.00029540084952867904, 0.00029404548339827415, 0.00029234682110992346, 0.00029818417640834486, 0.000296049259823162, 0.0002939543984985213, 0.00029267144062654056, 0.11871390225670816, -9.999698690894398, 0.00029979751157274774, 0.0002976395168349965, 0.032169944145211286, 0.0002944230409725035, -9.999700224500486, 0.00029827947462952333, 0.0002961431982613715, 0.0002940470120301948, 3.21015906691521, -9.999711171296543, 0.00028740654285250473, 0.00028626646184541627, 0.0002851646337764738, 0.0002837604310859514, 0.0002884643585112856, 0.0002870459066831489, 0.00028590867934403174, 0.0002848095982933341, 0.00028340888123553937, 0.00028956598201222185, 0.0002884087391265227, 0.000287290391426962, -9.99971413709802, -9.999715588045282, 0.0002883461491374031, 0.6977945336810828, 0.0002861054320641703, 0.00028469197205437043, 0.0002832533084130792, 0.00029089002253558616, 0.00028972219385106857, 0.00028859365723612774, 0.00028715556759631173, -19.999714307775587, 0.00028973877889542824, 0.0002883077958484761, 0.0002871605677693365, 0.0002860518599139665, -9.999715359303956, 0.4697373372668072, -9.999708604618851, 0.0002899478921762481, 0.0002887876008175739, 0.000287666318881511, 0.0002914979860540139, -9.999710171313835, 0.00028839668378709873, -9.999712751118501], "episode_lengths": [25, 25, 26, 25, 25, 25, 24, 25, 25, 26, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 418.8335506670618, "mean_inference_ms": 2.1055021697801575, "mean_action_processing_ms": 0.1441529274944664, "mean_env_wait_ms": 2.001348169873464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010368585586547852, "StateBufferConnector_ms": 0.006182193756103516, "ViewRequirementAgentConnector_ms": 0.17593765258789062}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 87750, "num_env_steps_sampled": 46000, "num_env_steps_trained": 87750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.445075946619579, "num_env_steps_trained_throughput_per_sec": 8.66789809590818, "timesteps_total": 46000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 8958.591, "sample_time_ms": 8894.238, "load_time_ms": 0.241, "load_throughput": 323404.223, "learn_time_ms": 12.888, "learn_throughput": 6052.23, "synch_weights_time_ms": 12.989}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 87750, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 87750, "last_target_update_ts": 45760, "num_target_updates": 87}, "done": false, "episodes_total": 1760, "training_iteration": 46, "trial_id": "2058a_00000", "date": "2024-04-17_08-08-50", "timestamp": 1713341330, "time_this_iter_s": 224.97702026367188, "time_total_s": 10104.076631307602, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 10104.076631307602, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 12.936760124610592, "ram_util_percent": 17.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02974875457584858, "cur_lr": 0.01}, "td_error": [1.4897277355194092, 1.4897321462631226, 1.4897278547286987, 0.9801333546638489, 0.3331809341907501, 1.4897304773330688, 1.4897277355194092, 0.7184749841690063, 1.4897282123565674, 1.4897276163101196, 1.4897280931472778, 1.48972749710083, 2.52996563911438, 1.4897295236587524, 1.48972749710083, 1.489728331565857, 1.4897280931472778, 1.4897279739379883, 1.4897284507751465, 2.5316178798675537, 0.7227644324302673, 1.4897279739379883, 1.489728331565857, 1.4897278547286987, 1.48972749710083, 1.5755730867385864, 1.4897276163101196, 1.4897286891937256, 1.489729642868042, 2.5321590900421143, 1.4897279739379883, 1.4897279739379883, 1.4897338151931763, 0.9801337718963623, 1.48972749710083, 1.4902232885360718, 1.4897279739379883, 1.5504353046417236, 1.575242519378662, 1.4897691011428833, 1.489729881286621, 0.980132520198822, 1.4897279739379883, 1.489728569984436, 1.4897310733795166, 1.489743709564209, 1.489729404449463, 1.489728569984436, 1.577602744102478, 1.4897280931472778, 1.5756741762161255, 1.489729404449463, 1.4897282123565674, 1.4897280931472778, 1.4897282123565674, 1.4897286891937256, 1.4897286891937256, 1.4897568225860596, 1.4897289276123047, 1.4897295236587524, 1.489729881286621, 1.4897363185882568, 1.489728331565857, 1.5752580165863037, 1.4897282123565674, 2.527927875518799, 1.4897277355194092, 0.9801326990127563, 1.489728331565857, 0.7169464826583862, 1.489728331565857, 1.4897279739379883, 1.4897279739379883, 1.5769133567810059, 1.4897290468215942, 0.9801335334777832, 1.489729881286621, 1.4897280931472778], "mean_td_error": 1.4734004735946655, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1150.0, "diff_num_grad_updates_vs_sampler_policy": 1149.0}}, "num_env_steps_sampled": 47000, "num_env_steps_trained": 89700, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 89700, "last_target_update_ts": 46800, "num_target_updates": 89}, "sampler_results": {"episode_reward_max": 3.21015906691521, "episode_reward_min": -19.999714307775587, "episode_reward_mean": -1.6746572297224684, "episode_len_mean": 25.18, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00028977751391996844, -9.999701228682275, 0.11836009231396523, 0.00029540084952867904, 0.00029404548339827415, 0.00029234682110992346, 0.00029818417640834486, 0.000296049259823162, 0.0002939543984985213, 0.00029267144062654056, 0.11871390225670816, -9.999698690894398, 0.00029979751157274774, 0.0002976395168349965, 0.032169944145211286, 0.0002944230409725035, -9.999700224500486, 0.00029827947462952333, 0.0002961431982613715, 0.0002940470120301948, 3.21015906691521, -9.999711171296543, 0.00028740654285250473, 0.00028626646184541627, 0.0002851646337764738, 0.0002837604310859514, 0.0002884643585112856, 0.0002870459066831489, 0.00028590867934403174, 0.0002848095982933341, 0.00028340888123553937, 0.00028956598201222185, 0.0002884087391265227, 0.000287290391426962, -9.99971413709802, -9.999715588045282, 0.0002883461491374031, 0.6977945336810828, 0.0002861054320641703, 0.00028469197205437043, 0.0002832533084130792, 0.00029089002253558616, 0.00028972219385106857, 0.00028859365723612774, 0.00028715556759631173, -19.999714307775587, 0.00028973877889542824, 0.0002883077958484761, 0.0002871605677693365, 0.0002860518599139665, -9.999715359303956, 0.4697373372668072, -9.999708604618851, 0.0002899478921762481, 0.0002887876008175739, 0.000287666318881511, 0.0002914979860540139, -9.999710171313835, 0.00028839668378709873, -9.999712751118501, 0.00028233114299166504, 0.00028106797381022264, 0.0002794748126759392, 0.1654862355850679, 0.0002774446200868996, -9.881498213388468, -9.999719165796181, 0.0002792435597486492, -9.999721765760896, 0.0002770380714906884, 0.0002831328724133506, 0.0002815162861261186, 0.00028049036968601394, 0.00027927489247568226, 0.0002780976929370578, 0.00028198189220961196, 0.00028037838413217536, 0.00027936073124640016, 0.13556164729683257, 0.00027703632446547834, 2.636130103015865, 0.0002827708618626422, -9.07860936925483, 0.00028062912437785373, 0.000279440504663706, 0.0002832007989026841, -9.999718070020368, 0.0002803269349937472, 0.00027930965494955427, 0.00027810436704259065, 0.00028623743321822974, 0.0002847831479395634, 2.997567833487156, -9.961340296574948, 0.10257474514902412, 0.00028613936207349524, 0.00028472556763191987, 0.7470981418651143, 0.00028202637805878783, 0.00028042236548427886], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 419.261138873374, "mean_inference_ms": 2.105753202748521, "mean_action_processing_ms": 0.14417350305943027, "mean_env_wait_ms": 1.9602368445073244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009936332702636719, "StateBufferConnector_ms": 0.00623774528503418, "ViewRequirementAgentConnector_ms": 0.1794898509979248}}, "episode_reward_max": 3.21015906691521, "episode_reward_min": -19.999714307775587, "episode_reward_mean": -1.6746572297224684, "episode_len_mean": 25.18, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00028977751391996844, -9.999701228682275, 0.11836009231396523, 0.00029540084952867904, 0.00029404548339827415, 0.00029234682110992346, 0.00029818417640834486, 0.000296049259823162, 0.0002939543984985213, 0.00029267144062654056, 0.11871390225670816, -9.999698690894398, 0.00029979751157274774, 0.0002976395168349965, 0.032169944145211286, 0.0002944230409725035, -9.999700224500486, 0.00029827947462952333, 0.0002961431982613715, 0.0002940470120301948, 3.21015906691521, -9.999711171296543, 0.00028740654285250473, 0.00028626646184541627, 0.0002851646337764738, 0.0002837604310859514, 0.0002884643585112856, 0.0002870459066831489, 0.00028590867934403174, 0.0002848095982933341, 0.00028340888123553937, 0.00028956598201222185, 0.0002884087391265227, 0.000287290391426962, -9.99971413709802, -9.999715588045282, 0.0002883461491374031, 0.6977945336810828, 0.0002861054320641703, 0.00028469197205437043, 0.0002832533084130792, 0.00029089002253558616, 0.00028972219385106857, 0.00028859365723612774, 0.00028715556759631173, -19.999714307775587, 0.00028973877889542824, 0.0002883077958484761, 0.0002871605677693365, 0.0002860518599139665, -9.999715359303956, 0.4697373372668072, -9.999708604618851, 0.0002899478921762481, 0.0002887876008175739, 0.000287666318881511, 0.0002914979860540139, -9.999710171313835, 0.00028839668378709873, -9.999712751118501, 0.00028233114299166504, 0.00028106797381022264, 0.0002794748126759392, 0.1654862355850679, 0.0002774446200868996, -9.881498213388468, -9.999719165796181, 0.0002792435597486492, -9.999721765760896, 0.0002770380714906884, 0.0002831328724133506, 0.0002815162861261186, 0.00028049036968601394, 0.00027927489247568226, 0.0002780976929370578, 0.00028198189220961196, 0.00028037838413217536, 0.00027936073124640016, 0.13556164729683257, 0.00027703632446547834, 2.636130103015865, 0.0002827708618626422, -9.07860936925483, 0.00028062912437785373, 0.000279440504663706, 0.0002832007989026841, -9.999718070020368, 0.0002803269349937472, 0.00027930965494955427, 0.00027810436704259065, 0.00028623743321822974, 0.0002847831479395634, 2.997567833487156, -9.961340296574948, 0.10257474514902412, 0.00028613936207349524, 0.00028472556763191987, 0.7470981418651143, 0.00028202637805878783, 0.00028042236548427886], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 419.261138873374, "mean_inference_ms": 2.105753202748521, "mean_action_processing_ms": 0.14417350305943027, "mean_env_wait_ms": 1.9602368445073244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009936332702636719, "StateBufferConnector_ms": 0.00623774528503418, "ViewRequirementAgentConnector_ms": 0.1794898509979248}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 89700, "num_env_steps_sampled": 47000, "num_env_steps_trained": 89700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7262229028714593, "num_env_steps_trained_throughput_per_sec": 7.266134660599345, "timesteps_total": 47000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 47000, "timers": {"training_iteration_time_ms": 11270.127, "sample_time_ms": 11206.367, "load_time_ms": 0.256, "load_throughput": 304500.849, "learn_time_ms": 13.214, "learn_throughput": 5902.77, "synch_weights_time_ms": 11.429}, "counters": {"num_env_steps_sampled": 47000, "num_env_steps_trained": 89700, "num_agent_steps_sampled": 47000, "num_agent_steps_trained": 89700, "last_target_update_ts": 46800, "num_target_updates": 89}, "done": false, "episodes_total": 1800, "training_iteration": 47, "trial_id": "2058a_00000", "date": "2024-04-17_08-13-19", "timestamp": 1713341599, "time_this_iter_s": 268.3771872520447, "time_total_s": 10372.453818559647, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 10372.453818559647, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 11.272965879265092, "ram_util_percent": 17.908398950131236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.08297033607959747, "cur_lr": 0.01}, "td_error": [1.4788199663162231, 1.4788225889205933, 1.4788202047348022, 3.894895076751709, 1.640196681022644, 1.4788182973861694, 1.4788190126419067, 4.285159587860107, 1.4788185358047485, 1.607889175415039, 1.4797804355621338, 1.4788190126419067, 1.4788178205490112, 1.4788193702697754, 1.4788261651992798, 0.9832223653793335, 1.4788191318511963, 1.4788181781768799, 0.983222484588623, 1.4788187742233276, 1.478818416595459, 1.4788188934326172, 1.4788196086883545, 1.478818416595459, 1.559377670288086, 1.4788190126419067, 1.4788206815719604, 2.5268638134002686, 1.4788464307785034, 2.523325204849243, 0.9832225441932678, 1.4788236618041992, 1.4788192510604858, 2.5251059532165527, 1.6265438795089722, 1.478818655014038, 0.9832226037979126, 2.523327589035034, 2.523324966430664, 1.4788250923156738, 1.4788181781768799, 1.478821039199829, 1.4788243770599365, 1.4788187742233276, 1.4788196086883545, 0.983222484588623, 1.4788179397583008, 1.478819489479065, 1.6274890899658203, 1.478819727897644, 1.478818655014038, 1.6669087409973145, 1.4788179397583008, 1.559477686882019, 1.6141877174377441, 1.4788204431533813, 1.4788181781768799, 0.983222484588623, 2.5233495235443115, 1.4788185358047485, 1.4788178205490112, 0.7499029636383057, 1.4788182973861694, 1.5602314472198486, 1.4788178205490112, 1.559645414352417, 1.4788761138916016, 1.4788180589675903, 1.363395094871521, 1.4788191318511963, 1.4788212776184082, 1.4788188934326172, 1.4788178205490112, 3.3875482082366943, 2.525155782699585, 1.478818655014038, 1.478818416595459, 1.4788177013397217], "mean_td_error": 1.6309571266174316, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1175.0, "diff_num_grad_updates_vs_sampler_policy": 1174.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 91650, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 91650, "last_target_update_ts": 47840, "num_target_updates": 91}, "sampler_results": {"episode_reward_max": 2.997567833487156, "episode_reward_min": -19.999714307775587, "episode_reward_mean": -1.4096279880841167, "episode_len_mean": 25.04, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0002832533084130792, 0.00029089002253558616, 0.00028972219385106857, 0.00028859365723612774, 0.00028715556759631173, -19.999714307775587, 0.00028973877889542824, 0.0002883077958484761, 0.0002871605677693365, 0.0002860518599139665, -9.999715359303956, 0.4697373372668072, -9.999708604618851, 0.0002899478921762481, 0.0002887876008175739, 0.000287666318881511, 0.0002914979860540139, -9.999710171313835, 0.00028839668378709873, -9.999712751118501, 0.00028233114299166504, 0.00028106797381022264, 0.0002794748126759392, 0.1654862355850679, 0.0002774446200868996, -9.881498213388468, -9.999719165796181, 0.0002792435597486492, -9.999721765760896, 0.0002770380714906884, 0.0002831328724133506, 0.0002815162861261186, 0.00028049036968601394, 0.00027927489247568226, 0.0002780976929370578, 0.00028198189220961196, 0.00028037838413217536, 0.00027936073124640016, 0.13556164729683257, 0.00027703632446547834, 2.636130103015865, 0.0002827708618626422, -9.07860936925483, 0.00028062912437785373, 0.000279440504663706, 0.0002832007989026841, -9.999718070020368, 0.0002803269349937472, 0.00027930965494955427, 0.00027810436704259065, 0.00028623743321822974, 0.0002847831479395634, 2.997567833487156, -9.961340296574948, 0.10257474514902412, 0.00028613936207349524, 0.00028472556763191987, 0.7470981418651143, 0.00028202637805878783, 0.00028042236548427886, 0.00027628276791658035, 0.00027487503491148413, 0.00026252246908131785, 0.0886170248831437, 0.00027103559032027404, 0.00027587961473774186, 0.41924031222013003, 0.0002621595559633547, -9.99972815159538, 0.00027056941267608066, 0.00027667145480196094, 0.0002642292730333162, 0.0002739847167994281, 0.00027268571111875735, 0.00026051726930615874, -9.999724378955985, -9.999736770161212, 0.06698269338221226, 0.0002717743166507795, 0.00025965072627957234, 0.0002780004977570183, 0.0002654919416356494, 0.0002752880101885239, 0.00027397664652106796, 0.0002617446275770887, 0.00027693699426008966, 0.00027552260456012727, 0.00026313774740381943, 0.00027285802696611907, 0.00027156965776837616, 0.00027986849274699074, 0.00027868629416198405, 0.00027725402879156787, 0.1056880606904434, 0.000274629598489163, 0.00027940439382048585, 0.00027819828991400075, 0.00027703013014679725, 0.00027561479152765135, 0.00026322533621688725], "episode_lengths": [25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 24, 26, 25, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 419.671394134116, "mean_inference_ms": 2.105697819403816, "mean_action_processing_ms": 0.14418040758521197, "mean_env_wait_ms": 1.9208333962335455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01003575325012207, "StateBufferConnector_ms": 0.0062408447265625, "ViewRequirementAgentConnector_ms": 0.1795191764831543}}, "episode_reward_max": 2.997567833487156, "episode_reward_min": -19.999714307775587, "episode_reward_mean": -1.4096279880841167, "episode_len_mean": 25.04, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0002832533084130792, 0.00029089002253558616, 0.00028972219385106857, 0.00028859365723612774, 0.00028715556759631173, -19.999714307775587, 0.00028973877889542824, 0.0002883077958484761, 0.0002871605677693365, 0.0002860518599139665, -9.999715359303956, 0.4697373372668072, -9.999708604618851, 0.0002899478921762481, 0.0002887876008175739, 0.000287666318881511, 0.0002914979860540139, -9.999710171313835, 0.00028839668378709873, -9.999712751118501, 0.00028233114299166504, 0.00028106797381022264, 0.0002794748126759392, 0.1654862355850679, 0.0002774446200868996, -9.881498213388468, -9.999719165796181, 0.0002792435597486492, -9.999721765760896, 0.0002770380714906884, 0.0002831328724133506, 0.0002815162861261186, 0.00028049036968601394, 0.00027927489247568226, 0.0002780976929370578, 0.00028198189220961196, 0.00028037838413217536, 0.00027936073124640016, 0.13556164729683257, 0.00027703632446547834, 2.636130103015865, 0.0002827708618626422, -9.07860936925483, 0.00028062912437785373, 0.000279440504663706, 0.0002832007989026841, -9.999718070020368, 0.0002803269349937472, 0.00027930965494955427, 0.00027810436704259065, 0.00028623743321822974, 0.0002847831479395634, 2.997567833487156, -9.961340296574948, 0.10257474514902412, 0.00028613936207349524, 0.00028472556763191987, 0.7470981418651143, 0.00028202637805878783, 0.00028042236548427886, 0.00027628276791658035, 0.00027487503491148413, 0.00026252246908131785, 0.0886170248831437, 0.00027103559032027404, 0.00027587961473774186, 0.41924031222013003, 0.0002621595559633547, -9.99972815159538, 0.00027056941267608066, 0.00027667145480196094, 0.0002642292730333162, 0.0002739847167994281, 0.00027268571111875735, 0.00026051726930615874, -9.999724378955985, -9.999736770161212, 0.06698269338221226, 0.0002717743166507795, 0.00025965072627957234, 0.0002780004977570183, 0.0002654919416356494, 0.0002752880101885239, 0.00027397664652106796, 0.0002617446275770887, 0.00027693699426008966, 0.00027552260456012727, 0.00026313774740381943, 0.00027285802696611907, 0.00027156965776837616, 0.00027986849274699074, 0.00027868629416198405, 0.00027725402879156787, 0.1056880606904434, 0.000274629598489163, 0.00027940439382048585, 0.00027819828991400075, 0.00027703013014679725, 0.00027561479152765135, 0.00026322533621688725], "episode_lengths": [25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 24, 26, 25, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 419.671394134116, "mean_inference_ms": 2.105697819403816, "mean_action_processing_ms": 0.14418040758521197, "mean_env_wait_ms": 1.9208333962335455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01003575325012207, "StateBufferConnector_ms": 0.0062408447265625, "ViewRequirementAgentConnector_ms": 0.1795191764831543}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 91650, "num_env_steps_sampled": 48000, "num_env_steps_trained": 91650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.567137324543062, "num_env_steps_trained_throughput_per_sec": 6.955917782858971, "timesteps_total": 48000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11207.515, "sample_time_ms": 11146.895, "load_time_ms": 0.224, "load_throughput": 347779.007, "learn_time_ms": 12.41, "learn_throughput": 6285.485, "synch_weights_time_ms": 11.181}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 91650, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 91650, "last_target_update_ts": 47840, "num_target_updates": 91}, "done": false, "episodes_total": 1840, "training_iteration": 48, "trial_id": "2058a_00000", "date": "2024-04-17_08-17-59", "timestamp": 1713341879, "time_this_iter_s": 280.34678173065186, "time_total_s": 10652.800600290298, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 10652.800600290298, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 10.808020050125313, "ram_util_percent": 18.03208020050125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.056398093700408936, "cur_lr": 0.01}, "td_error": [1.4971882104873657, 1.4971905946731567, 1.5720189809799194, 0.9778010845184326, 1.4971940517425537, 1.4971896409988403, 1.497227430343628, 1.4971915483474731, 1.497192144393921, 1.4971873760223389, 1.4971923828125, 1.4971930980682373, 1.8300745487213135, 0.9778034090995789, 1.497187852859497, 0.9778025150299072, 1.4971901178359985, 1.5413967370986938, 1.5739554166793823, 1.4971966743469238, 1.5870922803878784, 1.4971888065338135, 1.4971885681152344, 1.4971871376037598, 1.4971908330917358, 1.4972087144851685, 1.4971891641616821, 0.9778018593788147, 1.6912587881088257, 0.9778048992156982, 0.7152048945426941, 1.5723068714141846, 1.4972001314163208, 1.4971874952316284, 0.9778018593788147, 1.4971903562545776, 1.4971904754638672, 0.977802038192749, 1.497219443321228, 1.4971880912780762, 1.4971871376037598, 1.4971895217895508, 1.4971874952316284, 1.4971896409988403, 1.4971909523010254, 1.497187614440918, 1.4971868991851807, 1.497187852859497, 1.4971994161605835, 0.9778009653091431, 1.4971872568130493, 1.6198265552520752, 1.5377388000488281, 1.497191071510315, 1.4971868991851807, 1.4972294569015503, 1.4971888065338135, 1.4971908330917358, 1.4971888065338135, 1.4971874952316284, 1.4971895217895508, 1.4971880912780762, 1.554511547088623, 1.497190237045288, 1.8341410160064697, 1.4971892833709717, 1.4971929788589478, 1.4971868991851807, 0.9778045415878296, 1.4972000122070312, 1.6380364894866943, 1.497187852859497, 1.8251903057098389, 1.4971872568130493, 1.4971896409988403, 1.4971877336502075, 1.4971872568130493, 1.4971891641616821], "mean_td_error": 1.451776385307312, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1200.0, "diff_num_grad_updates_vs_sampler_policy": 1199.0}}, "num_env_steps_sampled": 49000, "num_env_steps_trained": 93600, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 93600, "last_target_update_ts": 48880, "num_target_updates": 93}, "sampler_results": {"episode_reward_max": 2.997567833487156, "episode_reward_min": -19.999740401639663, "episode_reward_mean": -1.0232725379957106, "episode_len_mean": 24.71, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0002827708618626422, -9.07860936925483, 0.00028062912437785373, 0.000279440504663706, 0.0002832007989026841, -9.999718070020368, 0.0002803269349937472, 0.00027930965494955427, 0.00027810436704259065, 0.00028623743321822974, 0.0002847831479395634, 2.997567833487156, -9.961340296574948, 0.10257474514902412, 0.00028613936207349524, 0.00028472556763191987, 0.7470981418651143, 0.00028202637805878783, 0.00028042236548427886, 0.00027628276791658035, 0.00027487503491148413, 0.00026252246908131785, 0.0886170248831437, 0.00027103559032027404, 0.00027587961473774186, 0.41924031222013003, 0.0002621595559633547, -9.99972815159538, 0.00027056941267608066, 0.00027667145480196094, 0.0002642292730333162, 0.0002739847167994281, 0.00027268571111875735, 0.00026051726930615874, -9.999724378955985, -9.999736770161212, 0.06698269338221226, 0.0002717743166507795, 0.00025965072627957234, 0.0002780004977570183, 0.0002654919416356494, 0.0002752880101885239, 0.00027397664652106796, 0.0002617446275770887, 0.00027693699426008966, 0.00027552260456012727, 0.00026313774740381943, 0.00027285802696611907, 0.00027156965776837616, 0.00027986849274699074, 0.00027868629416198405, 0.00027725402879156787, 0.1056880606904434, 0.000274629598489163, 0.00027940439382048585, 0.00027819828991400075, 0.00027703013014679725, 0.00027561479152765135, 0.00026322533621688725, 0.00025894833358517213, 0.0002471767728083719, 0.00025684245042066487, 0.000266019776956274, 0.0002649008094881402, 0.037678034568683676, 0.00024687417043189143, 0.07786509823694088, 0.0002657831139718122, 0.00026466613238767346, 0.000248668423058842, 0.00025838589653925996, 0.00026760920874663335, 0.0002664768585486294, 0.0002651362382194021, 0.0002478445746198636, 0.00025753345054274266, 0.0002667313783012239, 0.09399889345476016, 0.00026435114184452876, 1.4005380454019931, -19.999740401639663, 0.0002688574790821432, 0.00026771456313826037, 0.00026636149169683473, 0.17342574984869907, 0.0002476990279758812, 0.00025738284918639363, 0.00026657628883111644, 0.00026545264464548083, 0.0002733244852392169, 0.0002611245915108912, 0.00024924580948147923, 0.00025898331110365717, -9.999731775491284, -19.999727051322715, 0.0002716592179496478, 0.000259541289817685, 0.00024774052854183913, 0.00025742579110777703, 0.37855540163200124], "episode_lengths": [25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 24, 26, 25, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 24, 23, 24, 25, 25, 24, 23, 24, 25, 25, 23, 24, 25, 25, 25, 23, 24, 25, 25, 25, 23, 26, 25, 25, 25, 24, 23, 24, 25, 25, 25, 24, 23, 24, 26, 27, 25, 24, 23, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 420.1236506959502, "mean_inference_ms": 2.1027148390124886, "mean_action_processing_ms": 0.1440654574607291, "mean_env_wait_ms": 1.8826400207870244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009897708892822266, "StateBufferConnector_ms": 0.006078243255615234, "ViewRequirementAgentConnector_ms": 0.17285943031311035}}, "episode_reward_max": 2.997567833487156, "episode_reward_min": -19.999740401639663, "episode_reward_mean": -1.0232725379957106, "episode_len_mean": 24.71, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0002827708618626422, -9.07860936925483, 0.00028062912437785373, 0.000279440504663706, 0.0002832007989026841, -9.999718070020368, 0.0002803269349937472, 0.00027930965494955427, 0.00027810436704259065, 0.00028623743321822974, 0.0002847831479395634, 2.997567833487156, -9.961340296574948, 0.10257474514902412, 0.00028613936207349524, 0.00028472556763191987, 0.7470981418651143, 0.00028202637805878783, 0.00028042236548427886, 0.00027628276791658035, 0.00027487503491148413, 0.00026252246908131785, 0.0886170248831437, 0.00027103559032027404, 0.00027587961473774186, 0.41924031222013003, 0.0002621595559633547, -9.99972815159538, 0.00027056941267608066, 0.00027667145480196094, 0.0002642292730333162, 0.0002739847167994281, 0.00027268571111875735, 0.00026051726930615874, -9.999724378955985, -9.999736770161212, 0.06698269338221226, 0.0002717743166507795, 0.00025965072627957234, 0.0002780004977570183, 0.0002654919416356494, 0.0002752880101885239, 0.00027397664652106796, 0.0002617446275770887, 0.00027693699426008966, 0.00027552260456012727, 0.00026313774740381943, 0.00027285802696611907, 0.00027156965776837616, 0.00027986849274699074, 0.00027868629416198405, 0.00027725402879156787, 0.1056880606904434, 0.000274629598489163, 0.00027940439382048585, 0.00027819828991400075, 0.00027703013014679725, 0.00027561479152765135, 0.00026322533621688725, 0.00025894833358517213, 0.0002471767728083719, 0.00025684245042066487, 0.000266019776956274, 0.0002649008094881402, 0.037678034568683676, 0.00024687417043189143, 0.07786509823694088, 0.0002657831139718122, 0.00026466613238767346, 0.000248668423058842, 0.00025838589653925996, 0.00026760920874663335, 0.0002664768585486294, 0.0002651362382194021, 0.0002478445746198636, 0.00025753345054274266, 0.0002667313783012239, 0.09399889345476016, 0.00026435114184452876, 1.4005380454019931, -19.999740401639663, 0.0002688574790821432, 0.00026771456313826037, 0.00026636149169683473, 0.17342574984869907, 0.0002476990279758812, 0.00025738284918639363, 0.00026657628883111644, 0.00026545264464548083, 0.0002733244852392169, 0.0002611245915108912, 0.00024924580948147923, 0.00025898331110365717, -9.999731775491284, -19.999727051322715, 0.0002716592179496478, 0.000259541289817685, 0.00024774052854183913, 0.00025742579110777703, 0.37855540163200124], "episode_lengths": [25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 24, 26, 25, 25, 25, 24, 25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 24, 23, 24, 25, 25, 24, 23, 24, 25, 25, 23, 24, 25, 25, 25, 23, 24, 25, 25, 25, 23, 26, 25, 25, 25, 24, 23, 24, 25, 25, 25, 24, 23, 24, 26, 27, 25, 24, 23, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 420.1236506959502, "mean_inference_ms": 2.1027148390124886, "mean_action_processing_ms": 0.1440654574607291, "mean_env_wait_ms": 1.8826400207870244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009897708892822266, "StateBufferConnector_ms": 0.006078243255615234, "ViewRequirementAgentConnector_ms": 0.17285943031311035}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 93600, "num_env_steps_sampled": 49000, "num_env_steps_trained": 93600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.9085381439039044, "num_env_steps_trained_throughput_per_sec": 7.621649380612614, "timesteps_total": 49000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 49000, "timers": {"training_iteration_time_ms": 11085.939, "sample_time_ms": 11025.159, "load_time_ms": 0.236, "load_throughput": 330260.157, "learn_time_ms": 12.556, "learn_throughput": 6212.014, "synch_weights_time_ms": 11.067}, "counters": {"num_env_steps_sampled": 49000, "num_env_steps_trained": 93600, "num_agent_steps_sampled": 49000, "num_agent_steps_trained": 93600, "last_target_update_ts": 48880, "num_target_updates": 93}, "done": false, "episodes_total": 1881, "training_iteration": 49, "trial_id": "2058a_00000", "date": "2024-04-17_08-22-15", "timestamp": 1713342135, "time_this_iter_s": 255.85783624649048, "time_total_s": 10908.658436536789, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 10908.658436536789, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 12.030769230769232, "ram_util_percent": 18.132142857142853}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03545457497239113, "cur_lr": 0.01}, "td_error": [1.4674335718154907, 1.4674322605133057, 1.4674333333969116, 1.4674334526062012, 1.4674335718154907, 1.4674335718154907, 1.4674335718154907, 1.4976756572723389, 1.4674324989318848, 0.9778693914413452, 2.139866828918457, 2.529776096343994, 1.4674333333969116, 1.538345217704773, 1.467432975769043, 1.4674333333969116, 1.4674323797225952, 1.4674335718154907, 1.538501262664795, 1.4674324989318848, 1.4674336910247803, 1.4674336910247803, 1.4674335718154907, 1.4674330949783325, 1.4674336910247803, 1.4674335718154907, 1.4674336910247803, 0.9777559041976929, 0.9778639674186707, 1.4674335718154907, 1.5107784271240234, 2.2767412662506104, 2.5086710453033447, 1.467433214187622, 0.9778705835342407, 1.6739646196365356, 1.4674333333969116, 1.4674335718154907, 1.4674335718154907, 2.531421661376953, 1.4721444845199585, 1.4674334526062012, 1.4674335718154907, 1.467433214187622, 1.4674336910247803, 1.4674334526062012, 1.4674333333969116, 1.4674334526062012, 1.9120866060256958, 1.4674335718154907, 1.4674336910247803, 1.4674336910247803, 1.4674335718154907, 1.4674327373504639, 1.4674333333969116, 1.4674336910247803, 1.5383498668670654, 1.4674328565597534, 3.370452404022217, 1.6724333763122559, 0.977856457233429, 1.4674335718154907, 1.4674335718154907, 1.4674333333969116, 1.4674334526062012, 1.4674334526062012, 1.4674333333969116, 1.726698398590088, 1.4674323797225952, 1.5382390022277832, 1.4674336910247803, 1.4674335718154907, 1.4674334526062012, 2.2039332389831543, 1.4674336910247803, 1.4674333333969116, 1.4674335718154907, 1.4674326181411743], "mean_td_error": 1.548437476158142, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1225.0, "diff_num_grad_updates_vs_sampler_policy": 1224.0}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 95550, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 95550, "last_target_update_ts": 49920, "num_target_updates": 95}, "sampler_results": {"episode_reward_max": 1.4005380454019931, "episode_reward_min": -19.999740401639663, "episode_reward_mean": -1.1526531014954018, "episode_len_mean": 24.78, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0002780004977570183, 0.0002654919416356494, 0.0002752880101885239, 0.00027397664652106796, 0.0002617446275770887, 0.00027693699426008966, 0.00027552260456012727, 0.00026313774740381943, 0.00027285802696611907, 0.00027156965776837616, 0.00027986849274699074, 0.00027868629416198405, 0.00027725402879156787, 0.1056880606904434, 0.000274629598489163, 0.00027940439382048585, 0.00027819828991400075, 0.00027703013014679725, 0.00027561479152765135, 0.00026322533621688725, 0.00025894833358517213, 0.0002471767728083719, 0.00025684245042066487, 0.000266019776956274, 0.0002649008094881402, 0.037678034568683676, 0.00024687417043189143, 0.07786509823694088, 0.0002657831139718122, 0.00026466613238767346, 0.000248668423058842, 0.00025838589653925996, 0.00026760920874663335, 0.0002664768585486294, 0.0002651362382194021, 0.0002478445746198636, 0.00025753345054274266, 0.0002667313783012239, 0.09399889345476016, 0.00026435114184452876, 1.4005380454019931, -19.999740401639663, 0.0002688574790821432, 0.00026771456313826037, 0.00026636149169683473, 0.17342574984869907, 0.0002476990279758812, 0.00025738284918639363, 0.00026657628883111644, 0.00026545264464548083, 0.0002733244852392169, 0.0002611245915108912, 0.00024924580948147923, 0.00025898331110365717, -9.999731775491284, -19.999727051322715, 0.0002716592179496478, 0.000259541289817685, 0.00024774052854183913, 0.00025742579110777703, 0.37855540163200124, 0.0002635759610732268, 0.3601184165553671, 0.000261057479409506, -9.664702528988006, 0.00025892107692359354, 0.7597370481695307, 0.00026228994765079504, 0.00026081296324420534, 0.00025959237432227614, 0.00025865452504173235, 0.04374107434948123, 0.04802364036657198, -9.99973838388111, 0.00026066350817424694, 0.000259268245960552, 0.000263279357402313, 0.00026179124176946766, 0.07880831474800015, 0.0002596987255055977, -9.484699467828376, 0.0002652733777078072, 0.0002637627023845996, 0.0002625144083826734, -9.99973844452475, 0.00026015056616276956, -9.999735877510192, -9.999736947538077, 0.00026156679309935883, 0.00026033915336681296, 0.0002593959101562515, 0.00026708684234438384, 0.00026574009283143616, 0.00026465703943143144, 0.00026315335517210794, 0.23223038829720066, 0.07148865010707857, -9.99973572643925, 0.0002632022929415139, 0.00026171504580425957], "episode_lengths": [25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 24, 23, 24, 25, 25, 24, 23, 24, 25, 25, 23, 24, 25, 25, 25, 23, 24, 25, 25, 25, 23, 26, 25, 25, 25, 24, 23, 24, 25, 25, 25, 24, 23, 24, 26, 27, 25, 24, 23, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 420.59249414740225, "mean_inference_ms": 2.1025187649216037, "mean_action_processing_ms": 0.14405895976544747, "mean_env_wait_ms": 1.8477260771023123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00984501838684082, "StateBufferConnector_ms": 0.006101846694946289, "ViewRequirementAgentConnector_ms": 0.17174434661865234}}, "episode_reward_max": 1.4005380454019931, "episode_reward_min": -19.999740401639663, "episode_reward_mean": -1.1526531014954018, "episode_len_mean": 24.78, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0002780004977570183, 0.0002654919416356494, 0.0002752880101885239, 0.00027397664652106796, 0.0002617446275770887, 0.00027693699426008966, 0.00027552260456012727, 0.00026313774740381943, 0.00027285802696611907, 0.00027156965776837616, 0.00027986849274699074, 0.00027868629416198405, 0.00027725402879156787, 0.1056880606904434, 0.000274629598489163, 0.00027940439382048585, 0.00027819828991400075, 0.00027703013014679725, 0.00027561479152765135, 0.00026322533621688725, 0.00025894833358517213, 0.0002471767728083719, 0.00025684245042066487, 0.000266019776956274, 0.0002649008094881402, 0.037678034568683676, 0.00024687417043189143, 0.07786509823694088, 0.0002657831139718122, 0.00026466613238767346, 0.000248668423058842, 0.00025838589653925996, 0.00026760920874663335, 0.0002664768585486294, 0.0002651362382194021, 0.0002478445746198636, 0.00025753345054274266, 0.0002667313783012239, 0.09399889345476016, 0.00026435114184452876, 1.4005380454019931, -19.999740401639663, 0.0002688574790821432, 0.00026771456313826037, 0.00026636149169683473, 0.17342574984869907, 0.0002476990279758812, 0.00025738284918639363, 0.00026657628883111644, 0.00026545264464548083, 0.0002733244852392169, 0.0002611245915108912, 0.00024924580948147923, 0.00025898331110365717, -9.999731775491284, -19.999727051322715, 0.0002716592179496478, 0.000259541289817685, 0.00024774052854183913, 0.00025742579110777703, 0.37855540163200124, 0.0002635759610732268, 0.3601184165553671, 0.000261057479409506, -9.664702528988006, 0.00025892107692359354, 0.7597370481695307, 0.00026228994765079504, 0.00026081296324420534, 0.00025959237432227614, 0.00025865452504173235, 0.04374107434948123, 0.04802364036657198, -9.99973838388111, 0.00026066350817424694, 0.000259268245960552, 0.000263279357402313, 0.00026179124176946766, 0.07880831474800015, 0.0002596987255055977, -9.484699467828376, 0.0002652733777078072, 0.0002637627023845996, 0.0002625144083826734, -9.99973844452475, 0.00026015056616276956, -9.999735877510192, -9.999736947538077, 0.00026156679309935883, 0.00026033915336681296, 0.0002593959101562515, 0.00026708684234438384, 0.00026574009283143616, 0.00026465703943143144, 0.00026315335517210794, 0.23223038829720066, 0.07148865010707857, -9.99973572643925, 0.0002632022929415139, 0.00026171504580425957], "episode_lengths": [25, 24, 25, 25, 24, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 24, 23, 24, 25, 25, 24, 23, 24, 25, 25, 23, 24, 25, 25, 25, 23, 24, 25, 25, 25, 23, 26, 25, 25, 25, 24, 23, 24, 25, 25, 25, 24, 23, 24, 26, 27, 25, 24, 23, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 420.59249414740225, "mean_inference_ms": 2.1025187649216037, "mean_action_processing_ms": 0.14405895976544747, "mean_env_wait_ms": 1.8477260771023123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00984501838684082, "StateBufferConnector_ms": 0.006101846694946289, "ViewRequirementAgentConnector_ms": 0.17174434661865234}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 95550, "num_env_steps_sampled": 50000, "num_env_steps_trained": 95550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.893841307586963, "num_env_steps_trained_throughput_per_sec": 7.592990549794578, "timesteps_total": 50000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 8946.44, "sample_time_ms": 8885.381, "load_time_ms": 0.235, "load_throughput": 332576.712, "learn_time_ms": 12.252, "learn_throughput": 6366.284, "synch_weights_time_ms": 12.283}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 95550, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 95550, "last_target_update_ts": 49920, "num_target_updates": 95}, "done": false, "episodes_total": 1920, "training_iteration": 50, "trial_id": "2058a_00000", "date": "2024-04-17_08-26-32", "timestamp": 1713342392, "time_this_iter_s": 256.82591128349304, "time_total_s": 11165.484347820282, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 11165.484347820282, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 11.437431693989073, "ram_util_percent": 18.239071038251367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.016982201486825943, "cur_lr": 0.01}, "td_error": [1.44613516330719, 1.4461358785629272, 1.4461355209350586, 1.4461348056793213, 1.4461348056793213, 1.4461358785629272, 1.446135401725769, 1.446136474609375, 1.446137547492981, 1.446136474609375, 2.0888073444366455, 0.9560496211051941, 1.528745412826538, 1.4461349248886108, 1.4461380243301392, 1.4461376667022705, 0.7314320802688599, 1.5896917581558228, 1.4461359977722168, 1.894187331199646, 1.4461381435394287, 1.446144700050354, 1.5255835056304932, 1.4461348056793213, 1.4468204975128174, 1.446138858795166, 1.4461349248886108, 1.4461350440979004, 1.4461356401443481, 1.4461355209350586, 1.4461442232131958, 1.4461712837219238, 1.6372863054275513, 1.4461488723754883, 2.5924971103668213, 0.9560497999191284, 1.446144700050354, 1.44613516330719, 1.4461349248886108, 1.4461365938186646, 1.4461421966552734, 1.6372867822647095, 1.4461358785629272, 1.446138858795166, 1.4461361169815063, 1.446135401725769, 1.446138620376587, 1.4461357593536377, 1.4461368322372437, 0.9560496807098389, 2.587775230407715, 1.4461374282836914, 1.8988524675369263, 1.446136474609375, 1.44613778591156, 1.5257983207702637, 0.9560496807098389, 1.4463329315185547, 1.4461363554000854, 1.3455216884613037, 1.4461359977722168, 1.145603060722351, 1.4461355209350586, 1.44613516330719, 1.4461358785629272, 0.7285616397857666, 1.4461368322372437, 1.4461349248886108, 1.4461355209350586, 1.4461374282836914, 1.4461396932601929, 1.6372772455215454, 1.4462846517562866, 1.4461357593536377, 1.4461358785629272, 1.44613516330719, 1.4461584091186523, 1.4461356401443481], "mean_td_error": 1.4589248895645142, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1250.0, "diff_num_grad_updates_vs_sampler_policy": 1249.0}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 97500, "last_target_update_ts": 50960, "num_target_updates": 97}, "sampler_results": {"episode_reward_max": 2.489666705181324, "episode_reward_min": -19.999746740215045, "episode_reward_mean": -1.9262757614936377, "episode_len_mean": 24.92, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0002688574790821432, 0.00026771456313826037, 0.00026636149169683473, 0.17342574984869907, 0.0002476990279758812, 0.00025738284918639363, 0.00026657628883111644, 0.00026545264464548083, 0.0002733244852392169, 0.0002611245915108912, 0.00024924580948147923, 0.00025898331110365717, -9.999731775491284, -19.999727051322715, 0.0002716592179496478, 0.000259541289817685, 0.00024774052854183913, 0.00025742579110777703, 0.37855540163200124, 0.0002635759610732268, 0.3601184165553671, 0.000261057479409506, -9.664702528988006, 0.00025892107692359354, 0.7597370481695307, 0.00026228994765079504, 0.00026081296324420534, 0.00025959237432227614, 0.00025865452504173235, 0.04374107434948123, 0.04802364036657198, -9.99973838388111, 0.00026066350817424694, 0.000259268245960552, 0.000263279357402313, 0.00026179124176946766, 0.07880831474800015, 0.0002596987255055977, -9.484699467828376, 0.0002652733777078072, 0.0002637627023845996, 0.0002625144083826734, -9.99973844452475, 0.00026015056616276956, -9.999735877510192, -9.999736947538077, 0.00026156679309935883, 0.00026033915336681296, 0.0002593959101562515, 0.00026708684234438384, 0.00026574009283143616, 0.00026465703943143144, 0.00026315335517210794, 0.23223038829720066, 0.07148865010707857, -9.99973572643925, 0.0002632022929415139, 0.00026171504580425957, 0.00025754435455702736, 2.489666705181324, 0.04665951158746901, 0.0002540972603696425, -9.999747071333696, 0.00025728062797010964, 0.10848158357250162, 0.00023470916334189323, -9.999746190789484, 0.18552868696122612, 0.08920864337038342, 0.00023649574308932426, -19.999744268704504, 0.0002545472110702712, 0.00025346120930915813, 0.00025715578249706705, 0.0002355635348197439, -9.999745271648836, 0.0002535536200046046, 0.00025247606258967705, 0.00025896105010061646, 0.00023721004272913472, 0.0002564994771157183, 0.0777100341487453, 0.0002542945419849806, 0.00025801414768416935, 0.00025684404471857243, 1.3141558248133611, -9.999745570966173, -19.999746740215045, 0.00026106394825701156, 0.00025966440784843363, 0.0002584793233576973, -9.9997632292043, 0.00025602685604942716, 0.0002548402476665029, -9.999739513874847, 0.0002595417112282891, 0.00025815839931667513, 0.00025698699057808333, 0.04335282716547514, 0.00025468790864476666], "episode_lengths": [25, 25, 25, 24, 23, 24, 25, 25, 25, 24, 23, 24, 26, 27, 25, 24, 23, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 23, 25, 26, 25, 25, 23, 26, 25, 25, 23, 27, 25, 25, 25, 23, 26, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 26, 27, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 421.2287251956643, "mean_inference_ms": 2.101008947965358, "mean_action_processing_ms": 0.144029462065007, "mean_env_wait_ms": 1.812296252530297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009864568710327148, "StateBufferConnector_ms": 0.0061283111572265625, "ViewRequirementAgentConnector_ms": 0.1749882698059082}}, "episode_reward_max": 2.489666705181324, "episode_reward_min": -19.999746740215045, "episode_reward_mean": -1.9262757614936377, "episode_len_mean": 24.92, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0002688574790821432, 0.00026771456313826037, 0.00026636149169683473, 0.17342574984869907, 0.0002476990279758812, 0.00025738284918639363, 0.00026657628883111644, 0.00026545264464548083, 0.0002733244852392169, 0.0002611245915108912, 0.00024924580948147923, 0.00025898331110365717, -9.999731775491284, -19.999727051322715, 0.0002716592179496478, 0.000259541289817685, 0.00024774052854183913, 0.00025742579110777703, 0.37855540163200124, 0.0002635759610732268, 0.3601184165553671, 0.000261057479409506, -9.664702528988006, 0.00025892107692359354, 0.7597370481695307, 0.00026228994765079504, 0.00026081296324420534, 0.00025959237432227614, 0.00025865452504173235, 0.04374107434948123, 0.04802364036657198, -9.99973838388111, 0.00026066350817424694, 0.000259268245960552, 0.000263279357402313, 0.00026179124176946766, 0.07880831474800015, 0.0002596987255055977, -9.484699467828376, 0.0002652733777078072, 0.0002637627023845996, 0.0002625144083826734, -9.99973844452475, 0.00026015056616276956, -9.999735877510192, -9.999736947538077, 0.00026156679309935883, 0.00026033915336681296, 0.0002593959101562515, 0.00026708684234438384, 0.00026574009283143616, 0.00026465703943143144, 0.00026315335517210794, 0.23223038829720066, 0.07148865010707857, -9.99973572643925, 0.0002632022929415139, 0.00026171504580425957, 0.00025754435455702736, 2.489666705181324, 0.04665951158746901, 0.0002540972603696425, -9.999747071333696, 0.00025728062797010964, 0.10848158357250162, 0.00023470916334189323, -9.999746190789484, 0.18552868696122612, 0.08920864337038342, 0.00023649574308932426, -19.999744268704504, 0.0002545472110702712, 0.00025346120930915813, 0.00025715578249706705, 0.0002355635348197439, -9.999745271648836, 0.0002535536200046046, 0.00025247606258967705, 0.00025896105010061646, 0.00023721004272913472, 0.0002564994771157183, 0.0777100341487453, 0.0002542945419849806, 0.00025801414768416935, 0.00025684404471857243, 1.3141558248133611, -9.999745570966173, -19.999746740215045, 0.00026106394825701156, 0.00025966440784843363, 0.0002584793233576973, -9.9997632292043, 0.00025602685604942716, 0.0002548402476665029, -9.999739513874847, 0.0002595417112282891, 0.00025815839931667513, 0.00025698699057808333, 0.04335282716547514, 0.00025468790864476666], "episode_lengths": [25, 25, 25, 24, 23, 24, 25, 25, 25, 24, 23, 24, 26, 27, 25, 24, 23, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 23, 25, 26, 25, 25, 23, 26, 25, 25, 23, 27, 25, 25, 25, 23, 26, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 26, 27, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 421.2287251956643, "mean_inference_ms": 2.101008947965358, "mean_action_processing_ms": 0.144029462065007, "mean_env_wait_ms": 1.812296252530297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009864568710327148, "StateBufferConnector_ms": 0.0061283111572265625, "ViewRequirementAgentConnector_ms": 0.1749882698059082}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 97500, "num_env_steps_sampled": 51000, "num_env_steps_trained": 97500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.077187851272599, "num_env_steps_trained_throughput_per_sec": 7.950516309981569, "timesteps_total": 51000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 11119.676, "sample_time_ms": 11058.367, "load_time_ms": 0.244, "load_throughput": 319488.0, "learn_time_ms": 12.824, "learn_throughput": 6082.431, "synch_weights_time_ms": 11.171}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 97500, "last_target_update_ts": 50960, "num_target_updates": 97}, "done": false, "episodes_total": 1962, "training_iteration": 51, "trial_id": "2058a_00000", "date": "2024-04-17_08-30-37", "timestamp": 1713342637, "time_this_iter_s": 245.27623963356018, "time_total_s": 11410.760587453842, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 11410.760587453842, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 12.814655172413794, "ram_util_percent": 18.337068965517243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.060990359634160995, "cur_lr": 0.01}, "td_error": [1.4356335401535034, 0.3768123388290405, 0.9447467923164368, 1.4356322288513184, 1.4356331825256348, 0.944747805595398, 1.435636281967163, 1.4356322288513184, 1.4908274412155151, 1.435632586479187, 2.634948492050171, 1.4356367588043213, 1.4363781213760376, 1.4356366395950317, 1.435639500617981, 1.4356353282928467, 1.4356378316879272, 1.4356321096420288, 1.4356322288513184, 1.435633897781372, 1.4356331825256348, 1.4356328248977661, 1.4356321096420288, 1.435636281967163, 1.4356340169906616, 1.435634970664978, 1.5323708057403564, 0.9447473287582397, 0.9447490572929382, 1.435632586479187, 1.435632586479187, 1.4356354475021362, 1.4356321096420288, 1.4356359243392944, 1.4356342554092407, 1.4356342554092407, 0.9447469711303711, 0.9447484016418457, 1.3203604221343994, 1.4356378316879272, 1.4356330633163452, 1.435636043548584, 1.4356443881988525, 1.435634970664978, 0.7483091950416565, 1.5321511030197144, 1.435633897781372, 1.4356324672698975, 1.4356321096420288, 1.4356361627578735, 1.4356322288513184, 1.4356354475021362, 1.435634732246399, 1.4356591701507568, 1.4356322288513184, 0.9447476863861084, 1.4356414079666138, 1.3468890190124512, 1.4356348514556885, 1.4356378316879272, 0.9447463750839233, 1.4356354475021362, 1.435633897781372, 0.9447516202926636, 0.944747805595398, 1.4356353282928467, 1.4356330633163452, 1.4356335401535034, 1.4356364011764526, 1.43563973903656, 0.944747805595398, 1.4356330633163452, 1.4356346130371094, 1.4356398582458496, 0.9447476863861084, 1.435660481452942, 1.6156715154647827, 1.4356342554092407], "mean_td_error": 1.3559911251068115, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1275.0, "diff_num_grad_updates_vs_sampler_policy": 1274.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 99450, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 99450, "last_target_update_ts": 52000, "num_target_updates": 99}, "sampler_results": {"episode_reward_max": 2.489666705181324, "episode_reward_min": -19.99975239909352, "episode_reward_mean": -2.0263818157604767, "episode_len_mean": 25.05, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0002637627023845996, 0.0002625144083826734, -9.99973844452475, 0.00026015056616276956, -9.999735877510192, -9.999736947538077, 0.00026156679309935883, 0.00026033915336681296, 0.0002593959101562515, 0.00026708684234438384, 0.00026574009283143616, 0.00026465703943143144, 0.00026315335517210794, 0.23223038829720066, 0.07148865010707857, -9.99973572643925, 0.0002632022929415139, 0.00026171504580425957, 0.00025754435455702736, 2.489666705181324, 0.04665951158746901, 0.0002540972603696425, -9.999747071333696, 0.00025728062797010964, 0.10848158357250162, 0.00023470916334189323, -9.999746190789484, 0.18552868696122612, 0.08920864337038342, 0.00023649574308932426, -19.999744268704504, 0.0002545472110702712, 0.00025346120930915813, 0.00025715578249706705, 0.0002355635348197439, -9.999745271648836, 0.0002535536200046046, 0.00025247606258967705, 0.00025896105010061646, 0.00023721004272913472, 0.0002564994771157183, 0.0777100341487453, 0.0002542945419849806, 0.00025801414768416935, 0.00025684404471857243, 1.3141558248133611, -9.999745570966173, -19.999746740215045, 0.00026106394825701156, 0.00025966440784843363, 0.0002584793233576973, -9.9997632292043, 0.00025602685604942716, 0.0002548402476665029, -9.999739513874847, 0.0002595417112282891, 0.00025815839931667513, 0.00025698699057808333, 0.04335282716547514, 0.00025468790864476666, 0.0002518561723980042, 0.0002508062079844841, 0.00024955162673304766, -9.99975144103601, -19.99975239909352, 0.23032973282238572, 0.000250822806136263, 0.0002495680592347154, 0.00024857516685138607, 0.00024761873061125, 0.0002523978498248439, 0.0002511273344292949, 0.00025012202162977, 0.0002491536664640712, 0.0002477970843566053, 0.0002514209348103027, -9.999749839688421, 0.0002491626111848138, 0.05383827337143904, 0.06895822089909236, 0.00025322419446607164, 0.00025194536696583245, 0.7115039041417826, 0.00024996264304707674, 0.0002485972634640143, -9.99974781788515, 0.11941550333213656, 0.0002499314141461555, -9.99975106426646, 0.0002479764271626875, 0.00025375174917401273, 0.0002526859559116615, 0.6264620735511026, 0.0002504178269568582, 0.0002494471841567873, 0.00025351365291355083, 0.17039451257816582, 0.701608545085152, -9.999749828781987, 0.000249170646974028], "episode_lengths": [25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 23, 25, 26, 25, 25, 23, 26, 25, 25, 23, 27, 25, 25, 25, 23, 26, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 26, 27, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 23, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 421.7415996745865, "mean_inference_ms": 2.1021241295486224, "mean_action_processing_ms": 0.1440763627609844, "mean_env_wait_ms": 1.7795009951671323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009899139404296875, "StateBufferConnector_ms": 0.006314277648925781, "ViewRequirementAgentConnector_ms": 0.1769402027130127}}, "episode_reward_max": 2.489666705181324, "episode_reward_min": -19.99975239909352, "episode_reward_mean": -2.0263818157604767, "episode_len_mean": 25.05, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0002637627023845996, 0.0002625144083826734, -9.99973844452475, 0.00026015056616276956, -9.999735877510192, -9.999736947538077, 0.00026156679309935883, 0.00026033915336681296, 0.0002593959101562515, 0.00026708684234438384, 0.00026574009283143616, 0.00026465703943143144, 0.00026315335517210794, 0.23223038829720066, 0.07148865010707857, -9.99973572643925, 0.0002632022929415139, 0.00026171504580425957, 0.00025754435455702736, 2.489666705181324, 0.04665951158746901, 0.0002540972603696425, -9.999747071333696, 0.00025728062797010964, 0.10848158357250162, 0.00023470916334189323, -9.999746190789484, 0.18552868696122612, 0.08920864337038342, 0.00023649574308932426, -19.999744268704504, 0.0002545472110702712, 0.00025346120930915813, 0.00025715578249706705, 0.0002355635348197439, -9.999745271648836, 0.0002535536200046046, 0.00025247606258967705, 0.00025896105010061646, 0.00023721004272913472, 0.0002564994771157183, 0.0777100341487453, 0.0002542945419849806, 0.00025801414768416935, 0.00025684404471857243, 1.3141558248133611, -9.999745570966173, -19.999746740215045, 0.00026106394825701156, 0.00025966440784843363, 0.0002584793233576973, -9.9997632292043, 0.00025602685604942716, 0.0002548402476665029, -9.999739513874847, 0.0002595417112282891, 0.00025815839931667513, 0.00025698699057808333, 0.04335282716547514, 0.00025468790864476666, 0.0002518561723980042, 0.0002508062079844841, 0.00024955162673304766, -9.99975144103601, -19.99975239909352, 0.23032973282238572, 0.000250822806136263, 0.0002495680592347154, 0.00024857516685138607, 0.00024761873061125, 0.0002523978498248439, 0.0002511273344292949, 0.00025012202162977, 0.0002491536664640712, 0.0002477970843566053, 0.0002514209348103027, -9.999749839688421, 0.0002491626111848138, 0.05383827337143904, 0.06895822089909236, 0.00025322419446607164, 0.00025194536696583245, 0.7115039041417826, 0.00024996264304707674, 0.0002485972634640143, -9.99974781788515, 0.11941550333213656, 0.0002499314141461555, -9.99975106426646, 0.0002479764271626875, 0.00025375174917401273, 0.0002526859559116615, 0.6264620735511026, 0.0002504178269568582, 0.0002494471841567873, 0.00025351365291355083, 0.17039451257816582, 0.701608545085152, -9.999749828781987, 0.000249170646974028], "episode_lengths": [25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 23, 25, 26, 25, 25, 23, 26, 25, 25, 23, 27, 25, 25, 25, 23, 26, 25, 25, 25, 23, 25, 25, 25, 25, 25, 23, 26, 27, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 23, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 421.7415996745865, "mean_inference_ms": 2.1021241295486224, "mean_action_processing_ms": 0.1440763627609844, "mean_env_wait_ms": 1.7795009951671323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009899139404296875, "StateBufferConnector_ms": 0.006314277648925781, "ViewRequirementAgentConnector_ms": 0.1769402027130127}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 99450, "num_env_steps_sampled": 52000, "num_env_steps_trained": 99450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.45801060014276, "num_env_steps_trained_throughput_per_sec": 8.693120670278383, "timesteps_total": 52000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 7935.782, "sample_time_ms": 7871.9, "load_time_ms": 0.256, "load_throughput": 304189.411, "learn_time_ms": 13.586, "learn_throughput": 5741.155, "synch_weights_time_ms": 11.691}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 99450, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 99450, "last_target_update_ts": 52000, "num_target_updates": 99}, "done": false, "episodes_total": 2002, "training_iteration": 52, "trial_id": "2058a_00000", "date": "2024-04-17_08-34-22", "timestamp": 1713342862, "time_this_iter_s": 224.32415771484375, "time_total_s": 11635.084745168686, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 11635.084745168686, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 13.305956112852666, "ram_util_percent": 18.450156739811913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03041541390120983, "cur_lr": 0.01}, "td_error": [1.3981801271438599, 1.3981733322143555, 1.3981797695159912, 1.3981869220733643, 1.3981733322143555, 0.9465720653533936, 1.3981738090515137, 1.3981728553771973, 1.3981738090515137, 1.3981726169586182, 1.3981740474700928, 1.3981726169586182, 1.398303508758545, 1.3981736898422241, 1.3981753587722778, 1.398174524307251, 1.3981741666793823, 1.3981733322143555, 1.3981741666793823, 1.398173451423645, 1.3981746435165405, 1.613627552986145, 0.9465705156326294, 1.3981753587722778, 2.6545963287353516, 1.3981736898422241, 1.398173451423645, 1.3981730937957764, 1.3981754779815674, 1.398173213005066, 1.39817476272583, 1.3981728553771973, 0.9465705156326294, 0.9465717673301697, 1.3981748819351196, 1.3981735706329346, 1.3981724977493286, 1.398173213005066, 1.3981785774230957, 1.3916786909103394, 0.9465707540512085, 1.5244306325912476, 1.3981738090515137, 1.3981808423995972, 1.3981746435165405, 1.3981736898422241, 1.3981753587722778, 1.3981728553771973, 0.946570634841919, 1.3981733322143555, 1.398173451423645, 1.3981739282608032, 1.398174524307251, 1.398175597190857, 1.3981738090515137, 1.398173213005066, 1.398173213005066, 1.3981727361679077, 1.5109883546829224, 1.3981735706329346, 1.3981730937957764, 1.3981738090515137, 1.3981746435165405, 1.3981733322143555, 0.946570634841919, 0.9465718865394592, 2.652477264404297, 1.7965718507766724, 0.9465704560279846, 0.946570634841919, 1.3981742858886719, 1.5109732151031494, 1.7917823791503906, 1.3981724977493286, 1.5845131874084473, 1.7720319032669067, 1.3981735706329346, 1.3981757164001465], "mean_td_error": 1.3969930410385132, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1300.0, "diff_num_grad_updates_vs_sampler_policy": 1299.0}}, "num_env_steps_sampled": 53000, "num_env_steps_trained": 101400, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 101400, "last_target_update_ts": 52520, "num_target_updates": 100}, "sampler_results": {"episode_reward_max": 1.3141558248133611, "episode_reward_min": -19.99975239909352, "episode_reward_mean": -2.0062078866673305, "episode_len_mean": 25.13, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00025896105010061646, 0.00023721004272913472, 0.0002564994771157183, 0.0777100341487453, 0.0002542945419849806, 0.00025801414768416935, 0.00025684404471857243, 1.3141558248133611, -9.999745570966173, -19.999746740215045, 0.00026106394825701156, 0.00025966440784843363, 0.0002584793233576973, -9.9997632292043, 0.00025602685604942716, 0.0002548402476665029, -9.999739513874847, 0.0002595417112282891, 0.00025815839931667513, 0.00025698699057808333, 0.04335282716547514, 0.00025468790864476666, 0.0002518561723980042, 0.0002508062079844841, 0.00024955162673304766, -9.99975144103601, -19.99975239909352, 0.23032973282238572, 0.000250822806136263, 0.0002495680592347154, 0.00024857516685138607, 0.00024761873061125, 0.0002523978498248439, 0.0002511273344292949, 0.00025012202162977, 0.0002491536664640712, 0.0002477970843566053, 0.0002514209348103027, -9.999749839688421, 0.0002491626111848138, 0.05383827337143904, 0.06895822089909236, 0.00025322419446607164, 0.00025194536696583245, 0.7115039041417826, 0.00024996264304707674, 0.0002485972634640143, -9.99974781788515, 0.11941550333213656, 0.0002499314141461555, -9.99975106426646, 0.0002479764271626875, 0.00025375174917401273, 0.0002526859559116615, 0.6264620735511026, 0.0002504178269568582, 0.0002494471841567873, 0.00025351365291355083, 0.17039451257816582, 0.701608545085152, -9.999749828781987, 0.000249170646974028, 0.000246262760720358, 0.0002450110286555003, 0.00024366249136217232, 0.0002423993048336123, 0.00024116721061968017, -9.91085566338681, 0.00024509591737366485, 0.00024374644801085615, 0.136019378909343, 0.000241295857340132, 0.00024652974439418046, 0.00024516448337185987, 0.00024388571725435582, 0.00024263850330796642, 0.08809386976170283, -9.316614142610385, 0.000244479198758341, 0.00024320755261807243, -9.193768719700772, 0.00024100076151042997, -9.999752676784649, 0.00024594772249669647, 0.00024466079446107907, 0.00024340566006190016, 0.00024236678667788542, 0.00024663259682558157, -9.999754620582458, 0.00024402455227589176, 0.00024275761891633595, 0.10566617487198542, 0.0002480874133641807, -9.999753182793736, -9.86446975777279, -9.922607424105916, -7.002466048110432, 0.00024686534031739756, 0.12278552621530608, 0.0002444392988116037], "episode_lengths": [25, 23, 25, 25, 25, 25, 25, 23, 26, 27, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 23, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.1041976768774, "mean_inference_ms": 2.1032268804073415, "mean_action_processing_ms": 0.14409126350743995, "mean_env_wait_ms": 1.749308366151861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009985923767089844, "StateBufferConnector_ms": 0.006616115570068359, "ViewRequirementAgentConnector_ms": 0.1771526336669922}}, "episode_reward_max": 1.3141558248133611, "episode_reward_min": -19.99975239909352, "episode_reward_mean": -2.0062078866673305, "episode_len_mean": 25.13, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00025896105010061646, 0.00023721004272913472, 0.0002564994771157183, 0.0777100341487453, 0.0002542945419849806, 0.00025801414768416935, 0.00025684404471857243, 1.3141558248133611, -9.999745570966173, -19.999746740215045, 0.00026106394825701156, 0.00025966440784843363, 0.0002584793233576973, -9.9997632292043, 0.00025602685604942716, 0.0002548402476665029, -9.999739513874847, 0.0002595417112282891, 0.00025815839931667513, 0.00025698699057808333, 0.04335282716547514, 0.00025468790864476666, 0.0002518561723980042, 0.0002508062079844841, 0.00024955162673304766, -9.99975144103601, -19.99975239909352, 0.23032973282238572, 0.000250822806136263, 0.0002495680592347154, 0.00024857516685138607, 0.00024761873061125, 0.0002523978498248439, 0.0002511273344292949, 0.00025012202162977, 0.0002491536664640712, 0.0002477970843566053, 0.0002514209348103027, -9.999749839688421, 0.0002491626111848138, 0.05383827337143904, 0.06895822089909236, 0.00025322419446607164, 0.00025194536696583245, 0.7115039041417826, 0.00024996264304707674, 0.0002485972634640143, -9.99974781788515, 0.11941550333213656, 0.0002499314141461555, -9.99975106426646, 0.0002479764271626875, 0.00025375174917401273, 0.0002526859559116615, 0.6264620735511026, 0.0002504178269568582, 0.0002494471841567873, 0.00025351365291355083, 0.17039451257816582, 0.701608545085152, -9.999749828781987, 0.000249170646974028, 0.000246262760720358, 0.0002450110286555003, 0.00024366249136217232, 0.0002423993048336123, 0.00024116721061968017, -9.91085566338681, 0.00024509591737366485, 0.00024374644801085615, 0.136019378909343, 0.000241295857340132, 0.00024652974439418046, 0.00024516448337185987, 0.00024388571725435582, 0.00024263850330796642, 0.08809386976170283, -9.316614142610385, 0.000244479198758341, 0.00024320755261807243, -9.193768719700772, 0.00024100076151042997, -9.999752676784649, 0.00024594772249669647, 0.00024466079446107907, 0.00024340566006190016, 0.00024236678667788542, 0.00024663259682558157, -9.999754620582458, 0.00024402455227589176, 0.00024275761891633595, 0.10566617487198542, 0.0002480874133641807, -9.999753182793736, -9.86446975777279, -9.922607424105916, -7.002466048110432, 0.00024686534031739756, 0.12278552621530608, 0.0002444392988116037], "episode_lengths": [25, 23, 25, 25, 25, 25, 25, 23, 26, 27, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 23, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.1041976768774, "mean_inference_ms": 2.1032268804073415, "mean_action_processing_ms": 0.14409126350743995, "mean_env_wait_ms": 1.749308366151861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009985923767089844, "StateBufferConnector_ms": 0.006616115570068359, "ViewRequirementAgentConnector_ms": 0.1771526336669922}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 101400, "num_env_steps_sampled": 53000, "num_env_steps_trained": 101400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.888068804585261, "num_env_steps_trained_throughput_per_sec": 11.481734168941259, "timesteps_total": 53000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 53000, "timers": {"training_iteration_time_ms": 6820.717, "sample_time_ms": 6758.84, "load_time_ms": 0.233, "load_throughput": 334823.162, "learn_time_ms": 12.976, "learn_throughput": 6010.975, "synch_weights_time_ms": 10.707}, "counters": {"num_env_steps_sampled": 53000, "num_env_steps_trained": 101400, "num_agent_steps_sampled": 53000, "num_agent_steps_trained": 101400, "last_target_update_ts": 52520, "num_target_updates": 100}, "done": false, "episodes_total": 2040, "training_iteration": 53, "trial_id": "2058a_00000", "date": "2024-04-17_08-37-11", "timestamp": 1713343031, "time_this_iter_s": 169.84637188911438, "time_total_s": 11804.9311170578, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 11804.9311170578, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 16.525619834710746, "ram_util_percent": 18.55413223140496}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.06190173327922821, "cur_lr": 0.01}, "td_error": [0.9270416498184204, 1.376947283744812, 1.3769471645355225, 1.376947283744812, 0.7661673426628113, 1.3769471645355225, 1.3769471645355225, 1.3769471645355225, 1.376947283744812, 1.3769471645355225, 1.376947283744812, 1.376947283744812, 1.3769471645355225, 0.9270162582397461, 1.3769410848617554, 1.3769471645355225, 0.9270407557487488, 1.624695062637329, 1.3769471645355225, 1.376947283744812, 1.3769471645355225, 0.9270411133766174, 1.3769471645355225, 1.3769471645355225, 1.376947283744812, 1.376947045326233, 1.3769471645355225, 0.9270395040512085, 0.9270418882369995, 0.7991651296615601, 1.3769471645355225, 1.376947283744812, 1.3769474029541016, 1.4958940744400024, 0.9270419478416443, 1.376947283744812, 1.376947283744812, 1.3494889736175537, 1.3769471645355225, 1.3769474029541016, 2.990020751953125, 1.376947283744812, 1.376947283744812, 1.3769471645355225, 1.3769474029541016, 0.7285633683204651, 1.6078758239746094, 1.3769471645355225, 1.3769474029541016, 1.3769471645355225, 1.376947283744812, 1.376947283744812, 1.3769471645355225, 1.376947283744812, 1.4960631132125854, 1.376947283744812, 1.376947283744812, 0.9270414710044861, 1.8418866395950317, 1.376947283744812, 0.9270416498184204, 1.376947283744812, 1.376947283744812, 1.3769471645355225, 0.9270415306091309, 1.376947283744812, 1.376947283744812, 1.3769471645355225, 0.9270401000976562, 1.376947283744812, 1.376947283744812, 1.376947283744812, 1.376947283744812, 1.3769471645355225, 1.3769471645355225, 0.9250347018241882, 1.3769471645355225, 1.6077172756195068], "mean_td_error": 1.322590947151184, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1325.0, "diff_num_grad_updates_vs_sampler_policy": 1324.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 103350, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 103350, "last_target_update_ts": 53560, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": 2.2872981878558427, "episode_reward_min": -19.999759849477304, "episode_reward_mean": -1.6485269738140471, "episode_len_mean": 25.02, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.06895822089909236, 0.00025322419446607164, 0.00025194536696583245, 0.7115039041417826, 0.00024996264304707674, 0.0002485972634640143, -9.99974781788515, 0.11941550333213656, 0.0002499314141461555, -9.99975106426646, 0.0002479764271626875, 0.00025375174917401273, 0.0002526859559116615, 0.6264620735511026, 0.0002504178269568582, 0.0002494471841567873, 0.00025351365291355083, 0.17039451257816582, 0.701608545085152, -9.999749828781987, 0.000249170646974028, 0.000246262760720358, 0.0002450110286555003, 0.00024366249136217232, 0.0002423993048336123, 0.00024116721061968017, -9.91085566338681, 0.00024509591737366485, 0.00024374644801085615, 0.136019378909343, 0.000241295857340132, 0.00024652974439418046, 0.00024516448337185987, 0.00024388571725435582, 0.00024263850330796642, 0.08809386976170283, -9.316614142610385, 0.000244479198758341, 0.00024320755261807243, -9.193768719700772, 0.00024100076151042997, -9.999752676784649, 0.00024594772249669647, 0.00024466079446107907, 0.00024340566006190016, 0.00024236678667788542, 0.00024663259682558157, -9.999754620582458, 0.00024402455227589176, 0.00024275761891633595, 0.10566617487198542, 0.0002480874133641807, -9.999753182793736, -9.86446975777279, -9.922607424105916, -7.002466048110432, 0.00024686534031739756, 0.12278552621530608, 0.0002444392988116037, -19.999759849477304, -9.941614117822748, 0.00021899385618904271, 0.0002370021671924307, 0.00023601588790058052, 0.00024027487717755803, 0.00023905003140268501, 0.08929418005902111, 0.19030006741440156, 0.17263754631165384, 0.05177165902318187, 1.8556795491680527, 0.0002384999834805702, 0.00023750122640138783, 0.00023639110578650179, 0.00023976852380527721, 0.0002197039056197134, 0.00023776725442561545, 0.000236774611214124, 0.0002356712572252162, 0.00024112057829105504, -9.999779062082224, 0.00023909676763554796, 0.00023809301720063606, 0.00023697737030252636, 0.0002405554544284224, 0.00023932775406119544, 0.00021930163562734135, -9.999762662999395, 0.00023634477074480618, 0.00024303650645377366, 0.00024200077502925993, 0.00024075831761711058, 0.00022060722268200204, -7.216567697360064, 0.00024316806661511426, 0.00024192816404058348, 2.2872981878558427, 0.00023967393851969477, 0.00021961758253947284, 0.00023767424136753493], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 25, 27, 26, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.435796837624, "mean_inference_ms": 2.105362869212668, "mean_action_processing_ms": 0.14414404689372864, "mean_env_wait_ms": 1.7173342351219938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010315656661987305, "StateBufferConnector_ms": 0.0068225860595703125, "ViewRequirementAgentConnector_ms": 0.17884516716003418}}, "episode_reward_max": 2.2872981878558427, "episode_reward_min": -19.999759849477304, "episode_reward_mean": -1.6485269738140471, "episode_len_mean": 25.02, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.06895822089909236, 0.00025322419446607164, 0.00025194536696583245, 0.7115039041417826, 0.00024996264304707674, 0.0002485972634640143, -9.99974781788515, 0.11941550333213656, 0.0002499314141461555, -9.99975106426646, 0.0002479764271626875, 0.00025375174917401273, 0.0002526859559116615, 0.6264620735511026, 0.0002504178269568582, 0.0002494471841567873, 0.00025351365291355083, 0.17039451257816582, 0.701608545085152, -9.999749828781987, 0.000249170646974028, 0.000246262760720358, 0.0002450110286555003, 0.00024366249136217232, 0.0002423993048336123, 0.00024116721061968017, -9.91085566338681, 0.00024509591737366485, 0.00024374644801085615, 0.136019378909343, 0.000241295857340132, 0.00024652974439418046, 0.00024516448337185987, 0.00024388571725435582, 0.00024263850330796642, 0.08809386976170283, -9.316614142610385, 0.000244479198758341, 0.00024320755261807243, -9.193768719700772, 0.00024100076151042997, -9.999752676784649, 0.00024594772249669647, 0.00024466079446107907, 0.00024340566006190016, 0.00024236678667788542, 0.00024663259682558157, -9.999754620582458, 0.00024402455227589176, 0.00024275761891633595, 0.10566617487198542, 0.0002480874133641807, -9.999753182793736, -9.86446975777279, -9.922607424105916, -7.002466048110432, 0.00024686534031739756, 0.12278552621530608, 0.0002444392988116037, -19.999759849477304, -9.941614117822748, 0.00021899385618904271, 0.0002370021671924307, 0.00023601588790058052, 0.00024027487717755803, 0.00023905003140268501, 0.08929418005902111, 0.19030006741440156, 0.17263754631165384, 0.05177165902318187, 1.8556795491680527, 0.0002384999834805702, 0.00023750122640138783, 0.00023639110578650179, 0.00023976852380527721, 0.0002197039056197134, 0.00023776725442561545, 0.000236774611214124, 0.0002356712572252162, 0.00024112057829105504, -9.999779062082224, 0.00023909676763554796, 0.00023809301720063606, 0.00023697737030252636, 0.0002405554544284224, 0.00023932775406119544, 0.00021930163562734135, -9.999762662999395, 0.00023634477074480618, 0.00024303650645377366, 0.00024200077502925993, 0.00024075831761711058, 0.00022060722268200204, -7.216567697360064, 0.00024316806661511426, 0.00024192816404058348, 2.2872981878558427, 0.00023967393851969477, 0.00021961758253947284, 0.00023767424136753493], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 25, 27, 26, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.435796837624, "mean_inference_ms": 2.105362869212668, "mean_action_processing_ms": 0.14414404689372864, "mean_env_wait_ms": 1.7173342351219938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010315656661987305, "StateBufferConnector_ms": 0.0068225860595703125, "ViewRequirementAgentConnector_ms": 0.17884516716003418}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 103350, "num_env_steps_sampled": 54000, "num_env_steps_trained": 103350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.220914431753722, "num_env_steps_trained_throughput_per_sec": 10.180783141919758, "timesteps_total": 54000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 8913.373, "sample_time_ms": 8850.398, "load_time_ms": 0.245, "load_throughput": 317904.686, "learn_time_ms": 12.862, "learn_throughput": 6064.504, "synch_weights_time_ms": 12.105}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 103350, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 103350, "last_target_update_ts": 53560, "num_target_updates": 102}, "done": false, "episodes_total": 2081, "training_iteration": 54, "trial_id": "2058a_00000", "date": "2024-04-17_08-40-23", "timestamp": 1713343223, "time_this_iter_s": 191.54768228530884, "time_total_s": 11996.47879934311, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 11996.47879934311, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 15.912454212454215, "ram_util_percent": 18.65934065934066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02743000164628029, "cur_lr": 0.01}, "td_error": [1.3684180974960327, 3.1368913650512695, 1.8066318035125732, 1.3684180974960327, 1.3684180974960327, 1.368418574333191, 1.3684189319610596, 1.3687527179718018, 0.9177604913711548, 0.917760968208313, 1.4965389966964722, 1.629310131072998, 1.36841881275177, 1.3684183359146118, 0.9177595376968384, 1.3684234619140625, 1.368420958518982, 1.3684191703796387, 1.368418574333191, 1.3684178590774536, 1.3684196472167969, 1.0699151754379272, 1.3684184551239014, 1.3684179782867432, 2.8046469688415527, 1.5693814754486084, 1.3684189319610596, 1.3684197664260864, 1.368422269821167, 2.797823667526245, 1.3684231042861938, 1.3684190511703491, 1.3362557888031006, 1.3684180974960327, 1.36841881275177, 1.3684190511703491, 1.3684196472167969, 1.3684184551239014, 1.3684213161468506, 1.368418574333191, 1.3684179782867432, 1.3684180974960327, 1.3684191703796387, 0.9177609086036682, 1.3684180974960327, 3.5645999908447266, 1.52860426902771, 1.3684184551239014, 1.6091388463974, 1.3684182167053223, 1.9438306093215942, 1.3684184551239014, 1.3684184551239014, 1.3684191703796387, 1.368418574333191, 1.495956540107727, 1.3684189319610596, 1.3684180974960327, 1.3684184551239014, 1.3684191703796387, 1.4960262775421143, 1.3684192895889282, 3.2227745056152344, 1.368420124053955, 1.3684197664260864, 1.3684183359146118, 1.3684180974960327, 1.3684184551239014, 1.3684179782867432, 1.3684182167053223, 1.3684192895889282, 1.3684214353561401, 0.9177602529525757, 1.516248106956482, 1.3684208393096924, 1.3684316873550415, 0.9177607297897339, 1.368418574333191], "mean_td_error": 1.4717248678207397, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1350.0, "diff_num_grad_updates_vs_sampler_policy": 1349.0}}, "num_env_steps_sampled": 55000, "num_env_steps_trained": 105300, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 105300, "last_target_update_ts": 54600, "num_target_updates": 104}, "sampler_results": {"episode_reward_max": 2.2872981878558427, "episode_reward_min": -19.999759849477304, "episode_reward_mean": -2.062276835343866, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.193768719700772, 0.00024100076151042997, -9.999752676784649, 0.00024594772249669647, 0.00024466079446107907, 0.00024340566006190016, 0.00024236678667788542, 0.00024663259682558157, -9.999754620582458, 0.00024402455227589176, 0.00024275761891633595, 0.10566617487198542, 0.0002480874133641807, -9.999753182793736, -9.86446975777279, -9.922607424105916, -7.002466048110432, 0.00024686534031739756, 0.12278552621530608, 0.0002444392988116037, -19.999759849477304, -9.941614117822748, 0.00021899385618904271, 0.0002370021671924307, 0.00023601588790058052, 0.00024027487717755803, 0.00023905003140268501, 0.08929418005902111, 0.19030006741440156, 0.17263754631165384, 0.05177165902318187, 1.8556795491680527, 0.0002384999834805702, 0.00023750122640138783, 0.00023639110578650179, 0.00023976852380527721, 0.0002197039056197134, 0.00023776725442561545, 0.000236774611214124, 0.0002356712572252162, 0.00024112057829105504, -9.999779062082224, 0.00023909676763554796, 0.00023809301720063606, 0.00023697737030252636, 0.0002405554544284224, 0.00023932775406119544, 0.00021930163562734135, -9.999762662999395, 0.00023634477074480618, 0.00024303650645377366, 0.00024200077502925993, 0.00024075831761711058, 0.00022060722268200204, -7.216567697360064, 0.00024316806661511426, 0.00024192816404058348, 2.2872981878558427, 0.00023967393851969477, 0.00021961758253947284, 0.00023767424136753493, -9.999765080334178, 0.00023386480351527105, 0.00023300815641517052, 0.00023206677583882337, 0.00023123621500978353, 0.00023510384346583712, -9.999765952494812, 0.00023318943471696178, 0.0002322465917827859, 0.00023141474549887047, 0.00023532310495537827, 0.00023445576147082726, 0.00023350267165228198, 0.00023266181836885185, 1.248537925283943, 0.00023460973697859197, 0.06516584210790842, 0.0002328901186652684, 0.00023205366386750616, 0.00023136780174069888, 0.19902670551066962, 0.00023505687404925662, -9.999765901497389, -19.493739145093812, -9.999767429061857, 0.00023524540996523987, 0.00023418771425151537, 0.0002333287043569847, 0.00023238473717779003, -9.99976844801163, 0.0002377417016207141, 0.00023662933703832924, 0.0002355591871567971, -9.999765308236691, 0.00023373511369499477, 0.00023668237291736048, 0.00023557987642760362, 0.00023451917745076275, -9.999766344732459], "episode_lengths": [26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 25, 27, 26, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.72862507015043, "mean_inference_ms": 2.1076466878780384, "mean_action_processing_ms": 0.1442435660366536, "mean_env_wait_ms": 1.6882867984351526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010415077209472656, "StateBufferConnector_ms": 0.006570577621459961, "ViewRequirementAgentConnector_ms": 0.17781662940979004}}, "episode_reward_max": 2.2872981878558427, "episode_reward_min": -19.999759849477304, "episode_reward_mean": -2.062276835343866, "episode_len_mean": 25.06, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.193768719700772, 0.00024100076151042997, -9.999752676784649, 0.00024594772249669647, 0.00024466079446107907, 0.00024340566006190016, 0.00024236678667788542, 0.00024663259682558157, -9.999754620582458, 0.00024402455227589176, 0.00024275761891633595, 0.10566617487198542, 0.0002480874133641807, -9.999753182793736, -9.86446975777279, -9.922607424105916, -7.002466048110432, 0.00024686534031739756, 0.12278552621530608, 0.0002444392988116037, -19.999759849477304, -9.941614117822748, 0.00021899385618904271, 0.0002370021671924307, 0.00023601588790058052, 0.00024027487717755803, 0.00023905003140268501, 0.08929418005902111, 0.19030006741440156, 0.17263754631165384, 0.05177165902318187, 1.8556795491680527, 0.0002384999834805702, 0.00023750122640138783, 0.00023639110578650179, 0.00023976852380527721, 0.0002197039056197134, 0.00023776725442561545, 0.000236774611214124, 0.0002356712572252162, 0.00024112057829105504, -9.999779062082224, 0.00023909676763554796, 0.00023809301720063606, 0.00023697737030252636, 0.0002405554544284224, 0.00023932775406119544, 0.00021930163562734135, -9.999762662999395, 0.00023634477074480618, 0.00024303650645377366, 0.00024200077502925993, 0.00024075831761711058, 0.00022060722268200204, -7.216567697360064, 0.00024316806661511426, 0.00024192816404058348, 2.2872981878558427, 0.00023967393851969477, 0.00021961758253947284, 0.00023767424136753493, -9.999765080334178, 0.00023386480351527105, 0.00023300815641517052, 0.00023206677583882337, 0.00023123621500978353, 0.00023510384346583712, -9.999765952494812, 0.00023318943471696178, 0.0002322465917827859, 0.00023141474549887047, 0.00023532310495537827, 0.00023445576147082726, 0.00023350267165228198, 0.00023266181836885185, 1.248537925283943, 0.00023460973697859197, 0.06516584210790842, 0.0002328901186652684, 0.00023205366386750616, 0.00023136780174069888, 0.19902670551066962, 0.00023505687404925662, -9.999765901497389, -19.493739145093812, -9.999767429061857, 0.00023524540996523987, 0.00023418771425151537, 0.0002333287043569847, 0.00023238473717779003, -9.99976844801163, 0.0002377417016207141, 0.00023662933703832924, 0.0002355591871567971, -9.999765308236691, 0.00023373511369499477, 0.00023668237291736048, 0.00023557987642760362, 0.00023451917745076275, -9.999766344732459], "episode_lengths": [26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 26, 26, 25, 25, 25, 27, 26, 23, 25, 25, 25, 25, 23, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 422.72862507015043, "mean_inference_ms": 2.1076466878780384, "mean_action_processing_ms": 0.1442435660366536, "mean_env_wait_ms": 1.6882867984351526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010415077209472656, "StateBufferConnector_ms": 0.006570577621459961, "ViewRequirementAgentConnector_ms": 0.17781662940979004}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 105300, "num_env_steps_sampled": 55000, "num_env_steps_trained": 105300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.458870757523478, "num_env_steps_trained_throughput_per_sec": 8.694797977170783, "timesteps_total": 55000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 55000, "timers": {"training_iteration_time_ms": 8978.266, "sample_time_ms": 8914.649, "load_time_ms": 0.234, "load_throughput": 332847.403, "learn_time_ms": 12.739, "learn_throughput": 6123.072, "synch_weights_time_ms": 11.271}, "counters": {"num_env_steps_sampled": 55000, "num_env_steps_trained": 105300, "num_agent_steps_sampled": 55000, "num_agent_steps_trained": 105300, "last_target_update_ts": 54600, "num_target_updates": 104}, "done": false, "episodes_total": 2120, "training_iteration": 55, "trial_id": "2058a_00000", "date": "2024-04-17_08-44-07", "timestamp": 1713343447, "time_this_iter_s": 224.28021264076233, "time_total_s": 12220.759011983871, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 12220.759011983871, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 12.980877742946708, "ram_util_percent": 18.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.015765348449349403, "cur_lr": 0.01}, "td_error": [1.3833547830581665, 1.3833550214767456, 1.383354902267456, 1.3833550214767456, 1.3833550214767456, 1.3833550214767456, 1.383354902267456, 1.383355736732483, 0.9098865985870361, 1.3833550214767456, 1.3833551406860352, 1.3833551406860352, 1.3833550214767456, 1.3833553791046143, 2.5990912914276123, 0.9098862409591675, 1.3833550214767456, 1.3833556175231934, 1.3833550214767456, 1.3833550214767456, 1.6044400930404663, 1.3833550214767456, 1.3833550214767456, 1.3833550214767456, 1.4770491123199463, 1.3833551406860352, 1.6245412826538086, 1.3833551406860352, 1.3833554983139038, 1.3833566904067993, 0.7455998063087463, 1.3833550214767456, 0.9098832607269287, 1.3833550214767456, 0.9098869562149048, 1.3833550214767456, 1.3833550214767456, 1.3833558559417725, 1.3833551406860352, 1.3833552598953247, 0.9098858833312988, 1.3834364414215088, 1.597128987312317, 1.3833551406860352, 1.3833550214767456, 1.3833550214767456, 1.3833550214767456, 1.3835214376449585, 1.3833551406860352, 1.3833550214767456, 1.38356614112854, 1.383354902267456, 0.7271879315376282, 1.4770900011062622, 1.3833553791046143, 1.3833560943603516, 1.383354902267456, 1.3833551406860352, 1.3833547830581665, 1.3833551406860352, 2.8141028881073, 1.3833551406860352, 1.3833550214767456, 1.3833550214767456, 1.3833551406860352, 1.3833551406860352, 0.9098852872848511, 1.383354902267456, 0.9098877310752869, 1.3833550214767456, 1.3833551406860352, 1.3834304809570312, 1.3833550214767456, 1.3833550214767456, 1.3833550214767456, 1.3833551406860352, 1.3833552598953247, 1.3833550214767456], "mean_td_error": 1.3692818880081177, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1375.0, "diff_num_grad_updates_vs_sampler_policy": 1374.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 107250, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 107250, "last_target_update_ts": 55640, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": 2.2872981878558427, "episode_reward_min": -19.493739145093812, "episode_reward_mean": -1.4159614624834247, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00024112057829105504, -9.999779062082224, 0.00023909676763554796, 0.00023809301720063606, 0.00023697737030252636, 0.0002405554544284224, 0.00023932775406119544, 0.00021930163562734135, -9.999762662999395, 0.00023634477074480618, 0.00024303650645377366, 0.00024200077502925993, 0.00024075831761711058, 0.00022060722268200204, -7.216567697360064, 0.00024316806661511426, 0.00024192816404058348, 2.2872981878558427, 0.00023967393851969477, 0.00021961758253947284, 0.00023767424136753493, -9.999765080334178, 0.00023386480351527105, 0.00023300815641517052, 0.00023206677583882337, 0.00023123621500978353, 0.00023510384346583712, -9.999765952494812, 0.00023318943471696178, 0.0002322465917827859, 0.00023141474549887047, 0.00023532310495537827, 0.00023445576147082726, 0.00023350267165228198, 0.00023266181836885185, 1.248537925283943, 0.00023460973697859197, 0.06516584210790842, 0.0002328901186652684, 0.00023205366386750616, 0.00023136780174069888, 0.19902670551066962, 0.00023505687404925662, -9.999765901497389, -19.493739145093812, -9.999767429061857, 0.00023524540996523987, 0.00023418771425151537, 0.0002333287043569847, 0.00023238473717779003, -9.99976844801163, 0.0002377417016207141, 0.00023662933703832924, 0.0002355591871567971, -9.999765308236691, 0.00023373511369499477, 0.00023668237291736048, 0.00023557987642760362, 0.00023451917745076275, -9.999766344732459, 0.0002305551690565527, 0.00022954537774271767, 0.0002286928331024723, 0.00021865998157679636, 0.00022682933435743823, 0.00023073264913920348, 0.00022972130595554896, 0.43482758468510774, 0.00021884205494282738, 0.00022701742871230457, 0.0002310056873844261, 0.0002301422814583781, 0.00022004021969971566, 0.00022825518330770968, 0.00022743999964273801, 0.0002303508951203176, 0.00022949236778616695, 0.00021942134771233006, 0.00022761586951414184, 0.3022707914438912, 0.00023154336544947801, 0.0002306759432061369, 0.0002205483816761477, 0.00022878011906923824, 0.00022796118867353783, 0.11814158016513536, 0.00022993842253932306, 0.00022908296130206643, 0.0002190314883410766, 0.00022721312511381, 0.0002328925883342054, 0.00023220176591674704, 0.00023117753135549346, 0.00023031284280853657, -9.999779797283377, -9.999767288800774, 0.00023187594126923417, 0.00023119112767200014, -9.56197179025179, 0.0002293284533199739], "episode_lengths": [25, 24, 25, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.00936953134544, "mean_inference_ms": 2.1059031160970005, "mean_action_processing_ms": 0.14423861521709097, "mean_env_wait_ms": 1.6599994102297244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010351896286010742, "StateBufferConnector_ms": 0.006705284118652344, "ViewRequirementAgentConnector_ms": 0.17899250984191895}}, "episode_reward_max": 2.2872981878558427, "episode_reward_min": -19.493739145093812, "episode_reward_mean": -1.4159614624834247, "episode_len_mean": 25.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00024112057829105504, -9.999779062082224, 0.00023909676763554796, 0.00023809301720063606, 0.00023697737030252636, 0.0002405554544284224, 0.00023932775406119544, 0.00021930163562734135, -9.999762662999395, 0.00023634477074480618, 0.00024303650645377366, 0.00024200077502925993, 0.00024075831761711058, 0.00022060722268200204, -7.216567697360064, 0.00024316806661511426, 0.00024192816404058348, 2.2872981878558427, 0.00023967393851969477, 0.00021961758253947284, 0.00023767424136753493, -9.999765080334178, 0.00023386480351527105, 0.00023300815641517052, 0.00023206677583882337, 0.00023123621500978353, 0.00023510384346583712, -9.999765952494812, 0.00023318943471696178, 0.0002322465917827859, 0.00023141474549887047, 0.00023532310495537827, 0.00023445576147082726, 0.00023350267165228198, 0.00023266181836885185, 1.248537925283943, 0.00023460973697859197, 0.06516584210790842, 0.0002328901186652684, 0.00023205366386750616, 0.00023136780174069888, 0.19902670551066962, 0.00023505687404925662, -9.999765901497389, -19.493739145093812, -9.999767429061857, 0.00023524540996523987, 0.00023418771425151537, 0.0002333287043569847, 0.00023238473717779003, -9.99976844801163, 0.0002377417016207141, 0.00023662933703832924, 0.0002355591871567971, -9.999765308236691, 0.00023373511369499477, 0.00023668237291736048, 0.00023557987642760362, 0.00023451917745076275, -9.999766344732459, 0.0002305551690565527, 0.00022954537774271767, 0.0002286928331024723, 0.00021865998157679636, 0.00022682933435743823, 0.00023073264913920348, 0.00022972130595554896, 0.43482758468510774, 0.00021884205494282738, 0.00022701742871230457, 0.0002310056873844261, 0.0002301422814583781, 0.00022004021969971566, 0.00022825518330770968, 0.00022743999964273801, 0.0002303508951203176, 0.00022949236778616695, 0.00021942134771233006, 0.00022761586951414184, 0.3022707914438912, 0.00023154336544947801, 0.0002306759432061369, 0.0002205483816761477, 0.00022878011906923824, 0.00022796118867353783, 0.11814158016513536, 0.00022993842253932306, 0.00022908296130206643, 0.0002190314883410766, 0.00022721312511381, 0.0002328925883342054, 0.00023220176591674704, 0.00023117753135549346, 0.00023031284280853657, -9.999779797283377, -9.999767288800774, 0.00023187594126923417, 0.00023119112767200014, -9.56197179025179, 0.0002293284533199739], "episode_lengths": [25, 24, 25, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 26, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.00936953134544, "mean_inference_ms": 2.1059031160970005, "mean_action_processing_ms": 0.14423861521709097, "mean_env_wait_ms": 1.6599994102297244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010351896286010742, "StateBufferConnector_ms": 0.006705284118652344, "ViewRequirementAgentConnector_ms": 0.17899250984191895}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 107250, "num_env_steps_sampled": 56000, "num_env_steps_trained": 107250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.870781289625855, "num_env_steps_trained_throughput_per_sec": 7.548023514770417, "timesteps_total": 56000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 11214.348, "sample_time_ms": 11152.703, "load_time_ms": 0.234, "load_throughput": 333288.215, "learn_time_ms": 12.266, "learn_throughput": 6359.045, "synch_weights_time_ms": 11.496}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 107250, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 107250, "last_target_update_ts": 55640, "num_target_updates": 106}, "done": false, "episodes_total": 2160, "training_iteration": 56, "trial_id": "2058a_00000", "date": "2024-04-17_08-48-26", "timestamp": 1713343706, "time_this_iter_s": 258.3543429374695, "time_total_s": 12479.113354921341, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 12479.113354921341, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 11.619836956521738, "ram_util_percent": 18.87826086956522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0584988035261631, "cur_lr": 0.01}, "td_error": [1.4006993770599365, 1.4006997346878052, 1.400699257850647, 1.4006996154785156, 1.4006997346878052, 1.400699496269226, 1.4006996154785156, 0.9228209853172302, 1.4006996154785156, 1.4006980657577515, 1.400699496269226, 1.4006997346878052, 0.9228175282478333, 1.473731517791748, 1.400699257850647, 1.4006987810134888, 1.4006997346878052, 1.400699496269226, 1.4736837148666382, 1.4006999731063843, 0.38160404562950134, 1.4006996154785156, 1.4006996154785156, 1.4006997346878052, 1.400699496269226, 0.9228108525276184, 1.400699496269226, 1.4006983041763306, 1.4006996154785156, 1.4006998538970947, 1.400699496269226, 1.400697946548462, 1.400699257850647, 1.4006996154785156, 1.4006990194320679, 1.4006997346878052, 1.458871841430664, 1.4006997346878052, 1.4006997346878052, 1.4006766080856323, 1.4006998538970947, 1.4006997346878052, 1.4006987810134888, 1.5855846405029297, 1.4006996154785156, 1.4006991386413574, 1.400699496269226, 1.4006997346878052, 1.4006996154785156, 1.3732948303222656, 1.4006998538970947, 1.4006993770599365, 1.4006997346878052, 1.4006973505020142, 1.6014842987060547, 1.4736905097961426, 1.4006997346878052, 1.4006997346878052, 1.4006997346878052, 2.7322475910186768, 1.4006996154785156, 0.9228174686431885, 1.400699257850647, 1.4006996154785156, 1.4006993770599365, 2.7366013526916504, 0.9228214025497437, 1.4006996154785156, 1.4006996154785156, 1.400696873664856, 1.4006993770599365, 2.7322494983673096, 1.400699496269226, 1.4006997346878052, 0.7112767696380615, 2.733713388442993, 1.400699257850647, 1.4006997346878052], "mean_td_error": 1.4246673583984375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1400.0, "diff_num_grad_updates_vs_sampler_policy": 1399.0}}, "num_env_steps_sampled": 57000, "num_env_steps_trained": 109200, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 109200, "last_target_update_ts": 56680, "num_target_updates": 108}, "sampler_results": {"episode_reward_max": 3.7668079404064803, "episode_reward_min": -19.999783325083204, "episode_reward_mean": -1.7245319299187458, "episode_len_mean": 24.94, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00023136780174069888, 0.19902670551066962, 0.00023505687404925662, -9.999765901497389, -19.493739145093812, -9.999767429061857, 0.00023524540996523987, 0.00023418771425151537, 0.0002333287043569847, 0.00023238473717779003, -9.99976844801163, 0.0002377417016207141, 0.00023662933703832924, 0.0002355591871567971, -9.999765308236691, 0.00023373511369499477, 0.00023668237291736048, 0.00023557987642760362, 0.00023451917745076275, -9.999766344732459, 0.0002305551690565527, 0.00022954537774271767, 0.0002286928331024723, 0.00021865998157679636, 0.00022682933435743823, 0.00023073264913920348, 0.00022972130595554896, 0.43482758468510774, 0.00021884205494282738, 0.00022701742871230457, 0.0002310056873844261, 0.0002301422814583781, 0.00022004021969971566, 0.00022825518330770968, 0.00022743999964273801, 0.0002303508951203176, 0.00022949236778616695, 0.00021942134771233006, 0.00022761586951414184, 0.3022707914438912, 0.00023154336544947801, 0.0002306759432061369, 0.0002205483816761477, 0.00022878011906923824, 0.00022796118867353783, 0.11814158016513536, 0.00022993842253932306, 0.00022908296130206643, 0.0002190314883410766, 0.00022721312511381, 0.0002328925883342054, 0.00023220176591674704, 0.00023117753135549346, 0.00023031284280853657, -9.999779797283377, -9.999767288800774, 0.00023187594126923417, 0.00023119112767200014, -9.56197179025179, 0.0002293284533199739, 0.000226024284498211, 0.00021608254692807107, 3.7668079404064803, 0.00022356578029919408, 0.07500232536324776, 0.26172619404826347, 0.8149267381147348, 0.0002155506663574836, -9.928810938221462, 0.00022291518980917276, 0.00021743033686774234, 0.00021668992503422535, 0.00022494905906080025, 0.00022401888255621128, -9.999776747756293, 0.00021684118107128655, 0.00021610476933708848, 0.00022434366567429079, 0.00022341847877585804, 0.00022265446634782562, 0.00021792650188924085, 0.0002171827129463141, 0.45283836054442494, 0.00022453642638188727, 0.00022376476152254147, 0.00022640535378459732, -9.999783554578956, 0.0002157116094085433, 0.00022393690199517977, -9.999776984860183, -9.999771576958773, 0.08604416848336466, 0.00021764229885320188, 0.00021690044525346546, 0.00022516685742389778, 0.00021926526001787654, 0.00022745462376331233, 0.00022664513761589625, -19.999783325083204, -9.999784061574841], "episode_lengths": [25, 25, 25, 26, 27, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 24, 25, 25, 25, 24, 24, 26, 25, 24, 24, 25, 25, 26, 24, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 24, 25, 24, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.3525793639656, "mean_inference_ms": 2.1111225761122423, "mean_action_processing_ms": 0.14438596106684132, "mean_env_wait_ms": 1.6325004868961384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009758710861206055, "StateBufferConnector_ms": 0.006498098373413086, "ViewRequirementAgentConnector_ms": 0.17905116081237793}}, "episode_reward_max": 3.7668079404064803, "episode_reward_min": -19.999783325083204, "episode_reward_mean": -1.7245319299187458, "episode_len_mean": 24.94, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00023136780174069888, 0.19902670551066962, 0.00023505687404925662, -9.999765901497389, -19.493739145093812, -9.999767429061857, 0.00023524540996523987, 0.00023418771425151537, 0.0002333287043569847, 0.00023238473717779003, -9.99976844801163, 0.0002377417016207141, 0.00023662933703832924, 0.0002355591871567971, -9.999765308236691, 0.00023373511369499477, 0.00023668237291736048, 0.00023557987642760362, 0.00023451917745076275, -9.999766344732459, 0.0002305551690565527, 0.00022954537774271767, 0.0002286928331024723, 0.00021865998157679636, 0.00022682933435743823, 0.00023073264913920348, 0.00022972130595554896, 0.43482758468510774, 0.00021884205494282738, 0.00022701742871230457, 0.0002310056873844261, 0.0002301422814583781, 0.00022004021969971566, 0.00022825518330770968, 0.00022743999964273801, 0.0002303508951203176, 0.00022949236778616695, 0.00021942134771233006, 0.00022761586951414184, 0.3022707914438912, 0.00023154336544947801, 0.0002306759432061369, 0.0002205483816761477, 0.00022878011906923824, 0.00022796118867353783, 0.11814158016513536, 0.00022993842253932306, 0.00022908296130206643, 0.0002190314883410766, 0.00022721312511381, 0.0002328925883342054, 0.00023220176591674704, 0.00023117753135549346, 0.00023031284280853657, -9.999779797283377, -9.999767288800774, 0.00023187594126923417, 0.00023119112767200014, -9.56197179025179, 0.0002293284533199739, 0.000226024284498211, 0.00021608254692807107, 3.7668079404064803, 0.00022356578029919408, 0.07500232536324776, 0.26172619404826347, 0.8149267381147348, 0.0002155506663574836, -9.928810938221462, 0.00022291518980917276, 0.00021743033686774234, 0.00021668992503422535, 0.00022494905906080025, 0.00022401888255621128, -9.999776747756293, 0.00021684118107128655, 0.00021610476933708848, 0.00022434366567429079, 0.00022341847877585804, 0.00022265446634782562, 0.00021792650188924085, 0.0002171827129463141, 0.45283836054442494, 0.00022453642638188727, 0.00022376476152254147, 0.00022640535378459732, -9.999783554578956, 0.0002157116094085433, 0.00022393690199517977, -9.999776984860183, -9.999771576958773, 0.08604416848336466, 0.00021764229885320188, 0.00021690044525346546, 0.00022516685742389778, 0.00021926526001787654, 0.00022745462376331233, 0.00022664513761589625, -19.999783325083204, -9.999784061574841], "episode_lengths": [25, 25, 25, 26, 27, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 24, 25, 25, 25, 24, 24, 26, 25, 24, 24, 25, 25, 26, 24, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 24, 25, 24, 25, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.3525793639656, "mean_inference_ms": 2.1111225761122423, "mean_action_processing_ms": 0.14438596106684132, "mean_env_wait_ms": 1.6325004868961384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009758710861206055, "StateBufferConnector_ms": 0.006498098373413086, "ViewRequirementAgentConnector_ms": 0.17905116081237793}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 109200, "num_env_steps_sampled": 57000, "num_env_steps_trained": 109200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.241296879380825, "num_env_steps_trained_throughput_per_sec": 10.22052891479261, "timesteps_total": 57000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 57000, "timers": {"training_iteration_time_ms": 6823.871, "sample_time_ms": 6762.641, "load_time_ms": 0.241, "load_throughput": 323532.152, "learn_time_ms": 12.59, "learn_throughput": 6195.333, "synch_weights_time_ms": 11.63}, "counters": {"num_env_steps_sampled": 57000, "num_env_steps_trained": 109200, "num_agent_steps_sampled": 57000, "num_agent_steps_trained": 109200, "last_target_update_ts": 56680, "num_target_updates": 108}, "done": false, "episodes_total": 2200, "training_iteration": 57, "trial_id": "2058a_00000", "date": "2024-04-17_08-51-37", "timestamp": 1713343897, "time_this_iter_s": 190.80134415626526, "time_total_s": 12669.914699077606, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 12669.914699077606, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 15.543173431734317, "ram_util_percent": 19.004428044280438}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03974176570773125, "cur_lr": 0.01}, "td_error": [1.382284164428711, 1.3822821378707886, 1.3822821378707886, 1.382282018661499, 1.3822827339172363, 1.3822828531265259, 1.382282018661499, 1.3822821378707886, 1.3822823762893677, 1.382282018661499, 1.3822826147079468, 1.3824808597564697, 1.3822821378707886, 1.382283329963684, 1.3822821378707886, 1.382282018661499, 1.382282018661499, 0.9162889719009399, 1.9127099514007568, 0.34778711199760437, 1.3822821378707886, 1.3822839260101318, 1.3822822570800781, 1.3822827339172363, 1.38228178024292, 1.3822823762893677, 1.3917089700698853, 1.5658624172210693, 1.38228178024292, 1.3822822570800781, 1.3822834491729736, 1.382282018661499, 2.7991878986358643, 1.3822834491729736, 1.3822818994522095, 1.3822821378707886, 1.38228178024292, 1.3822823762893677, 1.3822818994522095, 1.9120092391967773, 1.5897331237792969, 1.3822824954986572, 1.3822826147079468, 0.9162891507148743, 1.382282018661499, 1.589361548423767, 0.9162869453430176, 1.3822823762893677, 1.38228440284729, 1.3822832107543945, 1.8138480186462402, 1.3822839260101318, 1.382282018661499, 1.3822849988937378, 1.3822821378707886, 1.382282018661499, 1.3822824954986572, 1.3822821378707886, 4.10139274597168, 1.382283091545105, 1.382282018661499, 1.3822824954986572, 1.3822822570800781, 1.382284164428711, 1.3822821378707886, 1.739553689956665, 1.4690124988555908, 1.3822821378707886, 1.382282018661499, 1.3822822570800781, 1.3822821378707886, 1.3822822570800781, 1.3822821378707886, 0.7206421494483948, 0.9162884950637817, 1.3822823762893677, 1.38228178024292, 1.3822821378707886], "mean_td_error": 1.4222742319107056, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1425.0, "diff_num_grad_updates_vs_sampler_policy": 1424.0}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 111150, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 111150, "last_target_update_ts": 57720, "num_target_updates": 110}, "sampler_results": {"episode_reward_max": 3.7668079404064803, "episode_reward_min": -19.999783325083204, "episode_reward_mean": -1.444610424614237, "episode_len_mean": 24.64, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0002205483816761477, 0.00022878011906923824, 0.00022796118867353783, 0.11814158016513536, 0.00022993842253932306, 0.00022908296130206643, 0.0002190314883410766, 0.00022721312511381, 0.0002328925883342054, 0.00023220176591674704, 0.00023117753135549346, 0.00023031284280853657, -9.999779797283377, -9.999767288800774, 0.00023187594126923417, 0.00023119112767200014, -9.56197179025179, 0.0002293284533199739, 0.000226024284498211, 0.00021608254692807107, 3.7668079404064803, 0.00022356578029919408, 0.07500232536324776, 0.26172619404826347, 0.8149267381147348, 0.0002155506663574836, -9.928810938221462, 0.00022291518980917276, 0.00021743033686774234, 0.00021668992503422535, 0.00022494905906080025, 0.00022401888255621128, -9.999776747756293, 0.00021684118107128655, 0.00021610476933708848, 0.00022434366567429079, 0.00022341847877585804, 0.00022265446634782562, 0.00021792650188924085, 0.0002171827129463141, 0.45283836054442494, 0.00022453642638188727, 0.00022376476152254147, 0.00022640535378459732, -9.999783554578956, 0.0002157116094085433, 0.00022393690199517977, -9.999776984860183, -9.999771576958773, 0.08604416848336466, 0.00021764229885320188, 0.00021690044525346546, 0.00022516685742389778, 0.00021926526001787654, 0.00022745462376331233, 0.00022664513761589625, -19.999783325083204, -9.999784061574841, 0.00022195877534256022, -9.999796571718464, 0.00021162650022766647, 0.00021095626423978637, 0.0002187958167872498, 0.00022215461002309447, 0.00020361004999134365, 0.00021181194355731383, 0.9535974591615509, -9.99978100628652, 0.00020461088841001584, 0.3352520076588098, 0.0002121901358129535, 0.08917213227933517, 0.07295333282881215, 0.00020406644573418576, 0.00021228526645680225, -9.999788389172279, 0.10115590578407703, 0.00021866250820976526, 0.0002050801772658248, 0.00021333657279008924, 0.05174461267033072, 0.00022062677585651434, 0.0002197601959705143, 0.00022225379977551855, 0.0002037006161939041, -7.369669972484269, 0.0002112356616653278, -9.999780915580379, 0.00022423488257331035, 0.00022346528554616403, 0.00020480675082784015, 0.00021305301473230153, 0.00021237372711050713, 0.03209761078473065, 0.0002241714829268397, 2.4467401239508657, 0.00022250591104278495, 1.2247692081573138, 0.0002122058776157352, 1.4988505547888096], "episode_lengths": [24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 24, 25, 25, 25, 24, 24, 26, 25, 24, 24, 25, 25, 26, 24, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 24, 25, 24, 25, 25, 26, 25, 25, 24, 24, 24, 25, 25, 23, 24, 24, 26, 23, 24, 24, 25, 25, 23, 24, 25, 25, 25, 23, 24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 25, 25, 25, 23, 24, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.8199591520409, "mean_inference_ms": 2.1116041450774348, "mean_action_processing_ms": 0.14437012414353925, "mean_env_wait_ms": 1.6052646381318925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009947538375854492, "StateBufferConnector_ms": 0.006376743316650391, "ViewRequirementAgentConnector_ms": 0.17865276336669922}}, "episode_reward_max": 3.7668079404064803, "episode_reward_min": -19.999783325083204, "episode_reward_mean": -1.444610424614237, "episode_len_mean": 24.64, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0002205483816761477, 0.00022878011906923824, 0.00022796118867353783, 0.11814158016513536, 0.00022993842253932306, 0.00022908296130206643, 0.0002190314883410766, 0.00022721312511381, 0.0002328925883342054, 0.00023220176591674704, 0.00023117753135549346, 0.00023031284280853657, -9.999779797283377, -9.999767288800774, 0.00023187594126923417, 0.00023119112767200014, -9.56197179025179, 0.0002293284533199739, 0.000226024284498211, 0.00021608254692807107, 3.7668079404064803, 0.00022356578029919408, 0.07500232536324776, 0.26172619404826347, 0.8149267381147348, 0.0002155506663574836, -9.928810938221462, 0.00022291518980917276, 0.00021743033686774234, 0.00021668992503422535, 0.00022494905906080025, 0.00022401888255621128, -9.999776747756293, 0.00021684118107128655, 0.00021610476933708848, 0.00022434366567429079, 0.00022341847877585804, 0.00022265446634782562, 0.00021792650188924085, 0.0002171827129463141, 0.45283836054442494, 0.00022453642638188727, 0.00022376476152254147, 0.00022640535378459732, -9.999783554578956, 0.0002157116094085433, 0.00022393690199517977, -9.999776984860183, -9.999771576958773, 0.08604416848336466, 0.00021764229885320188, 0.00021690044525346546, 0.00022516685742389778, 0.00021926526001787654, 0.00022745462376331233, 0.00022664513761589625, -19.999783325083204, -9.999784061574841, 0.00022195877534256022, -9.999796571718464, 0.00021162650022766647, 0.00021095626423978637, 0.0002187958167872498, 0.00022215461002309447, 0.00020361004999134365, 0.00021181194355731383, 0.9535974591615509, -9.99978100628652, 0.00020461088841001584, 0.3352520076588098, 0.0002121901358129535, 0.08917213227933517, 0.07295333282881215, 0.00020406644573418576, 0.00021228526645680225, -9.999788389172279, 0.10115590578407703, 0.00021866250820976526, 0.0002050801772658248, 0.00021333657279008924, 0.05174461267033072, 0.00022062677585651434, 0.0002197601959705143, 0.00022225379977551855, 0.0002037006161939041, -7.369669972484269, 0.0002112356616653278, -9.999780915580379, 0.00022423488257331035, 0.00022346528554616403, 0.00020480675082784015, 0.00021305301473230153, 0.00021237372711050713, 0.03209761078473065, 0.0002241714829268397, 2.4467401239508657, 0.00022250591104278495, 1.2247692081573138, 0.0002122058776157352, 1.4988505547888096], "episode_lengths": [24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 24, 24, 25, 25, 25, 24, 24, 26, 25, 24, 24, 25, 25, 26, 24, 24, 25, 25, 25, 24, 24, 25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 24, 25, 24, 25, 25, 26, 25, 25, 24, 24, 24, 25, 25, 23, 24, 24, 26, 23, 24, 24, 25, 25, 23, 24, 25, 25, 25, 23, 24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 25, 25, 25, 23, 24, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 423.8199591520409, "mean_inference_ms": 2.1116041450774348, "mean_action_processing_ms": 0.14437012414353925, "mean_env_wait_ms": 1.6052646381318925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009947538375854492, "StateBufferConnector_ms": 0.006376743316650391, "ViewRequirementAgentConnector_ms": 0.17865276336669922}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 111150, "num_env_steps_sampled": 58000, "num_env_steps_trained": 111150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.864922165284627, "num_env_steps_trained_throughput_per_sec": 7.536598222305023, "timesteps_total": 58000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 11228.233, "sample_time_ms": 11163.912, "load_time_ms": 0.238, "load_throughput": 327155.712, "learn_time_ms": 13.262, "learn_throughput": 5881.588, "synch_weights_time_ms": 12.405}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 111150, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 111150, "last_target_update_ts": 57720, "num_target_updates": 110}, "done": false, "episodes_total": 2242, "training_iteration": 58, "trial_id": "2058a_00000", "date": "2024-04-17_08-55-55", "timestamp": 1713344155, "time_this_iter_s": 258.74624371528625, "time_total_s": 12928.660942792892, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 12928.660942792892, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 12.20054347826087, "ram_util_percent": 19.11277173913043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04486871138215065, "cur_lr": 0.01}, "td_error": [1.4004034996032715, 1.400429129600525, 1.400429368019104, 1.4004294872283936, 1.4909013509750366, 0.9303712248802185, 1.4004292488098145, 0.750651478767395, 1.4004294872283936, 1.400429129600525, 1.4004294872283936, 2.7283008098602295, 0.9303691387176514, 2.7286128997802734, 1.4004294872283936, 1.4004294872283936, 1.4004292488098145, 1.4908210039138794, 1.4004292488098145, 3.266700506210327, 1.5768977403640747, 2.728456735610962, 1.4004294872283936, 1.4004290103912354, 1.400429129600525, 2.7287254333496094, 1.4004294872283936, 1.4004288911819458, 1.4004292488098145, 1.400429368019104, 1.4004294872283936, 1.4004290103912354, 1.400429368019104, 0.9303679466247559, 1.400429368019104, 1.4004294872283936, 1.400429129600525, 3.6469345092773438, 1.4004290103912354, 1.400429129600525, 1.4004292488098145, 1.400429368019104, 1.6001081466674805, 1.4004206657409668, 1.400429129600525, 1.4004292488098145, 0.9303708076477051, 1.4004294872283936, 1.4003902673721313, 1.4004287719726562, 1.400429368019104, 4.529786586761475, 1.400428295135498, 1.4004276990890503, 1.4004292488098145, 0.9303698539733887, 1.4004286527633667, 1.4004292488098145, 0.7640072703361511, 1.400429368019104, 1.400429368019104, 1.4004294872283936, 1.4004294872283936, 1.4004294872283936, 1.4004288911819458, 1.4004292488098145, 1.400429368019104, 1.4004294872283936, 1.400429129600525, 1.4004292488098145, 1.400429129600525, 0.9303706884384155, 1.400429368019104, 1.4004290103912354, 1.4004287719726562, 1.4004292488098145, 1.400429368019104, 1.4907346963882446], "mean_td_error": 1.5170342922210693, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1450.0, "diff_num_grad_updates_vs_sampler_policy": 1449.0}}, "num_env_steps_sampled": 59000, "num_env_steps_trained": 113100, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 113100, "last_target_update_ts": 58760, "num_target_updates": 112}, "sampler_results": {"episode_reward_max": 2.4467401239508657, "episode_reward_min": -19.999783325083204, "episode_reward_mean": -1.775119493277312, "episode_len_mean": 24.8, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.45283836054442494, 0.00022453642638188727, 0.00022376476152254147, 0.00022640535378459732, -9.999783554578956, 0.0002157116094085433, 0.00022393690199517977, -9.999776984860183, -9.999771576958773, 0.08604416848336466, 0.00021764229885320188, 0.00021690044525346546, 0.00022516685742389778, 0.00021926526001787654, 0.00022745462376331233, 0.00022664513761589625, -19.999783325083204, -9.999784061574841, 0.00022195877534256022, -9.999796571718464, 0.00021162650022766647, 0.00021095626423978637, 0.0002187958167872498, 0.00022215461002309447, 0.00020361004999134365, 0.00021181194355731383, 0.9535974591615509, -9.99978100628652, 0.00020461088841001584, 0.3352520076588098, 0.0002121901358129535, 0.08917213227933517, 0.07295333282881215, 0.00020406644573418576, 0.00021228526645680225, -9.999788389172279, 0.10115590578407703, 0.00021866250820976526, 0.0002050801772658248, 0.00021333657279008924, 0.05174461267033072, 0.00022062677585651434, 0.0002197601959705143, 0.00022225379977551855, 0.0002037006161939041, -7.369669972484269, 0.0002112356616653278, -9.999780915580379, 0.00022423488257331035, 0.00022346528554616403, 0.00020480675082784015, 0.00021305301473230153, 0.00021237372711050713, 0.03209761078473065, 0.0002241714829268397, 2.4467401239508657, 0.00022250591104278495, 1.2247692081573138, 0.0002122058776157352, 1.4988505547888096, 0.0002179435328209593, 0.00021696270223456698, 0.00021587805572149667, -9.99978509538099, -9.999785902415733, 0.00021813981417357487, -9.790303107865785, 0.0002160908203231781, 0.00021511539405925332, 0.00021430677839740772, 0.3422673903861902, -9.999782750766071, 0.0002162632699215269, 0.00021544601812335446, 0.00021452843243182265, 0.0002176752105782469, -9.999783416478785, 0.00021560357727671935, -9.999785207666807, -9.999786120662217, 0.5481531275687678, 0.0002176710657273529, 0.0002166813526408459, 0.33061087653135385, 0.08946848099440968, 0.0002182298136557097, 0.0002172464105627301, 0.00021615893262478126, 0.00021518289269774435, 0.12880265893981635, 0.2768130299781305, 0.00021853024770213982, -9.542377888174542, 0.00021645449346848115, 0.0002156357985441492, 0.11217857985274791, 0.00021857622280573824, 0.0002175897024117285, 0.0002164987934917551, 0.00021551968869059222], "episode_lengths": [25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 24, 25, 24, 25, 25, 26, 25, 25, 24, 24, 24, 25, 25, 23, 24, 24, 26, 23, 24, 24, 25, 25, 23, 24, 25, 25, 25, 23, 24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 25, 25, 25, 23, 24, 24, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.3150214933937, "mean_inference_ms": 2.1119115518535843, "mean_action_processing_ms": 0.1444045905173392, "mean_env_wait_ms": 1.58026660230032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009888648986816406, "StateBufferConnector_ms": 0.0063745975494384766, "ViewRequirementAgentConnector_ms": 0.1787400245666504}}, "episode_reward_max": 2.4467401239508657, "episode_reward_min": -19.999783325083204, "episode_reward_mean": -1.775119493277312, "episode_len_mean": 24.8, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.45283836054442494, 0.00022453642638188727, 0.00022376476152254147, 0.00022640535378459732, -9.999783554578956, 0.0002157116094085433, 0.00022393690199517977, -9.999776984860183, -9.999771576958773, 0.08604416848336466, 0.00021764229885320188, 0.00021690044525346546, 0.00022516685742389778, 0.00021926526001787654, 0.00022745462376331233, 0.00022664513761589625, -19.999783325083204, -9.999784061574841, 0.00022195877534256022, -9.999796571718464, 0.00021162650022766647, 0.00021095626423978637, 0.0002187958167872498, 0.00022215461002309447, 0.00020361004999134365, 0.00021181194355731383, 0.9535974591615509, -9.99978100628652, 0.00020461088841001584, 0.3352520076588098, 0.0002121901358129535, 0.08917213227933517, 0.07295333282881215, 0.00020406644573418576, 0.00021228526645680225, -9.999788389172279, 0.10115590578407703, 0.00021866250820976526, 0.0002050801772658248, 0.00021333657279008924, 0.05174461267033072, 0.00022062677585651434, 0.0002197601959705143, 0.00022225379977551855, 0.0002037006161939041, -7.369669972484269, 0.0002112356616653278, -9.999780915580379, 0.00022423488257331035, 0.00022346528554616403, 0.00020480675082784015, 0.00021305301473230153, 0.00021237372711050713, 0.03209761078473065, 0.0002241714829268397, 2.4467401239508657, 0.00022250591104278495, 1.2247692081573138, 0.0002122058776157352, 1.4988505547888096, 0.0002179435328209593, 0.00021696270223456698, 0.00021587805572149667, -9.99978509538099, -9.999785902415733, 0.00021813981417357487, -9.790303107865785, 0.0002160908203231781, 0.00021511539405925332, 0.00021430677839740772, 0.3422673903861902, -9.999782750766071, 0.0002162632699215269, 0.00021544601812335446, 0.00021452843243182265, 0.0002176752105782469, -9.999783416478785, 0.00021560357727671935, -9.999785207666807, -9.999786120662217, 0.5481531275687678, 0.0002176710657273529, 0.0002166813526408459, 0.33061087653135385, 0.08946848099440968, 0.0002182298136557097, 0.0002172464105627301, 0.00021615893262478126, 0.00021518289269774435, 0.12880265893981635, 0.2768130299781305, 0.00021853024770213982, -9.542377888174542, 0.00021645449346848115, 0.0002156357985441492, 0.11217857985274791, 0.00021857622280573824, 0.0002175897024117285, 0.0002164987934917551, 0.00021551968869059222], "episode_lengths": [25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 24, 25, 24, 25, 25, 26, 25, 25, 24, 24, 24, 25, 25, 23, 24, 24, 26, 23, 24, 24, 25, 25, 23, 24, 25, 25, 25, 23, 24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 25, 25, 25, 23, 24, 24, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.3150214933937, "mean_inference_ms": 2.1119115518535843, "mean_action_processing_ms": 0.1444045905173392, "mean_env_wait_ms": 1.58026660230032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009888648986816406, "StateBufferConnector_ms": 0.0063745975494384766, "ViewRequirementAgentConnector_ms": 0.1787400245666504}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 113100, "num_env_steps_sampled": 59000, "num_env_steps_trained": 113100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.228719509847848, "num_env_steps_trained_throughput_per_sec": 8.246003044203304, "timesteps_total": 59000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 59000, "timers": {"training_iteration_time_ms": 9041.067, "sample_time_ms": 8979.574, "load_time_ms": 0.241, "load_throughput": 322989.152, "learn_time_ms": 13.065, "learn_throughput": 5970.365, "synch_weights_time_ms": 11.185}, "counters": {"num_env_steps_sampled": 59000, "num_env_steps_trained": 113100, "num_agent_steps_sampled": 59000, "num_agent_steps_trained": 113100, "last_target_update_ts": 58760, "num_target_updates": 112}, "done": false, "episodes_total": 2282, "training_iteration": 59, "trial_id": "2058a_00000", "date": "2024-04-17_08-59-52", "timestamp": 1713344392, "time_this_iter_s": 236.48764967918396, "time_total_s": 13165.148592472076, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 13165.148592472076, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 12.673887240356084, "ram_util_percent": 19.21454005934718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.026574578136205673, "cur_lr": 0.01}, "td_error": [1.8924354314804077, 1.4070682525634766, 1.4070749282836914, 0.721306562423706, 1.4939777851104736, 1.4070736169815063, 1.407073736190796, 1.4070749282836914, 1.4736285209655762, 0.7483182549476624, 1.4070732593536377, 0.9279998540878296, 1.4070745706558228, 4.441904544830322, 1.407074213027954, 1.4070743322372437, 1.4070738554000854, 1.407072901725769, 1.9059418439865112, 1.4070725440979004, 0.7471365928649902, 0.9279909729957581, 0.9279994368553162, 1.407074213027954, 1.4070663452148438, 1.4070736169815063, 1.4070734977722168, 1.40707266330719, 1.407067894935608, 1.4070745706558228, 1.4070738554000854, 1.4070743322372437, 1.9448696374893188, 2.6997482776641846, 0.9279985427856445, 1.4070748090744019, 1.4070749282836914, 1.4070744514465332, 1.4070745706558228, 0.9280002117156982, 0.7513586282730103, 1.4070738554000854, 0.927993655204773, 1.4070714712142944, 1.4070748090744019, 1.407074213027954, 1.407074213027954, 1.4070746898651123, 1.407074213027954, 1.4070746898651123, 1.4070743322372437, 1.407067894935608, 1.4070749282836914, 1.4070743322372437, 1.407070279121399, 1.4070717096328735, 1.4070748090744019, 1.4731340408325195, 2.7024383544921875, 1.4070748090744019, 0.9280002117156982, 1.4070745706558228, 1.4070745706558228, 1.4070744514465332, 1.7673259973526, 0.9279937744140625, 1.407074213027954, 1.473047137260437, 1.4070748090744019, 1.4070733785629272, 0.9279995560646057, 1.1127469539642334, 1.6063936948776245, 0.9279996752738953, 0.9280006885528564, 1.4070743322372437, 1.4070744514465332, 1.4070748090744019], "mean_td_error": 1.4040688276290894, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1475.0, "diff_num_grad_updates_vs_sampler_policy": 1474.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 115050, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 115050, "last_target_update_ts": 59800, "num_target_updates": 114}, "sampler_results": {"episode_reward_max": 2.5978608977636104, "episode_reward_min": -19.999787182239864, "episode_reward_mean": -1.6374984704131907, "episode_len_mean": 25.04, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00021333657279008924, 0.05174461267033072, 0.00022062677585651434, 0.0002197601959705143, 0.00022225379977551855, 0.0002037006161939041, -7.369669972484269, 0.0002112356616653278, -9.999780915580379, 0.00022423488257331035, 0.00022346528554616403, 0.00020480675082784015, 0.00021305301473230153, 0.00021237372711050713, 0.03209761078473065, 0.0002241714829268397, 2.4467401239508657, 0.00022250591104278495, 1.2247692081573138, 0.0002122058776157352, 1.4988505547888096, 0.0002179435328209593, 0.00021696270223456698, 0.00021587805572149667, -9.99978509538099, -9.999785902415733, 0.00021813981417357487, -9.790303107865785, 0.0002160908203231781, 0.00021511539405925332, 0.00021430677839740772, 0.3422673903861902, -9.999782750766071, 0.0002162632699215269, 0.00021544601812335446, 0.00021452843243182265, 0.0002176752105782469, -9.999783416478785, 0.00021560357727671935, -9.999785207666807, -9.999786120662217, 0.5481531275687678, 0.0002176710657273529, 0.0002166813526408459, 0.33061087653135385, 0.08946848099440968, 0.0002182298136557097, 0.0002172464105627301, 0.00021615893262478126, 0.00021518289269774435, 0.12880265893981635, 0.2768130299781305, 0.00021853024770213982, -9.542377888174542, 0.00021645449346848115, 0.0002156357985441492, 0.11217857985274791, 0.00021857622280573824, 0.0002175897024117285, 0.0002164987934917551, 0.00021551968869059222, 2.5978608977636104, 0.00021221704071538257, 0.00021128155410249952, 0.0002102121940433378, 0.4229329348753199, 0.00021339884962687008, 0.0522959774714733, 0.057873093047746446, 0.649616176001309, 0.0002098374403469763, 0.00021354023885308276, 0.00021259307555415385, -9.999788488187063, 0.00021080924245344882, -9.99978983034758, 0.00021289702916014406, -9.999788044376949, 0.2607232094874623, 0.00021020145864970285, 0.0002095654748080974, 0.0002140221748676267, 0.9743256493399958, -9.999788011803536, 0.0002112837681420336, 0.0002106412292132338, 0.00021349774967650611, 0.15924420510893592, 0.00021160357233210764, 0.0002105309585528125, 0.00020983623793113552, -9.999785283326885, 0.00021372667529008881, 0.09689124036344897, 0.00021173480682912943, 0.5821450687315806, 0.0002147080364987889, 0.00021379671221099586, -19.999787182239864, -9.999788125451554], "episode_lengths": [24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 25, 25, 25, 23, 24, 24, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 27, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.73038517172847, "mean_inference_ms": 2.1129755070227407, "mean_action_processing_ms": 0.14446797523935445, "mean_env_wait_ms": 1.5565715129932003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010119438171386719, "StateBufferConnector_ms": 0.0063936710357666016, "ViewRequirementAgentConnector_ms": 0.17808771133422852}}, "episode_reward_max": 2.5978608977636104, "episode_reward_min": -19.999787182239864, "episode_reward_mean": -1.6374984704131907, "episode_len_mean": 25.04, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00021333657279008924, 0.05174461267033072, 0.00022062677585651434, 0.0002197601959705143, 0.00022225379977551855, 0.0002037006161939041, -7.369669972484269, 0.0002112356616653278, -9.999780915580379, 0.00022423488257331035, 0.00022346528554616403, 0.00020480675082784015, 0.00021305301473230153, 0.00021237372711050713, 0.03209761078473065, 0.0002241714829268397, 2.4467401239508657, 0.00022250591104278495, 1.2247692081573138, 0.0002122058776157352, 1.4988505547888096, 0.0002179435328209593, 0.00021696270223456698, 0.00021587805572149667, -9.99978509538099, -9.999785902415733, 0.00021813981417357487, -9.790303107865785, 0.0002160908203231781, 0.00021511539405925332, 0.00021430677839740772, 0.3422673903861902, -9.999782750766071, 0.0002162632699215269, 0.00021544601812335446, 0.00021452843243182265, 0.0002176752105782469, -9.999783416478785, 0.00021560357727671935, -9.999785207666807, -9.999786120662217, 0.5481531275687678, 0.0002176710657273529, 0.0002166813526408459, 0.33061087653135385, 0.08946848099440968, 0.0002182298136557097, 0.0002172464105627301, 0.00021615893262478126, 0.00021518289269774435, 0.12880265893981635, 0.2768130299781305, 0.00021853024770213982, -9.542377888174542, 0.00021645449346848115, 0.0002156357985441492, 0.11217857985274791, 0.00021857622280573824, 0.0002175897024117285, 0.0002164987934917551, 0.00021551968869059222, 2.5978608977636104, 0.00021221704071538257, 0.00021128155410249952, 0.0002102121940433378, 0.4229329348753199, 0.00021339884962687008, 0.0522959774714733, 0.057873093047746446, 0.649616176001309, 0.0002098374403469763, 0.00021354023885308276, 0.00021259307555415385, -9.999788488187063, 0.00021080924245344882, -9.99978983034758, 0.00021289702916014406, -9.999788044376949, 0.2607232094874623, 0.00021020145864970285, 0.0002095654748080974, 0.0002140221748676267, 0.9743256493399958, -9.999788011803536, 0.0002112837681420336, 0.0002106412292132338, 0.00021349774967650611, 0.15924420510893592, 0.00021160357233210764, 0.0002105309585528125, 0.00020983623793113552, -9.999785283326885, 0.00021372667529008881, 0.09689124036344897, 0.00021173480682912943, 0.5821450687315806, 0.0002147080364987889, 0.00021379671221099586, -19.999787182239864, -9.999788125451554], "episode_lengths": [24, 24, 25, 25, 25, 23, 25, 24, 26, 25, 25, 23, 24, 24, 25, 25, 25, 25, 23, 24, 24, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 27, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.73038517172847, "mean_inference_ms": 2.1129755070227407, "mean_action_processing_ms": 0.14446797523935445, "mean_env_wait_ms": 1.5565715129932003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010119438171386719, "StateBufferConnector_ms": 0.0063936710357666016, "ViewRequirementAgentConnector_ms": 0.17808771133422852}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 115050, "num_env_steps_sampled": 60000, "num_env_steps_trained": 115050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.463771892442635, "num_env_steps_trained_throughput_per_sec": 8.704355190263138, "timesteps_total": 60000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 9019.927, "sample_time_ms": 8954.265, "load_time_ms": 0.254, "load_throughput": 306583.93, "learn_time_ms": 13.72, "learn_throughput": 5685.077, "synch_weights_time_ms": 11.473}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 115050, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 115050, "last_target_update_ts": 59800, "num_target_updates": 114}, "done": false, "episodes_total": 2321, "training_iteration": 60, "trial_id": "2058a_00000", "date": "2024-04-17_09-03-36", "timestamp": 1713344616, "time_this_iter_s": 224.03746223449707, "time_total_s": 13389.186054706573, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 13389.186054706573, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 13.010062893081761, "ram_util_percent": 19.330503144654095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.028916411101818085, "cur_lr": 0.01}, "td_error": [1.3804171085357666, 0.9221967458724976, 1.380419373512268, 1.3804194927215576, 0.9221967458724976, 1.4517042636871338, 1.3804192543029785, 1.3804194927215576, 1.5865905284881592, 1.380419135093689, 1.3804177045822144, 1.3804192543029785, 1.3804194927215576, 1.3804181814193726, 1.380418300628662, 1.3804190158843994, 1.380419373512268, 0.9221962690353394, 1.3804171085357666, 1.3804188966751099, 2.7171151638031006, 1.380419135093689, 1.3804192543029785, 1.3804190158843994, 1.5734761953353882, 1.380418300628662, 1.3804168701171875, 1.090935230255127, 1.380419373512268, 0.9221965670585632, 1.3804192543029785, 1.380419135093689, 1.3804184198379517, 1.3804125785827637, 1.380416750907898, 1.380419135093689, 1.3804192543029785, 0.9221965074539185, 1.3804190158843994, 1.380419373512268, 1.380415678024292, 1.3804192543029785, 1.3804188966751099, 1.380419135093689, 1.380416750907898, 1.3804192543029785, 1.380419373512268, 1.3804192543029785, 1.3804188966751099, 1.380419135093689, 1.3804190158843994, 1.4519459009170532, 1.4516777992248535, 1.380419373512268, 1.380418062210083, 1.3210629224777222, 0.7203718423843384, 1.380418300628662, 1.3804136514663696, 0.922194242477417, 1.3804190158843994, 1.380419373512268, 1.3804062604904175, 1.380419373512268, 1.3804192543029785, 1.3804192543029785, 1.3804168701171875, 1.3804192543029785, 1.380419373512268, 1.3272500038146973, 1.3804168701171875, 1.380417823791504, 1.3804190158843994, 1.3804184198379517, 1.3804174661636353, 1.3804186582565308, 1.4518102407455444, 1.380419373512268], "mean_td_error": 1.3574696779251099, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1500.0, "diff_num_grad_updates_vs_sampler_policy": 1499.0}}, "num_env_steps_sampled": 61000, "num_env_steps_trained": 117000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 117000, "last_target_update_ts": 60840, "num_target_updates": 116}, "sampler_results": {"episode_reward_max": 2.5978608977636104, "episode_reward_min": -19.999787182239864, "episode_reward_mean": -1.2885140633307903, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999786120662217, 0.5481531275687678, 0.0002176710657273529, 0.0002166813526408459, 0.33061087653135385, 0.08946848099440968, 0.0002182298136557097, 0.0002172464105627301, 0.00021615893262478126, 0.00021518289269774435, 0.12880265893981635, 0.2768130299781305, 0.00021853024770213982, -9.542377888174542, 0.00021645449346848115, 0.0002156357985441492, 0.11217857985274791, 0.00021857622280573824, 0.0002175897024117285, 0.0002164987934917551, 0.00021551968869059222, 2.5978608977636104, 0.00021221704071538257, 0.00021128155410249952, 0.0002102121940433378, 0.4229329348753199, 0.00021339884962687008, 0.0522959774714733, 0.057873093047746446, 0.649616176001309, 0.0002098374403469763, 0.00021354023885308276, 0.00021259307555415385, -9.999788488187063, 0.00021080924245344882, -9.99978983034758, 0.00021289702916014406, -9.999788044376949, 0.2607232094874623, 0.00021020145864970285, 0.0002095654748080974, 0.0002140221748676267, 0.9743256493399958, -9.999788011803536, 0.0002112837681420336, 0.0002106412292132338, 0.00021349774967650611, 0.15924420510893592, 0.00021160357233210764, 0.0002105309585528125, 0.00020983623793113552, -9.999785283326885, 0.00021372667529008881, 0.09689124036344897, 0.00021173480682912943, 0.5821450687315806, 0.0002147080364987889, 0.00021379671221099586, -19.999787182239864, -9.999788125451554, 0.00020889961183745867, 0.9418501542958306, 0.12398235063145696, -9.999793458796766, 0.00020590536054644132, -9.999790796496672, 1.0117873468096674, 0.10783698436565246, 0.00020683796035351272, 0.00020620053724541208, 0.00020933546430390267, 0.00020852388257729774, 0.00020773822230008246, 0.00020709524725045792, 0.04890408928008178, 0.0002087361363958571, 0.00020792918631675557, 0.00020714799267700836, 0.00020650866029965514, 0.045643256224424715, 0.045647269290762515, 0.00020909424311398763, 0.00020830428706217392, 0.00020765780878672486, 0.10180752676089451, 0.00020920245851691505, 0.00020837598525378704, 0.4352436529131178, 0.12822589710500126, 0.000206203278847815, 0.00021039935125344983, 0.0002095634126719154, 0.0002087500658786779, 0.00020796270345673762, 0.34488803995063294, 0.00021079912172653533, -9.99978989729646, -9.999790532684218, 0.00020863868314070246, 0.00020783248493905663], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 27, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.9612724122146, "mean_inference_ms": 2.115217171789178, "mean_action_processing_ms": 0.14454755559752613, "mean_env_wait_ms": 1.5323029697265005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00988626480102539, "StateBufferConnector_ms": 0.006333589553833008, "ViewRequirementAgentConnector_ms": 0.17334294319152832}}, "episode_reward_max": 2.5978608977636104, "episode_reward_min": -19.999787182239864, "episode_reward_mean": -1.2885140633307903, "episode_len_mean": 25.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999786120662217, 0.5481531275687678, 0.0002176710657273529, 0.0002166813526408459, 0.33061087653135385, 0.08946848099440968, 0.0002182298136557097, 0.0002172464105627301, 0.00021615893262478126, 0.00021518289269774435, 0.12880265893981635, 0.2768130299781305, 0.00021853024770213982, -9.542377888174542, 0.00021645449346848115, 0.0002156357985441492, 0.11217857985274791, 0.00021857622280573824, 0.0002175897024117285, 0.0002164987934917551, 0.00021551968869059222, 2.5978608977636104, 0.00021221704071538257, 0.00021128155410249952, 0.0002102121940433378, 0.4229329348753199, 0.00021339884962687008, 0.0522959774714733, 0.057873093047746446, 0.649616176001309, 0.0002098374403469763, 0.00021354023885308276, 0.00021259307555415385, -9.999788488187063, 0.00021080924245344882, -9.99978983034758, 0.00021289702916014406, -9.999788044376949, 0.2607232094874623, 0.00021020145864970285, 0.0002095654748080974, 0.0002140221748676267, 0.9743256493399958, -9.999788011803536, 0.0002112837681420336, 0.0002106412292132338, 0.00021349774967650611, 0.15924420510893592, 0.00021160357233210764, 0.0002105309585528125, 0.00020983623793113552, -9.999785283326885, 0.00021372667529008881, 0.09689124036344897, 0.00021173480682912943, 0.5821450687315806, 0.0002147080364987889, 0.00021379671221099586, -19.999787182239864, -9.999788125451554, 0.00020889961183745867, 0.9418501542958306, 0.12398235063145696, -9.999793458796766, 0.00020590536054644132, -9.999790796496672, 1.0117873468096674, 0.10783698436565246, 0.00020683796035351272, 0.00020620053724541208, 0.00020933546430390267, 0.00020852388257729774, 0.00020773822230008246, 0.00020709524725045792, 0.04890408928008178, 0.0002087361363958571, 0.00020792918631675557, 0.00020714799267700836, 0.00020650866029965514, 0.045643256224424715, 0.045647269290762515, 0.00020909424311398763, 0.00020830428706217392, 0.00020765780878672486, 0.10180752676089451, 0.00020920245851691505, 0.00020837598525378704, 0.4352436529131178, 0.12822589710500126, 0.000206203278847815, 0.00021039935125344983, 0.0002095634126719154, 0.0002087500658786779, 0.00020796270345673762, 0.34488803995063294, 0.00021079912172653533, -9.99978989729646, -9.999790532684218, 0.00020863868314070246, 0.00020783248493905663], "episode_lengths": [26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 27, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 424.9612724122146, "mean_inference_ms": 2.115217171789178, "mean_action_processing_ms": 0.14454755559752613, "mean_env_wait_ms": 1.5323029697265005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00988626480102539, "StateBufferConnector_ms": 0.006333589553833008, "ViewRequirementAgentConnector_ms": 0.17334294319152832}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 117000, "num_env_steps_sampled": 61000, "num_env_steps_trained": 117000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.456215073081103, "num_env_steps_trained_throughput_per_sec": 8.68961939250815, "timesteps_total": 61000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 61000, "timers": {"training_iteration_time_ms": 8942.493, "sample_time_ms": 8877.949, "load_time_ms": 0.244, "load_throughput": 319800.305, "learn_time_ms": 13.009, "learn_throughput": 5995.805, "synch_weights_time_ms": 11.925}, "counters": {"num_env_steps_sampled": 61000, "num_env_steps_trained": 117000, "num_agent_steps_sampled": 61000, "num_agent_steps_trained": 117000, "last_target_update_ts": 60840, "num_target_updates": 116}, "done": false, "episodes_total": 2361, "training_iteration": 61, "trial_id": "2058a_00000", "date": "2024-04-17_09-07-20", "timestamp": 1713344840, "time_this_iter_s": 224.4149158000946, "time_total_s": 13613.600970506668, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 13613.600970506668, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 13.29375, "ram_util_percent": 19.478437500000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.028877705335617065, "cur_lr": 0.01}, "td_error": [1.3842029571533203, 1.3842029571533203, 4.577861785888672, 1.3842029571533203, 1.3842029571533203, 1.384203314781189, 1.3842030763626099, 1.3842034339904785, 1.3842029571533203, 1.6137404441833496, 1.3842028379440308, 1.3842028379440308, 1.3842036724090576, 1.3842030763626099, 1.3842029571533203, 1.3842029571533203, 1.6454771757125854, 1.3842036724090576, 1.3842028379440308, 1.3842030763626099, 1.3842029571533203, 1.3842029571533203, 1.4589005708694458, 1.3842029571533203, 1.3842029571533203, 1.3842029571533203, 0.9262354373931885, 1.3842029571533203, 1.3842029571533203, 1.3842030763626099, 1.3842029571533203, 1.458479881286621, 1.3842029571533203, 1.3842034339904785, 1.3842066526412964, 1.3842029571533203, 1.3842030763626099, 1.3842030763626099, 1.3842028379440308, 1.3842029571533203, 1.3842040300369263, 1.3842029571533203, 1.3842029571533203, 1.3842030763626099, 1.3842030763626099, 1.3842030763626099, 1.3842029571533203, 1.6163352727890015, 1.3842029571533203, 1.3842030763626099, 1.3842031955718994, 1.3842030763626099, 1.3842030763626099, 1.3842029571533203, 1.3842028379440308, 1.3842029571533203, 1.3842030763626099, 1.3842030763626099, 1.3842029571533203, 0.926239550113678, 1.6136765480041504, 1.3842031955718994, 1.3842031955718994, 1.3842029571533203, 1.3842029571533203, 1.3842030763626099, 1.3842029571533203, 1.384203314781189, 1.3842029571533203, 2.723165988922119, 1.3842030763626099, 1.3842029571533203, 1.3842029571533203, 1.4717384576797485, 1.3842029571533203, 1.3842030763626099, 1.3842031955718994, 1.1005809307098389], "mean_td_error": 1.442177414894104, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1525.0, "diff_num_grad_updates_vs_sampler_policy": 1524.0}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 118950, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 118950, "last_target_update_ts": 61880, "num_target_updates": 118}, "sampler_results": {"episode_reward_max": 1.507045910239525, "episode_reward_min": -19.999787182239864, "episode_reward_mean": -1.2025908554269749, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0002095654748080974, 0.0002140221748676267, 0.9743256493399958, -9.999788011803536, 0.0002112837681420336, 0.0002106412292132338, 0.00021349774967650611, 0.15924420510893592, 0.00021160357233210764, 0.0002105309585528125, 0.00020983623793113552, -9.999785283326885, 0.00021372667529008881, 0.09689124036344897, 0.00021173480682912943, 0.5821450687315806, 0.0002147080364987889, 0.00021379671221099586, -19.999787182239864, -9.999788125451554, 0.00020889961183745867, 0.9418501542958306, 0.12398235063145696, -9.999793458796766, 0.00020590536054644132, -9.999790796496672, 1.0117873468096674, 0.10783698436565246, 0.00020683796035351272, 0.00020620053724541208, 0.00020933546430390267, 0.00020852388257729774, 0.00020773822230008246, 0.00020709524725045792, 0.04890408928008178, 0.0002087361363958571, 0.00020792918631675557, 0.00020714799267700836, 0.00020650866029965514, 0.045643256224424715, 0.045647269290762515, 0.00020909424311398763, 0.00020830428706217392, 0.00020765780878672486, 0.10180752676089451, 0.00020920245851691505, 0.00020837598525378704, 0.4352436529131178, 0.12822589710500126, 0.000206203278847815, 0.00021039935125344983, 0.0002095634126719154, 0.0002087500658786779, 0.00020796270345673762, 0.34488803995063294, 0.00021079912172653533, -9.99978989729646, -9.999790532684218, 0.00020863868314070246, 0.00020783248493905663, 0.00020503635600637582, -9.999795874779695, 0.00020341241870816098, 0.00020278584456213277, 0.6890769225071807, 0.00020532904490396737, 0.05986283364630689, -9.999796208902483, 0.00020316212558349733, 0.9565961116804818, 0.00020539002994968868, 0.00020466844993422185, 0.00020403412583500964, 0.21665845752049223, 0.00020275229616469753, 0.00020481983854584175, 1.507045910239525, 0.00020348192859179649, 0.00019470592381032607, 0.00020218686054254424, -9.999794112616103, 0.15369709924840835, 0.00020465863649368396, 0.00019582819047968766, 0.00020334859517194003, 0.0002053317633830672, 0.00020441793895670623, 0.11120652323560706, 0.43800222185148524, 0.00019435657963066228, 0.0002064511894313598, 0.0002055273954987498, 0.00020480485161655782, 0.17034817088118742, 0.00019538452964957902, -9.999792947914852, 0.00020641327538033953, 0.00020553998784910804, 0.00020462431307173015, 0.27446286559658317], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 27, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.14854660930496, "mean_inference_ms": 2.114782017361669, "mean_action_processing_ms": 0.1445349913863115, "mean_env_wait_ms": 1.5089725451157399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010050296783447266, "StateBufferConnector_ms": 0.006345033645629883, "ViewRequirementAgentConnector_ms": 0.1726851463317871}}, "episode_reward_max": 1.507045910239525, "episode_reward_min": -19.999787182239864, "episode_reward_mean": -1.2025908554269749, "episode_len_mean": 25.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0002095654748080974, 0.0002140221748676267, 0.9743256493399958, -9.999788011803536, 0.0002112837681420336, 0.0002106412292132338, 0.00021349774967650611, 0.15924420510893592, 0.00021160357233210764, 0.0002105309585528125, 0.00020983623793113552, -9.999785283326885, 0.00021372667529008881, 0.09689124036344897, 0.00021173480682912943, 0.5821450687315806, 0.0002147080364987889, 0.00021379671221099586, -19.999787182239864, -9.999788125451554, 0.00020889961183745867, 0.9418501542958306, 0.12398235063145696, -9.999793458796766, 0.00020590536054644132, -9.999790796496672, 1.0117873468096674, 0.10783698436565246, 0.00020683796035351272, 0.00020620053724541208, 0.00020933546430390267, 0.00020852388257729774, 0.00020773822230008246, 0.00020709524725045792, 0.04890408928008178, 0.0002087361363958571, 0.00020792918631675557, 0.00020714799267700836, 0.00020650866029965514, 0.045643256224424715, 0.045647269290762515, 0.00020909424311398763, 0.00020830428706217392, 0.00020765780878672486, 0.10180752676089451, 0.00020920245851691505, 0.00020837598525378704, 0.4352436529131178, 0.12822589710500126, 0.000206203278847815, 0.00021039935125344983, 0.0002095634126719154, 0.0002087500658786779, 0.00020796270345673762, 0.34488803995063294, 0.00021079912172653533, -9.99978989729646, -9.999790532684218, 0.00020863868314070246, 0.00020783248493905663, 0.00020503635600637582, -9.999795874779695, 0.00020341241870816098, 0.00020278584456213277, 0.6890769225071807, 0.00020532904490396737, 0.05986283364630689, -9.999796208902483, 0.00020316212558349733, 0.9565961116804818, 0.00020539002994968868, 0.00020466844993422185, 0.00020403412583500964, 0.21665845752049223, 0.00020275229616469753, 0.00020481983854584175, 1.507045910239525, 0.00020348192859179649, 0.00019470592381032607, 0.00020218686054254424, -9.999794112616103, 0.15369709924840835, 0.00020465863649368396, 0.00019582819047968766, 0.00020334859517194003, 0.0002053317633830672, 0.00020441793895670623, 0.11120652323560706, 0.43800222185148524, 0.00019435657963066228, 0.0002064511894313598, 0.0002055273954987498, 0.00020480485161655782, 0.17034817088118742, 0.00019538452964957902, -9.999792947914852, 0.00020641327538033953, 0.00020553998784910804, 0.00020462431307173015, 0.27446286559658317], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 27, 26, 25, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.14854660930496, "mean_inference_ms": 2.114782017361669, "mean_action_processing_ms": 0.1445349913863115, "mean_env_wait_ms": 1.5089725451157399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010050296783447266, "StateBufferConnector_ms": 0.006345033645629883, "ViewRequirementAgentConnector_ms": 0.1726851463317871}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 118950, "num_env_steps_sampled": 62000, "num_env_steps_trained": 118950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.9152955958915614, "num_env_steps_trained_throughput_per_sec": 7.634826411988545, "timesteps_total": 62000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 9914.787, "sample_time_ms": 9849.712, "load_time_ms": 0.244, "load_throughput": 319987.981, "learn_time_ms": 13.263, "learn_throughput": 5880.827, "synch_weights_time_ms": 12.66}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 118950, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 118950, "last_target_update_ts": 61880, "num_target_updates": 118}, "done": false, "episodes_total": 2401, "training_iteration": 62, "trial_id": "2058a_00000", "date": "2024-04-17_09-11-36", "timestamp": 1713345096, "time_this_iter_s": 255.41912055015564, "time_total_s": 13869.020091056824, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 13869.020091056824, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 11.761983471074378, "ram_util_percent": 19.574380165289252}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.026139751076698303, "cur_lr": 0.01}, "td_error": [1.36436128616333, 1.364359736442566, 1.4417182207107544, 1.4416879415512085, 1.364361047744751, 1.3643605709075928, 1.3643608093261719, 1.364359736442566, 1.3641520738601685, 1.3643611669540405, 1.3643370866775513, 1.3643611669540405, 1.3643611669540405, 1.3643611669540405, 1.3643611669540405, 1.3643608093261719, 1.3643611669540405, 0.9081308841705322, 0.9081320762634277, 1.441704511642456, 1.3643605709075928, 1.364361047744751, 1.3643611669540405, 1.36436128616333, 1.3643611669540405, 1.36436128616333, 0.9081330299377441, 1.3643611669540405, 1.4416974782943726, 1.3643611669540405, 1.3643609285354614, 1.3643604516983032, 1.3643549680709839, 1.3643609285354614, 1.3643609285354614, 1.3643611669540405, 1.3643609285354614, 1.364359974861145, 1.364359974861145, 1.3643608093261719, 1.3643524646759033, 1.36436128616333, 1.3643611669540405, 1.999814510345459, 1.3643602132797241, 1.364361047744751, 2.006054639816284, 1.3643609285354614, 0.7426763772964478, 1.3643608093261719, 1.36436128616333, 1.3643611669540405, 3.076627016067505, 1.36436128616333, 1.3643604516983032, 1.0885639190673828, 1.3643608093261719, 1.3643611669540405, 1.36436128616333, 1.441649317741394, 1.3643611669540405, 1.3643606901168823, 1.3643608093261719, 0.9081318378448486, 1.5921475887298584, 1.364361047744751, 2.00240159034729, 0.9081329107284546, 1.3643608093261719, 1.364361047744751, 1.364361047744751, 1.3643604516983032, 0.7405281662940979, 1.3643611669540405, 1.3643611669540405, 1.3643584251403809, 1.3643609285354614, 1.3643605709075928], "mean_td_error": 1.3699915409088135, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1550.0, "diff_num_grad_updates_vs_sampler_policy": 1549.0}}, "num_env_steps_sampled": 63000, "num_env_steps_trained": 120900, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 120900, "last_target_update_ts": 62920, "num_target_updates": 120}, "sampler_results": {"episode_reward_max": 1.507045910239525, "episode_reward_min": -19.99979670240253, "episode_reward_mean": -1.4239220242870199, "episode_len_mean": 25.04, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.045647269290762515, 0.00020909424311398763, 0.00020830428706217392, 0.00020765780878672486, 0.10180752676089451, 0.00020920245851691505, 0.00020837598525378704, 0.4352436529131178, 0.12822589710500126, 0.000206203278847815, 0.00021039935125344983, 0.0002095634126719154, 0.0002087500658786779, 0.00020796270345673762, 0.34488803995063294, 0.00021079912172653533, -9.99978989729646, -9.999790532684218, 0.00020863868314070246, 0.00020783248493905663, 0.00020503635600637582, -9.999795874779695, 0.00020341241870816098, 0.00020278584456213277, 0.6890769225071807, 0.00020532904490396737, 0.05986283364630689, -9.999796208902483, 0.00020316212558349733, 0.9565961116804818, 0.00020539002994968868, 0.00020466844993422185, 0.00020403412583500964, 0.21665845752049223, 0.00020275229616469753, 0.00020481983854584175, 1.507045910239525, 0.00020348192859179649, 0.00019470592381032607, 0.00020218686054254424, -9.999794112616103, 0.15369709924840835, 0.00020465863649368396, 0.00019582819047968766, 0.00020334859517194003, 0.0002053317633830672, 0.00020441793895670623, 0.11120652323560706, 0.43800222185148524, 0.00019435657963066228, 0.0002064511894313598, 0.0002055273954987498, 0.00020480485161655782, 0.17034817088118742, 0.00019538452964957902, -9.999792947914852, 0.00020641327538033953, 0.00020553998784910804, 0.00020462431307173015, 0.27446286559658317, 0.0002015354946288913, 1.3454076941995181, 0.00020013116038895156, 0.00019928979974571918, 0.0001987247795722275, 0.00020187770747814187, -9.999798763351828, 0.0002004649281158864, 0.00019962076474822838, 0.00019905386868990523, 0.00020210561430657886, 0.00020132729265897006, 0.00020047586633346567, 0.0001999041092673716, 0.1268095723929802, 0.00020154377470837115, -9.999799229353801, 0.00019992303889905104, 0.00019935442686404767, -9.958276757850104, 0.00020269811018049203, 0.00020191522720733118, -9.999798941722524, 0.1289556102685077, 0.00019193327244535003, 0.00020182522208439516, -9.758895185829054, 0.00020043054233031998, -9.999800413987963, 0.0001990199652656491, 0.00020288933663077237, 0.0002022417817263271, 0.07498198923243701, -9.999799334798567, 0.00020009465757934522, -19.99979670240253, 0.00019453034133297165, 0.00020200509939255517, 0.0002013631673896424, 0.00020059054272427874], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 26, 25, 24, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 27, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.3338324833032, "mean_inference_ms": 2.113070004041644, "mean_action_processing_ms": 0.14447607673705562, "mean_env_wait_ms": 1.4865273113948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009840250015258789, "StateBufferConnector_ms": 0.006228208541870117, "ViewRequirementAgentConnector_ms": 0.1752009391784668}}, "episode_reward_max": 1.507045910239525, "episode_reward_min": -19.99979670240253, "episode_reward_mean": -1.4239220242870199, "episode_len_mean": 25.04, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.045647269290762515, 0.00020909424311398763, 0.00020830428706217392, 0.00020765780878672486, 0.10180752676089451, 0.00020920245851691505, 0.00020837598525378704, 0.4352436529131178, 0.12822589710500126, 0.000206203278847815, 0.00021039935125344983, 0.0002095634126719154, 0.0002087500658786779, 0.00020796270345673762, 0.34488803995063294, 0.00021079912172653533, -9.99978989729646, -9.999790532684218, 0.00020863868314070246, 0.00020783248493905663, 0.00020503635600637582, -9.999795874779695, 0.00020341241870816098, 0.00020278584456213277, 0.6890769225071807, 0.00020532904490396737, 0.05986283364630689, -9.999796208902483, 0.00020316212558349733, 0.9565961116804818, 0.00020539002994968868, 0.00020466844993422185, 0.00020403412583500964, 0.21665845752049223, 0.00020275229616469753, 0.00020481983854584175, 1.507045910239525, 0.00020348192859179649, 0.00019470592381032607, 0.00020218686054254424, -9.999794112616103, 0.15369709924840835, 0.00020465863649368396, 0.00019582819047968766, 0.00020334859517194003, 0.0002053317633830672, 0.00020441793895670623, 0.11120652323560706, 0.43800222185148524, 0.00019435657963066228, 0.0002064511894313598, 0.0002055273954987498, 0.00020480485161655782, 0.17034817088118742, 0.00019538452964957902, -9.999792947914852, 0.00020641327538033953, 0.00020553998784910804, 0.00020462431307173015, 0.27446286559658317, 0.0002015354946288913, 1.3454076941995181, 0.00020013116038895156, 0.00019928979974571918, 0.0001987247795722275, 0.00020187770747814187, -9.999798763351828, 0.0002004649281158864, 0.00019962076474822838, 0.00019905386868990523, 0.00020210561430657886, 0.00020132729265897006, 0.00020047586633346567, 0.0001999041092673716, 0.1268095723929802, 0.00020154377470837115, -9.999799229353801, 0.00019992303889905104, 0.00019935442686404767, -9.958276757850104, 0.00020269811018049203, 0.00020191522720733118, -9.999798941722524, 0.1289556102685077, 0.00019193327244535003, 0.00020182522208439516, -9.758895185829054, 0.00020043054233031998, -9.999800413987963, 0.0001990199652656491, 0.00020288933663077237, 0.0002022417817263271, 0.07498198923243701, -9.999799334798567, 0.00020009465757934522, -19.99979670240253, 0.00019453034133297165, 0.00020200509939255517, 0.0002013631673896424, 0.00020059054272427874], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 26, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 26, 25, 24, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 27, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.3338324833032, "mean_inference_ms": 2.113070004041644, "mean_action_processing_ms": 0.14447607673705562, "mean_env_wait_ms": 1.4865273113948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009840250015258789, "StateBufferConnector_ms": 0.006228208541870117, "ViewRequirementAgentConnector_ms": 0.1752009391784668}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 120900, "num_env_steps_sampled": 63000, "num_env_steps_trained": 120900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.243170674501923, "num_env_steps_trained_throughput_per_sec": 8.27418281527875, "timesteps_total": 63000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 63000, "timers": {"training_iteration_time_ms": 9021.838, "sample_time_ms": 8954.665, "load_time_ms": 0.261, "load_throughput": 298282.013, "learn_time_ms": 12.954, "learn_throughput": 6021.141, "synch_weights_time_ms": 12.814}, "counters": {"num_env_steps_sampled": 63000, "num_env_steps_trained": 120900, "num_agent_steps_sampled": 63000, "num_agent_steps_trained": 120900, "last_target_update_ts": 62920, "num_target_updates": 120}, "done": false, "episodes_total": 2441, "training_iteration": 63, "trial_id": "2058a_00000", "date": "2024-04-17_09-15-31", "timestamp": 1713345331, "time_this_iter_s": 235.68158888816833, "time_total_s": 14104.701679944992, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14104.701679944992, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 12.712537313432833, "ram_util_percent": 19.657611940298505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.016995297744870186, "cur_lr": 0.01}, "td_error": [1.3402023315429688, 1.3402029275894165, 1.3402034044265747, 1.3401988744735718, 1.3402034044265747, 1.3402032852172852, 2.85286021232605, 1.340202808380127, 1.3402025699615479, 1.3402031660079956, 1.3402035236358643, 1.3402035236358643, 1.3402029275894165, 1.3402001857757568, 1.340202808380127, 1.3402026891708374, 1.340203046798706, 1.3402026891708374, 1.3402036428451538, 0.904589831829071, 1.3402035236358643, 1.419065237045288, 1.3401771783828735, 1.3402025699615479, 1.557492971420288, 1.3402018547058105, 1.3402025699615479, 1.5998834371566772, 0.9045906066894531, 0.9045865535736084, 1.3402029275894165, 1.3402031660079956, 1.3402029275894165, 1.3402034044265747, 1.3402013778686523, 1.3402031660079956, 1.3402034044265747, 1.3401991128921509, 1.340202808380127, 1.340202808380127, 1.3402034044265747, 1.3402031660079956, 1.3402029275894165, 1.3402035236358643, 1.3402035236358643, 1.3402034044265747, 1.340201497077942, 1.3402034044265747, 1.3402032852172852, 3.9164557456970215, 1.340201497077942, 1.3402016162872314, 1.3402034044265747, 1.3402032852172852, 1.3402032852172852, 1.3402032852172852, 1.3402035236358643, 0.9045906066894531, 1.3402035236358643, 0.904589831829071, 1.4283462762832642, 1.3402031660079956, 1.3402034044265747, 1.3402007818222046, 0.904586911201477, 1.340203046798706, 1.340202808380127, 1.3402034044265747, 1.3402031660079956, 0.904587984085083, 1.3402025699615479, 1.4190409183502197, 2.8531219959259033, 1.3402025699615479, 1.340202808380127, 1.340202808380127, 1.340202808380127, 1.3402007818222046], "mean_td_error": 1.3821941614151, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1575.0, "diff_num_grad_updates_vs_sampler_policy": 1574.0}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 122850, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 122850, "last_target_update_ts": 63960, "num_target_updates": 122}, "sampler_results": {"episode_reward_max": 8.767279970297054, "episode_reward_min": -19.999803649440324, "episode_reward_mean": -1.8532683442057274, "episode_len_mean": 25.09, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999794112616103, 0.15369709924840835, 0.00020465863649368396, 0.00019582819047968766, 0.00020334859517194003, 0.0002053317633830672, 0.00020441793895670623, 0.11120652323560706, 0.43800222185148524, 0.00019435657963066228, 0.0002064511894313598, 0.0002055273954987498, 0.00020480485161655782, 0.17034817088118742, 0.00019538452964957902, -9.999792947914852, 0.00020641327538033953, 0.00020553998784910804, 0.00020462431307173015, 0.27446286559658317, 0.0002015354946288913, 1.3454076941995181, 0.00020013116038895156, 0.00019928979974571918, 0.0001987247795722275, 0.00020187770747814187, -9.999798763351828, 0.0002004649281158864, 0.00019962076474822838, 0.00019905386868990523, 0.00020210561430657886, 0.00020132729265897006, 0.00020047586633346567, 0.0001999041092673716, 0.1268095723929802, 0.00020154377470837115, -9.999799229353801, 0.00019992303889905104, 0.00019935442686404767, -9.958276757850104, 0.00020269811018049203, 0.00020191522720733118, -9.999798941722524, 0.1289556102685077, 0.00019193327244535003, 0.00020182522208439516, -9.758895185829054, 0.00020043054233031998, -9.999800413987963, 0.0001990199652656491, 0.00020288933663077237, 0.0002022417817263271, 0.07498198923243701, -9.999799334798567, 0.00020009465757934522, -19.99979670240253, 0.00019453034133297165, 0.00020200509939255517, 0.0002013631673896424, 0.00020059054272427874, 0.000190222511715208, -9.999802639528633, -9.999803294375315, -9.999803936758132, 1.8556564539802238, 2.13397167525473, -9.999802312963594, 0.00019702924491445467, 0.00019638402533957427, 0.00019584774423215905, 0.1105726825192854, -9.999802012982002, 0.00019733545858936435, 0.00019679397483700602, 0.000196247195358473, 0.0001980734966341553, 0.00019741319742556091, 0.26709406215592096, 0.00019628264211199188, 0.17454422655286994, 2.3585896031024784, 0.00019846271073265746, 0.6496039663489437, 3.7343202411910847, 0.0001967239641159857, 0.00019050424772053249, 0.00019765155260559415, 0.0001969940591238021, -19.999803649440324, -9.999804185240349, 0.00019152995281673595, -9.999801288457897, 8.767279970297054, 0.00019739560003045312, 0.2555411205712097, 0.3475527793950434, 0.00019918998687307223, 0.8963741317161391, -9.999802175495171, 0.00019716579984259947], "episode_lengths": [26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 26, 25, 24, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 27, 24, 25, 25, 25, 24, 26, 26, 26, 25, 24, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 27, 26, 24, 26, 25, 25, 25, 25, 25, 24, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.60462959062266, "mean_inference_ms": 2.1126842397969794, "mean_action_processing_ms": 0.14445632820407858, "mean_env_wait_ms": 1.4648824684024444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010008573532104492, "StateBufferConnector_ms": 0.006251096725463867, "ViewRequirementAgentConnector_ms": 0.17510557174682617}}, "episode_reward_max": 8.767279970297054, "episode_reward_min": -19.999803649440324, "episode_reward_mean": -1.8532683442057274, "episode_len_mean": 25.09, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999794112616103, 0.15369709924840835, 0.00020465863649368396, 0.00019582819047968766, 0.00020334859517194003, 0.0002053317633830672, 0.00020441793895670623, 0.11120652323560706, 0.43800222185148524, 0.00019435657963066228, 0.0002064511894313598, 0.0002055273954987498, 0.00020480485161655782, 0.17034817088118742, 0.00019538452964957902, -9.999792947914852, 0.00020641327538033953, 0.00020553998784910804, 0.00020462431307173015, 0.27446286559658317, 0.0002015354946288913, 1.3454076941995181, 0.00020013116038895156, 0.00019928979974571918, 0.0001987247795722275, 0.00020187770747814187, -9.999798763351828, 0.0002004649281158864, 0.00019962076474822838, 0.00019905386868990523, 0.00020210561430657886, 0.00020132729265897006, 0.00020047586633346567, 0.0001999041092673716, 0.1268095723929802, 0.00020154377470837115, -9.999799229353801, 0.00019992303889905104, 0.00019935442686404767, -9.958276757850104, 0.00020269811018049203, 0.00020191522720733118, -9.999798941722524, 0.1289556102685077, 0.00019193327244535003, 0.00020182522208439516, -9.758895185829054, 0.00020043054233031998, -9.999800413987963, 0.0001990199652656491, 0.00020288933663077237, 0.0002022417817263271, 0.07498198923243701, -9.999799334798567, 0.00020009465757934522, -19.99979670240253, 0.00019453034133297165, 0.00020200509939255517, 0.0002013631673896424, 0.00020059054272427874, 0.000190222511715208, -9.999802639528633, -9.999803294375315, -9.999803936758132, 1.8556564539802238, 2.13397167525473, -9.999802312963594, 0.00019702924491445467, 0.00019638402533957427, 0.00019584774423215905, 0.1105726825192854, -9.999802012982002, 0.00019733545858936435, 0.00019679397483700602, 0.000196247195358473, 0.0001980734966341553, 0.00019741319742556091, 0.26709406215592096, 0.00019628264211199188, 0.17454422655286994, 2.3585896031024784, 0.00019846271073265746, 0.6496039663489437, 3.7343202411910847, 0.0001967239641159857, 0.00019050424772053249, 0.00019765155260559415, 0.0001969940591238021, -19.999803649440324, -9.999804185240349, 0.00019152995281673595, -9.999801288457897, 8.767279970297054, 0.00019739560003045312, 0.2555411205712097, 0.3475527793950434, 0.00019918998687307223, 0.8963741317161391, -9.999802175495171, 0.00019716579984259947], "episode_lengths": [26, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 26, 25, 24, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 27, 24, 25, 25, 25, 24, 26, 26, 26, 25, 24, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 27, 26, 24, 26, 25, 25, 25, 25, 25, 24, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.60462959062266, "mean_inference_ms": 2.1126842397969794, "mean_action_processing_ms": 0.14445632820407858, "mean_env_wait_ms": 1.4648824684024444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010008573532104492, "StateBufferConnector_ms": 0.006251096725463867, "ViewRequirementAgentConnector_ms": 0.17510557174682617}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 122850, "num_env_steps_sampled": 64000, "num_env_steps_trained": 122850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.8794029865048043, "num_env_steps_trained_throughput_per_sec": 7.564835823684368, "timesteps_total": 64000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 11259.838, "sample_time_ms": 11194.465, "load_time_ms": 0.247, "load_throughput": 315939.847, "learn_time_ms": 13.265, "learn_throughput": 5880.267, "synch_weights_time_ms": 11.686}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 122850, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 122850, "last_target_update_ts": 63960, "num_target_updates": 122}, "done": false, "episodes_total": 2481, "training_iteration": 64, "trial_id": "2058a_00000", "date": "2024-04-17_09-19-49", "timestamp": 1713345589, "time_this_iter_s": 257.7805025577545, "time_total_s": 14362.482182502747, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14362.482182502747, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 11.624250681198909, "ram_util_percent": 19.76539509536785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.029972421005368233, "cur_lr": 0.01}, "td_error": [1.327939748764038, 1.327939510345459, 1.4147577285766602, 1.6452300548553467, 1.3279393911361694, 0.8841628432273865, 1.327939510345459, 1.3279396295547485, 1.3279396295547485, 0.8841626048088074, 1.3279396295547485, 0.8841629028320312, 1.3279396295547485, 0.8841623663902283, 1.327939510345459, 1.3279393911361694, 1.3279439210891724, 1.327939510345459, 1.4006600379943848, 1.3279393911361694, 0.8841626644134521, 1.3279398679733276, 1.3279393911361694, 1.327939510345459, 1.3279409408569336, 1.3279403448104858, 1.3279396295547485, 1.327939510345459, 1.3279398679733276, 1.327939510345459, 1.327939510345459, 1.327939510345459, 1.3279399871826172, 0.8841629028320312, 1.3279393911361694, 1.327939748764038, 1.0480777025222778, 1.3279412984848022, 1.327939510345459, 1.3279393911361694, 0.8841602802276611, 1.3279393911361694, 1.3279396295547485, 1.3800104856491089, 1.3279409408569336, 2.9850878715515137, 1.3279396295547485, 1.3279396295547485, 1.3279396295547485, 1.327939510345459, 0.8841624855995178, 1.3279393911361694, 1.9150453805923462, 1.3279396295547485, 1.3279396295547485, 1.327939510345459, 0.8841627836227417, 1.327939748764038, 1.3279396295547485, 0.8841624855995178, 1.3279396295547485, 1.327939510345459, 1.327939510345459, 0.884162187576294, 1.3279398679733276, 1.327939748764038, 1.3279414176940918, 0.7023527026176453, 1.32794189453125, 0.884162187576294, 3.233459949493408, 0.8841629028320312, 1.5430420637130737, 1.3279401063919067, 1.327939748764038, 1.400711178779602, 1.3279393911361694, 1.327939748764038], "mean_td_error": 1.3060424327850342, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1600.0, "diff_num_grad_updates_vs_sampler_policy": 1599.0}}, "num_env_steps_sampled": 65000, "num_env_steps_trained": 124800, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 124800, "last_target_update_ts": 65000, "num_target_updates": 124}, "sampler_results": {"episode_reward_max": 8.767279970297054, "episode_reward_min": -19.999805017306063, "episode_reward_mean": -2.4236647671442713, "episode_len_mean": 25.2, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00020269811018049203, 0.00020191522720733118, -9.999798941722524, 0.1289556102685077, 0.00019193327244535003, 0.00020182522208439516, -9.758895185829054, 0.00020043054233031998, -9.999800413987963, 0.0001990199652656491, 0.00020288933663077237, 0.0002022417817263271, 0.07498198923243701, -9.999799334798567, 0.00020009465757934522, -19.99979670240253, 0.00019453034133297165, 0.00020200509939255517, 0.0002013631673896424, 0.00020059054272427874, 0.000190222511715208, -9.999802639528633, -9.999803294375315, -9.999803936758132, 1.8556564539802238, 2.13397167525473, -9.999802312963594, 0.00019702924491445467, 0.00019638402533957427, 0.00019584774423215905, 0.1105726825192854, -9.999802012982002, 0.00019733545858936435, 0.00019679397483700602, 0.000196247195358473, 0.0001980734966341553, 0.00019741319742556091, 0.26709406215592096, 0.00019628264211199188, 0.17454422655286994, 2.3585896031024784, 0.00019846271073265746, 0.6496039663489437, 3.7343202411910847, 0.0001967239641159857, 0.00019050424772053249, 0.00019765155260559415, 0.0001969940591238021, -19.999803649440324, -9.999804185240349, 0.00019152995281673595, -9.999801288457897, 8.767279970297054, 0.00019739560003045312, 0.2555411205712097, 0.3475527793950434, 0.00019918998687307223, 0.8963741317161391, -9.999802175495171, 0.00019716579984259947, 0.00019498937866205938, -9.999805530964943, 0.00019393593417709287, 3.2878442403384196, 0.00019258019540618424, 0.5673972482947306, 0.00019479089008353763, 0.43479436041649255, -9.999806391670603, -9.682444624060006, 0.00019572006439781854, 0.00019518015353520876, 0.0001945141966106748, 0.00019380502888987803, 0.00019316528730436294, -9.99980476281006, -9.999805300712874, -9.400354594485442, 0.00019333671476294852, -9.999807299884237, 0.00019619427211621242, 0.00019565174563019742, -19.999805017306063, 0.000194269991407843, 0.1017949013202818, -9.999804728309412, -9.877047076665653, 0.00019424712610913525, 0.1902582606691052, 0.00019290502352616417, 0.00019632473484753363, 0.00019579718779270337, 0.00019525685196386893, 0.0001945903724385336, 0.00019388065018043294, 0.000196519687127319, 0.00019598266572314394, 0.00019544037877590337, 0.00019491756765721625, 0.00019438206883003246], "episode_lengths": [25, 25, 26, 25, 24, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 27, 24, 25, 25, 25, 24, 26, 26, 26, 25, 24, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 27, 26, 24, 26, 25, 25, 25, 25, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 26, 26, 25, 26, 25, 25, 27, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.85886466271427, "mean_inference_ms": 2.1121462196814065, "mean_action_processing_ms": 0.14442638104310476, "mean_env_wait_ms": 1.4438819131734828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010685443878173828, "StateBufferConnector_ms": 0.006267547607421875, "ViewRequirementAgentConnector_ms": 0.17522859573364258}}, "episode_reward_max": 8.767279970297054, "episode_reward_min": -19.999805017306063, "episode_reward_mean": -2.4236647671442713, "episode_len_mean": 25.2, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00020269811018049203, 0.00020191522720733118, -9.999798941722524, 0.1289556102685077, 0.00019193327244535003, 0.00020182522208439516, -9.758895185829054, 0.00020043054233031998, -9.999800413987963, 0.0001990199652656491, 0.00020288933663077237, 0.0002022417817263271, 0.07498198923243701, -9.999799334798567, 0.00020009465757934522, -19.99979670240253, 0.00019453034133297165, 0.00020200509939255517, 0.0002013631673896424, 0.00020059054272427874, 0.000190222511715208, -9.999802639528633, -9.999803294375315, -9.999803936758132, 1.8556564539802238, 2.13397167525473, -9.999802312963594, 0.00019702924491445467, 0.00019638402533957427, 0.00019584774423215905, 0.1105726825192854, -9.999802012982002, 0.00019733545858936435, 0.00019679397483700602, 0.000196247195358473, 0.0001980734966341553, 0.00019741319742556091, 0.26709406215592096, 0.00019628264211199188, 0.17454422655286994, 2.3585896031024784, 0.00019846271073265746, 0.6496039663489437, 3.7343202411910847, 0.0001967239641159857, 0.00019050424772053249, 0.00019765155260559415, 0.0001969940591238021, -19.999803649440324, -9.999804185240349, 0.00019152995281673595, -9.999801288457897, 8.767279970297054, 0.00019739560003045312, 0.2555411205712097, 0.3475527793950434, 0.00019918998687307223, 0.8963741317161391, -9.999802175495171, 0.00019716579984259947, 0.00019498937866205938, -9.999805530964943, 0.00019393593417709287, 3.2878442403384196, 0.00019258019540618424, 0.5673972482947306, 0.00019479089008353763, 0.43479436041649255, -9.999806391670603, -9.682444624060006, 0.00019572006439781854, 0.00019518015353520876, 0.0001945141966106748, 0.00019380502888987803, 0.00019316528730436294, -9.99980476281006, -9.999805300712874, -9.400354594485442, 0.00019333671476294852, -9.999807299884237, 0.00019619427211621242, 0.00019565174563019742, -19.999805017306063, 0.000194269991407843, 0.1017949013202818, -9.999804728309412, -9.877047076665653, 0.00019424712610913525, 0.1902582606691052, 0.00019290502352616417, 0.00019632473484753363, 0.00019579718779270337, 0.00019525685196386893, 0.0001945903724385336, 0.00019388065018043294, 0.000196519687127319, 0.00019598266572314394, 0.00019544037877590337, 0.00019491756765721625, 0.00019438206883003246], "episode_lengths": [25, 25, 26, 25, 24, 25, 26, 25, 26, 25, 25, 25, 25, 26, 25, 27, 24, 25, 25, 25, 24, 26, 26, 26, 25, 24, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 27, 26, 24, 26, 25, 25, 25, 25, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 26, 26, 25, 26, 25, 25, 27, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 425.85886466271427, "mean_inference_ms": 2.1121462196814065, "mean_action_processing_ms": 0.14442638104310476, "mean_env_wait_ms": 1.4438819131734828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010685443878173828, "StateBufferConnector_ms": 0.006267547607421875, "ViewRequirementAgentConnector_ms": 0.17522859573364258}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 124800, "num_env_steps_sampled": 65000, "num_env_steps_trained": 124800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.6047560719334983, "num_env_steps_trained_throughput_per_sec": 7.029274340270322, "timesteps_total": 65000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 65000, "timers": {"training_iteration_time_ms": 11126.071, "sample_time_ms": 11062.559, "load_time_ms": 0.24, "load_throughput": 324946.079, "learn_time_ms": 12.871, "learn_throughput": 6059.932, "synch_weights_time_ms": 12.464}, "counters": {"num_env_steps_sampled": 65000, "num_env_steps_trained": 124800, "num_agent_steps_sampled": 65000, "num_agent_steps_trained": 124800, "last_target_update_ts": 65000, "num_target_updates": 124}, "done": false, "episodes_total": 2521, "training_iteration": 65, "trial_id": "2058a_00000", "date": "2024-04-17_09-24-27", "timestamp": 1713345867, "time_this_iter_s": 277.41995787620544, "time_total_s": 14639.902140378952, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14639.902140378952, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 10.845177664974619, "ram_util_percent": 19.88071065989848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04841507598757744, "cur_lr": 0.01}, "td_error": [1.3023556470870972, 1.3023546934127808, 1.3023548126220703, 1.3023558855056763, 0.8765299320220947, 1.3023555278778076, 1.3038232326507568, 1.3023558855056763, 1.3023558855056763, 1.3023544549942017, 1.3023558855056763, 1.3023557662963867, 1.3023552894592285, 1.3023557662963867, 1.302354335784912, 1.3023552894592285, 1.3023557662963867, 1.376390814781189, 0.8765296936035156, 1.3023556470870972, 0.8765288591384888, 1.3023558855056763, 0.876526415348053, 0.8765295743942261, 1.3023557662963867, 1.3023546934127808, 1.4957588911056519, 1.3023558855056763, 1.3023557662963867, 1.3023557662963867, 1.302355170249939, 1.3023560047149658, 0.8765292167663574, 1.3023557662963867, 1.3020228147506714, 1.3023545742034912, 1.3023558855056763, 1.302354335784912, 1.3023557662963867, 1.3023545742034912, 1.3023558855056763, 2.5795960426330566, 1.3023557662963867, 1.3023558855056763, 1.3023560047149658, 1.3023560047149658, 1.3023558855056763, 1.3023558855056763, 1.3023556470870972, 1.302355408668518, 0.8765265941619873, 1.4164255857467651, 1.3023560047149658, 1.3023558855056763, 1.3023558855056763, 1.3023558855056763, 1.3023557662963867, 1.302355170249939, 1.3023558855056763, 1.376391887664795, 1.3023557662963867, 1.3023552894592285, 1.3023558855056763, 1.3023536205291748, 0.8765295743942261, 1.3023557662963867, 1.3023560047149658, 1.3023555278778076, 1.3023557662963867, 1.3023560047149658, 1.302354335784912, 1.3023558855056763, 1.3023558855056763, 1.3023557662963867, 1.3023556470870972, 1.3023507595062256, 1.3023550510406494, 1.302355408668518], "mean_td_error": 1.2809107303619385, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1625.0, "diff_num_grad_updates_vs_sampler_policy": 1624.0}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 126750, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 126750, "last_target_update_ts": 65520, "num_target_updates": 125}, "sampler_results": {"episode_reward_max": 8.767279970297054, "episode_reward_min": -19.999805017306063, "episode_reward_mean": -2.2175042636303224, "episode_len_mean": 25.15, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.3585896031024784, 0.00019846271073265746, 0.6496039663489437, 3.7343202411910847, 0.0001967239641159857, 0.00019050424772053249, 0.00019765155260559415, 0.0001969940591238021, -19.999803649440324, -9.999804185240349, 0.00019152995281673595, -9.999801288457897, 8.767279970297054, 0.00019739560003045312, 0.2555411205712097, 0.3475527793950434, 0.00019918998687307223, 0.8963741317161391, -9.999802175495171, 0.00019716579984259947, 0.00019498937866205938, -9.999805530964943, 0.00019393593417709287, 3.2878442403384196, 0.00019258019540618424, 0.5673972482947306, 0.00019479089008353763, 0.43479436041649255, -9.999806391670603, -9.682444624060006, 0.00019572006439781854, 0.00019518015353520876, 0.0001945141966106748, 0.00019380502888987803, 0.00019316528730436294, -9.99980476281006, -9.999805300712874, -9.400354594485442, 0.00019333671476294852, -9.999807299884237, 0.00019619427211621242, 0.00019565174563019742, -19.999805017306063, 0.000194269991407843, 0.1017949013202818, -9.999804728309412, -9.877047076665653, 0.00019424712610913525, 0.1902582606691052, 0.00019290502352616417, 0.00019632473484753363, 0.00019579718779270337, 0.00019525685196386893, 0.0001945903724385336, 0.00019388065018043294, 0.000196519687127319, 0.00019598266572314394, 0.00019544037877590337, 0.00019491756765721625, 0.00019438206883003246, 0.00019194850140090658, -8.50116847948607, -9.999809376407883, 0.0001899055403757709, 0.0001816795461863776, 0.0001923156173803081, 0.00019170683634466977, 0.00019098330376869866, 0.00019026260263557652, 0.0001820199595573488, 1.1106467483364264, 0.09491899984125103, 0.0001911425381241048, 0.0001828588470537519, 0.00018967471993323016, 0.000192088842598692, 0.00019136242933556869, -9.999809361072536, 0.00018237867712873383, -9.999810820718789, 0.00019305832447681095, -9.809742947780896, -9.896918083210402, 0.00018343575832482039, 0.0001902706038333081, -9.961388509706282, -9.130600193440081, 0.00019101182640066808, 0.00019029091038339478, 0.0001820469471989633, 0.00019324041007279577, 0.00019262576926695624, 0.0001918952974336233, 0.09759564710414409, 0.06911312231457513, -9.999806278402502, 0.00019301812748690682, 0.00019238356194740405, 0.04433148383181366, 1.4869998860666003], "episode_lengths": [25, 25, 25, 25, 25, 24, 25, 25, 27, 26, 24, 26, 25, 25, 25, 25, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 26, 26, 25, 26, 25, 25, 27, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 26, 25, 26, 26, 24, 25, 26, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.09235681083123, "mean_inference_ms": 2.1117685651971865, "mean_action_processing_ms": 0.14440838574542547, "mean_env_wait_ms": 1.4235260872875102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010676383972167969, "StateBufferConnector_ms": 0.006342172622680664, "ViewRequirementAgentConnector_ms": 0.1757957935333252}}, "episode_reward_max": 8.767279970297054, "episode_reward_min": -19.999805017306063, "episode_reward_mean": -2.2175042636303224, "episode_len_mean": 25.15, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.3585896031024784, 0.00019846271073265746, 0.6496039663489437, 3.7343202411910847, 0.0001967239641159857, 0.00019050424772053249, 0.00019765155260559415, 0.0001969940591238021, -19.999803649440324, -9.999804185240349, 0.00019152995281673595, -9.999801288457897, 8.767279970297054, 0.00019739560003045312, 0.2555411205712097, 0.3475527793950434, 0.00019918998687307223, 0.8963741317161391, -9.999802175495171, 0.00019716579984259947, 0.00019498937866205938, -9.999805530964943, 0.00019393593417709287, 3.2878442403384196, 0.00019258019540618424, 0.5673972482947306, 0.00019479089008353763, 0.43479436041649255, -9.999806391670603, -9.682444624060006, 0.00019572006439781854, 0.00019518015353520876, 0.0001945141966106748, 0.00019380502888987803, 0.00019316528730436294, -9.99980476281006, -9.999805300712874, -9.400354594485442, 0.00019333671476294852, -9.999807299884237, 0.00019619427211621242, 0.00019565174563019742, -19.999805017306063, 0.000194269991407843, 0.1017949013202818, -9.999804728309412, -9.877047076665653, 0.00019424712610913525, 0.1902582606691052, 0.00019290502352616417, 0.00019632473484753363, 0.00019579718779270337, 0.00019525685196386893, 0.0001945903724385336, 0.00019388065018043294, 0.000196519687127319, 0.00019598266572314394, 0.00019544037877590337, 0.00019491756765721625, 0.00019438206883003246, 0.00019194850140090658, -8.50116847948607, -9.999809376407883, 0.0001899055403757709, 0.0001816795461863776, 0.0001923156173803081, 0.00019170683634466977, 0.00019098330376869866, 0.00019026260263557652, 0.0001820199595573488, 1.1106467483364264, 0.09491899984125103, 0.0001911425381241048, 0.0001828588470537519, 0.00018967471993323016, 0.000192088842598692, 0.00019136242933556869, -9.999809361072536, 0.00018237867712873383, -9.999810820718789, 0.00019305832447681095, -9.809742947780896, -9.896918083210402, 0.00018343575832482039, 0.0001902706038333081, -9.961388509706282, -9.130600193440081, 0.00019101182640066808, 0.00019029091038339478, 0.0001820469471989633, 0.00019324041007279577, 0.00019262576926695624, 0.0001918952974336233, 0.09759564710414409, 0.06911312231457513, -9.999806278402502, 0.00019301812748690682, 0.00019238356194740405, 0.04433148383181366, 1.4869998860666003], "episode_lengths": [25, 25, 25, 25, 25, 24, 25, 25, 27, 26, 24, 26, 25, 25, 25, 25, 25, 24, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 26, 26, 26, 25, 26, 25, 25, 27, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 26, 25, 26, 26, 24, 25, 26, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.09235681083123, "mean_inference_ms": 2.1117685651971865, "mean_action_processing_ms": 0.14440838574542547, "mean_env_wait_ms": 1.4235260872875102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010676383972167969, "StateBufferConnector_ms": 0.006342172622680664, "ViewRequirementAgentConnector_ms": 0.1757957935333252}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 126750, "num_env_steps_sampled": 66000, "num_env_steps_trained": 126750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.459579642250466, "num_env_steps_trained_throughput_per_sec": 8.696180302388408, "timesteps_total": 66000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 8968.532, "sample_time_ms": 8907.242, "load_time_ms": 0.236, "load_throughput": 330794.451, "learn_time_ms": 12.594, "learn_throughput": 6193.374, "synch_weights_time_ms": 11.252}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 126750, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 126750, "last_target_update_ts": 65520, "num_target_updates": 125}, "done": false, "episodes_total": 2561, "training_iteration": 66, "trial_id": "2058a_00000", "date": "2024-04-17_09-28-11", "timestamp": 1713346091, "time_this_iter_s": 224.2448332309723, "time_total_s": 14864.146973609924, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14864.146973609924, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 13.218808777429464, "ram_util_percent": 20.000313479623827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.025003701448440552, "cur_lr": 0.01}, "td_error": [1.3553186655044556, 1.2888273000717163, 1.2888273000717163, 1.2888273000717163, 1.2888273000717163, 1.2888271808624268, 1.2888271808624268, 1.2888273000717163, 1.2888271808624268, 1.2888271808624268, 1.2888273000717163, 1.2888273000717163, 1.2888273000717163, 1.2888273000717163, 1.2888274192810059, 1.2888271808624268, 1.4385547637939453, 1.2888273000717163, 0.8670178651809692, 1.2888273000717163, 1.2888273000717163, 1.2888274192810059, 1.2888273000717163, 1.2888271808624268, 1.3553736209869385, 1.2888273000717163, 1.2888273000717163, 1.2888273000717163, 1.2888271808624268, 1.2888273000717163, 0.8670185804367065, 1.2888273000717163, 1.2888274192810059, 1.2888273000717163, 1.2888273000717163, 1.2888273000717163, 1.2888273000717163, 1.2888271808624268, 1.2888271808624268, 1.2888273000717163, 1.2888274192810059, 1.2888273000717163, 1.2888271808624268, 1.2888274192810059, 1.4764727354049683, 1.2888271808624268, 0.867018461227417, 1.2888271808624268, 1.2888273000717163, 1.2888271808624268, 1.2888273000717163, 1.2888271808624268, 1.2888273000717163, 1.2888271808624268, 1.2888271808624268, 1.2888273000717163, 1.2888271808624268, 1.2888273000717163, 1.2888274192810059, 1.2888271808624268, 1.2888273000717163, 1.2888273000717163, 1.2888271808624268, 1.2888263463974, 1.2888274192810059, 1.2888273000717163, 1.2888269424438477, 1.4368659257888794, 1.3553599119186401, 1.2888273000717163, 1.2888271808624268, 1.331932783126831, 1.2888273000717163, 1.2888273000717163, 1.3548758029937744, 1.2888270616531372, 1.2888273000717163, 0.8670119047164917], "mean_td_error": 1.2773772478103638, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1650.0, "diff_num_grad_updates_vs_sampler_policy": 1649.0}}, "num_env_steps_sampled": 67000, "num_env_steps_trained": 128700, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 128700, "last_target_update_ts": 66560, "num_target_updates": 127}, "sampler_results": {"episode_reward_max": 1.4869998860666003, "episode_reward_min": -19.999805017306063, "episode_reward_mean": -2.0822610926508514, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00019619427211621242, 0.00019565174563019742, -19.999805017306063, 0.000194269991407843, 0.1017949013202818, -9.999804728309412, -9.877047076665653, 0.00019424712610913525, 0.1902582606691052, 0.00019290502352616417, 0.00019632473484753363, 0.00019579718779270337, 0.00019525685196386893, 0.0001945903724385336, 0.00019388065018043294, 0.000196519687127319, 0.00019598266572314394, 0.00019544037877590337, 0.00019491756765721625, 0.00019438206883003246, 0.00019194850140090658, -8.50116847948607, -9.999809376407883, 0.0001899055403757709, 0.0001816795461863776, 0.0001923156173803081, 0.00019170683634466977, 0.00019098330376869866, 0.00019026260263557652, 0.0001820199595573488, 1.1106467483364264, 0.09491899984125103, 0.0001911425381241048, 0.0001828588470537519, 0.00018967471993323016, 0.000192088842598692, 0.00019136242933556869, -9.999809361072536, 0.00018237867712873383, -9.999810820718789, 0.00019305832447681095, -9.809742947780896, -9.896918083210402, 0.00018343575832482039, 0.0001902706038333081, -9.961388509706282, -9.130600193440081, 0.00019101182640066808, 0.00019029091038339478, 0.0001820469471989633, 0.00019324041007279577, 0.00019262576926695624, 0.0001918952974336233, 0.09759564710414409, 0.06911312231457513, -9.999806278402502, 0.00019301812748690682, 0.00019238356194740405, 0.04433148383181366, 1.4869998860666003, 0.12096144522264922, -9.999812295909964, 0.0001869514269609713, 0.00018625764078200927, 0.00018562096069999487, -9.99981119172672, -9.999811975621558, 0.00018726949858296338, 0.00018657335382580252, 0.00018593451736479728, 0.00018888362881019306, 0.00018812190488342098, 0.11935432961293158, -9.999813191699582, 0.00018607226509615, -9.99981160816425, -9.99981236593481, 0.33058310659025375, 0.00018630801231026112, -9.999814422549186, -9.999810523285396, 0.00018870805703732473, 0.00018800119521447987, -7.411448724696288, 0.00018662297771784235, 0.41113863053128463, 0.9418309220917253, 0.2314905141848674, 0.00018669827196937024, 0.00018605858129113343, 0.9071225446559988, 0.0001890055773144675, 0.00018824287153193156, 0.00018753948420228614, 0.00018689402632395444, 0.0001903924752979783, 0.00018214377549688812, 0.00018893611012904633, 0.00018815115566774297, 0.08944201104398218], "episode_lengths": [25, 25, 27, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 26, 25, 26, 26, 24, 25, 26, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 25, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.3120041002598, "mean_inference_ms": 2.111094378928593, "mean_action_processing_ms": 0.14438250803906963, "mean_env_wait_ms": 1.4037639806780964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009370803833007812, "StateBufferConnector_ms": 0.006215572357177734, "ViewRequirementAgentConnector_ms": 0.17312097549438477}}, "episode_reward_max": 1.4869998860666003, "episode_reward_min": -19.999805017306063, "episode_reward_mean": -2.0822610926508514, "episode_len_mean": 25.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00019619427211621242, 0.00019565174563019742, -19.999805017306063, 0.000194269991407843, 0.1017949013202818, -9.999804728309412, -9.877047076665653, 0.00019424712610913525, 0.1902582606691052, 0.00019290502352616417, 0.00019632473484753363, 0.00019579718779270337, 0.00019525685196386893, 0.0001945903724385336, 0.00019388065018043294, 0.000196519687127319, 0.00019598266572314394, 0.00019544037877590337, 0.00019491756765721625, 0.00019438206883003246, 0.00019194850140090658, -8.50116847948607, -9.999809376407883, 0.0001899055403757709, 0.0001816795461863776, 0.0001923156173803081, 0.00019170683634466977, 0.00019098330376869866, 0.00019026260263557652, 0.0001820199595573488, 1.1106467483364264, 0.09491899984125103, 0.0001911425381241048, 0.0001828588470537519, 0.00018967471993323016, 0.000192088842598692, 0.00019136242933556869, -9.999809361072536, 0.00018237867712873383, -9.999810820718789, 0.00019305832447681095, -9.809742947780896, -9.896918083210402, 0.00018343575832482039, 0.0001902706038333081, -9.961388509706282, -9.130600193440081, 0.00019101182640066808, 0.00019029091038339478, 0.0001820469471989633, 0.00019324041007279577, 0.00019262576926695624, 0.0001918952974336233, 0.09759564710414409, 0.06911312231457513, -9.999806278402502, 0.00019301812748690682, 0.00019238356194740405, 0.04433148383181366, 1.4869998860666003, 0.12096144522264922, -9.999812295909964, 0.0001869514269609713, 0.00018625764078200927, 0.00018562096069999487, -9.99981119172672, -9.999811975621558, 0.00018726949858296338, 0.00018657335382580252, 0.00018593451736479728, 0.00018888362881019306, 0.00018812190488342098, 0.11935432961293158, -9.999813191699582, 0.00018607226509615, -9.99981160816425, -9.99981236593481, 0.33058310659025375, 0.00018630801231026112, -9.999814422549186, -9.999810523285396, 0.00018870805703732473, 0.00018800119521447987, -7.411448724696288, 0.00018662297771784235, 0.41113863053128463, 0.9418309220917253, 0.2314905141848674, 0.00018669827196937024, 0.00018605858129113343, 0.9071225446559988, 0.0001890055773144675, 0.00018824287153193156, 0.00018753948420228614, 0.00018689402632395444, 0.0001903924752979783, 0.00018214377549688812, 0.00018893611012904633, 0.00018815115566774297, 0.08944201104398218], "episode_lengths": [25, 25, 27, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 26, 24, 26, 25, 26, 26, 24, 25, 26, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 25, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.3120041002598, "mean_inference_ms": 2.111094378928593, "mean_action_processing_ms": 0.14438250803906963, "mean_env_wait_ms": 1.4037639806780964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009370803833007812, "StateBufferConnector_ms": 0.006215572357177734, "ViewRequirementAgentConnector_ms": 0.17312097549438477}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 128700, "num_env_steps_sampled": 67000, "num_env_steps_trained": 128700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.092506258580437, "num_env_steps_trained_throughput_per_sec": 7.980387204231853, "timesteps_total": 67000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 67000, "timers": {"training_iteration_time_ms": 8986.82, "sample_time_ms": 8924.429, "load_time_ms": 0.257, "load_throughput": 303906.839, "learn_time_ms": 12.738, "learn_throughput": 6123.622, "synch_weights_time_ms": 11.466}, "counters": {"num_env_steps_sampled": 67000, "num_env_steps_trained": 128700, "num_agent_steps_sampled": 67000, "num_agent_steps_trained": 128700, "last_target_update_ts": 66560, "num_target_updates": 127}, "done": false, "episodes_total": 2601, "training_iteration": 67, "trial_id": "2058a_00000", "date": "2024-04-17_09-32-15", "timestamp": 1713346335, "time_this_iter_s": 244.3575360774994, "time_total_s": 15108.504509687424, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15108.504509687424, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 12.25287356321839, "ram_util_percent": 20.137931034482754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03265002742409706, "cur_lr": 0.01}, "td_error": [1.232060194015503, 1.2320598363876343, 1.2320600748062134, 1.2320599555969238, 1.2320599555969238, 1.2320598363876343, 1.2320613861083984, 1.2320599555969238, 1.2320598363876343, 1.2320613861083984, 1.2320605516433716, 1.232060194015503, 1.2320600748062134, 1.2320600748062134, 0.8477926254272461, 1.232060432434082, 1.2320598363876343, 0.8477926254272461, 1.2320598363876343, 0.8477928638458252, 1.2320600748062134, 1.2320599555969238, 1.232061743736267, 0.8477927446365356, 0.8477926254272461, 1.232060194015503, 1.3465983867645264, 0.8477927446365356, 1.2320598363876343, 1.2320598363876343, 1.2320607900619507, 1.2320598363876343, 1.2320599555969238, 1.2320599555969238, 1.2320598363876343, 1.232060194015503, 1.3065204620361328, 0.8477926254272461, 1.2320599555969238, 1.2320599555969238, 0.8477926254272461, 1.232060432434082, 1.2320599555969238, 1.2320597171783447, 0.8477926254272461, 1.232060194015503, 0.8477926254272461, 1.2320599555969238, 1.232060194015503, 1.2320607900619507, 1.2320599555969238, 1.2320599555969238, 1.2320599555969238, 1.2320599555969238, 1.4871894121170044, 0.8477926254272461, 1.2320599555969238, 1.2320598363876343, 1.2320821285247803, 1.2320599555969238, 1.2320598363876343, 1.232060194015503, 1.2320599555969238, 1.2320599555969238, 0.8477926254272461, 1.2320599555969238, 1.2320600748062134, 1.2320598363876343, 1.2320600748062134, 1.2320597171783447, 1.2320598363876343, 1.2320599555969238, 1.2973227500915527, 1.2320599555969238, 1.297346830368042, 1.2320605516433716, 1.232060194015503, 1.232060194015503], "mean_td_error": 1.1803100109100342, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1675.0, "diff_num_grad_updates_vs_sampler_policy": 1674.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 130650, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 130650, "last_target_update_ts": 67600, "num_target_updates": 129}, "sampler_results": {"episode_reward_max": 2.1648928055182264, "episode_reward_min": -9.999816834431012, "episode_reward_mean": -1.9556144396360327, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00019305832447681095, -9.809742947780896, -9.896918083210402, 0.00018343575832482039, 0.0001902706038333081, -9.961388509706282, -9.130600193440081, 0.00019101182640066808, 0.00019029091038339478, 0.0001820469471989633, 0.00019324041007279577, 0.00019262576926695624, 0.0001918952974336233, 0.09759564710414409, 0.06911312231457513, -9.999806278402502, 0.00019301812748690682, 0.00019238356194740405, 0.04433148383181366, 1.4869998860666003, 0.12096144522264922, -9.999812295909964, 0.0001869514269609713, 0.00018625764078200927, 0.00018562096069999487, -9.99981119172672, -9.999811975621558, 0.00018726949858296338, 0.00018657335382580252, 0.00018593451736479728, 0.00018888362881019306, 0.00018812190488342098, 0.11935432961293158, -9.999813191699582, 0.00018607226509615, -9.99981160816425, -9.99981236593481, 0.33058310659025375, 0.00018630801231026112, -9.999814422549186, -9.999810523285396, 0.00018870805703732473, 0.00018800119521447987, -7.411448724696288, 0.00018662297771784235, 0.41113863053128463, 0.9418309220917253, 0.2314905141848674, 0.00018669827196937024, 0.00018605858129113343, 0.9071225446559988, 0.0001890055773144675, 0.00018824287153193156, 0.00018753948420228614, 0.00018689402632395444, 0.0001903924752979783, 0.00018214377549688812, 0.00018893611012904633, 0.00018815115566774297, 0.08944201104398218, -9.999815105656527, 0.0001843087378454888, 0.10781398965108036, -9.999816834431012, 0.00018263653466960315, 0.0001852053930557944, 0.00018461787311192107, 0.00018393058037448156, 0.27313055344761317, 0.00018295034812116162, -9.999814520703804, 0.34223519253361345, 0.0001842945838947369, 0.00018375907124962767, 0.0001759580931300967, -8.051580220419956, 0.00018429770071037773, 0.0001837986479429855, 0.0001832660093801313, 0.00017548716513030396, 0.0001860264441410867, 0.00018532864351271242, -9.29967303250362, 0.00018429016757701226, 0.0001764653409802304, 0.0001853284855081946, 0.00018474018559950966, 0.04322146714647725, 0.00018361474558533752, 0.05240750084467038, 0.00018615737186979293, -9.999814436138655, 0.00018486946575711416, 0.00018436731556131897, 0.00018383138076829658, 2.1648928055182264, -9.999813894622395, 0.00018537168478143984, 0.08018737706050162, 0.07245029627202472], "episode_lengths": [25, 26, 26, 24, 25, 26, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 25, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.5350820848525, "mean_inference_ms": 2.1104317446250223, "mean_action_processing_ms": 0.14434998963434462, "mean_env_wait_ms": 1.384599461165945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009790420532226562, "StateBufferConnector_ms": 0.006150960922241211, "ViewRequirementAgentConnector_ms": 0.17406368255615234}}, "episode_reward_max": 2.1648928055182264, "episode_reward_min": -9.999816834431012, "episode_reward_mean": -1.9556144396360327, "episode_len_mean": 25.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00019305832447681095, -9.809742947780896, -9.896918083210402, 0.00018343575832482039, 0.0001902706038333081, -9.961388509706282, -9.130600193440081, 0.00019101182640066808, 0.00019029091038339478, 0.0001820469471989633, 0.00019324041007279577, 0.00019262576926695624, 0.0001918952974336233, 0.09759564710414409, 0.06911312231457513, -9.999806278402502, 0.00019301812748690682, 0.00019238356194740405, 0.04433148383181366, 1.4869998860666003, 0.12096144522264922, -9.999812295909964, 0.0001869514269609713, 0.00018625764078200927, 0.00018562096069999487, -9.99981119172672, -9.999811975621558, 0.00018726949858296338, 0.00018657335382580252, 0.00018593451736479728, 0.00018888362881019306, 0.00018812190488342098, 0.11935432961293158, -9.999813191699582, 0.00018607226509615, -9.99981160816425, -9.99981236593481, 0.33058310659025375, 0.00018630801231026112, -9.999814422549186, -9.999810523285396, 0.00018870805703732473, 0.00018800119521447987, -7.411448724696288, 0.00018662297771784235, 0.41113863053128463, 0.9418309220917253, 0.2314905141848674, 0.00018669827196937024, 0.00018605858129113343, 0.9071225446559988, 0.0001890055773144675, 0.00018824287153193156, 0.00018753948420228614, 0.00018689402632395444, 0.0001903924752979783, 0.00018214377549688812, 0.00018893611012904633, 0.00018815115566774297, 0.08944201104398218, -9.999815105656527, 0.0001843087378454888, 0.10781398965108036, -9.999816834431012, 0.00018263653466960315, 0.0001852053930557944, 0.00018461787311192107, 0.00018393058037448156, 0.27313055344761317, 0.00018295034812116162, -9.999814520703804, 0.34223519253361345, 0.0001842945838947369, 0.00018375907124962767, 0.0001759580931300967, -8.051580220419956, 0.00018429770071037773, 0.0001837986479429855, 0.0001832660093801313, 0.00017548716513030396, 0.0001860264441410867, 0.00018532864351271242, -9.29967303250362, 0.00018429016757701226, 0.0001764653409802304, 0.0001853284855081946, 0.00018474018559950966, 0.04322146714647725, 0.00018361474558533752, 0.05240750084467038, 0.00018615737186979293, -9.999814436138655, 0.00018486946575711416, 0.00018436731556131897, 0.00018383138076829658, 2.1648928055182264, -9.999813894622395, 0.00018537168478143984, 0.08018737706050162, 0.07245029627202472], "episode_lengths": [25, 26, 26, 24, 25, 26, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 26, 25, 26, 26, 25, 25, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.5350820848525, "mean_inference_ms": 2.1104317446250223, "mean_action_processing_ms": 0.14434998963434462, "mean_env_wait_ms": 1.384599461165945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009790420532226562, "StateBufferConnector_ms": 0.006150960922241211, "ViewRequirementAgentConnector_ms": 0.17406368255615234}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 130650, "num_env_steps_sampled": 68000, "num_env_steps_trained": 130650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.561073533229705, "num_env_steps_trained_throughput_per_sec": 10.844093389797925, "timesteps_total": 68000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 6757.343, "sample_time_ms": 6693.438, "load_time_ms": 0.232, "load_throughput": 336337.732, "learn_time_ms": 12.999, "learn_throughput": 6000.314, "synch_weights_time_ms": 11.188}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 130650, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 130650, "last_target_update_ts": 67600, "num_target_updates": 129}, "done": false, "episodes_total": 2641, "training_iteration": 68, "trial_id": "2058a_00000", "date": "2024-04-17_09-35-15", "timestamp": 1713346515, "time_this_iter_s": 179.8319673538208, "time_total_s": 15288.336477041245, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15288.336477041245, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 16.323828125, "ram_util_percent": 20.207031249999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.02075819857418537, "cur_lr": 0.01}, "td_error": [1.1962906122207642, 1.1962909698486328, 1.1962308883666992, 1.1962907314300537, 1.1962907314300537, 1.196288824081421, 1.1962910890579224, 1.1962909698486328, 1.196288824081421, 1.1962896585464478, 1.196286678314209, 1.1962907314300537, 1.1962909698486328, 1.1962906122207642, 1.2574844360351562, 1.196290373802185, 1.1962909698486328, 1.1962907314300537, 1.1962908506393433, 3.0698671340942383, 1.1962907314300537, 0.8341452479362488, 1.1962906122207642, 1.196290135383606, 1.2574856281280518, 1.196291208267212, 1.1962908506393433, 0.7704852223396301, 1.1962897777557373, 1.1962909698486328, 1.196291208267212, 0.834144115447998, 1.4573782682418823, 1.1962898969650269, 3.3133811950683594, 1.1962890625, 1.1962897777557373, 1.1962906122207642, 1.1962909698486328, 1.1962857246398926, 1.1962907314300537, 1.196288824081421, 1.1962904930114746, 1.1962909698486328, 1.196291208267212, 1.1962909698486328, 1.1962909698486328, 1.1962907314300537, 1.196290135383606, 1.1962850093841553, 1.196291208267212, 1.1962913274765015, 1.1962895393371582, 1.196291208267212, 1.196291208267212, 1.1962906122207642, 1.1962904930114746, 1.1962897777557373, 1.196291208267212, 1.196291208267212, 0.8341460227966309, 1.196291208267212, 1.1962909698486328, 1.196291208267212, 1.4571661949157715, 0.8341413736343384, 2.6748032569885254, 1.1962906122207642, 1.1962908506393433, 1.196290135383606, 1.1962906122207642, 1.1962907314300537, 1.1962910890579224, 1.1962906122207642, 1.1962876319885254, 1.1962827444076538, 1.1962910890579224, 1.1962902545928955], "mean_td_error": 1.2506375312805176, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1700.0, "diff_num_grad_updates_vs_sampler_policy": 1699.0}}, "num_env_steps_sampled": 69000, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 132600, "last_target_update_ts": 68640, "num_target_updates": 131}, "sampler_results": {"episode_reward_max": 2.1648928055182264, "episode_reward_min": -9.999834621987956, "episode_reward_mean": -1.3764247574280288, "episode_len_mean": 24.73, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999810523285396, 0.00018870805703732473, 0.00018800119521447987, -7.411448724696288, 0.00018662297771784235, 0.41113863053128463, 0.9418309220917253, 0.2314905141848674, 0.00018669827196937024, 0.00018605858129113343, 0.9071225446559988, 0.0001890055773144675, 0.00018824287153193156, 0.00018753948420228614, 0.00018689402632395444, 0.0001903924752979783, 0.00018214377549688812, 0.00018893611012904633, 0.00018815115566774297, 0.08944201104398218, -9.999815105656527, 0.0001843087378454888, 0.10781398965108036, -9.999816834431012, 0.00018263653466960315, 0.0001852053930557944, 0.00018461787311192107, 0.00018393058037448156, 0.27313055344761317, 0.00018295034812116162, -9.999814520703804, 0.34223519253361345, 0.0001842945838947369, 0.00018375907124962767, 0.0001759580931300967, -8.051580220419956, 0.00018429770071037773, 0.0001837986479429855, 0.0001832660093801313, 0.00017548716513030396, 0.0001860264441410867, 0.00018532864351271242, -9.29967303250362, 0.00018429016757701226, 0.0001764653409802304, 0.0001853284855081946, 0.00018474018559950966, 0.04322146714647725, 0.00018361474558533752, 0.05240750084467038, 0.00018615737186979293, -9.999814436138655, 0.00018486946575711416, 0.00018436731556131897, 0.00018383138076829658, 2.1648928055182264, -9.999813894622395, 0.00018537168478143984, 0.08018737706050162, 0.07245029627202472, 0.0001748859385768173, 0.0001669780124738473, 0.00018099878027532485, 0.00018040952295870266, -9.999834621987956, 0.16320071713277817, 0.0001672807596336639, 0.00018132604462648452, -9.999819265289986, 0.0775498030754369, 0.0001679978696193269, 0.0001821012148860291, 0.00018150476889321893, 0.00016637843138991623, 0.00017304725707574623, 0.00016754991818977155, 0.00018161699754919798, 0.0001810237143566047, 0.00016593906289058303, 0.17312881141686454, -9.768861669536399, 0.0001826383877788335, 0.00018203842328518542, -9.999833134115674, 0.00017355253855940288, 0.00017537163345766977, 0.00016744002193963694, -9.999818499652024, 0.0001809056945330329, 0.0001658312688471118, 0.00017602715608484282, 0.0001680635622415907, -9.999817827464142, 0.00018157531482524097, 0.00016644286341627935, 0.00018370694304426055, 0.00018317483509121217, 0.00017540008300815767, 0.7435683939597195, 0.00018153358516098013], "episode_lengths": [26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 23, 25, 25, 24, 24, 23, 25, 26, 23, 23, 25, 25, 23, 24, 23, 25, 25, 23, 24, 24, 25, 25, 24, 24, 24, 23, 26, 25, 23, 24, 23, 26, 25, 23, 25, 25, 24, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.7462911317346, "mean_inference_ms": 2.1098799091259264, "mean_action_processing_ms": 0.1443165231962566, "mean_env_wait_ms": 1.3660080695938919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010060548782348633, "StateBufferConnector_ms": 0.006241559982299805, "ViewRequirementAgentConnector_ms": 0.17453384399414062}}, "episode_reward_max": 2.1648928055182264, "episode_reward_min": -9.999834621987956, "episode_reward_mean": -1.3764247574280288, "episode_len_mean": 24.73, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999810523285396, 0.00018870805703732473, 0.00018800119521447987, -7.411448724696288, 0.00018662297771784235, 0.41113863053128463, 0.9418309220917253, 0.2314905141848674, 0.00018669827196937024, 0.00018605858129113343, 0.9071225446559988, 0.0001890055773144675, 0.00018824287153193156, 0.00018753948420228614, 0.00018689402632395444, 0.0001903924752979783, 0.00018214377549688812, 0.00018893611012904633, 0.00018815115566774297, 0.08944201104398218, -9.999815105656527, 0.0001843087378454888, 0.10781398965108036, -9.999816834431012, 0.00018263653466960315, 0.0001852053930557944, 0.00018461787311192107, 0.00018393058037448156, 0.27313055344761317, 0.00018295034812116162, -9.999814520703804, 0.34223519253361345, 0.0001842945838947369, 0.00018375907124962767, 0.0001759580931300967, -8.051580220419956, 0.00018429770071037773, 0.0001837986479429855, 0.0001832660093801313, 0.00017548716513030396, 0.0001860264441410867, 0.00018532864351271242, -9.29967303250362, 0.00018429016757701226, 0.0001764653409802304, 0.0001853284855081946, 0.00018474018559950966, 0.04322146714647725, 0.00018361474558533752, 0.05240750084467038, 0.00018615737186979293, -9.999814436138655, 0.00018486946575711416, 0.00018436731556131897, 0.00018383138076829658, 2.1648928055182264, -9.999813894622395, 0.00018537168478143984, 0.08018737706050162, 0.07245029627202472, 0.0001748859385768173, 0.0001669780124738473, 0.00018099878027532485, 0.00018040952295870266, -9.999834621987956, 0.16320071713277817, 0.0001672807596336639, 0.00018132604462648452, -9.999819265289986, 0.0775498030754369, 0.0001679978696193269, 0.0001821012148860291, 0.00018150476889321893, 0.00016637843138991623, 0.00017304725707574623, 0.00016754991818977155, 0.00018161699754919798, 0.0001810237143566047, 0.00016593906289058303, 0.17312881141686454, -9.768861669536399, 0.0001826383877788335, 0.00018203842328518542, -9.999833134115674, 0.00017355253855940288, 0.00017537163345766977, 0.00016744002193963694, -9.999818499652024, 0.0001809056945330329, 0.0001658312688471118, 0.00017602715608484282, 0.0001680635622415907, -9.999817827464142, 0.00018157531482524097, 0.00016644286341627935, 0.00018370694304426055, 0.00018317483509121217, 0.00017540008300815767, 0.7435683939597195, 0.00018153358516098013], "episode_lengths": [26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 23, 25, 25, 24, 24, 23, 25, 26, 23, 23, 25, 25, 23, 24, 23, 25, 25, 23, 24, 24, 25, 25, 24, 24, 24, 23, 26, 25, 23, 24, 23, 26, 25, 23, 25, 25, 24, 23, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.7462911317346, "mean_inference_ms": 2.1098799091259264, "mean_action_processing_ms": 0.1443165231962566, "mean_env_wait_ms": 1.3660080695938919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010060548782348633, "StateBufferConnector_ms": 0.006241559982299805, "ViewRequirementAgentConnector_ms": 0.17453384399414062}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 132600, "num_env_steps_sampled": 69000, "num_env_steps_trained": 132600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.076058591872885, "num_env_steps_trained_throughput_per_sec": 7.948314254152124, "timesteps_total": 69000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 69000, "timers": {"training_iteration_time_ms": 8869.458, "sample_time_ms": 8805.458, "load_time_ms": 0.234, "load_throughput": 333798.298, "learn_time_ms": 12.88, "learn_throughput": 6055.725, "synch_weights_time_ms": 11.288}, "counters": {"num_env_steps_sampled": 69000, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 69000, "num_agent_steps_trained": 132600, "last_target_update_ts": 68640, "num_target_updates": 131}, "done": false, "episodes_total": 2681, "training_iteration": 69, "trial_id": "2058a_00000", "date": "2024-04-17_09-39-21", "timestamp": 1713346761, "time_this_iter_s": 245.3429193496704, "time_total_s": 15533.679396390915, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15533.679396390915, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 12.103724928366761, "ram_util_percent": 20.327793696275076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.00791282206773758, "cur_lr": 0.01}, "td_error": [1.1738027334213257, 1.1738065481185913, 1.1738065481185913, 1.1738059520721436, 1.1738048791885376, 1.1738065481185913, 1.1738064289093018, 1.1738064289093018, 1.1738064289093018, 0.8543328642845154, 1.173803448677063, 1.1738059520721436, 1.1738063097000122, 1.469042420387268, 1.2299286127090454, 1.1738063097000122, 1.1738063097000122, 0.8254975080490112, 1.1738065481185913, 1.173805832862854, 1.1738044023513794, 1.1738064289093018, 1.1738064289093018, 1.1738061904907227, 1.1738066673278809, 1.1738059520721436, 1.1738063097000122, 1.1738057136535645, 1.1738064289093018, 1.1738059520721436, 1.173805594444275, 1.1738046407699585, 1.1738065481185913, 1.1738049983978271, 1.1738065481185913, 1.1738032102584839, 1.1738061904907227, 1.1738064289093018, 1.1738065481185913, 1.173805832862854, 1.1738063097000122, 1.173805832862854, 1.173774242401123, 1.173802375793457, 1.1738066673278809, 1.1738059520721436, 1.1738059520721436, 1.1738064289093018, 1.1738048791885376, 0.8254976272583008, 1.1738059520721436, 1.1738063097000122, 1.1738033294677734, 0.7819879055023193, 1.1738041639328003, 1.1738059520721436, 1.173803687095642, 1.1738063097000122, 1.1738063097000122, 1.173806071281433, 1.1738059520721436, 1.1738061904907227, 1.2309905290603638, 1.1738051176071167, 3.399367570877075, 1.1738038063049316, 1.1738046407699585, 1.1738063097000122, 1.1738064289093018, 1.1738052368164062, 1.1738059520721436, 1.1738057136535645, 1.1738059520721436, 1.1738059520721436, 1.173806071281433, 1.1738061904907227, 1.1738063097000122, 1.1738049983978271], "mean_td_error": 1.189525842666626, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1725.0, "diff_num_grad_updates_vs_sampler_policy": 1724.0}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 134550, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 134550, "last_target_update_ts": 69680, "num_target_updates": 133}, "sampler_results": {"episode_reward_max": 2.6360288929441373, "episode_reward_min": -9.999834621987956, "episode_reward_mean": -1.3083865793769076, "episode_len_mean": 24.68, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0001860264441410867, 0.00018532864351271242, -9.29967303250362, 0.00018429016757701226, 0.0001764653409802304, 0.0001853284855081946, 0.00018474018559950966, 0.04322146714647725, 0.00018361474558533752, 0.05240750084467038, 0.00018615737186979293, -9.999814436138655, 0.00018486946575711416, 0.00018436731556131897, 0.00018383138076829658, 2.1648928055182264, -9.999813894622395, 0.00018537168478143984, 0.08018737706050162, 0.07245029627202472, 0.0001748859385768173, 0.0001669780124738473, 0.00018099878027532485, 0.00018040952295870266, -9.999834621987956, 0.16320071713277817, 0.0001672807596336639, 0.00018132604462648452, -9.999819265289986, 0.0775498030754369, 0.0001679978696193269, 0.0001821012148860291, 0.00018150476889321893, 0.00016637843138991623, 0.00017304725707574623, 0.00016754991818977155, 0.00018161699754919798, 0.0001810237143566047, 0.00016593906289058303, 0.17312881141686454, -9.768861669536399, 0.0001826383877788335, 0.00018203842328518542, -9.999833134115674, 0.00017355253855940288, 0.00017537163345766977, 0.00016744002193963694, -9.999818499652024, 0.0001809056945330329, 0.0001658312688471118, 0.00017602715608484282, 0.0001680635622415907, -9.999817827464142, 0.00018157531482524097, 0.00016644286341627935, 0.00018370694304426055, 0.00018317483509121217, 0.00017540008300815767, 0.7435683939597195, 0.00018153358516098013, 0.00017201017834244322, 0.0001786113548680557, -9.99982215291061, 0.00017720266527437262, 0.6976882909147928, 0.0001723620711188032, 0.00017897559606370328, 0.0001782081658909217, 0.00017756117772184168, 0.04431720628186456, 0.0001796848126763452, 0.07872992434314664, -9.999821705658768, 0.0001776254904877441, 0.016277865469413205, 0.00017930438934682098, 0.00017853414280358848, 0.0001778847898734734, 0.00017721905297212072, 0.00017666128743987905, 0.00018020780383033494, 0.0001794297923911617, 0.00017877391994951063, -9.946525511345362, 0.00017758701411249282, 0.00017248000949428532, 0.12095246248068184, 0.00017835454916880617, 0.00017770649961118822, 0.0001770420940933081, 0.00017311405344942098, -9.999820245997473, 2.6360288929441373, 0.00017832855770834696, 0.0001776595012033457, 0.00018094084595330934, 0.07871682558714715, 0.00017255104248775668, 0.0001791711967661565, -9.081138904806991], "episode_lengths": [25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 23, 25, 25, 24, 24, 23, 25, 26, 23, 23, 25, 25, 23, 24, 23, 25, 25, 23, 24, 24, 25, 25, 24, 24, 24, 23, 26, 25, 23, 24, 23, 26, 25, 23, 25, 25, 24, 23, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 23, 24, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.9569140670417, "mean_inference_ms": 2.1095688769912417, "mean_action_processing_ms": 0.14429750440215158, "mean_env_wait_ms": 1.3479830980257566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010364532470703125, "StateBufferConnector_ms": 0.0064449310302734375, "ViewRequirementAgentConnector_ms": 0.17807316780090332}}, "episode_reward_max": 2.6360288929441373, "episode_reward_min": -9.999834621987956, "episode_reward_mean": -1.3083865793769076, "episode_len_mean": 24.68, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0001860264441410867, 0.00018532864351271242, -9.29967303250362, 0.00018429016757701226, 0.0001764653409802304, 0.0001853284855081946, 0.00018474018559950966, 0.04322146714647725, 0.00018361474558533752, 0.05240750084467038, 0.00018615737186979293, -9.999814436138655, 0.00018486946575711416, 0.00018436731556131897, 0.00018383138076829658, 2.1648928055182264, -9.999813894622395, 0.00018537168478143984, 0.08018737706050162, 0.07245029627202472, 0.0001748859385768173, 0.0001669780124738473, 0.00018099878027532485, 0.00018040952295870266, -9.999834621987956, 0.16320071713277817, 0.0001672807596336639, 0.00018132604462648452, -9.999819265289986, 0.0775498030754369, 0.0001679978696193269, 0.0001821012148860291, 0.00018150476889321893, 0.00016637843138991623, 0.00017304725707574623, 0.00016754991818977155, 0.00018161699754919798, 0.0001810237143566047, 0.00016593906289058303, 0.17312881141686454, -9.768861669536399, 0.0001826383877788335, 0.00018203842328518542, -9.999833134115674, 0.00017355253855940288, 0.00017537163345766977, 0.00016744002193963694, -9.999818499652024, 0.0001809056945330329, 0.0001658312688471118, 0.00017602715608484282, 0.0001680635622415907, -9.999817827464142, 0.00018157531482524097, 0.00016644286341627935, 0.00018370694304426055, 0.00018317483509121217, 0.00017540008300815767, 0.7435683939597195, 0.00018153358516098013, 0.00017201017834244322, 0.0001786113548680557, -9.99982215291061, 0.00017720266527437262, 0.6976882909147928, 0.0001723620711188032, 0.00017897559606370328, 0.0001782081658909217, 0.00017756117772184168, 0.04431720628186456, 0.0001796848126763452, 0.07872992434314664, -9.999821705658768, 0.0001776254904877441, 0.016277865469413205, 0.00017930438934682098, 0.00017853414280358848, 0.0001778847898734734, 0.00017721905297212072, 0.00017666128743987905, 0.00018020780383033494, 0.0001794297923911617, 0.00017877391994951063, -9.946525511345362, 0.00017758701411249282, 0.00017248000949428532, 0.12095246248068184, 0.00017835454916880617, 0.00017770649961118822, 0.0001770420940933081, 0.00017311405344942098, -9.999820245997473, 2.6360288929441373, 0.00017832855770834696, 0.0001776595012033457, 0.00018094084595330934, 0.07871682558714715, 0.00017255104248775668, 0.0001791711967661565, -9.081138904806991], "episode_lengths": [25, 25, 26, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 24, 23, 25, 25, 24, 24, 23, 25, 26, 23, 23, 25, 25, 23, 24, 23, 25, 25, 23, 24, 24, 25, 25, 24, 24, 24, 23, 26, 25, 23, 24, 23, 26, 25, 23, 25, 25, 24, 23, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 23, 24, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 426.9569140670417, "mean_inference_ms": 2.1095688769912417, "mean_action_processing_ms": 0.14429750440215158, "mean_env_wait_ms": 1.3479830980257566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010364532470703125, "StateBufferConnector_ms": 0.0064449310302734375, "ViewRequirementAgentConnector_ms": 0.17807316780090332}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 134550, "num_env_steps_sampled": 70000, "num_env_steps_trained": 134550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.696245069291679, "num_env_steps_trained_throughput_per_sec": 9.157677885118774, "timesteps_total": 70000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 8962.098, "sample_time_ms": 8898.715, "load_time_ms": 0.245, "load_throughput": 318554.734, "learn_time_ms": 13.14, "learn_throughput": 5936.014, "synch_weights_time_ms": 11.435}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 134550, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 134550, "last_target_update_ts": 69680, "num_target_updates": 133}, "done": false, "episodes_total": 2721, "training_iteration": 70, "trial_id": "2058a_00000", "date": "2024-04-17_09-42-54", "timestamp": 1713346974, "time_this_iter_s": 212.94733476638794, "time_total_s": 15746.626731157303, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15746.626731157303, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 14.024422442244223, "ram_util_percent": 20.450165016501654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.00973919965326786, "cur_lr": 0.01}, "td_error": [1.1391421556472778, 3.5103671550750732, 1.139142394065857, 1.1391416788101196, 1.1385762691497803, 1.1391419172286987, 1.1391422748565674, 0.8101508021354675, 0.8101504445075989, 1.1391419172286987, 1.1391419172286987, 1.1391404867172241, 1.1391421556472778, 1.1391422748565674, 1.139140009880066, 0.8101507425308228, 1.1391421556472778, 1.1391422748565674, 1.1391419172286987, 1.1391410827636719, 1.1391421556472778, 1.1391407251358032, 0.8101500868797302, 1.1391403675079346, 1.1391369104385376, 1.1391417980194092, 1.1391414403915405, 0.8101509809494019, 1.1391420364379883, 1.13914155960083, 1.1391422748565674, 1.1391416788101196, 1.1391421556472778, 1.139142394065857, 1.1391422748565674, 1.1391422748565674, 1.1391420364379883, 1.1391417980194092, 1.1391417980194092, 1.13914155960083, 1.1391422748565674, 1.1391419172286987, 1.1391401290893555, 1.13914155960083, 1.1391421556472778, 1.1391417980194092, 1.1391421556472778, 1.1391407251358032, 1.1391404867172241, 1.13914155960083, 1.1391412019729614, 0.8101508617401123, 1.13914155960083, 1.1391409635543823, 1.1391421556472778, 1.1391414403915405, 1.139142394065857, 1.139142394065857, 0.8101509809494019, 3.5103676319122314, 1.1391412019729614, 1.1391421556472778, 0.8101506233215332, 1.1391421556472778, 1.1391412019729614, 1.1391422748565674, 1.13914155960083, 0.7349182367324829, 1.1391420364379883, 1.1391417980194092, 1.1391422748565674, 1.1391419172286987, 1.1391421556472778, 0.8101506233215332, 1.1391412019729614, 1.1391422748565674, 1.1391406059265137, 0.8101509809494019], "mean_td_error": 1.1525743007659912, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1750.0, "diff_num_grad_updates_vs_sampler_policy": 1749.0}}, "num_env_steps_sampled": 71000, "num_env_steps_trained": 136500, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 136500, "last_target_update_ts": 70720, "num_target_updates": 135}, "sampler_results": {"episode_reward_max": 2.6360288929441373, "episode_reward_min": -19.999825113409567, "episode_reward_mean": -1.3134332129997508, "episode_len_mean": 24.81, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.768861669536399, 0.0001826383877788335, 0.00018203842328518542, -9.999833134115674, 0.00017355253855940288, 0.00017537163345766977, 0.00016744002193963694, -9.999818499652024, 0.0001809056945330329, 0.0001658312688471118, 0.00017602715608484282, 0.0001680635622415907, -9.999817827464142, 0.00018157531482524097, 0.00016644286341627935, 0.00018370694304426055, 0.00018317483509121217, 0.00017540008300815767, 0.7435683939597195, 0.00018153358516098013, 0.00017201017834244322, 0.0001786113548680557, -9.99982215291061, 0.00017720266527437262, 0.6976882909147928, 0.0001723620711188032, 0.00017897559606370328, 0.0001782081658909217, 0.00017756117772184168, 0.04431720628186456, 0.0001796848126763452, 0.07872992434314664, -9.999821705658768, 0.0001776254904877441, 0.016277865469413205, 0.00017930438934682098, 0.00017853414280358848, 0.0001778847898734734, 0.00017721905297212072, 0.00017666128743987905, 0.00018020780383033494, 0.0001794297923911617, 0.00017877391994951063, -9.946525511345362, 0.00017758701411249282, 0.00017248000949428532, 0.12095246248068184, 0.00017835454916880617, 0.00017770649961118822, 0.0001770420940933081, 0.00017311405344942098, -9.999820245997473, 2.6360288929441373, 0.00017832855770834696, 0.0001776595012033457, 0.00018094084595330934, 0.07871682558714715, 0.00017255104248775668, 0.0001791711967661565, -9.081138904806991, 0.09250272264535302, 0.06047731478788792, 0.0001676223937507349, 0.00017408319954470127, 0.12293245527231902, 0.00017639327391978196, 0.00017568265590336128, 0.0001679107772820783, -9.99982561815216, 0.00017372868708703145, 0.0603974127751537, 0.33056539964995196, 0.00017529426942831445, 0.00017463431744872468, 0.0001741656893447241, 0.00017594851296190138, 0.10189707159803862, 0.00017469708561192445, 0.00017404161413911217, 0.00017357615752108468, 0.00017686676612916914, 0.00016903747328577974, 0.00017554837935396033, -19.999825113409567, 0.06342207324036779, 0.0001764854401233207, 0.1705473438273409, 0.46326777305752614, 0.00017449996683871886, 0.0001738459709566065, 0.0001770989642092075, 0.00017638266114959356, 0.5539467712388427, 0.810941791123432, 0.07424520910907058, 0.0001777701838321001, -19.88159889663025, 0.00017659215580283325, 0.0001758799378757331, 0.0001680984982563689], "episode_lengths": [24, 25, 25, 24, 24, 24, 23, 26, 25, 23, 24, 23, 26, 25, 23, 25, 25, 24, 23, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 23, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 27, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.1759831051524, "mean_inference_ms": 2.109059365345012, "mean_action_processing_ms": 0.14425648684584086, "mean_env_wait_ms": 1.3304742514774746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01013946533203125, "StateBufferConnector_ms": 0.006301164627075195, "ViewRequirementAgentConnector_ms": 0.18394804000854492}}, "episode_reward_max": 2.6360288929441373, "episode_reward_min": -19.999825113409567, "episode_reward_mean": -1.3134332129997508, "episode_len_mean": 24.81, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.768861669536399, 0.0001826383877788335, 0.00018203842328518542, -9.999833134115674, 0.00017355253855940288, 0.00017537163345766977, 0.00016744002193963694, -9.999818499652024, 0.0001809056945330329, 0.0001658312688471118, 0.00017602715608484282, 0.0001680635622415907, -9.999817827464142, 0.00018157531482524097, 0.00016644286341627935, 0.00018370694304426055, 0.00018317483509121217, 0.00017540008300815767, 0.7435683939597195, 0.00018153358516098013, 0.00017201017834244322, 0.0001786113548680557, -9.99982215291061, 0.00017720266527437262, 0.6976882909147928, 0.0001723620711188032, 0.00017897559606370328, 0.0001782081658909217, 0.00017756117772184168, 0.04431720628186456, 0.0001796848126763452, 0.07872992434314664, -9.999821705658768, 0.0001776254904877441, 0.016277865469413205, 0.00017930438934682098, 0.00017853414280358848, 0.0001778847898734734, 0.00017721905297212072, 0.00017666128743987905, 0.00018020780383033494, 0.0001794297923911617, 0.00017877391994951063, -9.946525511345362, 0.00017758701411249282, 0.00017248000949428532, 0.12095246248068184, 0.00017835454916880617, 0.00017770649961118822, 0.0001770420940933081, 0.00017311405344942098, -9.999820245997473, 2.6360288929441373, 0.00017832855770834696, 0.0001776595012033457, 0.00018094084595330934, 0.07871682558714715, 0.00017255104248775668, 0.0001791711967661565, -9.081138904806991, 0.09250272264535302, 0.06047731478788792, 0.0001676223937507349, 0.00017408319954470127, 0.12293245527231902, 0.00017639327391978196, 0.00017568265590336128, 0.0001679107772820783, -9.99982561815216, 0.00017372868708703145, 0.0603974127751537, 0.33056539964995196, 0.00017529426942831445, 0.00017463431744872468, 0.0001741656893447241, 0.00017594851296190138, 0.10189707159803862, 0.00017469708561192445, 0.00017404161413911217, 0.00017357615752108468, 0.00017686676612916914, 0.00016903747328577974, 0.00017554837935396033, -19.999825113409567, 0.06342207324036779, 0.0001764854401233207, 0.1705473438273409, 0.46326777305752614, 0.00017449996683871886, 0.0001738459709566065, 0.0001770989642092075, 0.00017638266114959356, 0.5539467712388427, 0.810941791123432, 0.07424520910907058, 0.0001777701838321001, -19.88159889663025, 0.00017659215580283325, 0.0001758799378757331, 0.0001680984982563689], "episode_lengths": [24, 25, 25, 24, 24, 24, 23, 26, 25, 23, 24, 23, 26, 25, 23, 25, 25, 24, 23, 25, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 23, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 27, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.1759831051524, "mean_inference_ms": 2.109059365345012, "mean_action_processing_ms": 0.14425648684584086, "mean_env_wait_ms": 1.3304742514774746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01013946533203125, "StateBufferConnector_ms": 0.006301164627075195, "ViewRequirementAgentConnector_ms": 0.18394804000854492}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 136500, "num_env_steps_sampled": 71000, "num_env_steps_trained": 136500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 5.2077498733692185, "num_env_steps_trained_throughput_per_sec": 10.155112253069976, "timesteps_total": 71000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 71000, "timers": {"training_iteration_time_ms": 6798.106, "sample_time_ms": 6731.72, "load_time_ms": 0.254, "load_throughput": 307477.173, "learn_time_ms": 13.143, "learn_throughput": 5934.905, "synch_weights_time_ms": 11.826}, "counters": {"num_env_steps_sampled": 71000, "num_env_steps_trained": 136500, "num_agent_steps_sampled": 71000, "num_agent_steps_trained": 136500, "last_target_update_ts": 70720, "num_target_updates": 135}, "done": false, "episodes_total": 2761, "training_iteration": 71, "trial_id": "2058a_00000", "date": "2024-04-17_09-46-06", "timestamp": 1713347166, "time_this_iter_s": 192.030335187912, "time_total_s": 15938.657066345215, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 15938.657066345215, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 15.461904761904764, "ram_util_percent": 20.55384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04506470635533333, "cur_lr": 0.01}, "td_error": [1.141004204750061, 1.1410044431686401, 1.141001582145691, 1.1410048007965088, 1.141005039215088, 1.141004204750061, 1.1410046815872192, 1.1410049200057983, 1.1410048007965088, 1.1410044431686401, 1.1410044431686401, 1.1410044431686401, 1.1410036087036133, 1.1410049200057983, 1.141004204750061, 1.1410049200057983, 1.1410045623779297, 1.141005039215088, 1.1410043239593506, 1.141005039215088, 0.8147366046905518, 1.1410048007965088, 1.141004204750061, 1.1410049200057983, 1.1410048007965088, 1.141001582145691, 3.4621753692626953, 1.1410048007965088, 0.8147353529930115, 1.1410049200057983, 0.8147368431091309, 0.8147364854812622, 1.1410048007965088, 1.1410045623779297, 1.1410048007965088, 1.1410048007965088, 1.1410048007965088, 3.459035634994507, 0.8147367238998413, 0.8147354125976562, 1.1410046815872192, 1.1410045623779297, 2.9535233974456787, 0.8147361278533936, 1.1410046815872192, 3.4653429985046387, 0.8147367238998413, 1.1410021781921387, 1.1410048007965088, 1.1410046815872192, 1.141005039215088, 1.141004204750061, 1.1410046815872192, 1.1410049200057983, 1.141004204750061, 1.1410045623779297, 3.4653353691101074, 1.141005039215088, 1.1410045623779297, 1.1410049200057983, 1.1410049200057983, 1.1410046815872192, 1.1409684419631958, 1.1410049200057983, 3.4559357166290283, 1.1410045623779297, 1.141005039215088, 0.8147363662719727, 1.1410027742385864, 1.1410032510757446, 1.1410049200057983, 1.1410049200057983, 1.1410048007965088, 1.141004204750061, 1.1410049200057983, 1.1410038471221924, 0.814736545085907, 1.1410046815872192], "mean_td_error": 1.2711659669876099, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1775.0, "diff_num_grad_updates_vs_sampler_policy": 1774.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 138450, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 138450, "last_target_update_ts": 71760, "num_target_updates": 137}, "sampler_results": {"episode_reward_max": 2.6360288929441373, "episode_reward_min": -19.999825113409567, "episode_reward_mean": -1.6112337715408618, "episode_len_mean": 25.04, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00018020780383033494, 0.0001794297923911617, 0.00017877391994951063, -9.946525511345362, 0.00017758701411249282, 0.00017248000949428532, 0.12095246248068184, 0.00017835454916880617, 0.00017770649961118822, 0.0001770420940933081, 0.00017311405344942098, -9.999820245997473, 2.6360288929441373, 0.00017832855770834696, 0.0001776595012033457, 0.00018094084595330934, 0.07871682558714715, 0.00017255104248775668, 0.0001791711967661565, -9.081138904806991, 0.09250272264535302, 0.06047731478788792, 0.0001676223937507349, 0.00017408319954470127, 0.12293245527231902, 0.00017639327391978196, 0.00017568265590336128, 0.0001679107772820783, -9.99982561815216, 0.00017372868708703145, 0.0603974127751537, 0.33056539964995196, 0.00017529426942831445, 0.00017463431744872468, 0.0001741656893447241, 0.00017594851296190138, 0.10189707159803862, 0.00017469708561192445, 0.00017404161413911217, 0.00017357615752108468, 0.00017686676612916914, 0.00016903747328577974, 0.00017554837935396033, -19.999825113409567, 0.06342207324036779, 0.0001764854401233207, 0.1705473438273409, 0.46326777305752614, 0.00017449996683871886, 0.0001738459709566065, 0.0001770989642092075, 0.00017638266114959356, 0.5539467712388427, 0.810941791123432, 0.07424520910907058, 0.0001777701838321001, -19.88159889663025, 0.00017659215580283325, 0.0001758799378757331, 0.0001680984982563689, -9.99982700447222, 0.10840121956466421, -9.999828082523395, 0.0001714753465028106, 0.0001710497296191982, 0.00017326490057290663, 0.0001726742777655388, 0.00017213746612236358, 0.00017169425229413248, 0.00017126754943174645, -9.999826431032036, 0.00017302654024891131, 0.00017257874151844647, 1.2526066762970351, 0.00017163163478038098, -9.999827015218685, -9.999827554805627, 0.00017199988655342073, -9.938536265419623, 0.00017110173499190656, 0.00017385096763706411, 0.00017330682668624178, -9.999827142440946, 0.00017242508044879116, 0.00017190470412964374, 0.00017338155884464906, 0.00017279014179093284, 0.00017225261065838642, 0.0001718088043635337, 0.00017138153266498942, 0.00017408404624257766, 0.00017348783518842572, 0.00017294596138382764, 0.0001724985791637864, 0.00017206787423145023, 0.0001745761685990295, 0.6089926566410887, -9.999826540020837, -9.99982712812688, 0.00017233181141605017], "episode_lengths": [25, 25, 25, 26, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 23, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 27, 25, 25, 24, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.3923735937582, "mean_inference_ms": 2.1084996720641214, "mean_action_processing_ms": 0.14422619968215605, "mean_env_wait_ms": 1.3134626180724702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010052204132080078, "StateBufferConnector_ms": 0.006170511245727539, "ViewRequirementAgentConnector_ms": 0.18253755569458008}}, "episode_reward_max": 2.6360288929441373, "episode_reward_min": -19.999825113409567, "episode_reward_mean": -1.6112337715408618, "episode_len_mean": 25.04, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00018020780383033494, 0.0001794297923911617, 0.00017877391994951063, -9.946525511345362, 0.00017758701411249282, 0.00017248000949428532, 0.12095246248068184, 0.00017835454916880617, 0.00017770649961118822, 0.0001770420940933081, 0.00017311405344942098, -9.999820245997473, 2.6360288929441373, 0.00017832855770834696, 0.0001776595012033457, 0.00018094084595330934, 0.07871682558714715, 0.00017255104248775668, 0.0001791711967661565, -9.081138904806991, 0.09250272264535302, 0.06047731478788792, 0.0001676223937507349, 0.00017408319954470127, 0.12293245527231902, 0.00017639327391978196, 0.00017568265590336128, 0.0001679107772820783, -9.99982561815216, 0.00017372868708703145, 0.0603974127751537, 0.33056539964995196, 0.00017529426942831445, 0.00017463431744872468, 0.0001741656893447241, 0.00017594851296190138, 0.10189707159803862, 0.00017469708561192445, 0.00017404161413911217, 0.00017357615752108468, 0.00017686676612916914, 0.00016903747328577974, 0.00017554837935396033, -19.999825113409567, 0.06342207324036779, 0.0001764854401233207, 0.1705473438273409, 0.46326777305752614, 0.00017449996683871886, 0.0001738459709566065, 0.0001770989642092075, 0.00017638266114959356, 0.5539467712388427, 0.810941791123432, 0.07424520910907058, 0.0001777701838321001, -19.88159889663025, 0.00017659215580283325, 0.0001758799378757331, 0.0001680984982563689, -9.99982700447222, 0.10840121956466421, -9.999828082523395, 0.0001714753465028106, 0.0001710497296191982, 0.00017326490057290663, 0.0001726742777655388, 0.00017213746612236358, 0.00017169425229413248, 0.00017126754943174645, -9.999826431032036, 0.00017302654024891131, 0.00017257874151844647, 1.2526066762970351, 0.00017163163478038098, -9.999827015218685, -9.999827554805627, 0.00017199988655342073, -9.938536265419623, 0.00017110173499190656, 0.00017385096763706411, 0.00017330682668624178, -9.999827142440946, 0.00017242508044879116, 0.00017190470412964374, 0.00017338155884464906, 0.00017279014179093284, 0.00017225261065838642, 0.0001718088043635337, 0.00017138153266498942, 0.00017408404624257766, 0.00017348783518842572, 0.00017294596138382764, 0.0001724985791637864, 0.00017206787423145023, 0.0001745761685990295, 0.6089926566410887, -9.999826540020837, -9.99982712812688, 0.00017233181141605017], "episode_lengths": [25, 25, 25, 26, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 23, 24, 25, 26, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 27, 25, 25, 24, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.3923735937582, "mean_inference_ms": 2.1084996720641214, "mean_action_processing_ms": 0.14422619968215605, "mean_env_wait_ms": 1.3134626180724702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010052204132080078, "StateBufferConnector_ms": 0.006170511245727539, "ViewRequirementAgentConnector_ms": 0.18253755569458008}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 138450, "num_env_steps_sampled": 72000, "num_env_steps_trained": 138450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.962825857207488, "num_env_steps_trained_throughput_per_sec": 9.6775104215546, "timesteps_total": 72000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 9006.954, "sample_time_ms": 8943.657, "load_time_ms": 0.238, "load_throughput": 328403.646, "learn_time_ms": 12.621, "learn_throughput": 6180.387, "synch_weights_time_ms": 11.448}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 138450, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 138450, "last_target_update_ts": 71760, "num_target_updates": 137}, "done": false, "episodes_total": 2801, "training_iteration": 72, "trial_id": "2058a_00000", "date": "2024-04-17_09-49-27", "timestamp": 1713347367, "time_this_iter_s": 201.50684452056885, "time_total_s": 16140.163910865784, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 16140.163910865784, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 14.660278745644598, "ram_util_percent": 20.67247386759582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0077009242959320545, "cur_lr": 0.01}, "td_error": [1.1504766941070557, 1.1504765748977661, 1.1504765748977661, 1.1504766941070557, 1.1504765748977661, 1.1504766941070557, 1.1504766941070557, 0.8185728192329407, 1.1504764556884766, 1.2002930641174316, 1.1504768133163452, 1.1504765748977661, 1.1504766941070557, 1.1504766941070557, 1.1504768133163452, 1.1504764556884766, 1.1504765748977661, 1.1504766941070557, 1.1504768133163452, 1.1504766941070557, 0.8185726404190063, 1.1504765748977661, 3.387378692626953, 1.1504765748977661, 1.1504764556884766, 1.1504766941070557, 1.1504766941070557, 1.1504768133163452, 1.1504766941070557, 1.1504766941070557, 1.1504765748977661, 1.1504765748977661, 1.1504764556884766, 1.1504766941070557, 0.8185706734657288, 1.1504764556884766, 1.1504765748977661, 0.8185725808143616, 1.1504765748977661, 1.1504765748977661, 1.1504765748977661, 1.1504762172698975, 1.150476336479187, 0.8971912860870361, 1.1504766941070557, 1.1504764556884766, 1.1504766941070557, 0.8185725212097168, 1.1504768133163452, 1.1504764556884766, 1.1504766941070557, 1.1504766941070557, 1.1504766941070557, 1.1504764556884766, 3.3872382640838623, 1.1504766941070557, 1.1504764556884766, 1.1504766941070557, 1.1504766941070557, 1.1504766941070557, 1.1504766941070557, 1.1504766941070557, 0.8185725808143616, 1.1504764556884766, 1.1504766941070557, 1.1504765748977661, 1.1504766941070557, 1.1504764556884766, 1.150476098060608, 1.1504766941070557, 1.1504765748977661, 1.1504766941070557, 1.1504766941070557, 1.1504766941070557, 1.1504759788513184, 1.1504764556884766, 1.1504765748977661, 1.1504768133163452], "mean_td_error": 1.1796915531158447, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1800.0, "diff_num_grad_updates_vs_sampler_policy": 1799.0}}, "num_env_steps_sampled": 73000, "num_env_steps_trained": 140400, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 140400, "last_target_update_ts": 72800, "num_target_updates": 139}, "sampler_results": {"episode_reward_max": 1.6597763798835603, "episode_reward_min": -19.999830079201008, "episode_reward_mean": -2.309939368174523, "episode_len_mean": 25.09, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00017686676612916914, 0.00016903747328577974, 0.00017554837935396033, -19.999825113409567, 0.06342207324036779, 0.0001764854401233207, 0.1705473438273409, 0.46326777305752614, 0.00017449996683871886, 0.0001738459709566065, 0.0001770989642092075, 0.00017638266114959356, 0.5539467712388427, 0.810941791123432, 0.07424520910907058, 0.0001777701838321001, -19.88159889663025, 0.00017659215580283325, 0.0001758799378757331, 0.0001680984982563689, -9.99982700447222, 0.10840121956466421, -9.999828082523395, 0.0001714753465028106, 0.0001710497296191982, 0.00017326490057290663, 0.0001726742777655388, 0.00017213746612236358, 0.00017169425229413248, 0.00017126754943174645, -9.999826431032036, 0.00017302654024891131, 0.00017257874151844647, 1.2526066762970351, 0.00017163163478038098, -9.999827015218685, -9.999827554805627, 0.00017199988655342073, -9.938536265419623, 0.00017110173499190656, 0.00017385096763706411, 0.00017330682668624178, -9.999827142440946, 0.00017242508044879116, 0.00017190470412964374, 0.00017338155884464906, 0.00017279014179093284, 0.00017225261065838642, 0.0001718088043635337, 0.00017138153266498942, 0.00017408404624257766, 0.00017348783518842572, 0.00017294596138382764, 0.0001724985791637864, 0.00017206787423145023, 0.0001745761685990295, 0.6089926566410887, -9.999826540020837, -9.99982712812688, 0.00017233181141605017, 0.00017053760869832415, -9.999836726477739, 0.00016970629703121998, -9.123128561062945, 0.0001687249782515409, 0.00017075412545557107, 0.00016347938039553203, -19.999830079201008, 1.6597763798835603, 0.00016893546632965577, 0.00016431721407559084, 0.249465096427862, 0.00017031211661010424, 0.00016980450385097723, 0.00016246855725298947, 0.0001638112759330681, 0.00017026492756502037, 0.0001697778575242146, 0.00016927341939538146, 0.00016196210697865746, 0.00016457793212040151, -19.999828939863256, 0.00017056841992578984, -9.999829940673097, 0.00016271151256848856, -9.99982913252718, 1.2178081324510097, 0.701530424506079, 0.00016955437975094085, -9.999830948687782, 0.0001715496483301687, 0.00016423893554436573, 0.00017070846446495236, -9.999829781096503, 0.00016971179931562596, 0.0001718875973711047, 0.00017145993418734212, 0.00017094535794248808, -9.999836337984899, 0.0001701100757575364], "episode_lengths": [25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 27, 25, 25, 24, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 24, 27, 25, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 27, 25, 26, 24, 26, 24, 25, 25, 26, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.61593115364616, "mean_inference_ms": 2.1081070703674594, "mean_action_processing_ms": 0.1442095285519259, "mean_env_wait_ms": 1.2969094909322134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010265588760375977, "StateBufferConnector_ms": 0.006171464920043945, "ViewRequirementAgentConnector_ms": 0.181488037109375}}, "episode_reward_max": 1.6597763798835603, "episode_reward_min": -19.999830079201008, "episode_reward_mean": -2.309939368174523, "episode_len_mean": 25.09, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00017686676612916914, 0.00016903747328577974, 0.00017554837935396033, -19.999825113409567, 0.06342207324036779, 0.0001764854401233207, 0.1705473438273409, 0.46326777305752614, 0.00017449996683871886, 0.0001738459709566065, 0.0001770989642092075, 0.00017638266114959356, 0.5539467712388427, 0.810941791123432, 0.07424520910907058, 0.0001777701838321001, -19.88159889663025, 0.00017659215580283325, 0.0001758799378757331, 0.0001680984982563689, -9.99982700447222, 0.10840121956466421, -9.999828082523395, 0.0001714753465028106, 0.0001710497296191982, 0.00017326490057290663, 0.0001726742777655388, 0.00017213746612236358, 0.00017169425229413248, 0.00017126754943174645, -9.999826431032036, 0.00017302654024891131, 0.00017257874151844647, 1.2526066762970351, 0.00017163163478038098, -9.999827015218685, -9.999827554805627, 0.00017199988655342073, -9.938536265419623, 0.00017110173499190656, 0.00017385096763706411, 0.00017330682668624178, -9.999827142440946, 0.00017242508044879116, 0.00017190470412964374, 0.00017338155884464906, 0.00017279014179093284, 0.00017225261065838642, 0.0001718088043635337, 0.00017138153266498942, 0.00017408404624257766, 0.00017348783518842572, 0.00017294596138382764, 0.0001724985791637864, 0.00017206787423145023, 0.0001745761685990295, 0.6089926566410887, -9.999826540020837, -9.99982712812688, 0.00017233181141605017, 0.00017053760869832415, -9.999836726477739, 0.00016970629703121998, -9.123128561062945, 0.0001687249782515409, 0.00017075412545557107, 0.00016347938039553203, -19.999830079201008, 1.6597763798835603, 0.00016893546632965577, 0.00016431721407559084, 0.249465096427862, 0.00017031211661010424, 0.00016980450385097723, 0.00016246855725298947, 0.0001638112759330681, 0.00017026492756502037, 0.0001697778575242146, 0.00016927341939538146, 0.00016196210697865746, 0.00016457793212040151, -19.999828939863256, 0.00017056841992578984, -9.999829940673097, 0.00016271151256848856, -9.99982913252718, 1.2178081324510097, 0.701530424506079, 0.00016955437975094085, -9.999830948687782, 0.0001715496483301687, 0.00016423893554436573, 0.00017070846446495236, -9.999829781096503, 0.00016971179931562596, 0.0001718875973711047, 0.00017145993418734212, 0.00017094535794248808, -9.999836337984899, 0.0001701100757575364], "episode_lengths": [25, 24, 25, 27, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 27, 25, 25, 24, 26, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 26, 26, 25, 26, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 24, 27, 25, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 27, 25, 26, 24, 26, 24, 25, 25, 26, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.61593115364616, "mean_inference_ms": 2.1081070703674594, "mean_action_processing_ms": 0.1442095285519259, "mean_env_wait_ms": 1.2969094909322134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010265588760375977, "StateBufferConnector_ms": 0.006171464920043945, "ViewRequirementAgentConnector_ms": 0.181488037109375}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 140400, "num_env_steps_sampled": 73000, "num_env_steps_trained": 140400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.664197515235352, "num_env_steps_trained_throughput_per_sec": 9.095185154708936, "timesteps_total": 73000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 73000, "timers": {"training_iteration_time_ms": 9041.062, "sample_time_ms": 8976.833, "load_time_ms": 0.245, "load_throughput": 318182.953, "learn_time_ms": 13.371, "learn_throughput": 5833.379, "synch_weights_time_ms": 11.484}, "counters": {"num_env_steps_sampled": 73000, "num_env_steps_trained": 140400, "num_agent_steps_sampled": 73000, "num_agent_steps_trained": 140400, "last_target_update_ts": 72800, "num_target_updates": 139}, "done": false, "episodes_total": 2841, "training_iteration": 73, "trial_id": "2058a_00000", "date": "2024-04-17_09-53-02", "timestamp": 1713347582, "time_this_iter_s": 214.40882778167725, "time_total_s": 16354.572738647461, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 16354.572738647461, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 14.046229508196722, "ram_util_percent": 20.772131147540986}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.017751965671777725, "cur_lr": 0.01}, "td_error": [1.1463886499404907, 1.1463888883590698, 1.1463898420333862, 1.4266033172607422, 1.1463887691497803, 1.1463888883590698, 1.1463887691497803, 1.1463888883590698, 1.146389365196228, 1.1463888883590698, 1.1463890075683594, 1.1463888883590698, 0.8132729530334473, 1.2446482181549072, 0.8132734298706055, 1.366001844406128, 1.1463887691497803, 1.1463886499404907, 1.1463886499404907, 1.1463888883590698, 1.1463887691497803, 3.1778836250305176, 1.1463890075683594, 1.1463890075683594, 1.1463887691497803, 1.1463892459869385, 1.1463892459869385, 1.1463888883590698, 1.1463890075683594, 1.1463887691497803, 1.146389365196228, 1.1463888883590698, 1.1463888883590698, 1.1463897228240967, 1.146389365196228, 1.146389126777649, 1.1466182470321655, 1.1463888883590698, 0.8132734298706055, 1.1463887691497803, 1.1463888883590698, 1.1463892459869385, 1.1463887691497803, 0.8132734894752502, 1.1463887691497803, 1.1463888883590698, 1.1463887691497803, 3.4325215816497803, 1.1463887691497803, 0.8132734298706055, 1.1463887691497803, 1.1463890075683594, 1.1463892459869385, 3.4293482303619385, 1.1463894844055176, 1.1463888883590698, 1.1463894844055176, 1.1463887691497803, 0.8132734298706055, 1.1463886499404907, 1.1463886499404907, 1.1463888883590698, 1.1463887691497803, 1.1463896036148071, 1.1463885307312012, 1.1466394662857056, 1.1463888883590698, 0.8132730722427368, 1.1463887691497803, 1.1463887691497803, 1.1463886499404907, 1.1463890075683594, 1.1463887691497803, 1.146389126777649, 1.310738205909729, 1.1463888883590698, 1.1463885307312012, 1.1463888883590698], "mean_td_error": 1.2108978033065796, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1825.0, "diff_num_grad_updates_vs_sampler_policy": 1824.0}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 142350, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 142350, "last_target_update_ts": 73840, "num_target_updates": 141}, "sampler_results": {"episode_reward_max": 2.997455713916811, "episode_reward_min": -19.999830079201008, "episode_reward_mean": -1.8004869657713483, "episode_len_mean": 25.03, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00017385096763706411, 0.00017330682668624178, -9.999827142440946, 0.00017242508044879116, 0.00017190470412964374, 0.00017338155884464906, 0.00017279014179093284, 0.00017225261065838642, 0.0001718088043635337, 0.00017138153266498942, 0.00017408404624257766, 0.00017348783518842572, 0.00017294596138382764, 0.0001724985791637864, 0.00017206787423145023, 0.0001745761685990295, 0.6089926566410887, -9.999826540020837, -9.99982712812688, 0.00017233181141605017, 0.00017053760869832415, -9.999836726477739, 0.00016970629703121998, -9.123128561062945, 0.0001687249782515409, 0.00017075412545557107, 0.00016347938039553203, -19.999830079201008, 1.6597763798835603, 0.00016893546632965577, 0.00016431721407559084, 0.249465096427862, 0.00017031211661010424, 0.00016980450385097723, 0.00016246855725298947, 0.0001638112759330681, 0.00017026492756502037, 0.0001697778575242146, 0.00016927341939538146, 0.00016196210697865746, 0.00016457793212040151, -19.999828939863256, 0.00017056841992578984, -9.999829940673097, 0.00016271151256848856, -9.99982913252718, 1.2178081324510097, 0.701530424506079, 0.00016955437975094085, -9.999830948687782, 0.0001715496483301687, 0.00016423893554436573, 0.00017070846446495236, -9.999829781096503, 0.00016971179931562596, 0.0001718875973711047, 0.00017145993418734212, 0.00017094535794248808, -9.999836337984899, 0.0001701100757575364, 0.00016143909400419767, 0.00016772650395394892, 0.0001672260317175186, 0.0001666337187591121, 0.00016604675962070327, 0.00016163982425257067, 0.00016793450652228617, 0.00016743279412183393, 0.00016683901817443392, 0.00016625061424673635, -9.99983120670481, -9.999831713553597, 0.00016768656616308048, 0.0001670921789014243, 0.00016645581304283938, 0.00016826846250634386, 0.10961287194553236, 0.0001671899601434699, 0.06196628352462724, 0.0001660212340876503, 0.00016904499851806264, 0.0001685366391952288, 0.00016793502234645628, 0.00016733887537045166, 2.997455713916811, 0.00016175025554131971, -9.999831951016779, 0.10269992062428676, 0.00016697626935722765, 0.6495737912391191, 0.08523170734730083, 0.0001687272225477857, -9.999831779184927, 0.0001676214018364861, 0.4640275311724372, 0.00016962388998823788, -9.848223460717508, 0.00016183202918388786, 0.00016813367364122247, 0.0001676307723220992], "episode_lengths": [25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 24, 27, 25, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 27, 25, 26, 24, 26, 24, 25, 25, 26, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.83308688267925, "mean_inference_ms": 2.1078444467371624, "mean_action_processing_ms": 0.14419716288876494, "mean_env_wait_ms": 1.2808139043271194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010720968246459961, "StateBufferConnector_ms": 0.006239414215087891, "ViewRequirementAgentConnector_ms": 0.17319416999816895}}, "episode_reward_max": 2.997455713916811, "episode_reward_min": -19.999830079201008, "episode_reward_mean": -1.8004869657713483, "episode_len_mean": 25.03, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00017385096763706411, 0.00017330682668624178, -9.999827142440946, 0.00017242508044879116, 0.00017190470412964374, 0.00017338155884464906, 0.00017279014179093284, 0.00017225261065838642, 0.0001718088043635337, 0.00017138153266498942, 0.00017408404624257766, 0.00017348783518842572, 0.00017294596138382764, 0.0001724985791637864, 0.00017206787423145023, 0.0001745761685990295, 0.6089926566410887, -9.999826540020837, -9.99982712812688, 0.00017233181141605017, 0.00017053760869832415, -9.999836726477739, 0.00016970629703121998, -9.123128561062945, 0.0001687249782515409, 0.00017075412545557107, 0.00016347938039553203, -19.999830079201008, 1.6597763798835603, 0.00016893546632965577, 0.00016431721407559084, 0.249465096427862, 0.00017031211661010424, 0.00016980450385097723, 0.00016246855725298947, 0.0001638112759330681, 0.00017026492756502037, 0.0001697778575242146, 0.00016927341939538146, 0.00016196210697865746, 0.00016457793212040151, -19.999828939863256, 0.00017056841992578984, -9.999829940673097, 0.00016271151256848856, -9.99982913252718, 1.2178081324510097, 0.701530424506079, 0.00016955437975094085, -9.999830948687782, 0.0001715496483301687, 0.00016423893554436573, 0.00017070846446495236, -9.999829781096503, 0.00016971179931562596, 0.0001718875973711047, 0.00017145993418734212, 0.00017094535794248808, -9.999836337984899, 0.0001701100757575364, 0.00016143909400419767, 0.00016772650395394892, 0.0001672260317175186, 0.0001666337187591121, 0.00016604675962070327, 0.00016163982425257067, 0.00016793450652228617, 0.00016743279412183393, 0.00016683901817443392, 0.00016625061424673635, -9.99983120670481, -9.999831713553597, 0.00016768656616308048, 0.0001670921789014243, 0.00016645581304283938, 0.00016826846250634386, 0.10961287194553236, 0.0001671899601434699, 0.06196628352462724, 0.0001660212340876503, 0.00016904499851806264, 0.0001685366391952288, 0.00016793502234645628, 0.00016733887537045166, 2.997455713916811, 0.00016175025554131971, -9.999831951016779, 0.10269992062428676, 0.00016697626935722765, 0.6495737912391191, 0.08523170734730083, 0.0001687272225477857, -9.999831779184927, 0.0001676214018364861, 0.4640275311724372, 0.00016962388998823788, -9.848223460717508, 0.00016183202918388786, 0.00016813367364122247, 0.0001676307723220992], "episode_lengths": [25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 24, 27, 25, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 27, 25, 26, 24, 26, 24, 25, 25, 26, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 427.83308688267925, "mean_inference_ms": 2.1078444467371624, "mean_action_processing_ms": 0.14419716288876494, "mean_env_wait_ms": 1.2808139043271194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010720968246459961, "StateBufferConnector_ms": 0.006239414215087891, "ViewRequirementAgentConnector_ms": 0.17319416999816895}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 142350, "num_env_steps_sampled": 74000, "num_env_steps_trained": 142350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.478460777850247, "num_env_steps_trained_throughput_per_sec": 8.732998516807983, "timesteps_total": 74000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 8938.172, "sample_time_ms": 8875.429, "load_time_ms": 0.231, "load_throughput": 337482.682, "learn_time_ms": 12.932, "learn_throughput": 6031.321, "synch_weights_time_ms": 11.418}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 142350, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 142350, "last_target_update_ts": 73840, "num_target_updates": 141}, "done": false, "episodes_total": 2881, "training_iteration": 74, "trial_id": "2058a_00000", "date": "2024-04-17_09-56-45", "timestamp": 1713347805, "time_this_iter_s": 223.3015639781952, "time_total_s": 16577.874302625656, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 16577.874302625656, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 13.340880503144655, "ram_util_percent": 20.895597484276735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.056982338428497314, "cur_lr": 0.01}, "td_error": [1.159552812576294, 1.159550666809082, 1.1595509052276611, 1.1595516204833984, 1.1595516204833984, 1.1595518589019775, 0.813876748085022, 1.1595513820648193, 1.1595529317855835, 1.159550666809082, 1.1595509052276611, 0.7416049242019653, 1.1595516204833984, 4.394435405731201, 1.159550428390503, 1.159551739692688, 1.1595503091812134, 1.1595503091812134, 1.1595529317855835, 1.1595515012741089, 1.1595512628555298, 1.1595515012741089, 1.1595510244369507, 1.1595550775527954, 1.1595510244369507, 1.159550428390503, 1.1595523357391357, 3.3819403648376465, 1.1595510244369507, 1.1595513820648193, 1.1595503091812134, 1.159551739692688, 1.1595515012741089, 1.2107652425765991, 1.1595512628555298, 1.1595522165298462, 1.1595507860183716, 1.1595509052276611, 1.1595509052276611, 1.1595513820648193, 1.1595510244369507, 1.1595505475997925, 3.3819403648376465, 1.159550428390503, 1.1595524549484253, 1.1595510244369507, 1.1595512628555298, 1.1595516204833984, 1.1595505475997925, 1.1595542430877686, 1.1595505475997925, 0.8138748407363892, 1.1595510244369507, 0.8138755559921265, 1.1595510244369507, 1.1595505475997925, 1.1595505475997925, 1.1595505475997925, 1.1595509052276611, 1.1595509052276611, 1.1595510244369507, 1.1595509052276611, 1.1595507860183716, 1.1595512628555298, 3.3812217712402344, 0.8138748407363892, 1.1595503091812134, 1.1595511436462402, 1.1595509052276611, 1.159550666809082, 1.1595532894134521, 1.1595505475997925, 1.1595529317855835, 1.159551739692688, 3.3819406032562256, 1.1595509052276611, 1.1595512628555298, 0.8138766288757324], "mean_td_error": 1.2881232500076294, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1850.0, "diff_num_grad_updates_vs_sampler_policy": 1849.0}}, "num_env_steps_sampled": 75000, "num_env_steps_trained": 144300, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 144300, "last_target_update_ts": 74880, "num_target_updates": 143}, "sampler_results": {"episode_reward_max": 7.514806376118869, "episode_reward_min": -19.99983416252578, "episode_reward_mean": -1.3997386226078807, "episode_len_mean": 25.03, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00016457793212040151, -19.999828939863256, 0.00017056841992578984, -9.999829940673097, 0.00016271151256848856, -9.99982913252718, 1.2178081324510097, 0.701530424506079, 0.00016955437975094085, -9.999830948687782, 0.0001715496483301687, 0.00016423893554436573, 0.00017070846446495236, -9.999829781096503, 0.00016971179931562596, 0.0001718875973711047, 0.00017145993418734212, 0.00017094535794248808, -9.999836337984899, 0.0001701100757575364, 0.00016143909400419767, 0.00016772650395394892, 0.0001672260317175186, 0.0001666337187591121, 0.00016604675962070327, 0.00016163982425257067, 0.00016793450652228617, 0.00016743279412183393, 0.00016683901817443392, 0.00016625061424673635, -9.99983120670481, -9.999831713553597, 0.00016768656616308048, 0.0001670921789014243, 0.00016645581304283938, 0.00016826846250634386, 0.10961287194553236, 0.0001671899601434699, 0.06196628352462724, 0.0001660212340876503, 0.00016904499851806264, 0.0001685366391952288, 0.00016793502234645628, 0.00016733887537045166, 2.997455713916811, 0.00016175025554131971, -9.999831951016779, 0.10269992062428676, 0.00016697626935722765, 0.6495737912391191, 0.08523170734730083, 0.0001687272225477857, -9.999831779184927, 0.0001676214018364861, 0.4640275311724372, 0.00016962388998823788, -9.848223460717508, 0.00016183202918388786, 0.00016813367364122247, 0.0001676307723220992, 0.00016541831528723422, 0.0001648654875184414, 0.00016438300398099673, 0.00016392779514368597, 0.00016342313216000204, 0.17053760200034468, 0.00016508455104925757, 0.08177837919027918, 0.00016417978361946102, 0.0001636735702953623, 0.0001658960395458195, 1.348941849483767, 0.00016494938171030308, 0.00016443841881645248, -9.999842538702032, 0.00016546437522438, 0.0001649783850599462, 7.514806376118869, 0.00016401202283663287, 0.0001570539821341585, -9.9998338598083, 3.447049050037906, 0.0001651888642384868, 0.0001646764188693251, 0.0001576885787416202, 0.2506647268055125, 0.09217009669685683, 0.00016481615840849813, 0.00016435855084181723, 0.0001638512362283298, 0.00016639762047334294, -19.99983416252578, 0.0001653500520672553, 0.00016488947924764245, 0.5648656831134266, 0.00016703559385499085, 0.00016644580487224457, 0.00016581434265670856, 0.00016525886870776493, 0.00016477408325863517], "episode_lengths": [24, 27, 25, 26, 24, 26, 24, 25, 25, 26, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.0249135251829, "mean_inference_ms": 2.1079658021185605, "mean_action_processing_ms": 0.1441977813952641, "mean_env_wait_ms": 1.2651475158430243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01021122932434082, "StateBufferConnector_ms": 0.006293296813964844, "ViewRequirementAgentConnector_ms": 0.17391705513000488}}, "episode_reward_max": 7.514806376118869, "episode_reward_min": -19.99983416252578, "episode_reward_mean": -1.3997386226078807, "episode_len_mean": 25.03, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00016457793212040151, -19.999828939863256, 0.00017056841992578984, -9.999829940673097, 0.00016271151256848856, -9.99982913252718, 1.2178081324510097, 0.701530424506079, 0.00016955437975094085, -9.999830948687782, 0.0001715496483301687, 0.00016423893554436573, 0.00017070846446495236, -9.999829781096503, 0.00016971179931562596, 0.0001718875973711047, 0.00017145993418734212, 0.00017094535794248808, -9.999836337984899, 0.0001701100757575364, 0.00016143909400419767, 0.00016772650395394892, 0.0001672260317175186, 0.0001666337187591121, 0.00016604675962070327, 0.00016163982425257067, 0.00016793450652228617, 0.00016743279412183393, 0.00016683901817443392, 0.00016625061424673635, -9.99983120670481, -9.999831713553597, 0.00016768656616308048, 0.0001670921789014243, 0.00016645581304283938, 0.00016826846250634386, 0.10961287194553236, 0.0001671899601434699, 0.06196628352462724, 0.0001660212340876503, 0.00016904499851806264, 0.0001685366391952288, 0.00016793502234645628, 0.00016733887537045166, 2.997455713916811, 0.00016175025554131971, -9.999831951016779, 0.10269992062428676, 0.00016697626935722765, 0.6495737912391191, 0.08523170734730083, 0.0001687272225477857, -9.999831779184927, 0.0001676214018364861, 0.4640275311724372, 0.00016962388998823788, -9.848223460717508, 0.00016183202918388786, 0.00016813367364122247, 0.0001676307723220992, 0.00016541831528723422, 0.0001648654875184414, 0.00016438300398099673, 0.00016392779514368597, 0.00016342313216000204, 0.17053760200034468, 0.00016508455104925757, 0.08177837919027918, 0.00016417978361946102, 0.0001636735702953623, 0.0001658960395458195, 1.348941849483767, 0.00016494938171030308, 0.00016443841881645248, -9.999842538702032, 0.00016546437522438, 0.0001649783850599462, 7.514806376118869, 0.00016401202283663287, 0.0001570539821341585, -9.9998338598083, 3.447049050037906, 0.0001651888642384868, 0.0001646764188693251, 0.0001576885787416202, 0.2506647268055125, 0.09217009669685683, 0.00016481615840849813, 0.00016435855084181723, 0.0001638512362283298, 0.00016639762047334294, -19.99983416252578, 0.0001653500520672553, 0.00016488947924764245, 0.5648656831134266, 0.00016703559385499085, 0.00016644580487224457, 0.00016581434265670856, 0.00016525886870776493, 0.00016477408325863517], "episode_lengths": [24, 27, 25, 26, 24, 26, 24, 25, 25, 26, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.0249135251829, "mean_inference_ms": 2.1079658021185605, "mean_action_processing_ms": 0.1441977813952641, "mean_env_wait_ms": 1.2651475158430243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01021122932434082, "StateBufferConnector_ms": 0.006293296813964844, "ViewRequirementAgentConnector_ms": 0.17391705513000488}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 144300, "num_env_steps_sampled": 75000, "num_env_steps_trained": 144300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.4826127080808735, "num_env_steps_trained_throughput_per_sec": 8.741094780757704, "timesteps_total": 75000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 75000, "timers": {"training_iteration_time_ms": 8944.645, "sample_time_ms": 8841.348, "load_time_ms": 0.255, "load_throughput": 306067.651, "learn_time_ms": 12.589, "learn_throughput": 6195.826, "synch_weights_time_ms": 53.301}, "counters": {"num_env_steps_sampled": 75000, "num_env_steps_trained": 144300, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 144300, "last_target_update_ts": 74880, "num_target_updates": 143}, "done": false, "episodes_total": 2921, "training_iteration": 75, "trial_id": "2058a_00000", "date": "2024-04-17_10-00-28", "timestamp": 1713348028, "time_this_iter_s": 223.0936734676361, "time_total_s": 16800.967976093292, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 16800.967976093292, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 13.28769716088328, "ram_util_percent": 20.970977917981074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03524777293205261, "cur_lr": 0.01}, "td_error": [0.8230946063995361, 1.1699092388153076, 1.169910192489624, 1.1699079275131226, 1.1699104309082031, 1.169909954071045, 1.1699093580245972, 1.1699100732803345, 1.1699100732803345, 0.823093593120575, 0.8230946063995361, 1.169909954071045, 1.1699103116989136, 1.1699104309082031, 1.169909954071045, 1.1699098348617554, 1.1699100732803345, 1.1699094772338867, 1.169910192489624, 1.169910192489624, 1.1699104309082031, 1.1699103116989136, 1.169907569885254, 0.8230948448181152, 0.8230946063995361, 0.8230940103530884, 0.8230947256088257, 1.169909954071045, 0.823094367980957, 1.169909119606018, 1.1699098348617554, 1.1699070930480957, 1.1699092388153076, 1.1699069738388062, 1.1699105501174927, 1.169909954071045, 1.169910192489624, 0.8230947256088257, 1.1699100732803345, 1.1699104309082031, 1.1699095964431763, 1.1699092388153076, 1.1699076890945435, 0.8230942487716675, 1.169909954071045, 1.169907569885254, 1.169910192489624, 1.169909954071045, 1.1699103116989136, 0.8230950832366943, 1.1699098348617554, 1.169910192489624, 0.8230949640274048, 1.169909954071045, 1.1699104309082031, 1.1699103116989136, 0.8230948448181152, 1.1699085235595703, 1.1699093580245972, 1.169910192489624, 0.8230941891670227, 1.1699103116989136, 1.169909954071045, 1.1699104309082031, 1.1699098348617554, 1.1699093580245972, 1.1699097156524658, 1.169910192489624, 1.1699103116989136, 1.1699097156524658, 1.1699100732803345, 0.8230941295623779, 1.1699104309082031, 1.169909954071045, 1.1699100732803345, 1.1699103116989136, 1.1699104309082031, 1.1699104309082031], "mean_td_error": 1.1032145023345947, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1875.0, "diff_num_grad_updates_vs_sampler_policy": 1874.0}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 146250, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 146250, "last_target_update_ts": 75920, "num_target_updates": 145}, "sampler_results": {"episode_reward_max": 7.514806376118869, "episode_reward_min": -19.999842628055926, "episode_reward_mean": -0.7176765365470255, "episode_len_mean": 24.75, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00016793502234645628, 0.00016733887537045166, 2.997455713916811, 0.00016175025554131971, -9.999831951016779, 0.10269992062428676, 0.00016697626935722765, 0.6495737912391191, 0.08523170734730083, 0.0001687272225477857, -9.999831779184927, 0.0001676214018364861, 0.4640275311724372, 0.00016962388998823788, -9.848223460717508, 0.00016183202918388786, 0.00016813367364122247, 0.0001676307723220992, 0.00016541831528723422, 0.0001648654875184414, 0.00016438300398099673, 0.00016392779514368597, 0.00016342313216000204, 0.17053760200034468, 0.00016508455104925757, 0.08177837919027918, 0.00016417978361946102, 0.0001636735702953623, 0.0001658960395458195, 1.348941849483767, 0.00016494938171030308, 0.00016443841881645248, -9.999842538702032, 0.00016546437522438, 0.0001649783850599462, 7.514806376118869, 0.00016401202283663287, 0.0001570539821341585, -9.9998338598083, 3.447049050037906, 0.0001651888642384868, 0.0001646764188693251, 0.0001576885787416202, 0.2506647268055125, 0.09217009669685683, 0.00016481615840849813, 0.00016435855084181723, 0.0001638512362283298, 0.00016639762047334294, -19.99983416252578, 0.0001653500520672553, 0.00016488947924764245, 0.5648656831134266, 0.00016703559385499085, 0.00016644580487224457, 0.00016581434265670856, 0.00016525886870776493, 0.00016477408325863517, 0.00015649149346840606, 0.0001561795585168132, 0.00016232341642309373, 0.00014898901052753228, 0.00016148926188381846, 0.00015673070484055102, 0.06744670854195278, 0.00016260810225226347, 0.00014924969928319603, 0.00016177102693393564, 0.00016130280962320956, 0.00015714544587775572, 1.2767686314973894, 0.00014994650464319765, 0.00016252415435973747, 0.00016205157354965834, -9.999843260154377, 0.0001629043939171988, 0.00014952101331519281, 0.0841315503629764, 0.0001616194668033337, -19.999842628055926, 0.052249062524916894, 0.062366048369654425, 0.00016274909174218412, 0.00016227520376724353, 0.4243643911026071, 0.00015659473668668857, 0.0001627539600183087, 0.0001493832614075875, 0.00016191538628205533, 0.00015740900642143674, 0.0001570934066990659, 0.00016327107866205377, 0.3077605343836692, 0.0001624379521432557, 5.566563993578224, 0.00016381010593912048, 0.00015686111902054746, 0.00015654771026335702, 2.456635484379343, 0.00014934001116100084], "episode_lengths": [25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 24, 25, 23, 25, 25, 25, 25, 23, 25, 25, 26, 25, 23, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 25, 24, 24, 25, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.36016332315774, "mean_inference_ms": 2.108376705108425, "mean_action_processing_ms": 0.14420789093731992, "mean_env_wait_ms": 1.2495237330571487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010623931884765625, "StateBufferConnector_ms": 0.006571054458618164, "ViewRequirementAgentConnector_ms": 0.1800680160522461}}, "episode_reward_max": 7.514806376118869, "episode_reward_min": -19.999842628055926, "episode_reward_mean": -0.7176765365470255, "episode_len_mean": 24.75, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00016793502234645628, 0.00016733887537045166, 2.997455713916811, 0.00016175025554131971, -9.999831951016779, 0.10269992062428676, 0.00016697626935722765, 0.6495737912391191, 0.08523170734730083, 0.0001687272225477857, -9.999831779184927, 0.0001676214018364861, 0.4640275311724372, 0.00016962388998823788, -9.848223460717508, 0.00016183202918388786, 0.00016813367364122247, 0.0001676307723220992, 0.00016541831528723422, 0.0001648654875184414, 0.00016438300398099673, 0.00016392779514368597, 0.00016342313216000204, 0.17053760200034468, 0.00016508455104925757, 0.08177837919027918, 0.00016417978361946102, 0.0001636735702953623, 0.0001658960395458195, 1.348941849483767, 0.00016494938171030308, 0.00016443841881645248, -9.999842538702032, 0.00016546437522438, 0.0001649783850599462, 7.514806376118869, 0.00016401202283663287, 0.0001570539821341585, -9.9998338598083, 3.447049050037906, 0.0001651888642384868, 0.0001646764188693251, 0.0001576885787416202, 0.2506647268055125, 0.09217009669685683, 0.00016481615840849813, 0.00016435855084181723, 0.0001638512362283298, 0.00016639762047334294, -19.99983416252578, 0.0001653500520672553, 0.00016488947924764245, 0.5648656831134266, 0.00016703559385499085, 0.00016644580487224457, 0.00016581434265670856, 0.00016525886870776493, 0.00016477408325863517, 0.00015649149346840606, 0.0001561795585168132, 0.00016232341642309373, 0.00014898901052753228, 0.00016148926188381846, 0.00015673070484055102, 0.06744670854195278, 0.00016260810225226347, 0.00014924969928319603, 0.00016177102693393564, 0.00016130280962320956, 0.00015714544587775572, 1.2767686314973894, 0.00014994650464319765, 0.00016252415435973747, 0.00016205157354965834, -9.999843260154377, 0.0001629043939171988, 0.00014952101331519281, 0.0841315503629764, 0.0001616194668033337, -19.999842628055926, 0.052249062524916894, 0.062366048369654425, 0.00016274909174218412, 0.00016227520376724353, 0.4243643911026071, 0.00015659473668668857, 0.0001627539600183087, 0.0001493832614075875, 0.00016191538628205533, 0.00015740900642143674, 0.0001570934066990659, 0.00016327107866205377, 0.3077605343836692, 0.0001624379521432557, 5.566563993578224, 0.00016381010593912048, 0.00015686111902054746, 0.00015654771026335702, 2.456635484379343, 0.00014934001116100084], "episode_lengths": [25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 24, 25, 23, 25, 25, 25, 25, 23, 25, 25, 26, 25, 23, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 25, 24, 24, 25, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.36016332315774, "mean_inference_ms": 2.108376705108425, "mean_action_processing_ms": 0.14420789093731992, "mean_env_wait_ms": 1.2495237330571487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010623931884765625, "StateBufferConnector_ms": 0.006571054458618164, "ViewRequirementAgentConnector_ms": 0.1800680160522461}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 146250, "num_env_steps_sampled": 76000, "num_env_steps_trained": 146250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.862143421569769, "num_env_steps_trained_throughput_per_sec": 7.531179672061049, "timesteps_total": 76000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 11306.939, "sample_time_ms": 11241.917, "load_time_ms": 0.24, "load_throughput": 324559.238, "learn_time_ms": 13.236, "learn_throughput": 5893.03, "synch_weights_time_ms": 11.258}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 146250, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 146250, "last_target_update_ts": 75920, "num_target_updates": 145}, "done": false, "episodes_total": 2963, "training_iteration": 76, "trial_id": "2058a_00000", "date": "2024-04-17_10-04-47", "timestamp": 1713348287, "time_this_iter_s": 258.9345066547394, "time_total_s": 17059.90248274803, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 17059.90248274803, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 12.175271739130435, "ram_util_percent": 21.074184782608693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.018328960984945297, "cur_lr": 0.01}, "td_error": [3.525407314300537, 1.120675802230835, 1.1206759214401245, 1.1206756830215454, 1.1206755638122559, 1.1206759214401245, 1.1206759214401245, 0.7591871023178101, 1.1206759214401245, 1.1206755638122559, 1.1206755638122559, 1.1206756830215454, 1.120675802230835, 1.1206752061843872, 1.1206756830215454, 1.1206756830215454, 1.120675802230835, 1.1206759214401245, 1.120675802230835, 1.120675802230835, 1.1206742525100708, 1.1206756830215454, 1.120675802230835, 1.1206756830215454, 1.1206756830215454, 0.8039003014564514, 1.1206756830215454, 1.1206755638122559, 1.1206755638122559, 1.1206756830215454, 1.120675802230835, 1.1206759214401245, 1.1206754446029663, 0.8039006590843201, 1.1206759214401245, 1.1206759214401245, 0.8039006590843201, 1.120676040649414, 1.1206756830215454, 1.1206759214401245, 1.1206759214401245, 0.8039007186889648, 0.8039008378982544, 1.1206756830215454, 1.120675802230835, 1.1206759214401245, 0.8039008378982544, 0.8039007186889648, 1.120675802230835, 1.227542757987976, 1.120675802230835, 1.1206759214401245, 1.1206756830215454, 1.1206755638122559, 1.1206753253936768, 1.1206759214401245, 1.1206759214401245, 1.120675802230835, 1.1206759214401245, 0.8039007186889648, 1.120675802230835, 1.1206759214401245, 1.120675802230835, 1.1206755638122559, 1.120674729347229, 1.1206759214401245, 0.8039006590843201, 1.120675802230835, 1.1206743717193604, 1.1206759214401245, 1.120675802230835, 1.1206752061843872, 1.1206756830215454, 1.1206755638122559, 1.1206759214401245, 0.8039003610610962, 1.120675802230835, 1.1206753253936768], "mean_td_error": 1.1076290607452393, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1900.0, "diff_num_grad_updates_vs_sampler_policy": 1899.0}}, "num_env_steps_sampled": 77000, "num_env_steps_trained": 148200, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 148200, "last_target_update_ts": 76960, "num_target_updates": 147}, "sampler_results": {"episode_reward_max": 5.566563993578224, "episode_reward_min": -19.999842628055926, "episode_reward_mean": -0.8009476074716138, "episode_len_mean": 24.72, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0001651888642384868, 0.0001646764188693251, 0.0001576885787416202, 0.2506647268055125, 0.09217009669685683, 0.00016481615840849813, 0.00016435855084181723, 0.0001638512362283298, 0.00016639762047334294, -19.99983416252578, 0.0001653500520672553, 0.00016488947924764245, 0.5648656831134266, 0.00016703559385499085, 0.00016644580487224457, 0.00016581434265670856, 0.00016525886870776493, 0.00016477408325863517, 0.00015649149346840606, 0.0001561795585168132, 0.00016232341642309373, 0.00014898901052753228, 0.00016148926188381846, 0.00015673070484055102, 0.06744670854195278, 0.00016260810225226347, 0.00014924969928319603, 0.00016177102693393564, 0.00016130280962320956, 0.00015714544587775572, 1.2767686314973894, 0.00014994650464319765, 0.00016252415435973747, 0.00016205157354965834, -9.999843260154377, 0.0001629043939171988, 0.00014952101331519281, 0.0841315503629764, 0.0001616194668033337, -19.999842628055926, 0.052249062524916894, 0.062366048369654425, 0.00016274909174218412, 0.00016227520376724353, 0.4243643911026071, 0.00015659473668668857, 0.0001627539600183087, 0.0001493832614075875, 0.00016191538628205533, 0.00015740900642143674, 0.0001570934066990659, 0.00016327107866205377, 0.3077605343836692, 0.0001624379521432557, 5.566563993578224, 0.00016381010593912048, 0.00015686111902054746, 0.00015654771026335702, 2.456635484379343, 0.00014934001116100084, 0.00016102267188701353, -6.045583306873919, 0.00016027893778361422, 0.0001598343070378734, 0.00015933453794881867, 0.11995975296245283, 0.10661546121686497, 0.00016012512205173724, 0.00015962353543704503, 0.00015916524503844343, -9.999844792293565, 2.0369534817900252, 0.00016082459873072638, 0.0001603186270823536, 0.00015985634268675882, 0.00015479476733077052, 0.0674512282263127, 0.00016043424562461815, 0.00015993072345410185, 0.0001594706700834278, 0.00015542135134804776, 0.0001614948677900372, 0.00016104347483306367, -9.999839465028241, -19.89161063226805, 0.11715127833164518, 1.77127748700904, 0.0001607204627493122, 0.00016027338241368506, 0.00015977086794074146, 0.245217406286739, 0.00015513582472710718, 0.10690775919981174, 0.00016077108792031787, 0.00016026545240440234, 0.05259799949803048, 0.00016144914124744064, 0.00015463201222785385, 0.000160676710830476, 0.00016022987353094697], "episode_lengths": [25, 25, 24, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 24, 25, 23, 25, 25, 25, 25, 23, 25, 25, 26, 25, 23, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 25, 24, 24, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 27, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.66406036630013, "mean_inference_ms": 2.1086570003075966, "mean_action_processing_ms": 0.1442271411502348, "mean_env_wait_ms": 1.2350297598842759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010247230529785156, "StateBufferConnector_ms": 0.0065844058990478516, "ViewRequirementAgentConnector_ms": 0.18019461631774902}}, "episode_reward_max": 5.566563993578224, "episode_reward_min": -19.999842628055926, "episode_reward_mean": -0.8009476074716138, "episode_len_mean": 24.72, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0001651888642384868, 0.0001646764188693251, 0.0001576885787416202, 0.2506647268055125, 0.09217009669685683, 0.00016481615840849813, 0.00016435855084181723, 0.0001638512362283298, 0.00016639762047334294, -19.99983416252578, 0.0001653500520672553, 0.00016488947924764245, 0.5648656831134266, 0.00016703559385499085, 0.00016644580487224457, 0.00016581434265670856, 0.00016525886870776493, 0.00016477408325863517, 0.00015649149346840606, 0.0001561795585168132, 0.00016232341642309373, 0.00014898901052753228, 0.00016148926188381846, 0.00015673070484055102, 0.06744670854195278, 0.00016260810225226347, 0.00014924969928319603, 0.00016177102693393564, 0.00016130280962320956, 0.00015714544587775572, 1.2767686314973894, 0.00014994650464319765, 0.00016252415435973747, 0.00016205157354965834, -9.999843260154377, 0.0001629043939171988, 0.00014952101331519281, 0.0841315503629764, 0.0001616194668033337, -19.999842628055926, 0.052249062524916894, 0.062366048369654425, 0.00016274909174218412, 0.00016227520376724353, 0.4243643911026071, 0.00015659473668668857, 0.0001627539600183087, 0.0001493832614075875, 0.00016191538628205533, 0.00015740900642143674, 0.0001570934066990659, 0.00016327107866205377, 0.3077605343836692, 0.0001624379521432557, 5.566563993578224, 0.00016381010593912048, 0.00015686111902054746, 0.00015654771026335702, 2.456635484379343, 0.00014934001116100084, 0.00016102267188701353, -6.045583306873919, 0.00016027893778361422, 0.0001598343070378734, 0.00015933453794881867, 0.11995975296245283, 0.10661546121686497, 0.00016012512205173724, 0.00015962353543704503, 0.00015916524503844343, -9.999844792293565, 2.0369534817900252, 0.00016082459873072638, 0.0001603186270823536, 0.00015985634268675882, 0.00015479476733077052, 0.0674512282263127, 0.00016043424562461815, 0.00015993072345410185, 0.0001594706700834278, 0.00015542135134804776, 0.0001614948677900372, 0.00016104347483306367, -9.999839465028241, -19.89161063226805, 0.11715127833164518, 1.77127748700904, 0.0001607204627493122, 0.00016027338241368506, 0.00015977086794074146, 0.245217406286739, 0.00015513582472710718, 0.10690775919981174, 0.00016077108792031787, 0.00016026545240440234, 0.05259799949803048, 0.00016144914124744064, 0.00015463201222785385, 0.000160676710830476, 0.00016022987353094697], "episode_lengths": [25, 25, 24, 25, 25, 25, 25, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 24, 25, 23, 25, 25, 25, 25, 23, 25, 25, 26, 25, 23, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 25, 24, 24, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 27, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.66406036630013, "mean_inference_ms": 2.1086570003075966, "mean_action_processing_ms": 0.1442271411502348, "mean_env_wait_ms": 1.2350297598842759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010247230529785156, "StateBufferConnector_ms": 0.0065844058990478516, "ViewRequirementAgentConnector_ms": 0.18019461631774902}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 148200, "num_env_steps_sampled": 77000, "num_env_steps_trained": 148200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.574543780056526, "num_env_steps_trained_throughput_per_sec": 6.970360371110225, "timesteps_total": 77000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 77000, "timers": {"training_iteration_time_ms": 11057.432, "sample_time_ms": 10992.172, "load_time_ms": 0.235, "load_throughput": 331296.924, "learn_time_ms": 12.937, "learn_throughput": 6029.353, "synch_weights_time_ms": 11.525}, "counters": {"num_env_steps_sampled": 77000, "num_env_steps_trained": 148200, "num_agent_steps_sampled": 77000, "num_agent_steps_trained": 148200, "last_target_update_ts": 76960, "num_target_updates": 147}, "done": false, "episodes_total": 3003, "training_iteration": 77, "trial_id": "2058a_00000", "date": "2024-04-17_10-09-27", "timestamp": 1713348567, "time_this_iter_s": 279.76534700393677, "time_total_s": 17339.66782975197, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 17339.66782975197, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 10.774874371859296, "ram_util_percent": 21.175879396984914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04740133509039879, "cur_lr": 0.01}, "td_error": [1.126985788345337, 1.126986026763916, 1.1269865036010742, 3.406207323074341, 1.126985788345337, 1.126985788345337, 1.126985788345337, 1.1269869804382324, 0.8074607849121094, 1.126986026763916, 1.1269856691360474, 1.126986026763916, 1.126985788345337, 1.1269863843917847, 1.1269863843917847, 0.8074609041213989, 1.1269855499267578, 1.1269859075546265, 1.1269859075546265, 1.1269856691360474, 1.126985788345337, 1.1269859075546265, 1.126985788345337, 1.126986026763916, 1.1269866228103638, 0.7584458589553833, 1.3722813129425049, 0.8074608445167542, 1.1269865036010742, 1.126985788345337, 0.8074607849121094, 3.4048495292663574, 1.1269861459732056, 1.1269856691360474, 1.1269868612289429, 0.8074607849121094, 1.1269856691360474, 1.126985788345337, 1.1269856691360474, 3.387739896774292, 1.126985788345337, 1.1269859075546265, 1.1269856691360474, 1.1269856691360474, 1.1269865036010742, 1.126985788345337, 1.1269867420196533, 1.126986026763916, 0.8074608445167542, 1.126987338066101, 3.402094602584839, 1.1269859075546265, 1.126985788345337, 1.126986026763916, 1.126985788345337, 1.1269861459732056, 1.1269856691360474, 1.126986026763916, 0.8074607849121094, 1.1269862651824951, 1.1269856691360474, 1.1269878149032593, 1.1269863843917847, 1.1269859075546265, 1.126985788345337, 1.126985788345337, 0.8074607849121094, 1.1269863843917847, 1.126986026763916, 0.8074607849121094, 1.1269856691360474, 1.126985788345337, 1.126985788345337, 1.126985788345337, 1.126985788345337, 1.126985788345337, 1.126985788345337, 1.1269856691360474], "mean_td_error": 1.2051138877868652, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1925.0, "diff_num_grad_updates_vs_sampler_policy": 1924.0}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 150150, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 150150, "last_target_update_ts": 78000, "num_target_updates": 149}, "sampler_results": {"episode_reward_max": 5.566563993578224, "episode_reward_min": -19.999842628055926, "episode_reward_mean": -0.9959875933949496, "episode_len_mean": 24.85, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.999842628055926, 0.052249062524916894, 0.062366048369654425, 0.00016274909174218412, 0.00016227520376724353, 0.4243643911026071, 0.00015659473668668857, 0.0001627539600183087, 0.0001493832614075875, 0.00016191538628205533, 0.00015740900642143674, 0.0001570934066990659, 0.00016327107866205377, 0.3077605343836692, 0.0001624379521432557, 5.566563993578224, 0.00016381010593912048, 0.00015686111902054746, 0.00015654771026335702, 2.456635484379343, 0.00014934001116100084, 0.00016102267188701353, -6.045583306873919, 0.00016027893778361422, 0.0001598343070378734, 0.00015933453794881867, 0.11995975296245283, 0.10661546121686497, 0.00016012512205173724, 0.00015962353543704503, 0.00015916524503844343, -9.999844792293565, 2.0369534817900252, 0.00016082459873072638, 0.0001603186270823536, 0.00015985634268675882, 0.00015479476733077052, 0.0674512282263127, 0.00016043424562461815, 0.00015993072345410185, 0.0001594706700834278, 0.00015542135134804776, 0.0001614948677900372, 0.00016104347483306367, -9.999839465028241, -19.89161063226805, 0.11715127833164518, 1.77127748700904, 0.0001607204627493122, 0.00016027338241368506, 0.00015977086794074146, 0.245217406286739, 0.00015513582472710718, 0.10690775919981174, 0.00016077108792031787, 0.00016026545240440234, 0.05259799949803048, 0.00016144914124744064, 0.00015463201222785385, 0.000160676710830476, 0.00016022987353094697, 0.00015887790304511872, 0.00015845133172229424, 0.00015807170936015126, 0.00015757516736524457, 0.00015716747961696888, 0.00015873713131174533, 0.0001583561399111406, 0.00015785781241618927, 0.00015744866244577516, 0.00015072105088536491, -9.999840575265246, -9.999840961577094, 0.0001585375789389325, 0.00015812490160399087, 0.00015136654759453404, 0.6605737641524854, 0.00015866211282826066, 0.00015816186103651043, -9.999842248825033, 0.14830002213873347, 0.0001596791781681842, 0.00015929365676539301, 0.00015878942143956605, 0.00015837543343821817, 0.00015160568602413403, 0.00015931173241237742, 0.15574131922307927, 0.00015851722349919991, 0.00015801788339277827, 1.8672167299226126, 0.00015980347416081071, 0.00015937192459458972, 0.0001589878836108541, 0.0001584855789494322, 0.00015807317198029803, 0.00015972763143838774, 0.000159268744004028, -9.999841159119581, -9.999841541370856], "episode_lengths": [26, 25, 23, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 25, 24, 24, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 27, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 26, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.8360902974446, "mean_inference_ms": 2.108968396236356, "mean_action_processing_ms": 0.14426961088641818, "mean_env_wait_ms": 1.221022585170116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010131597518920898, "StateBufferConnector_ms": 0.006686210632324219, "ViewRequirementAgentConnector_ms": 0.17876839637756348}}, "episode_reward_max": 5.566563993578224, "episode_reward_min": -19.999842628055926, "episode_reward_mean": -0.9959875933949496, "episode_len_mean": 24.85, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.999842628055926, 0.052249062524916894, 0.062366048369654425, 0.00016274909174218412, 0.00016227520376724353, 0.4243643911026071, 0.00015659473668668857, 0.0001627539600183087, 0.0001493832614075875, 0.00016191538628205533, 0.00015740900642143674, 0.0001570934066990659, 0.00016327107866205377, 0.3077605343836692, 0.0001624379521432557, 5.566563993578224, 0.00016381010593912048, 0.00015686111902054746, 0.00015654771026335702, 2.456635484379343, 0.00014934001116100084, 0.00016102267188701353, -6.045583306873919, 0.00016027893778361422, 0.0001598343070378734, 0.00015933453794881867, 0.11995975296245283, 0.10661546121686497, 0.00016012512205173724, 0.00015962353543704503, 0.00015916524503844343, -9.999844792293565, 2.0369534817900252, 0.00016082459873072638, 0.0001603186270823536, 0.00015985634268675882, 0.00015479476733077052, 0.0674512282263127, 0.00016043424562461815, 0.00015993072345410185, 0.0001594706700834278, 0.00015542135134804776, 0.0001614948677900372, 0.00016104347483306367, -9.999839465028241, -19.89161063226805, 0.11715127833164518, 1.77127748700904, 0.0001607204627493122, 0.00016027338241368506, 0.00015977086794074146, 0.245217406286739, 0.00015513582472710718, 0.10690775919981174, 0.00016077108792031787, 0.00016026545240440234, 0.05259799949803048, 0.00016144914124744064, 0.00015463201222785385, 0.000160676710830476, 0.00016022987353094697, 0.00015887790304511872, 0.00015845133172229424, 0.00015807170936015126, 0.00015757516736524457, 0.00015716747961696888, 0.00015873713131174533, 0.0001583561399111406, 0.00015785781241618927, 0.00015744866244577516, 0.00015072105088536491, -9.999840575265246, -9.999840961577094, 0.0001585375789389325, 0.00015812490160399087, 0.00015136654759453404, 0.6605737641524854, 0.00015866211282826066, 0.00015816186103651043, -9.999842248825033, 0.14830002213873347, 0.0001596791781681842, 0.00015929365676539301, 0.00015878942143956605, 0.00015837543343821817, 0.00015160568602413403, 0.00015931173241237742, 0.15574131922307927, 0.00015851722349919991, 0.00015801788339277827, 1.8672167299226126, 0.00015980347416081071, 0.00015937192459458972, 0.0001589878836108541, 0.0001584855789494322, 0.00015807317198029803, 0.00015972763143838774, 0.000159268744004028, -9.999841159119581, -9.999841541370856], "episode_lengths": [26, 25, 23, 25, 25, 24, 24, 25, 23, 25, 24, 24, 25, 23, 25, 25, 25, 24, 24, 25, 23, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 26, 27, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 26, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 428.8360902974446, "mean_inference_ms": 2.108968396236356, "mean_action_processing_ms": 0.14426961088641818, "mean_env_wait_ms": 1.221022585170116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010131597518920898, "StateBufferConnector_ms": 0.006686210632324219, "ViewRequirementAgentConnector_ms": 0.17876839637756348}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 150150, "num_env_steps_sampled": 78000, "num_env_steps_trained": 150150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.577274346501245, "num_env_steps_trained_throughput_per_sec": 6.975684975677428, "timesteps_total": 78000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 11193.729, "sample_time_ms": 11127.925, "load_time_ms": 0.24, "load_throughput": 325495.684, "learn_time_ms": 13.217, "learn_throughput": 5901.471, "synch_weights_time_ms": 11.784}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 150150, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 150150, "last_target_update_ts": 78000, "num_target_updates": 149}, "done": false, "episodes_total": 3042, "training_iteration": 78, "trial_id": "2058a_00000", "date": "2024-04-17_10-14-06", "timestamp": 1713348846, "time_this_iter_s": 279.5502281188965, "time_total_s": 17619.218057870865, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 17619.218057870865, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 10.630150753768845, "ram_util_percent": 21.279899497487442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.008965667337179184, "cur_lr": 0.01}, "td_error": [1.1359812021255493, 0.8123383522033691, 1.1359816789627075, 1.1359809637069702, 1.135981559753418, 1.1359813213348389, 1.1359821557998657, 1.1359812021255493, 1.1359812021255493, 1.1359809637069702, 0.8123382329940796, 1.1359813213348389, 1.1359816789627075, 1.1359810829162598, 1.1359810829162598, 1.135981559753418, 1.1359814405441284, 1.1359812021255493, 1.1359812021255493, 1.1359809637069702, 1.1359816789627075, 1.1359813213348389, 1.1359813213348389, 1.1359813213348389, 1.1359808444976807, 0.759247899055481, 1.1359810829162598, 1.1359810829162598, 1.1359809637069702, 1.1359808444976807, 1.3542523384094238, 1.1359810829162598, 1.135981798171997, 1.1359809637069702, 0.8123383522033691, 1.1359812021255493, 1.1359810829162598, 1.135981559753418, 1.1359810829162598, 1.1359809637069702, 1.1359813213348389, 1.1359812021255493, 0.8123382329940796, 1.135981559753418, 1.1359813213348389, 1.1359812021255493, 1.1359810829162598, 1.1359810829162598, 1.1359809637069702, 1.1359816789627075, 1.1359809637069702, 1.1359809637069702, 1.135981559753418, 1.1359813213348389, 1.1359831094741821, 1.1359820365905762, 1.1359810829162598, 1.1359809637069702, 1.1359810829162598, 1.1359812021255493, 1.1359808444976807, 1.1359810829162598, 3.3582613468170166, 1.1359808444976807, 1.1359813213348389, 1.1359810829162598, 1.1359810829162598, 1.1359810829162598, 1.1359809637069702, 1.1359813213348389, 1.1359822750091553, 1.1359808444976807, 0.8123382925987244, 1.1359809637069702, 1.1359809637069702, 1.1359809637069702, 1.1359809637069702, 1.1359822750091553], "mean_td_error": 1.1416940689086914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1950.0, "diff_num_grad_updates_vs_sampler_policy": 1949.0}}, "num_env_steps_sampled": 79000, "num_env_steps_trained": 152100, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 152100, "last_target_update_ts": 78520, "num_target_updates": 150}, "sampler_results": {"episode_reward_max": 1.8672167299226126, "episode_reward_min": -19.99984369159586, "episode_reward_mean": -1.70573701833917, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0001594706700834278, 0.00015542135134804776, 0.0001614948677900372, 0.00016104347483306367, -9.999839465028241, -19.89161063226805, 0.11715127833164518, 1.77127748700904, 0.0001607204627493122, 0.00016027338241368506, 0.00015977086794074146, 0.245217406286739, 0.00015513582472710718, 0.10690775919981174, 0.00016077108792031787, 0.00016026545240440234, 0.05259799949803048, 0.00016144914124744064, 0.00015463201222785385, 0.000160676710830476, 0.00016022987353094697, 0.00015887790304511872, 0.00015845133172229424, 0.00015807170936015126, 0.00015757516736524457, 0.00015716747961696888, 0.00015873713131174533, 0.0001583561399111406, 0.00015785781241618927, 0.00015744866244577516, 0.00015072105088536491, -9.999840575265246, -9.999840961577094, 0.0001585375789389325, 0.00015812490160399087, 0.00015136654759453404, 0.6605737641524854, 0.00015866211282826066, 0.00015816186103651043, -9.999842248825033, 0.14830002213873347, 0.0001596791781681842, 0.00015929365676539301, 0.00015878942143956605, 0.00015837543343821817, 0.00015160568602413403, 0.00015931173241237742, 0.15574131922307927, 0.00015851722349919991, 0.00015801788339277827, 1.8672167299226126, 0.00015980347416081071, 0.00015937192459458972, 0.0001589878836108541, 0.0001584855789494322, 0.00015807317198029803, 0.00015972763143838774, 0.000159268744004028, -9.999841159119581, -9.999841541370856, 0.14339729046229754, 0.12393329034449779, 1.4869659384361682, 0.0001554000300419378, -9.999844942536184, 0.0001564445568032141, 0.0001559956961434206, 0.00015563178847414385, 0.0001552868853475604, 0.00015503237265472957, 0.00015711218045047875, 0.00015665948560493703, 0.0001562924782313585, -9.999844055317514, 0.00015568797198967918, 0.00015675950173926672, -19.99984369159586, -9.99984405649511, -9.999844402779715, 0.00015534165153335226, 0.00015735951114393643, -9.911292901649606, 0.00015655966819709183, 0.00015621064448051322, 0.0001559530972454923, -9.999849125531316, 0.00015660319471447315, 0.00015615342446481317, 0.00015578878143774618, 0.00015544318284255583, 0.1772579399475378, 0.0001570730290473659, -9.999843379401282, 0.6495640731669861, 0.00015591076892771432, 0.0001579596175162882, -8.685917976700592, 0.05645212725232552, 0.1398092651218104, 0.000156150337429622], "episode_lengths": [25, 24, 25, 25, 26, 27, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 26, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.0190053008402, "mean_inference_ms": 2.1105260540869306, "mean_action_processing_ms": 0.14434381840620705, "mean_env_wait_ms": 1.2069372129312086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009809017181396484, "StateBufferConnector_ms": 0.0065631866455078125, "ViewRequirementAgentConnector_ms": 0.17719745635986328}}, "episode_reward_max": 1.8672167299226126, "episode_reward_min": -19.99984369159586, "episode_reward_mean": -1.70573701833917, "episode_len_mean": 25.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0001594706700834278, 0.00015542135134804776, 0.0001614948677900372, 0.00016104347483306367, -9.999839465028241, -19.89161063226805, 0.11715127833164518, 1.77127748700904, 0.0001607204627493122, 0.00016027338241368506, 0.00015977086794074146, 0.245217406286739, 0.00015513582472710718, 0.10690775919981174, 0.00016077108792031787, 0.00016026545240440234, 0.05259799949803048, 0.00016144914124744064, 0.00015463201222785385, 0.000160676710830476, 0.00016022987353094697, 0.00015887790304511872, 0.00015845133172229424, 0.00015807170936015126, 0.00015757516736524457, 0.00015716747961696888, 0.00015873713131174533, 0.0001583561399111406, 0.00015785781241618927, 0.00015744866244577516, 0.00015072105088536491, -9.999840575265246, -9.999840961577094, 0.0001585375789389325, 0.00015812490160399087, 0.00015136654759453404, 0.6605737641524854, 0.00015866211282826066, 0.00015816186103651043, -9.999842248825033, 0.14830002213873347, 0.0001596791781681842, 0.00015929365676539301, 0.00015878942143956605, 0.00015837543343821817, 0.00015160568602413403, 0.00015931173241237742, 0.15574131922307927, 0.00015851722349919991, 0.00015801788339277827, 1.8672167299226126, 0.00015980347416081071, 0.00015937192459458972, 0.0001589878836108541, 0.0001584855789494322, 0.00015807317198029803, 0.00015972763143838774, 0.000159268744004028, -9.999841159119581, -9.999841541370856, 0.14339729046229754, 0.12393329034449779, 1.4869659384361682, 0.0001554000300419378, -9.999844942536184, 0.0001564445568032141, 0.0001559956961434206, 0.00015563178847414385, 0.0001552868853475604, 0.00015503237265472957, 0.00015711218045047875, 0.00015665948560493703, 0.0001562924782313585, -9.999844055317514, 0.00015568797198967918, 0.00015675950173926672, -19.99984369159586, -9.99984405649511, -9.999844402779715, 0.00015534165153335226, 0.00015735951114393643, -9.911292901649606, 0.00015655966819709183, 0.00015621064448051322, 0.0001559530972454923, -9.999849125531316, 0.00015660319471447315, 0.00015615342446481317, 0.00015578878143774618, 0.00015544318284255583, 0.1772579399475378, 0.0001570730290473659, -9.999843379401282, 0.6495640731669861, 0.00015591076892771432, 0.0001579596175162882, -8.685917976700592, 0.05645212725232552, 0.1398092651218104, 0.000156150337429622], "episode_lengths": [25, 24, 25, 25, 26, 27, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 26, 26, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.0190053008402, "mean_inference_ms": 2.1105260540869306, "mean_action_processing_ms": 0.14434381840620705, "mean_env_wait_ms": 1.2069372129312086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009809017181396484, "StateBufferConnector_ms": 0.0065631866455078125, "ViewRequirementAgentConnector_ms": 0.17719745635986328}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 152100, "num_env_steps_sampled": 79000, "num_env_steps_trained": 152100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5796559254187392, "num_env_steps_trained_throughput_per_sec": 6.980329054566542, "timesteps_total": 79000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 79000, "timers": {"training_iteration_time_ms": 11115.005, "sample_time_ms": 11050.677, "load_time_ms": 0.23, "load_throughput": 338740.642, "learn_time_ms": 13.075, "learn_throughput": 5965.521, "synch_weights_time_ms": 11.945}, "counters": {"num_env_steps_sampled": 79000, "num_env_steps_trained": 152100, "num_agent_steps_sampled": 79000, "num_agent_steps_trained": 152100, "last_target_update_ts": 78520, "num_target_updates": 150}, "done": false, "episodes_total": 3082, "training_iteration": 79, "trial_id": "2058a_00000", "date": "2024-04-17_10-18-46", "timestamp": 1713349126, "time_this_iter_s": 279.36517214775085, "time_total_s": 17898.583230018616, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 17898.583230018616, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 10.744472361809043, "ram_util_percent": 21.3643216080402}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.037066955119371414, "cur_lr": 0.01}, "td_error": [0.8122630715370178, 1.1387486457824707, 0.8122631311416626, 1.1387488842010498, 1.1387488842010498, 1.1387487649917603, 1.1387490034103394, 1.1387492418289185, 1.1387488842010498, 1.1387487649917603, 1.1387488842010498, 1.1387488842010498, 1.1387487649917603, 0.8122625946998596, 0.8122631907463074, 1.1387490034103394, 0.812263011932373, 1.1387487649917603, 0.812263011932373, 0.8122631907463074, 1.1387490034103394, 1.1387485265731812, 1.1387487649917603, 1.1387484073638916, 1.1387488842010498, 1.1387490034103394, 0.812263011932373, 0.812262773513794, 1.1387490034103394, 1.1387488842010498, 1.1387490034103394, 1.1387484073638916, 0.8122628331184387, 0.8122626543045044, 0.8122630715370178, 1.1387490034103394, 1.1387487649917603, 1.1387481689453125, 1.1387488842010498, 1.138749122619629, 1.1387485265731812, 1.138749122619629, 1.138749122619629, 1.1387487649917603, 0.8122628927230835, 1.1387488842010498, 1.138749122619629, 0.8122630715370178, 1.1387488842010498, 1.1387487649917603, 1.1387488842010498, 1.1387490034103394, 1.1387488842010498, 1.1387490034103394, 1.138749122619629, 1.138749122619629, 1.1387490034103394, 1.1387490034103394, 1.1387486457824707, 1.0923566818237305, 1.138749122619629, 1.1387490034103394, 1.1387490034103394, 1.1387488842010498, 1.1387488842010498, 1.1387488842010498, 1.138749122619629, 1.1387488842010498, 1.1387486457824707, 0.812262237071991, 1.1387485265731812, 1.1387488842010498, 1.1387490034103394, 1.1387490034103394, 1.138749122619629, 1.1387490034103394, 1.1387486457824707, 1.1387488842010498], "mean_td_error": 1.0753684043884277, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 1975.0, "diff_num_grad_updates_vs_sampler_policy": 1974.0}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 154050, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 154050, "last_target_update_ts": 79560, "num_target_updates": 152}, "sampler_results": {"episode_reward_max": 1.8672167299226126, "episode_reward_min": -19.999846251094826, "episode_reward_mean": -1.8860720093030696, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.14830002213873347, 0.0001596791781681842, 0.00015929365676539301, 0.00015878942143956605, 0.00015837543343821817, 0.00015160568602413403, 0.00015931173241237742, 0.15574131922307927, 0.00015851722349919991, 0.00015801788339277827, 1.8672167299226126, 0.00015980347416081071, 0.00015937192459458972, 0.0001589878836108541, 0.0001584855789494322, 0.00015807317198029803, 0.00015972763143838774, 0.000159268744004028, -9.999841159119581, -9.999841541370856, 0.14339729046229754, 0.12393329034449779, 1.4869659384361682, 0.0001554000300419378, -9.999844942536184, 0.0001564445568032141, 0.0001559956961434206, 0.00015563178847414385, 0.0001552868853475604, 0.00015503237265472957, 0.00015711218045047875, 0.00015665948560493703, 0.0001562924782313585, -9.999844055317514, 0.00015568797198967918, 0.00015675950173926672, -19.99984369159586, -9.99984405649511, -9.999844402779715, 0.00015534165153335226, 0.00015735951114393643, -9.911292901649606, 0.00015655966819709183, 0.00015621064448051322, 0.0001559530972454923, -9.999849125531316, 0.00015660319471447315, 0.00015615342446481317, 0.00015578878143774618, 0.00015544318284255583, 0.1772579399475378, 0.0001570730290473659, -9.999843379401282, 0.6495640731669861, 0.00015591076892771432, 0.0001579596175162882, -8.685917976700592, 0.05645212725232552, 0.1398092651218104, 0.000156150337429622, 0.0001548023947737626, 0.00015438402188599492, 0.00015394098955603052, 0.00015352264114706386, 0.00015315424211996955, 0.00015461275753168033, -9.999845831548667, -19.999846251094826, 0.00015337934559698222, 0.00015295688524764338, 0.00015526480554073474, 0.03853765913734776, 0.9565580505272663, 0.00015406388307364878, 0.6402842145565291, 0.11623570122963058, -9.999845501613855, -9.999845922993252, 0.00015370590806291695, 0.00015328164912828266, 0.0001555284903982286, 0.00015507887470707333, -9.185132077710694, 0.00015428433620677014, 0.0001538568821506969, 0.00015518815797543715, 0.5211900886873639, 0.00015432735612859087, 0.00015390690792368547, 0.00015353666479373044, -9.999844346000232, 0.44243318713285645, 0.00015484330010668939, 0.0001544200397138095, 0.000154047326895494, 0.00015578570880197168, 0.0001554401238250643, -8.501203183427446, 0.0001547661720861527, 0.00015432094688598954], "episode_lengths": [24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.13847462830165, "mean_inference_ms": 2.1103543891273757, "mean_action_processing_ms": 0.14433822413225786, "mean_env_wait_ms": 1.1930962326043453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009620428085327148, "StateBufferConnector_ms": 0.006368875503540039, "ViewRequirementAgentConnector_ms": 0.17703032493591309}}, "episode_reward_max": 1.8672167299226126, "episode_reward_min": -19.999846251094826, "episode_reward_mean": -1.8860720093030696, "episode_len_mean": 25.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.14830002213873347, 0.0001596791781681842, 0.00015929365676539301, 0.00015878942143956605, 0.00015837543343821817, 0.00015160568602413403, 0.00015931173241237742, 0.15574131922307927, 0.00015851722349919991, 0.00015801788339277827, 1.8672167299226126, 0.00015980347416081071, 0.00015937192459458972, 0.0001589878836108541, 0.0001584855789494322, 0.00015807317198029803, 0.00015972763143838774, 0.000159268744004028, -9.999841159119581, -9.999841541370856, 0.14339729046229754, 0.12393329034449779, 1.4869659384361682, 0.0001554000300419378, -9.999844942536184, 0.0001564445568032141, 0.0001559956961434206, 0.00015563178847414385, 0.0001552868853475604, 0.00015503237265472957, 0.00015711218045047875, 0.00015665948560493703, 0.0001562924782313585, -9.999844055317514, 0.00015568797198967918, 0.00015675950173926672, -19.99984369159586, -9.99984405649511, -9.999844402779715, 0.00015534165153335226, 0.00015735951114393643, -9.911292901649606, 0.00015655966819709183, 0.00015621064448051322, 0.0001559530972454923, -9.999849125531316, 0.00015660319471447315, 0.00015615342446481317, 0.00015578878143774618, 0.00015544318284255583, 0.1772579399475378, 0.0001570730290473659, -9.999843379401282, 0.6495640731669861, 0.00015591076892771432, 0.0001579596175162882, -8.685917976700592, 0.05645212725232552, 0.1398092651218104, 0.000156150337429622, 0.0001548023947737626, 0.00015438402188599492, 0.00015394098955603052, 0.00015352264114706386, 0.00015315424211996955, 0.00015461275753168033, -9.999845831548667, -19.999846251094826, 0.00015337934559698222, 0.00015295688524764338, 0.00015526480554073474, 0.03853765913734776, 0.9565580505272663, 0.00015406388307364878, 0.6402842145565291, 0.11623570122963058, -9.999845501613855, -9.999845922993252, 0.00015370590806291695, 0.00015328164912828266, 0.0001555284903982286, 0.00015507887470707333, -9.185132077710694, 0.00015428433620677014, 0.0001538568821506969, 0.00015518815797543715, 0.5211900886873639, 0.00015432735612859087, 0.00015390690792368547, 0.00015353666479373044, -9.999844346000232, 0.44243318713285645, 0.00015484330010668939, 0.0001544200397138095, 0.000154047326895494, 0.00015578570880197168, 0.0001554401238250643, -8.501203183427446, 0.0001547661720861527, 0.00015432094688598954], "episode_lengths": [24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 26, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.13847462830165, "mean_inference_ms": 2.1103543891273757, "mean_action_processing_ms": 0.14433822413225786, "mean_env_wait_ms": 1.1930962326043453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009620428085327148, "StateBufferConnector_ms": 0.006368875503540039, "ViewRequirementAgentConnector_ms": 0.17703032493591309}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 154050, "num_env_steps_sampled": 80000, "num_env_steps_trained": 154050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.570387891804113, "num_env_steps_trained_throughput_per_sec": 6.9622563890180205, "timesteps_total": 80000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 11258.835, "sample_time_ms": 11195.724, "load_time_ms": 0.238, "load_throughput": 327352.123, "learn_time_ms": 13.01, "learn_throughput": 5995.267, "synch_weights_time_ms": 11.214}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 154050, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 154050, "last_target_update_ts": 79560, "num_target_updates": 152}, "done": false, "episodes_total": 3122, "training_iteration": 80, "trial_id": "2058a_00000", "date": "2024-04-17_10-23-26", "timestamp": 1713349406, "time_this_iter_s": 280.09077620506287, "time_total_s": 18178.67400622368, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 18178.67400622368, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 10.84396984924623, "ram_util_percent": 21.495979899497488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.027530580759048462, "cur_lr": 0.01}, "td_error": [1.1190719604492188, 1.1190714836120605, 1.1190721988677979, 0.8065178394317627, 1.1190719604492188, 1.1190720796585083, 1.119072675704956, 1.1190717220306396, 1.1190714836120605, 1.1190727949142456, 1.1190706491470337, 1.1190717220306396, 0.8065174221992493, 1.1190721988677979, 0.8065174221992493, 1.1190718412399292, 1.1190725564956665, 1.1190721988677979, 1.11907160282135, 0.8065164685249329, 1.1190721988677979, 1.1190714836120605, 1.1190721988677979, 1.1190719604492188, 1.11907160282135, 1.119072437286377, 1.119072437286377, 1.1190727949142456, 1.1190727949142456, 0.8065177798271179, 1.1190699338912964, 1.1190712451934814, 1.1190719604492188, 1.1190695762634277, 1.1190720796585083, 1.1190719604492188, 1.1190725564956665, 0.8065168261528015, 1.119072437286377, 1.11907160282135, 1.1190725564956665, 1.1190714836120605, 1.119072675704956, 1.119072437286377, 1.1190723180770874, 1.1190712451934814, 1.119071125984192, 1.119072675704956, 1.1190717220306396, 1.1190723180770874, 1.1190721988677979, 1.1190698146820068, 1.6155402660369873, 1.1190721988677979, 1.119072437286377, 1.11907160282135, 1.119072437286377, 3.515669107437134, 1.1190705299377441, 1.1190721988677979, 1.119072437286377, 1.119072437286377, 1.1190708875656128, 1.11907160282135, 1.1190720796585083, 1.1190714836120605, 1.1190717220306396, 1.1190720796585083, 1.1190714836120605, 1.1190720796585083, 1.1190727949142456, 1.119071125984192, 1.1190725564956665, 1.1190712451934814, 3.595149040222168, 3.515669345855713, 1.1190721988677979, 1.1190725564956665], "mean_td_error": 1.1945902109146118, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2000.0, "diff_num_grad_updates_vs_sampler_policy": 1999.0}}, "num_env_steps_sampled": 81000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 156000, "last_target_update_ts": 80600, "num_target_updates": 154}, "sampler_results": {"episode_reward_max": 2.9225089088118157, "episode_reward_min": -19.999846251094826, "episode_reward_mean": -1.383309903952242, "episode_len_mean": 25.12, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00015534165153335226, 0.00015735951114393643, -9.911292901649606, 0.00015655966819709183, 0.00015621064448051322, 0.0001559530972454923, -9.999849125531316, 0.00015660319471447315, 0.00015615342446481317, 0.00015578878143774618, 0.00015544318284255583, 0.1772579399475378, 0.0001570730290473659, -9.999843379401282, 0.6495640731669861, 0.00015591076892771432, 0.0001579596175162882, -8.685917976700592, 0.05645212725232552, 0.1398092651218104, 0.000156150337429622, 0.0001548023947737626, 0.00015438402188599492, 0.00015394098955603052, 0.00015352264114706386, 0.00015315424211996955, 0.00015461275753168033, -9.999845831548667, -19.999846251094826, 0.00015337934559698222, 0.00015295688524764338, 0.00015526480554073474, 0.03853765913734776, 0.9565580505272663, 0.00015406388307364878, 0.6402842145565291, 0.11623570122963058, -9.999845501613855, -9.999845922993252, 0.00015370590806291695, 0.00015328164912828266, 0.0001555284903982286, 0.00015507887470707333, -9.185132077710694, 0.00015428433620677014, 0.0001538568821506969, 0.00015518815797543715, 0.5211900886873639, 0.00015432735612859087, 0.00015390690792368547, 0.00015353666479373044, -9.999844346000232, 0.44243318713285645, 0.00015484330010668939, 0.0001544200397138095, 0.000154047326895494, 0.00015578570880197168, 0.0001554401238250643, -8.501203183427446, 0.0001547661720861527, 0.00015432094688598954, 0.00015273301933847543, 0.00015239030514068369, 0.0001519704716212529, 0.08615234348371385, 0.00015107803078474427, 0.00015261316689353798, -9.99984780785681, 0.00015175136903449723, 0.00015126428739152808, 0.00015329393225081247, 0.1383199649142404, 0.00015243904280128428, -9.949843433918465, 0.0001515408278210802, 0.00015293647143259975, 0.0001525136272900954, 0.11211393943398627, 0.00015160104638787665, 0.0001511522949821352, 0.00015350911205028916, 0.0001530830998317382, 0.00015263719453601198, 0.0001521444199724751, 2.9225089088118157, 0.6047738787723753, 0.0001527738784195518, -9.890401925650874, 0.00015192788576790217, 0.07687411260389175, 0.00015362118347728978, 0.0001532744767708613, 0.00015284976407405374, 0.00015240521512699097, 0.0001519139346071726, 0.00015390053355631407, 0.0001535303210545128, 0.10188287365359619, 0.00015280345835862354, 0.00015238134840987494], "episode_lengths": [25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.21309248298525, "mean_inference_ms": 2.108464528521421, "mean_action_processing_ms": 0.14426909098347676, "mean_env_wait_ms": 1.1798237679660435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01004934310913086, "StateBufferConnector_ms": 0.006484031677246094, "ViewRequirementAgentConnector_ms": 0.17695164680480957}}, "episode_reward_max": 2.9225089088118157, "episode_reward_min": -19.999846251094826, "episode_reward_mean": -1.383309903952242, "episode_len_mean": 25.12, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00015534165153335226, 0.00015735951114393643, -9.911292901649606, 0.00015655966819709183, 0.00015621064448051322, 0.0001559530972454923, -9.999849125531316, 0.00015660319471447315, 0.00015615342446481317, 0.00015578878143774618, 0.00015544318284255583, 0.1772579399475378, 0.0001570730290473659, -9.999843379401282, 0.6495640731669861, 0.00015591076892771432, 0.0001579596175162882, -8.685917976700592, 0.05645212725232552, 0.1398092651218104, 0.000156150337429622, 0.0001548023947737626, 0.00015438402188599492, 0.00015394098955603052, 0.00015352264114706386, 0.00015315424211996955, 0.00015461275753168033, -9.999845831548667, -19.999846251094826, 0.00015337934559698222, 0.00015295688524764338, 0.00015526480554073474, 0.03853765913734776, 0.9565580505272663, 0.00015406388307364878, 0.6402842145565291, 0.11623570122963058, -9.999845501613855, -9.999845922993252, 0.00015370590806291695, 0.00015328164912828266, 0.0001555284903982286, 0.00015507887470707333, -9.185132077710694, 0.00015428433620677014, 0.0001538568821506969, 0.00015518815797543715, 0.5211900886873639, 0.00015432735612859087, 0.00015390690792368547, 0.00015353666479373044, -9.999844346000232, 0.44243318713285645, 0.00015484330010668939, 0.0001544200397138095, 0.000154047326895494, 0.00015578570880197168, 0.0001554401238250643, -8.501203183427446, 0.0001547661720861527, 0.00015432094688598954, 0.00015273301933847543, 0.00015239030514068369, 0.0001519704716212529, 0.08615234348371385, 0.00015107803078474427, 0.00015261316689353798, -9.99984780785681, 0.00015175136903449723, 0.00015126428739152808, 0.00015329393225081247, 0.1383199649142404, 0.00015243904280128428, -9.949843433918465, 0.0001515408278210802, 0.00015293647143259975, 0.0001525136272900954, 0.11211393943398627, 0.00015160104638787665, 0.0001511522949821352, 0.00015350911205028916, 0.0001530830998317382, 0.00015263719453601198, 0.0001521444199724751, 2.9225089088118157, 0.6047738787723753, 0.0001527738784195518, -9.890401925650874, 0.00015192788576790217, 0.07687411260389175, 0.00015362118347728978, 0.0001532744767708613, 0.00015284976407405374, 0.00015240521512699097, 0.0001519139346071726, 0.00015390053355631407, 0.0001535303210545128, 0.10188287365359619, 0.00015280345835862354, 0.00015238134840987494], "episode_lengths": [25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 26, 24, 25, 25, 25, 25, 25, 25, 25, 25, 26, 27, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.21309248298525, "mean_inference_ms": 2.108464528521421, "mean_action_processing_ms": 0.14426909098347676, "mean_env_wait_ms": 1.1798237679660435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01004934310913086, "StateBufferConnector_ms": 0.006484031677246094, "ViewRequirementAgentConnector_ms": 0.17695164680480957}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 81000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.584956537035427, "num_env_steps_trained_throughput_per_sec": 6.9906652472190824, "timesteps_total": 81000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 81000, "timers": {"training_iteration_time_ms": 11068.796, "sample_time_ms": 11005.972, "load_time_ms": 0.222, "load_throughput": 351931.704, "learn_time_ms": 12.72, "learn_throughput": 6131.92, "synch_weights_time_ms": 12.175}, "counters": {"num_env_steps_sampled": 81000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 81000, "num_agent_steps_trained": 156000, "last_target_update_ts": 80600, "num_target_updates": 154}, "done": false, "episodes_total": 3161, "training_iteration": 81, "trial_id": "2058a_00000", "date": "2024-04-17_10-28-05", "timestamp": 1713349685, "time_this_iter_s": 278.95322251319885, "time_total_s": 18457.627228736877, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 18457.627228736877, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 10.571284634760708, "ram_util_percent": 21.57632241813602}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04466988518834114, "cur_lr": 0.01}, "td_error": [1.130361795425415, 1.130364179611206, 1.1303625106811523, 1.1303619146347046, 1.130361795425415, 1.1303622722625732, 0.809350311756134, 1.1303622722625732, 1.1303623914718628, 1.130362629890442, 1.1303619146347046, 1.130362868309021, 1.1303619146347046, 1.130361795425415, 1.130362629890442, 1.130361795425415, 1.1303622722625732, 1.1303616762161255, 1.1303623914718628, 1.130361795425415, 1.1303620338439941, 1.1303620338439941, 1.1303623914718628, 1.1303625106811523, 1.130361795425415, 3.4550716876983643, 1.1303620338439941, 1.130362868309021, 1.1303627490997314, 1.130361795425415, 3.4531657695770264, 1.1303621530532837, 1.1303631067276, 1.130362629890442, 0.8093500137329102, 1.130361795425415, 1.1303622722625732, 1.1303623914718628, 1.1303647756576538, 1.1303623914718628, 1.1303623914718628, 1.1303625106811523, 0.8093500137329102, 1.1303619146347046, 1.1303625106811523, 1.1303632259368896, 1.1303625106811523, 1.1303623914718628, 1.1303619146347046, 1.130361795425415, 1.1303622722625732, 0.8093498349189758, 1.1303632259368896, 1.1303651332855225, 1.1303619146347046, 0.8093500137329102, 1.1303623914718628, 0.8093496561050415, 1.1303631067276, 0.8093499541282654, 1.1303622722625732, 1.1303623914718628, 1.1303622722625732, 1.130362868309021, 0.8093501925468445, 1.1303621530532837, 1.1303623914718628, 1.1303625106811523, 1.1900913715362549, 0.8093501329421997, 1.1911287307739258, 1.1303619146347046, 1.1303637027740479, 1.1303623914718628, 1.1303621530532837, 0.8093500137329102, 1.1303631067276, 1.1303623914718628], "mean_td_error": 1.1503353118896484, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2025.0, "diff_num_grad_updates_vs_sampler_policy": 2024.0}}, "num_env_steps_sampled": 82000, "num_env_steps_trained": 157950, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 157950, "last_target_update_ts": 81640, "num_target_updates": 156}, "sampler_results": {"episode_reward_max": 2.9225089088118157, "episode_reward_min": -9.999850580138462, "episode_reward_mean": -0.791561293549632, "episode_len_mean": 25.09, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00015328164912828266, 0.0001555284903982286, 0.00015507887470707333, -9.185132077710694, 0.00015428433620677014, 0.0001538568821506969, 0.00015518815797543715, 0.5211900886873639, 0.00015432735612859087, 0.00015390690792368547, 0.00015353666479373044, -9.999844346000232, 0.44243318713285645, 0.00015484330010668939, 0.0001544200397138095, 0.000154047326895494, 0.00015578570880197168, 0.0001554401238250643, -8.501203183427446, 0.0001547661720861527, 0.00015432094688598954, 0.00015273301933847543, 0.00015239030514068369, 0.0001519704716212529, 0.08615234348371385, 0.00015107803078474427, 0.00015261316689353798, -9.99984780785681, 0.00015175136903449723, 0.00015126428739152808, 0.00015329393225081247, 0.1383199649142404, 0.00015243904280128428, -9.949843433918465, 0.0001515408278210802, 0.00015293647143259975, 0.0001525136272900954, 0.11211393943398627, 0.00015160104638787665, 0.0001511522949821352, 0.00015350911205028916, 0.0001530830998317382, 0.00015263719453601198, 0.0001521444199724751, 2.9225089088118157, 0.6047738787723753, 0.0001527738784195518, -9.890401925650874, 0.00015192788576790217, 0.07687411260389175, 0.00015362118347728978, 0.0001532744767708613, 0.00015284976407405374, 0.00015240521512699097, 0.0001519139346071726, 0.00015390053355631407, 0.0001535303210545128, 0.10188287365359619, 0.00015280345835862354, 0.00015238134840987494, 0.0001506323665283381, 0.00015019877418151004, 0.04620142672993066, 0.00014928725062942556, 0.0001488682946696244, 0.00015081752495639162, 2.35854280105089, 0.00014984084286423591, -9.999850580138462, 0.00014899962663820376, 0.00015110199817472815, 0.0001505537459091276, 0.09635362316251662, 0.06508516455210846, 0.00014937259688289122, 0.0001507157090717683, 0.0001501702515055522, 0.0001497468788526568, 0.00014932534293447523, 0.00014893698532215583, 0.00015125379312521325, 0.00015070444071579137, 0.00015027805463941707, -9.303697518090008, 0.00014949226615922567, 0.00015102558420512563, 0.00015058972879648303, 0.00015004518112538419, 0.0001496225124692285, 0.0001492016754164138, 0.0001514633312676882, 0.08940708801365414, 0.00015050477148765762, 0.0001500795130159823, 0.00014965610505006778, 0.00015193951607984005, 0.00015145122803198052, 0.00015100336202959224, 0.00015056763467142376, -9.999849976717472], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.3176665254422, "mean_inference_ms": 2.1085945031912496, "mean_action_processing_ms": 0.14428843455665816, "mean_env_wait_ms": 1.166643277240858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010030269622802734, "StateBufferConnector_ms": 0.006373882293701172, "ViewRequirementAgentConnector_ms": 0.17821240425109863}}, "episode_reward_max": 2.9225089088118157, "episode_reward_min": -9.999850580138462, "episode_reward_mean": -0.791561293549632, "episode_len_mean": 25.09, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00015328164912828266, 0.0001555284903982286, 0.00015507887470707333, -9.185132077710694, 0.00015428433620677014, 0.0001538568821506969, 0.00015518815797543715, 0.5211900886873639, 0.00015432735612859087, 0.00015390690792368547, 0.00015353666479373044, -9.999844346000232, 0.44243318713285645, 0.00015484330010668939, 0.0001544200397138095, 0.000154047326895494, 0.00015578570880197168, 0.0001554401238250643, -8.501203183427446, 0.0001547661720861527, 0.00015432094688598954, 0.00015273301933847543, 0.00015239030514068369, 0.0001519704716212529, 0.08615234348371385, 0.00015107803078474427, 0.00015261316689353798, -9.99984780785681, 0.00015175136903449723, 0.00015126428739152808, 0.00015329393225081247, 0.1383199649142404, 0.00015243904280128428, -9.949843433918465, 0.0001515408278210802, 0.00015293647143259975, 0.0001525136272900954, 0.11211393943398627, 0.00015160104638787665, 0.0001511522949821352, 0.00015350911205028916, 0.0001530830998317382, 0.00015263719453601198, 0.0001521444199724751, 2.9225089088118157, 0.6047738787723753, 0.0001527738784195518, -9.890401925650874, 0.00015192788576790217, 0.07687411260389175, 0.00015362118347728978, 0.0001532744767708613, 0.00015284976407405374, 0.00015240521512699097, 0.0001519139346071726, 0.00015390053355631407, 0.0001535303210545128, 0.10188287365359619, 0.00015280345835862354, 0.00015238134840987494, 0.0001506323665283381, 0.00015019877418151004, 0.04620142672993066, 0.00014928725062942556, 0.0001488682946696244, 0.00015081752495639162, 2.35854280105089, 0.00014984084286423591, -9.999850580138462, 0.00014899962663820376, 0.00015110199817472815, 0.0001505537459091276, 0.09635362316251662, 0.06508516455210846, 0.00014937259688289122, 0.0001507157090717683, 0.0001501702515055522, 0.0001497468788526568, 0.00014932534293447523, 0.00014893698532215583, 0.00015125379312521325, 0.00015070444071579137, 0.00015027805463941707, -9.303697518090008, 0.00014949226615922567, 0.00015102558420512563, 0.00015058972879648303, 0.00015004518112538419, 0.0001496225124692285, 0.0001492016754164138, 0.0001514633312676882, 0.08940708801365414, 0.00015050477148765762, 0.0001500795130159823, 0.00014965610505006778, 0.00015193951607984005, 0.00015145122803198052, 0.00015100336202959224, 0.00015056763467142376, -9.999849976717472], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.3176665254422, "mean_inference_ms": 2.1085945031912496, "mean_action_processing_ms": 0.14428843455665816, "mean_env_wait_ms": 1.166643277240858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010030269622802734, "StateBufferConnector_ms": 0.006373882293701172, "ViewRequirementAgentConnector_ms": 0.17821240425109863}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 157950, "num_env_steps_sampled": 82000, "num_env_steps_trained": 157950, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.602443115619674, "num_env_steps_trained_throughput_per_sec": 7.024764075458364, "timesteps_total": 82000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 82000, "timers": {"training_iteration_time_ms": 11150.897, "sample_time_ms": 11087.65, "load_time_ms": 0.232, "load_throughput": 336891.888, "learn_time_ms": 12.877, "learn_throughput": 6057.216, "synch_weights_time_ms": 11.893}, "counters": {"num_env_steps_sampled": 82000, "num_env_steps_trained": 157950, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 157950, "last_target_update_ts": 81640, "num_target_updates": 156}, "done": false, "episodes_total": 3201, "training_iteration": 82, "trial_id": "2058a_00000", "date": "2024-04-17_10-32-43", "timestamp": 1713349963, "time_this_iter_s": 277.59926533699036, "time_total_s": 18735.226494073868, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 18735.226494073868, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 10.918227848101267, "ram_util_percent": 21.69569620253164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01015455275774002, "cur_lr": 0.01}, "td_error": [1.1372990608215332, 1.1372991800308228, 1.1372992992401123, 1.1372989416122437, 1.137298583984375, 0.8022950291633606, 1.1372989416122437, 0.8022950887680054, 1.1372989416122437, 1.137299656867981, 1.1372989416122437, 1.1372987031936646, 0.8022950887680054, 1.137298822402954, 0.8022950887680054, 1.1372989416122437, 1.1372987031936646, 0.8022950887680054, 1.137298822402954, 1.1372987031936646, 1.1372990608215332, 1.1372994184494019, 1.1372987031936646, 1.137298822402954, 1.1372990608215332, 1.1372990608215332, 1.1372989416122437, 0.8022950887680054, 1.1372994184494019, 1.1372987031936646, 1.1372989416122437, 0.8022948503494263, 0.8022950887680054, 0.8022949695587158, 1.1372987031936646, 0.7722362279891968, 0.8022949695587158, 1.1372987031936646, 1.1372989416122437, 1.137298583984375, 0.8022950887680054, 1.1372990608215332, 0.8022950887680054, 1.137298822402954, 1.1372990608215332, 1.1372990608215332, 1.1372991800308228, 1.1372987031936646, 1.1372989416122437, 1.137298822402954, 1.1372989416122437, 1.1372987031936646, 1.1372989416122437, 1.1372995376586914, 0.8022950887680054, 1.1372989416122437, 1.1372991800308228, 1.137298822402954, 1.137298822402954, 1.1372987031936646, 1.1372989416122437, 1.1372989416122437, 1.1372992992401123, 1.1372987031936646, 1.1372990608215332, 1.1372990608215332, 1.1372992992401123, 1.137298822402954, 1.1372987031936646, 0.8022950887680054, 1.137298822402954, 3.4996886253356934, 1.1372987031936646, 0.8022950887680054, 1.1372990608215332, 1.1372987031936646, 1.1372992992401123, 1.1372989416122437], "mean_td_error": 1.0984817743301392, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2050.0, "diff_num_grad_updates_vs_sampler_policy": 2049.0}}, "num_env_steps_sampled": 83000, "num_env_steps_trained": 159900, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 159900, "last_target_update_ts": 82680, "num_target_updates": 158}, "sampler_results": {"episode_reward_max": 4.329569778890575, "episode_reward_min": -17.216654382777644, "episode_reward_mean": -1.1546486243659715, "episode_len_mean": 25.07, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0001511522949821352, 0.00015350911205028916, 0.0001530830998317382, 0.00015263719453601198, 0.0001521444199724751, 2.9225089088118157, 0.6047738787723753, 0.0001527738784195518, -9.890401925650874, 0.00015192788576790217, 0.07687411260389175, 0.00015362118347728978, 0.0001532744767708613, 0.00015284976407405374, 0.00015240521512699097, 0.0001519139346071726, 0.00015390053355631407, 0.0001535303210545128, 0.10188287365359619, 0.00015280345835862354, 0.00015238134840987494, 0.0001506323665283381, 0.00015019877418151004, 0.04620142672993066, 0.00014928725062942556, 0.0001488682946696244, 0.00015081752495639162, 2.35854280105089, 0.00014984084286423591, -9.999850580138462, 0.00014899962663820376, 0.00015110199817472815, 0.0001505537459091276, 0.09635362316251662, 0.06508516455210846, 0.00014937259688289122, 0.0001507157090717683, 0.0001501702515055522, 0.0001497468788526568, 0.00014932534293447523, 0.00014893698532215583, 0.00015125379312521325, 0.00015070444071579137, 0.00015027805463941707, -9.303697518090008, 0.00014949226615922567, 0.00015102558420512563, 0.00015058972879648303, 0.00015004518112538419, 0.0001496225124692285, 0.0001492016754164138, 0.0001514633312676882, 0.08940708801365414, 0.00015050477148765762, 0.0001500795130159823, 0.00014965610505006778, 0.00015193951607984005, 0.00015145122803198052, 0.00015100336202959224, 0.00015056763467142376, -9.999849976717472, -9.9998515173603, 0.24832592027134887, 0.0001477660152636882, 0.00014742463442551348, 0.00014112233231793666, 0.2707318660482246, 0.0001482663936488651, 0.00014789598985121778, 0.0001475540089415507, -9.999858752957373, -9.99985098501732, 4.329569778890575, -9.291405936728392, 0.0001419560534438696, 0.08411752981407514, 0.00014858010985767454, 0.0001482081386659573, -9.999852134695965, 2.635992716075542, 0.00014703202554161102, -9.316263072398733, 0.5480859254776177, -17.216654382777644, 0.0001420732074433613, 0.00014881395998596531, 0.00014845767306555333, 0.0001480863139874162, 0.0001477434534338631, 3.323607494870655, 0.00014926602724837034, -9.894830507456712, -9.9998514484122, 0.0001482065368911003, 1.3437512526535158, 0.00014960070124694731, 0.05068129380230822, 0.24066662019171695, 0.00014849465911803667, 0.00014812311518391566], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 26, 25, 26, 24, 25, 25, 25, 26, 24, 25, 26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.44122418930573, "mean_inference_ms": 2.109668504390616, "mean_action_processing_ms": 0.14433124204406414, "mean_env_wait_ms": 1.1541946024204717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010587692260742188, "StateBufferConnector_ms": 0.0075054168701171875, "ViewRequirementAgentConnector_ms": 0.18401336669921875}}, "episode_reward_max": 4.329569778890575, "episode_reward_min": -17.216654382777644, "episode_reward_mean": -1.1546486243659715, "episode_len_mean": 25.07, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0001511522949821352, 0.00015350911205028916, 0.0001530830998317382, 0.00015263719453601198, 0.0001521444199724751, 2.9225089088118157, 0.6047738787723753, 0.0001527738784195518, -9.890401925650874, 0.00015192788576790217, 0.07687411260389175, 0.00015362118347728978, 0.0001532744767708613, 0.00015284976407405374, 0.00015240521512699097, 0.0001519139346071726, 0.00015390053355631407, 0.0001535303210545128, 0.10188287365359619, 0.00015280345835862354, 0.00015238134840987494, 0.0001506323665283381, 0.00015019877418151004, 0.04620142672993066, 0.00014928725062942556, 0.0001488682946696244, 0.00015081752495639162, 2.35854280105089, 0.00014984084286423591, -9.999850580138462, 0.00014899962663820376, 0.00015110199817472815, 0.0001505537459091276, 0.09635362316251662, 0.06508516455210846, 0.00014937259688289122, 0.0001507157090717683, 0.0001501702515055522, 0.0001497468788526568, 0.00014932534293447523, 0.00014893698532215583, 0.00015125379312521325, 0.00015070444071579137, 0.00015027805463941707, -9.303697518090008, 0.00014949226615922567, 0.00015102558420512563, 0.00015058972879648303, 0.00015004518112538419, 0.0001496225124692285, 0.0001492016754164138, 0.0001514633312676882, 0.08940708801365414, 0.00015050477148765762, 0.0001500795130159823, 0.00014965610505006778, 0.00015193951607984005, 0.00015145122803198052, 0.00015100336202959224, 0.00015056763467142376, -9.999849976717472, -9.9998515173603, 0.24832592027134887, 0.0001477660152636882, 0.00014742463442551348, 0.00014112233231793666, 0.2707318660482246, 0.0001482663936488651, 0.00014789598985121778, 0.0001475540089415507, -9.999858752957373, -9.99985098501732, 4.329569778890575, -9.291405936728392, 0.0001419560534438696, 0.08411752981407514, 0.00014858010985767454, 0.0001482081386659573, -9.999852134695965, 2.635992716075542, 0.00014703202554161102, -9.316263072398733, 0.5480859254776177, -17.216654382777644, 0.0001420732074433613, 0.00014881395998596531, 0.00014845767306555333, 0.0001480863139874162, 0.0001477434534338631, 3.323607494870655, 0.00014926602724837034, -9.894830507456712, -9.9998514484122, 0.0001482065368911003, 1.3437512526535158, 0.00014960070124694731, 0.05068129380230822, 0.24066662019171695, 0.00014849465911803667, 0.00014812311518391566], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 26, 25, 26, 24, 25, 25, 25, 26, 24, 25, 26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.44122418930573, "mean_inference_ms": 2.109668504390616, "mean_action_processing_ms": 0.14433124204406414, "mean_env_wait_ms": 1.1541946024204717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010587692260742188, "StateBufferConnector_ms": 0.0075054168701171875, "ViewRequirementAgentConnector_ms": 0.18401336669921875}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 159900, "num_env_steps_sampled": 83000, "num_env_steps_trained": 159900, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.690659141814137, "num_env_steps_trained_throughput_per_sec": 9.146785326537566, "timesteps_total": 83000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 83000, "timers": {"training_iteration_time_ms": 7817.96, "sample_time_ms": 7751.809, "load_time_ms": 0.263, "load_throughput": 296739.875, "learn_time_ms": 13.828, "learn_throughput": 5640.771, "synch_weights_time_ms": 12.521}, "counters": {"num_env_steps_sampled": 83000, "num_env_steps_trained": 159900, "num_agent_steps_sampled": 83000, "num_agent_steps_trained": 159900, "last_target_update_ts": 82680, "num_target_updates": 158}, "done": false, "episodes_total": 3240, "training_iteration": 83, "trial_id": "2058a_00000", "date": "2024-04-17_10-36-16", "timestamp": 1713350176, "time_this_iter_s": 213.19769430160522, "time_total_s": 18948.424188375473, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 18948.424188375473, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 13.551815181518155, "ram_util_percent": 21.805280528052812}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04733756557106972, "cur_lr": 0.01}, "td_error": [1.1010500192642212, 1.1010504961013794, 1.1010496616363525, 1.1010496616363525, 1.1010504961013794, 1.101049780845642, 1.1010496616363525, 1.1010499000549316, 1.1010501384735107, 1.1010496616363525, 1.101049780845642, 1.1010496616363525, 1.1010512113571167, 1.1010501384735107, 0.7973588705062866, 3.5884945392608643, 0.7973588705062866, 0.7973589897155762, 1.1010500192642212, 1.1010500192642212, 1.1010496616363525, 0.7973587512969971, 1.1010500192642212, 1.1010501384735107, 1.1010500192642212, 1.101049780845642, 3.5916149616241455, 1.1010501384735107, 1.1010502576828003, 1.1010502576828003, 1.1010518074035645, 1.1010503768920898, 1.1010502576828003, 0.7973587512969971, 1.1010501384735107, 3.5900471210479736, 1.101049780845642, 1.1010496616363525, 1.1010499000549316, 1.1010499000549316, 1.1010500192642212, 1.101050615310669, 1.1010499000549316, 1.1010509729385376, 1.1010501384735107, 1.1010500192642212, 1.1010496616363525, 1.1010502576828003, 3.5916154384613037, 1.1010500192642212, 1.1010496616363525, 1.1010500192642212, 1.1010496616363525, 1.1010499000549316, 1.1010502576828003, 1.101050615310669, 1.1010501384735107, 1.1010496616363525, 1.1010503768920898, 1.1010501384735107, 1.1010496616363525, 1.101049780845642, 1.1010502576828003, 1.8104888200759888, 1.1021618843078613, 0.7767621278762817, 1.1010501384735107, 1.1010500192642212, 1.1010502576828003, 1.238017201423645, 0.7973591089248657, 0.7973589897155762, 0.7767670750617981, 1.1010501384735107, 1.1010496616363525, 1.1010496616363525, 1.1010513305664062, 1.101049780845642], "mean_td_error": 1.2040075063705444, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2075.0, "diff_num_grad_updates_vs_sampler_policy": 2074.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 161850, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 161850, "last_target_update_ts": 83720, "num_target_updates": 160}, "sampler_results": {"episode_reward_max": 4.329569778890575, "episode_reward_min": -19.9998530513283, "episode_reward_mean": -1.8384128156004467, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00014893698532215583, 0.00015125379312521325, 0.00015070444071579137, 0.00015027805463941707, -9.303697518090008, 0.00014949226615922567, 0.00015102558420512563, 0.00015058972879648303, 0.00015004518112538419, 0.0001496225124692285, 0.0001492016754164138, 0.0001514633312676882, 0.08940708801365414, 0.00015050477148765762, 0.0001500795130159823, 0.00014965610505006778, 0.00015193951607984005, 0.00015145122803198052, 0.00015100336202959224, 0.00015056763467142376, -9.999849976717472, -9.9998515173603, 0.24832592027134887, 0.0001477660152636882, 0.00014742463442551348, 0.00014112233231793666, 0.2707318660482246, 0.0001482663936488651, 0.00014789598985121778, 0.0001475540089415507, -9.999858752957373, -9.99985098501732, 4.329569778890575, -9.291405936728392, 0.0001419560534438696, 0.08411752981407514, 0.00014858010985767454, 0.0001482081386659573, -9.999852134695965, 2.635992716075542, 0.00014703202554161102, -9.316263072398733, 0.5480859254776177, -17.216654382777644, 0.0001420732074433613, 0.00014881395998596531, 0.00014845767306555333, 0.0001480863139874162, 0.0001477434534338631, 3.323607494870655, 0.00014926602724837034, -9.894830507456712, -9.9998514484122, 0.0001482065368911003, 1.3437512526535158, 0.00014960070124694731, 0.05068129380230822, 0.24066662019171695, 0.00014849465911803667, 0.00014812311518391566, -9.999853403967236, 0.00014617475584587295, 0.00014578064377176428, 0.10969840579514877, 0.0001392528546398085, -9.508563291479975, 0.00014630747719459897, 0.0001459126501505947, 0.00014549389225482494, 0.00013936458826601213, 0.00014705422079006378, 0.00014665535899498683, 3.247210692139147, 0.00014007093704999056, 0.00014557398030058227, 0.00014660827697650456, -9.999853788138719, 0.00014579135257411277, -9.999860351081658, 0.00014513634504832566, 3.094408681560824, 0.00014715498023683623, 0.00014675557245964554, 0.19841292120343415, 0.00014017515985363996, 0.6648354304925076, -9.99985350690725, -9.999853902735358, 0.10557414698294323, 0.00013955978409127616, 0.00014737063397728147, 0.00014694493418581053, 0.00014654666415774755, 0.000146124264167816, 0.00013996706007031034, 0.0001477800844118273, -9.999858538354932, -19.9998530513283, 0.09388454715154933, 0.0001461516214490606], "episode_lengths": [25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 26, 25, 26, 24, 25, 25, 25, 26, 24, 25, 26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.555229947412, "mean_inference_ms": 2.1098355357592298, "mean_action_processing_ms": 0.14434929097332477, "mean_env_wait_ms": 1.1416445191854292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01094508171081543, "StateBufferConnector_ms": 0.007780313491821289, "ViewRequirementAgentConnector_ms": 0.18466949462890625}}, "episode_reward_max": 4.329569778890575, "episode_reward_min": -19.9998530513283, "episode_reward_mean": -1.8384128156004467, "episode_len_mean": 25.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00014893698532215583, 0.00015125379312521325, 0.00015070444071579137, 0.00015027805463941707, -9.303697518090008, 0.00014949226615922567, 0.00015102558420512563, 0.00015058972879648303, 0.00015004518112538419, 0.0001496225124692285, 0.0001492016754164138, 0.0001514633312676882, 0.08940708801365414, 0.00015050477148765762, 0.0001500795130159823, 0.00014965610505006778, 0.00015193951607984005, 0.00015145122803198052, 0.00015100336202959224, 0.00015056763467142376, -9.999849976717472, -9.9998515173603, 0.24832592027134887, 0.0001477660152636882, 0.00014742463442551348, 0.00014112233231793666, 0.2707318660482246, 0.0001482663936488651, 0.00014789598985121778, 0.0001475540089415507, -9.999858752957373, -9.99985098501732, 4.329569778890575, -9.291405936728392, 0.0001419560534438696, 0.08411752981407514, 0.00014858010985767454, 0.0001482081386659573, -9.999852134695965, 2.635992716075542, 0.00014703202554161102, -9.316263072398733, 0.5480859254776177, -17.216654382777644, 0.0001420732074433613, 0.00014881395998596531, 0.00014845767306555333, 0.0001480863139874162, 0.0001477434534338631, 3.323607494870655, 0.00014926602724837034, -9.894830507456712, -9.9998514484122, 0.0001482065368911003, 1.3437512526535158, 0.00014960070124694731, 0.05068129380230822, 0.24066662019171695, 0.00014849465911803667, 0.00014812311518391566, -9.999853403967236, 0.00014617475584587295, 0.00014578064377176428, 0.10969840579514877, 0.0001392528546398085, -9.508563291479975, 0.00014630747719459897, 0.0001459126501505947, 0.00014549389225482494, 0.00013936458826601213, 0.00014705422079006378, 0.00014665535899498683, 3.247210692139147, 0.00014007093704999056, 0.00014557398030058227, 0.00014660827697650456, -9.999853788138719, 0.00014579135257411277, -9.999860351081658, 0.00014513634504832566, 3.094408681560824, 0.00014715498023683623, 0.00014675557245964554, 0.19841292120343415, 0.00014017515985363996, 0.6648354304925076, -9.99985350690725, -9.999853902735358, 0.10557414698294323, 0.00013955978409127616, 0.00014737063397728147, 0.00014694493418581053, 0.00014654666415774755, 0.000146124264167816, 0.00013996706007031034, 0.0001477800844118273, -9.999858538354932, -19.9998530513283, 0.09388454715154933, 0.0001461516214490606], "episode_lengths": [25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 24, 25, 25, 25, 25, 25, 26, 25, 26, 24, 25, 25, 25, 26, 24, 25, 26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.555229947412, "mean_inference_ms": 2.1098355357592298, "mean_action_processing_ms": 0.14434929097332477, "mean_env_wait_ms": 1.1416445191854292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01094508171081543, "StateBufferConnector_ms": 0.007780313491821289, "ViewRequirementAgentConnector_ms": 0.18466949462890625}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 161850, "num_env_steps_sampled": 84000, "num_env_steps_trained": 161850, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.419693966405578, "num_env_steps_trained_throughput_per_sec": 8.618403234490877, "timesteps_total": 84000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 9087.955, "sample_time_ms": 9023.074, "load_time_ms": 0.251, "load_throughput": 310306.091, "learn_time_ms": 13.517, "learn_throughput": 5770.593, "synch_weights_time_ms": 11.85}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 161850, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 161850, "last_target_update_ts": 83720, "num_target_updates": 160}, "done": false, "episodes_total": 3280, "training_iteration": 84, "trial_id": "2058a_00000", "date": "2024-04-17_10-40-02", "timestamp": 1713350402, "time_this_iter_s": 226.26750683784485, "time_total_s": 19174.691695213318, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 19174.691695213318, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 13.32834890965732, "ram_util_percent": 21.904672897196267}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04038721323013306, "cur_lr": 0.01}, "td_error": [0.8063380122184753, 1.1195321083068848, 1.1195317506790161, 1.119530200958252, 1.1195307970046997, 0.8063392639160156, 0.8063380122184753, 1.1195309162139893, 1.1195317506790161, 3.485867500305176, 1.1195276975631714, 1.1195321083068848, 1.119527816772461, 1.119529366493225, 0.8063392639160156, 1.1195311546325684, 1.119531512260437, 1.1195305585861206, 0.8063392043113708, 1.1195317506790161, 1.119531273841858, 1.1195305585861206, 1.1195313930511475, 1.1195309162139893, 1.1195317506790161, 1.1195309162139893, 1.1195321083068848, 1.1195305585861206, 1.1195311546325684, 0.8063387870788574, 1.1195316314697266, 1.1195317506790161, 1.1195321083068848, 0.8063376545906067, 1.1726726293563843, 1.1195299625396729, 1.1195305585861206, 1.1195311546325684, 1.119530200958252, 1.1195311546325684, 1.119531273841858, 0.8063386082649231, 1.119531512260437, 0.8063378930091858, 1.119531273841858, 1.1195307970046997, 1.1195307970046997, 1.1195294857025146, 1.1195299625396729, 1.1195310354232788, 1.119531512260437, 1.119531273841858, 0.8063389658927917, 1.1195319890975952, 1.1195321083068848, 1.119531512260437, 1.1195316314697266, 1.1195321083068848, 1.1195321083068848, 1.1195303201675415, 1.1195309162139893, 0.8063393831253052, 1.1195297241210938, 0.8063386678695679, 1.119531273841858, 1.1195322275161743, 0.8063395023345947, 1.1195305585861206, 1.1195316314697266, 1.1195318698883057, 0.8063366413116455, 0.8063393831253052, 1.1195319890975952, 1.1195305585861206, 0.8063386678695679, 1.1195305585861206, 1.1195311546325684, 0.8063395023345947], "mean_td_error": 1.0822901725769043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2100.0, "diff_num_grad_updates_vs_sampler_policy": 2099.0}}, "num_env_steps_sampled": 85000, "num_env_steps_trained": 163800, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 163800, "last_target_update_ts": 84760, "num_target_updates": 162}, "sampler_results": {"episode_reward_max": 8.767228484490865, "episode_reward_min": -19.9998530513283, "episode_reward_mean": -1.4210501869001297, "episode_len_mean": 25.02, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.316263072398733, 0.5480859254776177, -17.216654382777644, 0.0001420732074433613, 0.00014881395998596531, 0.00014845767306555333, 0.0001480863139874162, 0.0001477434534338631, 3.323607494870655, 0.00014926602724837034, -9.894830507456712, -9.9998514484122, 0.0001482065368911003, 1.3437512526535158, 0.00014960070124694731, 0.05068129380230822, 0.24066662019171695, 0.00014849465911803667, 0.00014812311518391566, -9.999853403967236, 0.00014617475584587295, 0.00014578064377176428, 0.10969840579514877, 0.0001392528546398085, -9.508563291479975, 0.00014630747719459897, 0.0001459126501505947, 0.00014549389225482494, 0.00013936458826601213, 0.00014705422079006378, 0.00014665535899498683, 3.247210692139147, 0.00014007093704999056, 0.00014557398030058227, 0.00014660827697650456, -9.999853788138719, 0.00014579135257411277, -9.999860351081658, 0.00014513634504832566, 3.094408681560824, 0.00014715498023683623, 0.00014675557245964554, 0.19841292120343415, 0.00014017515985363996, 0.6648354304925076, -9.99985350690725, -9.999853902735358, 0.10557414698294323, 0.00013955978409127616, 0.00014737063397728147, 0.00014694493418581053, 0.00014654666415774755, 0.000146124264167816, 0.00013996706007031034, 0.0001477800844118273, -9.999858538354932, -19.9998530513283, 0.09388454715154933, 0.0001461516214490606, 0.00014472568778846375, 0.11052054128383337, 0.00014397517834222577, 0.00014364750964052043, 0.00014320613005126584, 0.0001448415488419715, 8.767228484490865, 0.0001440723904972106, 0.00014374427972282516, 0.00014330230614585172, 0.1373395081590724, 0.00014481315014916972, 0.0001444816610047643, 0.00014403514820514026, 0.00013793278245459984, 0.5480820543958362, 0.0001443684909047287, 0.00014403903178090505, 0.00014359524652271147, 0.0001375125537629879, 0.00014568205021323679, 0.00014526157817372804, 0.000144903658622935, 0.000144571755514821, 0.00014412468652015605, 0.0001380183157213262, 0.00014504395416580233, 0.039537093468773946, 0.0001443146434962152, 0.00014398542978194895, 0.08922244210452712, 0.00014546626861166467, 0.00014504703934090668, 1.0273938728016452, -19.919851455918423, 0.00014395092005500143, -9.99985426900855, 0.00013959167386395766, 0.00014507702165514262, 0.00014466002956906314, 0.000144305065172669], "episode_lengths": [26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.68510083588876, "mean_inference_ms": 2.1094721004576407, "mean_action_processing_ms": 0.14434769148179147, "mean_env_wait_ms": 1.129060492536351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010860919952392578, "StateBufferConnector_ms": 0.0076673030853271484, "ViewRequirementAgentConnector_ms": 0.17873144149780273}}, "episode_reward_max": 8.767228484490865, "episode_reward_min": -19.9998530513283, "episode_reward_mean": -1.4210501869001297, "episode_len_mean": 25.02, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.316263072398733, 0.5480859254776177, -17.216654382777644, 0.0001420732074433613, 0.00014881395998596531, 0.00014845767306555333, 0.0001480863139874162, 0.0001477434534338631, 3.323607494870655, 0.00014926602724837034, -9.894830507456712, -9.9998514484122, 0.0001482065368911003, 1.3437512526535158, 0.00014960070124694731, 0.05068129380230822, 0.24066662019171695, 0.00014849465911803667, 0.00014812311518391566, -9.999853403967236, 0.00014617475584587295, 0.00014578064377176428, 0.10969840579514877, 0.0001392528546398085, -9.508563291479975, 0.00014630747719459897, 0.0001459126501505947, 0.00014549389225482494, 0.00013936458826601213, 0.00014705422079006378, 0.00014665535899498683, 3.247210692139147, 0.00014007093704999056, 0.00014557398030058227, 0.00014660827697650456, -9.999853788138719, 0.00014579135257411277, -9.999860351081658, 0.00014513634504832566, 3.094408681560824, 0.00014715498023683623, 0.00014675557245964554, 0.19841292120343415, 0.00014017515985363996, 0.6648354304925076, -9.99985350690725, -9.999853902735358, 0.10557414698294323, 0.00013955978409127616, 0.00014737063397728147, 0.00014694493418581053, 0.00014654666415774755, 0.000146124264167816, 0.00013996706007031034, 0.0001477800844118273, -9.999858538354932, -19.9998530513283, 0.09388454715154933, 0.0001461516214490606, 0.00014472568778846375, 0.11052054128383337, 0.00014397517834222577, 0.00014364750964052043, 0.00014320613005126584, 0.0001448415488419715, 8.767228484490865, 0.0001440723904972106, 0.00014374427972282516, 0.00014330230614585172, 0.1373395081590724, 0.00014481315014916972, 0.0001444816610047643, 0.00014403514820514026, 0.00013793278245459984, 0.5480820543958362, 0.0001443684909047287, 0.00014403903178090505, 0.00014359524652271147, 0.0001375125537629879, 0.00014568205021323679, 0.00014526157817372804, 0.000144903658622935, 0.000144571755514821, 0.00014412468652015605, 0.0001380183157213262, 0.00014504395416580233, 0.039537093468773946, 0.0001443146434962152, 0.00014398542978194895, 0.08922244210452712, 0.00014546626861166467, 0.00014504703934090668, 1.0273938728016452, -19.919851455918423, 0.00014395092005500143, -9.99985426900855, 0.00013959167386395766, 0.00014507702165514262, 0.00014466002956906314, 0.000144305065172669], "episode_lengths": [26, 25, 27, 24, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 25, 26, 25, 25, 25, 24, 26, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.68510083588876, "mean_inference_ms": 2.1094721004576407, "mean_action_processing_ms": 0.14434769148179147, "mean_env_wait_ms": 1.129060492536351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010860919952392578, "StateBufferConnector_ms": 0.0076673030853271484, "ViewRequirementAgentConnector_ms": 0.17873144149780273}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 163800, "num_env_steps_sampled": 85000, "num_env_steps_trained": 163800, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.26391476217343, "num_env_steps_trained_throughput_per_sec": 8.314633786238188, "timesteps_total": 85000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 85000, "timers": {"training_iteration_time_ms": 10023.201, "sample_time_ms": 9959.534, "load_time_ms": 0.241, "load_throughput": 323756.271, "learn_time_ms": 12.795, "learn_throughput": 6096.304, "synch_weights_time_ms": 11.267}, "counters": {"num_env_steps_sampled": 85000, "num_env_steps_trained": 163800, "num_agent_steps_sampled": 85000, "num_agent_steps_trained": 163800, "last_target_update_ts": 84760, "num_target_updates": 162}, "done": false, "episodes_total": 3321, "training_iteration": 85, "trial_id": "2058a_00000", "date": "2024-04-17_10-43-57", "timestamp": 1713350637, "time_this_iter_s": 234.53468561172485, "time_total_s": 19409.226380825043, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 19409.226380825043, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 13.02934131736527, "ram_util_percent": 22.00958083832335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.03588661924004555, "cur_lr": 0.01}, "td_error": [1.1130870580673218, 1.1130869388580322, 1.1130869388580322, 1.1130865812301636, 1.1130867004394531, 1.1130868196487427, 0.8028349876403809, 1.1130870580673218, 1.1130867004394531, 1.1130872964859009, 1.1130869388580322, 0.8028349876403809, 3.45450496673584, 1.1130868196487427, 1.1130868196487427, 1.1130870580673218, 1.1130867004394531, 2.4391932487487793, 1.1130867004394531, 1.1130870580673218, 1.1130869388580322, 1.1130868196487427, 1.1130865812301636, 0.8028349876403809, 1.1130867004394531, 1.1130872964859009, 1.1130868196487427, 1.1130868196487427, 0.7604696750640869, 1.1130871772766113, 1.1130867004394531, 1.1130865812301636, 1.1130868196487427, 1.1130865812301636, 1.1130867004394531, 0.8028351068496704, 1.1130868196487427, 0.8028350472450256, 1.1130868196487427, 0.8028349876403809, 1.1130865812301636, 1.1130869388580322, 1.1130867004394531, 1.1130865812301636, 0.8028350472450256, 1.1130867004394531, 1.1130867004394531, 1.1130868196487427, 1.1130874156951904, 1.1130867004394531, 1.1130868196487427, 1.1130868196487427, 1.1718791723251343, 1.1130869388580322, 1.1130867004394531, 1.1130871772766113, 1.1130865812301636, 1.1130867004394531, 1.1130869388580322, 0.8028351068496704, 1.1130868196487427, 1.1130868196487427, 3.462031602859497, 1.1130868196487427, 1.1130874156951904, 0.8028350472450256, 6.688572883605957, 1.1130871772766113, 1.1130869388580322, 1.1130867004394531, 1.1130868196487427, 1.1130872964859009, 1.1130867004394531, 1.1130865812301636, 1.1130868196487427, 1.11308753490448, 1.1130867004394531, 1.1130869388580322], "mean_td_error": 1.222136378288269, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2125.0, "diff_num_grad_updates_vs_sampler_policy": 2124.0}}, "num_env_steps_sampled": 86000, "num_env_steps_trained": 165750, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 165750, "last_target_update_ts": 85800, "num_target_updates": 164}, "sampler_results": {"episode_reward_max": 8.767228484490865, "episode_reward_min": -19.9998530513283, "episode_reward_mean": -0.973144076489931, "episode_len_mean": 24.98, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00014715498023683623, 0.00014675557245964554, 0.19841292120343415, 0.00014017515985363996, 0.6648354304925076, -9.99985350690725, -9.999853902735358, 0.10557414698294323, 0.00013955978409127616, 0.00014737063397728147, 0.00014694493418581053, 0.00014654666415774755, 0.000146124264167816, 0.00013996706007031034, 0.0001477800844118273, -9.999858538354932, -19.9998530513283, 0.09388454715154933, 0.0001461516214490606, 0.00014472568778846375, 0.11052054128383337, 0.00014397517834222577, 0.00014364750964052043, 0.00014320613005126584, 0.0001448415488419715, 8.767228484490865, 0.0001440723904972106, 0.00014374427972282516, 0.00014330230614585172, 0.1373395081590724, 0.00014481315014916972, 0.0001444816610047643, 0.00014403514820514026, 0.00013793278245459984, 0.5480820543958362, 0.0001443684909047287, 0.00014403903178090505, 0.00014359524652271147, 0.0001375125537629879, 0.00014568205021323679, 0.00014526157817372804, 0.000144903658622935, 0.000144571755514821, 0.00014412468652015605, 0.0001380183157213262, 0.00014504395416580233, 0.039537093468773946, 0.0001443146434962152, 0.00014398542978194895, 0.08922244210452712, 0.00014546626861166467, 0.00014504703934090668, 1.0273938728016452, -19.919851455918423, 0.00014395092005500143, -9.99985426900855, 0.00013959167386395766, 0.00014507702165514262, 0.00014466002956906314, 0.000144305065172669, 0.00013714083382438603, 0.00014252079778695326, 0.00014210736789512846, 0.0001417959857360729, 0.00014147625529420995, 0.3510571269611898, 0.00014262381799062872, 0.044327443302605435, 0.00014193498142651287, 0.0001416146245807388, 0.00014334187729334112, 0.00014292367729155204, 0.00014260871128098565, -9.999857714658035, 0.00014198024117428095, 0.00014290619375906624, 0.08097672318204013, 0.0001421955835988863, 0.00014187405066401376, 0.00014157074157667213, 0.00014343055547047257, 0.00014301183865543938, 0.00014269648436477826, 0.000142372684843943, 0.0001420672420886418, 0.00013748558197592247, 0.00014287822981129625, 0.00014246272674970888, 0.000142149786970156, 0.00014182846086967544, 0.00013785232158975731, -9.99985674150933, 0.0001428407436589561, 0.00014252614268665085, 0.00014220311485650797, 0.00014397589510205665, 0.15791797603710475, 0.17724466958187668, 0.00014286987657377453, -9.999857545545504], "episode_lengths": [25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 24, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.8903683253034, "mean_inference_ms": 2.1096216775943217, "mean_action_processing_ms": 0.14436124838250264, "mean_env_wait_ms": 1.1173412808153806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01032257080078125, "StateBufferConnector_ms": 0.006607770919799805, "ViewRequirementAgentConnector_ms": 0.1802058219909668}}, "episode_reward_max": 8.767228484490865, "episode_reward_min": -19.9998530513283, "episode_reward_mean": -0.973144076489931, "episode_len_mean": 24.98, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00014715498023683623, 0.00014675557245964554, 0.19841292120343415, 0.00014017515985363996, 0.6648354304925076, -9.99985350690725, -9.999853902735358, 0.10557414698294323, 0.00013955978409127616, 0.00014737063397728147, 0.00014694493418581053, 0.00014654666415774755, 0.000146124264167816, 0.00013996706007031034, 0.0001477800844118273, -9.999858538354932, -19.9998530513283, 0.09388454715154933, 0.0001461516214490606, 0.00014472568778846375, 0.11052054128383337, 0.00014397517834222577, 0.00014364750964052043, 0.00014320613005126584, 0.0001448415488419715, 8.767228484490865, 0.0001440723904972106, 0.00014374427972282516, 0.00014330230614585172, 0.1373395081590724, 0.00014481315014916972, 0.0001444816610047643, 0.00014403514820514026, 0.00013793278245459984, 0.5480820543958362, 0.0001443684909047287, 0.00014403903178090505, 0.00014359524652271147, 0.0001375125537629879, 0.00014568205021323679, 0.00014526157817372804, 0.000144903658622935, 0.000144571755514821, 0.00014412468652015605, 0.0001380183157213262, 0.00014504395416580233, 0.039537093468773946, 0.0001443146434962152, 0.00014398542978194895, 0.08922244210452712, 0.00014546626861166467, 0.00014504703934090668, 1.0273938728016452, -19.919851455918423, 0.00014395092005500143, -9.99985426900855, 0.00013959167386395766, 0.00014507702165514262, 0.00014466002956906314, 0.000144305065172669, 0.00013714083382438603, 0.00014252079778695326, 0.00014210736789512846, 0.0001417959857360729, 0.00014147625529420995, 0.3510571269611898, 0.00014262381799062872, 0.044327443302605435, 0.00014193498142651287, 0.0001416146245807388, 0.00014334187729334112, 0.00014292367729155204, 0.00014260871128098565, -9.999857714658035, 0.00014198024117428095, 0.00014290619375906624, 0.08097672318204013, 0.0001421955835988863, 0.00014187405066401376, 0.00014157074157667213, 0.00014343055547047257, 0.00014301183865543938, 0.00014269648436477826, 0.000142372684843943, 0.0001420672420886418, 0.00013748558197592247, 0.00014287822981129625, 0.00014246272674970888, 0.000142149786970156, 0.00014182846086967544, 0.00013785232158975731, -9.99985674150933, 0.0001428407436589561, 0.00014252614268665085, 0.00014220311485650797, 0.00014397589510205665, 0.15791797603710475, 0.17724466958187668, 0.00014286987657377453, -9.999857545545504], "episode_lengths": [25, 25, 25, 24, 25, 26, 26, 25, 24, 25, 25, 25, 25, 24, 25, 25, 27, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 24, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 429.8903683253034, "mean_inference_ms": 2.1096216775943217, "mean_action_processing_ms": 0.14436124838250264, "mean_env_wait_ms": 1.1173412808153806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01032257080078125, "StateBufferConnector_ms": 0.006607770919799805, "ViewRequirementAgentConnector_ms": 0.1802058219909668}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 165750, "num_env_steps_sampled": 86000, "num_env_steps_trained": 165750, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5977316462132705, "num_env_steps_trained_throughput_per_sec": 7.0155767101158775, "timesteps_total": 86000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 86000, "timers": {"training_iteration_time_ms": 11184.178, "sample_time_ms": 11116.748, "load_time_ms": 0.236, "load_throughput": 330293.5, "learn_time_ms": 13.367, "learn_throughput": 5835.179, "synch_weights_time_ms": 12.731}, "counters": {"num_env_steps_sampled": 86000, "num_env_steps_trained": 165750, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 165750, "last_target_update_ts": 85800, "num_target_updates": 164}, "done": false, "episodes_total": 3361, "training_iteration": 86, "trial_id": "2058a_00000", "date": "2024-04-17_10-48-35", "timestamp": 1713350915, "time_this_iter_s": 277.96216917037964, "time_total_s": 19687.188549995422, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 19687.188549995422, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 10.794191919191919, "ram_util_percent": 22.140151515151505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.05503619834780693, "cur_lr": 0.01}, "td_error": [0.8122493624687195, 1.1514233350753784, 1.151423454284668, 1.1514230966567993, 1.151423454284668, 1.1514235734939575, 1.1514233350753784, 3.381337881088257, 3.382401704788208, 1.151423454284668, 1.1514233350753784, 1.151423454284668, 1.1514233350753784, 1.1514232158660889, 1.1514233350753784, 1.151423454284668, 1.151423454284668, 1.1514233350753784, 1.1514232158660889, 1.151423454284668, 1.1514230966567993, 1.1514230966567993, 1.151423454284668, 1.1514233350753784, 1.151423454284668, 1.151423454284668, 1.1514233350753784, 1.1514233350753784, 0.8093196749687195, 0.8122497200965881, 1.151423454284668, 3.381338119506836, 1.1514230966567993, 1.151423454284668, 1.1514233350753784, 1.151423454284668, 0.8122497200965881, 1.1514230966567993, 1.1514233350753784, 3.381337881088257, 1.1514233350753784, 1.151423454284668, 1.151423454284668, 1.151423454284668, 1.1514232158660889, 1.1514233350753784, 1.151423454284668, 1.1514233350753784, 1.151423454284668, 1.151423454284668, 1.1514233350753784, 3.7091970443725586, 1.151423454284668, 0.8122491836547852, 1.1514232158660889, 1.151423454284668, 1.151423454284668, 1.1514233350753784, 1.1514230966567993, 1.151423454284668, 1.151423454284668, 1.151423454284668, 1.1514230966567993, 1.1514230966567993, 1.1514233350753784, 0.8122490644454956, 0.8122485876083374, 1.151423454284668, 1.1514233350753784, 1.1514233350753784, 1.1514232158660889, 1.1514232158660889, 1.1514233350753784, 1.1514232158660889, 0.8122495412826538, 1.151423454284668, 1.1514233350753784, 1.1514233350753784], "mean_td_error": 1.263758897781372, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2150.0, "diff_num_grad_updates_vs_sampler_policy": 2149.0}}, "num_env_steps_sampled": 87000, "num_env_steps_trained": 167700, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 167700, "last_target_update_ts": 86840, "num_target_updates": 166}, "sampler_results": {"episode_reward_max": 2.2872010653173382, "episode_reward_min": -19.919851455918423, "episode_reward_mean": -0.8278314983735412, "episode_len_mean": 25.02, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00014526157817372804, 0.000144903658622935, 0.000144571755514821, 0.00014412468652015605, 0.0001380183157213262, 0.00014504395416580233, 0.039537093468773946, 0.0001443146434962152, 0.00014398542978194895, 0.08922244210452712, 0.00014546626861166467, 0.00014504703934090668, 1.0273938728016452, -19.919851455918423, 0.00014395092005500143, -9.99985426900855, 0.00013959167386395766, 0.00014507702165514262, 0.00014466002956906314, 0.000144305065172669, 0.00013714083382438603, 0.00014252079778695326, 0.00014210736789512846, 0.0001417959857360729, 0.00014147625529420995, 0.3510571269611898, 0.00014262381799062872, 0.044327443302605435, 0.00014193498142651287, 0.0001416146245807388, 0.00014334187729334112, 0.00014292367729155204, 0.00014260871128098565, -9.999857714658035, 0.00014198024117428095, 0.00014290619375906624, 0.08097672318204013, 0.0001421955835988863, 0.00014187405066401376, 0.00014157074157667213, 0.00014343055547047257, 0.00014301183865543938, 0.00014269648436477826, 0.000142372684843943, 0.0001420672420886418, 0.00013748558197592247, 0.00014287822981129625, 0.00014246272674970888, 0.000142149786970156, 0.00014182846086967544, 0.00013785232158975731, -9.99985674150933, 0.0001428407436589561, 0.00014252614268665085, 0.00014220311485650797, 0.00014397589510205665, 0.15791797603710475, 0.17724466958187668, 0.00014286987657377453, -9.999857545545504, 0.00014117464303074761, 0.0001407623525864346, 0.0001403313456759352, 0.00013992018184258017, 0.0001396012859500443, 0.00014131242263223543, 0.00014089932832390687, -9.999859532815421, 0.0001400555225983313, 2.2872010653173382, 0.00014156323947380774, 0.00014112732134527372, 0.00014071148678108296, 0.378434228107654, 0.00014007653222434572, 0.0001411561380240024, 0.00014072271979951624, 0.00014030926269650474, 0.00013998859273553501, 0.00013967354244150937, 0.00014164972999783455, 0.00014121327983034637, 0.0001407969392940373, 0.1772477849325604, 0.682428948487629, 0.00014152534648978875, 0.00014111100835938946, 0.4415336706684784, 0.03965277443954339, 0.00013999839179325527, 0.0001418983985328804, -9.952092765473543, 0.33518346841567775, 0.00014068524486632265, 0.00014036285589704182, 0.6790693386645157, 0.0001418235335712735, 0.00014152044023143352, 0.08886730005390356, -9.999859299507111], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.0654257746888, "mean_inference_ms": 2.109514641602326, "mean_action_processing_ms": 0.14436255211778293, "mean_env_wait_ms": 1.1058780872984277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009884834289550781, "StateBufferConnector_ms": 0.006562709808349609, "ViewRequirementAgentConnector_ms": 0.17710494995117188}}, "episode_reward_max": 2.2872010653173382, "episode_reward_min": -19.919851455918423, "episode_reward_mean": -0.8278314983735412, "episode_len_mean": 25.02, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00014526157817372804, 0.000144903658622935, 0.000144571755514821, 0.00014412468652015605, 0.0001380183157213262, 0.00014504395416580233, 0.039537093468773946, 0.0001443146434962152, 0.00014398542978194895, 0.08922244210452712, 0.00014546626861166467, 0.00014504703934090668, 1.0273938728016452, -19.919851455918423, 0.00014395092005500143, -9.99985426900855, 0.00013959167386395766, 0.00014507702165514262, 0.00014466002956906314, 0.000144305065172669, 0.00013714083382438603, 0.00014252079778695326, 0.00014210736789512846, 0.0001417959857360729, 0.00014147625529420995, 0.3510571269611898, 0.00014262381799062872, 0.044327443302605435, 0.00014193498142651287, 0.0001416146245807388, 0.00014334187729334112, 0.00014292367729155204, 0.00014260871128098565, -9.999857714658035, 0.00014198024117428095, 0.00014290619375906624, 0.08097672318204013, 0.0001421955835988863, 0.00014187405066401376, 0.00014157074157667213, 0.00014343055547047257, 0.00014301183865543938, 0.00014269648436477826, 0.000142372684843943, 0.0001420672420886418, 0.00013748558197592247, 0.00014287822981129625, 0.00014246272674970888, 0.000142149786970156, 0.00014182846086967544, 0.00013785232158975731, -9.99985674150933, 0.0001428407436589561, 0.00014252614268665085, 0.00014220311485650797, 0.00014397589510205665, 0.15791797603710475, 0.17724466958187668, 0.00014286987657377453, -9.999857545545504, 0.00014117464303074761, 0.0001407623525864346, 0.0001403313456759352, 0.00013992018184258017, 0.0001396012859500443, 0.00014131242263223543, 0.00014089932832390687, -9.999859532815421, 0.0001400555225983313, 2.2872010653173382, 0.00014156323947380774, 0.00014112732134527372, 0.00014071148678108296, 0.378434228107654, 0.00014007653222434572, 0.0001411561380240024, 0.00014072271979951624, 0.00014030926269650474, 0.00013998859273553501, 0.00013967354244150937, 0.00014164972999783455, 0.00014121327983034637, 0.0001407969392940373, 0.1772477849325604, 0.682428948487629, 0.00014152534648978875, 0.00014111100835938946, 0.4415336706684784, 0.03965277443954339, 0.00013999839179325527, 0.0001418983985328804, -9.952092765473543, 0.33518346841567775, 0.00014068524486632265, 0.00014036285589704182, 0.6790693386645157, 0.0001418235335712735, 0.00014152044023143352, 0.08886730005390356, -9.999859299507111], "episode_lengths": [25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 25, 27, 25, 26, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.0654257746888, "mean_inference_ms": 2.109514641602326, "mean_action_processing_ms": 0.14436255211778293, "mean_env_wait_ms": 1.1058780872984277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009884834289550781, "StateBufferConnector_ms": 0.006562709808349609, "ViewRequirementAgentConnector_ms": 0.17710494995117188}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 167700, "num_env_steps_sampled": 87000, "num_env_steps_trained": 167700, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5901540165787904, "num_env_steps_trained_throughput_per_sec": 7.000800332328641, "timesteps_total": 87000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 87000, "timers": {"training_iteration_time_ms": 11216.364, "sample_time_ms": 11153.495, "load_time_ms": 0.237, "load_throughput": 329196.732, "learn_time_ms": 12.979, "learn_throughput": 6009.617, "synch_weights_time_ms": 11.094}, "counters": {"num_env_steps_sampled": 87000, "num_env_steps_trained": 167700, "num_agent_steps_sampled": 87000, "num_agent_steps_trained": 167700, "last_target_update_ts": 86840, "num_target_updates": 166}, "done": false, "episodes_total": 3401, "training_iteration": 87, "trial_id": "2058a_00000", "date": "2024-04-17_10-53-13", "timestamp": 1713351193, "time_this_iter_s": 278.54894280433655, "time_total_s": 19965.73749279976, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 19965.73749279976, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 10.86111111111111, "ram_util_percent": 22.23131313131313}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.017311755567789078, "cur_lr": 0.01}, "td_error": [1.15896737575531, 1.1589674949645996, 0.7663889527320862, 1.1589676141738892, 1.1589674949645996, 1.594528317451477, 1.1589674949645996, 1.15896737575531, 1.15896737575531, 1.1589676141738892, 1.1589676141738892, 1.15896737575531, 1.1589672565460205, 1.15896737575531, 1.1589674949645996, 1.1589674949645996, 1.1589674949645996, 1.1589674949645996, 1.15896737575531, 1.15896737575531, 1.15896737575531, 1.1589676141738892, 0.7663869857788086, 1.15896737575531, 1.158968210220337, 1.1589672565460205, 1.1589676141738892, 1.1589674949645996, 1.1589674949645996, 0.817533016204834, 1.1589677333831787, 1.15896737575531, 1.1589674949645996, 1.1589676141738892, 1.1589679718017578, 1.3357479572296143, 1.15896737575531, 1.1589676141738892, 1.15896737575531, 1.1589674949645996, 1.1589676141738892, 1.15896737575531, 1.15896737575531, 0.8175328969955444, 1.1589674949645996, 1.15896737575531, 1.1589674949645996, 1.1589674949645996, 1.1589676141738892, 0.8175327777862549, 1.1589674949645996, 0.8175328969955444, 1.1589674949645996, 1.1589674949645996, 1.1589676141738892, 1.1589674949645996, 1.1589674949645996, 1.15896737575531, 1.1589676141738892, 1.1589680910110474, 1.1589674949645996, 1.15896737575531, 1.1589674949645996, 1.1589676141738892, 1.1589676141738892, 1.1589674949645996, 1.1589676141738892, 1.1589679718017578, 1.1589674949645996, 1.1589674949645996, 1.15896737575531, 1.1589674949645996, 1.1589676141738892, 0.8175328969955444, 1.1589674949645996, 1.1589674949645996, 0.8175326585769653, 1.1589674949645996], "mean_td_error": 1.1304875612258911, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2175.0, "diff_num_grad_updates_vs_sampler_policy": 2174.0}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 169650, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 169650, "last_target_update_ts": 87880, "num_target_updates": 168}, "sampler_results": {"episode_reward_max": 2.2872010653173382, "episode_reward_min": -9.999866476372747, "episode_reward_mean": -1.103327350996443, "episode_len_mean": 25.01, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00014343055547047257, 0.00014301183865543938, 0.00014269648436477826, 0.000142372684843943, 0.0001420672420886418, 0.00013748558197592247, 0.00014287822981129625, 0.00014246272674970888, 0.000142149786970156, 0.00014182846086967544, 0.00013785232158975731, -9.99985674150933, 0.0001428407436589561, 0.00014252614268665085, 0.00014220311485650797, 0.00014397589510205665, 0.15791797603710475, 0.17724466958187668, 0.00014286987657377453, -9.999857545545504, 0.00014117464303074761, 0.0001407623525864346, 0.0001403313456759352, 0.00013992018184258017, 0.0001396012859500443, 0.00014131242263223543, 0.00014089932832390687, -9.999859532815421, 0.0001400555225983313, 2.2872010653173382, 0.00014156323947380774, 0.00014112732134527372, 0.00014071148678108296, 0.378434228107654, 0.00014007653222434572, 0.0001411561380240024, 0.00014072271979951624, 0.00014030926269650474, 0.00013998859273553501, 0.00013967354244150937, 0.00014164972999783455, 0.00014121327983034637, 0.0001407969392940373, 0.1772477849325604, 0.682428948487629, 0.00014152534648978875, 0.00014111100835938946, 0.4415336706684784, 0.03965277443954339, 0.00013999839179325527, 0.0001418983985328804, -9.952092765473543, 0.33518346841567775, 0.00014068524486632265, 0.00014036285589704182, 0.6790693386645157, 0.0001418235335712735, 0.00014152044023143352, 0.08886730005390356, -9.999859299507111, 0.00013928797459396492, 0.0902935733120786, 0.00013317903703220768, 0.00013840910419175018, -9.417924984315032, 0.00013942322133499337, 0.00013915859158236766, 0.8148471921088364, -9.999861479385466, 0.00013817542812741366, 0.00013980941909975025, 0.00013390721985683215, -9.999860835835394, -9.999861184201768, -9.99986154678341, 0.00013940796253365643, -9.999866476372747, 0.2679011014985134, 0.0001384282735959477, 0.04427991478139313, 0.00013991382494317781, 0.08939053026660591, 0.00013929114659103238, 0.00013894214492129347, 0.00013857890379196584, 0.48195743528737756, 0.00013942209389498556, 0.06297451612832433, 0.18453478820507788, 0.09670529442182359, 0.00014004612066692603, 0.00013977912339992258, 0.0001338782700936883, 0.0001391341169738322, -9.999861214068385, 0.00014028713469440283, 0.00013996656576083694, 0.00013965161449274564, 0.0001393861178857187, 1.4488208492691623], "episode_lengths": [25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 24, 26, 25, 25, 24, 26, 26, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.1983324185456, "mean_inference_ms": 2.1093986700069394, "mean_action_processing_ms": 0.1443699560227144, "mean_env_wait_ms": 1.0945617897672002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010320901870727539, "StateBufferConnector_ms": 0.0065004825592041016, "ViewRequirementAgentConnector_ms": 0.17515254020690918}}, "episode_reward_max": 2.2872010653173382, "episode_reward_min": -9.999866476372747, "episode_reward_mean": -1.103327350996443, "episode_len_mean": 25.01, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00014343055547047257, 0.00014301183865543938, 0.00014269648436477826, 0.000142372684843943, 0.0001420672420886418, 0.00013748558197592247, 0.00014287822981129625, 0.00014246272674970888, 0.000142149786970156, 0.00014182846086967544, 0.00013785232158975731, -9.99985674150933, 0.0001428407436589561, 0.00014252614268665085, 0.00014220311485650797, 0.00014397589510205665, 0.15791797603710475, 0.17724466958187668, 0.00014286987657377453, -9.999857545545504, 0.00014117464303074761, 0.0001407623525864346, 0.0001403313456759352, 0.00013992018184258017, 0.0001396012859500443, 0.00014131242263223543, 0.00014089932832390687, -9.999859532815421, 0.0001400555225983313, 2.2872010653173382, 0.00014156323947380774, 0.00014112732134527372, 0.00014071148678108296, 0.378434228107654, 0.00014007653222434572, 0.0001411561380240024, 0.00014072271979951624, 0.00014030926269650474, 0.00013998859273553501, 0.00013967354244150937, 0.00014164972999783455, 0.00014121327983034637, 0.0001407969392940373, 0.1772477849325604, 0.682428948487629, 0.00014152534648978875, 0.00014111100835938946, 0.4415336706684784, 0.03965277443954339, 0.00013999839179325527, 0.0001418983985328804, -9.952092765473543, 0.33518346841567775, 0.00014068524486632265, 0.00014036285589704182, 0.6790693386645157, 0.0001418235335712735, 0.00014152044023143352, 0.08886730005390356, -9.999859299507111, 0.00013928797459396492, 0.0902935733120786, 0.00013317903703220768, 0.00013840910419175018, -9.417924984315032, 0.00013942322133499337, 0.00013915859158236766, 0.8148471921088364, -9.999861479385466, 0.00013817542812741366, 0.00013980941909975025, 0.00013390721985683215, -9.999860835835394, -9.999861184201768, -9.99986154678341, 0.00013940796253365643, -9.999866476372747, 0.2679011014985134, 0.0001384282735959477, 0.04427991478139313, 0.00013991382494317781, 0.08939053026660591, 0.00013929114659103238, 0.00013894214492129347, 0.00013857890379196584, 0.48195743528737756, 0.00013942209389498556, 0.06297451612832433, 0.18453478820507788, 0.09670529442182359, 0.00014004612066692603, 0.00013977912339992258, 0.0001338782700936883, 0.0001391341169738322, -9.999861214068385, 0.00014028713469440283, 0.00013996656576083694, 0.00013965161449274564, 0.0001393861178857187, 1.4488208492691623], "episode_lengths": [25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 26, 25, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 24, 26, 25, 25, 24, 26, 26, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.1983324185456, "mean_inference_ms": 2.1093986700069394, "mean_action_processing_ms": 0.1443699560227144, "mean_env_wait_ms": 1.0945617897672002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010320901870727539, "StateBufferConnector_ms": 0.0065004825592041016, "ViewRequirementAgentConnector_ms": 0.17515254020690918}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 169650, "num_env_steps_sampled": 88000, "num_env_steps_trained": 169650, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7238308928066357, "num_env_steps_trained_throughput_per_sec": 7.2614702409729395, "timesteps_total": 88000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 10038.735, "sample_time_ms": 9972.579, "load_time_ms": 0.25, "load_throughput": 312052.377, "learn_time_ms": 13.416, "learn_throughput": 5813.869, "synch_weights_time_ms": 12.003}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 169650, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 169650, "last_target_update_ts": 87880, "num_target_updates": 168}, "done": false, "episodes_total": 3441, "training_iteration": 88, "trial_id": "2058a_00000", "date": "2024-04-17_10-57-42", "timestamp": 1713351462, "time_this_iter_s": 268.5506453514099, "time_total_s": 20234.28813815117, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 20234.28813815117, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 11.159685863874346, "ram_util_percent": 22.337434554973825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.031430210918188095, "cur_lr": 0.01}, "td_error": [1.158794641494751, 1.158794641494751, 1.1587947607040405, 0.8157806992530823, 1.1587944030761719, 1.158794641494751, 1.158794641494751, 0.815780520439148, 1.158794641494751, 1.1587947607040405, 1.158794641494751, 1.1587947607040405, 1.15879487991333, 1.158794641494751, 1.15879487991333, 1.1587942838668823, 1.1587945222854614, 1.158794641494751, 0.8157806396484375, 1.1587941646575928, 1.1587940454483032, 1.1587944030761719, 1.1587947607040405, 1.158794641494751, 1.158794641494751, 1.158794641494751, 1.1587947607040405, 0.8157800436019897, 1.1587945222854614, 1.1587939262390137, 0.8157806396484375, 1.158794641494751, 1.1587944030761719, 1.1587944030761719, 2.8505120277404785, 1.158794641494751, 1.1587942838668823, 1.158794641494751, 1.1587945222854614, 1.1587936878204346, 1.1587947607040405, 1.158794641494751, 0.8157804608345032, 1.158794641494751, 1.1587945222854614, 0.8157798051834106, 1.1587945222854614, 1.1587945222854614, 1.15879487991333, 1.158794641494751, 1.1587947607040405, 1.1587940454483032, 1.1587944030761719, 1.15879487991333, 0.8157798051834106, 2.8777172565460205, 0.8157798647880554, 1.1993378400802612, 1.1587944030761719, 1.1587945222854614, 1.158794641494751, 1.1587942838668823, 1.1587944030761719, 1.3167223930358887, 0.8157803416252136, 0.8157798051834106, 1.15879487991333, 1.7281923294067383, 1.15879487991333, 1.1587944030761719, 1.1587945222854614, 1.1587945222854614, 1.158794641494751, 1.1587940454483032, 1.15879487991333, 0.8157802820205688, 1.1587945222854614, 1.1587942838668823], "mean_td_error": 1.1595935821533203, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2200.0, "diff_num_grad_updates_vs_sampler_policy": 2199.0}}, "num_env_steps_sampled": 89000, "num_env_steps_trained": 171600, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 171600, "last_target_update_ts": 88920, "num_target_updates": 170}, "sampler_results": {"episode_reward_max": 3.531320672510963, "episode_reward_min": -9.999866476372747, "episode_reward_mean": -1.2579163663262225, "episode_len_mean": 25.06, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00014164972999783455, 0.00014121327983034637, 0.0001407969392940373, 0.1772477849325604, 0.682428948487629, 0.00014152534648978875, 0.00014111100835938946, 0.4415336706684784, 0.03965277443954339, 0.00013999839179325527, 0.0001418983985328804, -9.952092765473543, 0.33518346841567775, 0.00014068524486632265, 0.00014036285589704182, 0.6790693386645157, 0.0001418235335712735, 0.00014152044023143352, 0.08886730005390356, -9.999859299507111, 0.00013928797459396492, 0.0902935733120786, 0.00013317903703220768, 0.00013840910419175018, -9.417924984315032, 0.00013942322133499337, 0.00013915859158236766, 0.8148471921088364, -9.999861479385466, 0.00013817542812741366, 0.00013980941909975025, 0.00013390721985683215, -9.999860835835394, -9.999861184201768, -9.99986154678341, 0.00013940796253365643, -9.999866476372747, 0.2679011014985134, 0.0001384282735959477, 0.04427991478139313, 0.00013991382494317781, 0.08939053026660591, 0.00013929114659103238, 0.00013894214492129347, 0.00013857890379196584, 0.48195743528737756, 0.00013942209389498556, 0.06297451612832433, 0.18453478820507788, 0.09670529442182359, 0.00014004612066692603, 0.00013977912339992258, 0.0001338782700936883, 0.0001391341169738322, -9.999861214068385, 0.00014028713469440283, 0.00013996656576083694, 0.00013965161449274564, 0.0001393861178857187, 1.4488208492691623, 0.00013770935748599493, 0.0001374360676638764, 0.03680064754461856, 0.22306440733908223, 0.4541098693043848, 0.00013781617966429735, -9.999862457503594, 0.032017830543362547, 0.00013679026547957007, 0.00013649376258763422, 0.0001381769387529237, 0.0001378014704310381, 0.5059255294341655, 0.00013708016535420468, 0.00013678501181971253, 0.0001378242373578375, 0.00013745068071980494, 0.3784310039941671, -9.999863263474547, 0.0001364400012234045, 0.000138302155221965, 0.0001379260070415184, 1.4432743611038372, 3.531320672510963, 0.00013690577033086536, 0.0001381340936413357, -9.999862140852581, -9.99986251459809, 0.00013706061049092227, 0.00013676293568124932, 0.00013842347507633953, 0.00013814734634004345, 0.00013777203859956927, 0.00013734550705199675, 0.0001370465947489662, 0.0001387466779377754, -9.999861599728941, 0.3275681835361812, 0.18762000660098865, 0.4228637106954916], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 24, 26, 25, 25, 24, 26, 26, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.34148012039236, "mean_inference_ms": 2.1097175356512152, "mean_action_processing_ms": 0.14439376426924125, "mean_env_wait_ms": 1.0835300735032325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010459184646606445, "StateBufferConnector_ms": 0.006436586380004883, "ViewRequirementAgentConnector_ms": 0.18042516708374023}}, "episode_reward_max": 3.531320672510963, "episode_reward_min": -9.999866476372747, "episode_reward_mean": -1.2579163663262225, "episode_len_mean": 25.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00014164972999783455, 0.00014121327983034637, 0.0001407969392940373, 0.1772477849325604, 0.682428948487629, 0.00014152534648978875, 0.00014111100835938946, 0.4415336706684784, 0.03965277443954339, 0.00013999839179325527, 0.0001418983985328804, -9.952092765473543, 0.33518346841567775, 0.00014068524486632265, 0.00014036285589704182, 0.6790693386645157, 0.0001418235335712735, 0.00014152044023143352, 0.08886730005390356, -9.999859299507111, 0.00013928797459396492, 0.0902935733120786, 0.00013317903703220768, 0.00013840910419175018, -9.417924984315032, 0.00013942322133499337, 0.00013915859158236766, 0.8148471921088364, -9.999861479385466, 0.00013817542812741366, 0.00013980941909975025, 0.00013390721985683215, -9.999860835835394, -9.999861184201768, -9.99986154678341, 0.00013940796253365643, -9.999866476372747, 0.2679011014985134, 0.0001384282735959477, 0.04427991478139313, 0.00013991382494317781, 0.08939053026660591, 0.00013929114659103238, 0.00013894214492129347, 0.00013857890379196584, 0.48195743528737756, 0.00013942209389498556, 0.06297451612832433, 0.18453478820507788, 0.09670529442182359, 0.00014004612066692603, 0.00013977912339992258, 0.0001338782700936883, 0.0001391341169738322, -9.999861214068385, 0.00014028713469440283, 0.00013996656576083694, 0.00013965161449274564, 0.0001393861178857187, 1.4488208492691623, 0.00013770935748599493, 0.0001374360676638764, 0.03680064754461856, 0.22306440733908223, 0.4541098693043848, 0.00013781617966429735, -9.999862457503594, 0.032017830543362547, 0.00013679026547957007, 0.00013649376258763422, 0.0001381769387529237, 0.0001378014704310381, 0.5059255294341655, 0.00013708016535420468, 0.00013678501181971253, 0.0001378242373578375, 0.00013745068071980494, 0.3784310039941671, -9.999863263474547, 0.0001364400012234045, 0.000138302155221965, 0.0001379260070415184, 1.4432743611038372, 3.531320672510963, 0.00013690577033086536, 0.0001381340936413357, -9.999862140852581, -9.99986251459809, 0.00013706061049092227, 0.00013676293568124932, 0.00013842347507633953, 0.00013814734634004345, 0.00013777203859956927, 0.00013734550705199675, 0.0001370465947489662, 0.0001387466779377754, -9.999861599728941, 0.3275681835361812, 0.18762000660098865, 0.4228637106954916], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 24, 25, 26, 25, 25, 24, 26, 25, 25, 24, 26, 26, 26, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.34148012039236, "mean_inference_ms": 2.1097175356512152, "mean_action_processing_ms": 0.14439376426924125, "mean_env_wait_ms": 1.0835300735032325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010459184646606445, "StateBufferConnector_ms": 0.006436586380004883, "ViewRequirementAgentConnector_ms": 0.18042516708374023}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 171600, "num_env_steps_sampled": 89000, "num_env_steps_trained": 171600, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7114349389009047, "num_env_steps_trained_throughput_per_sec": 7.237298130856764, "timesteps_total": 89000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 89000, "timers": {"training_iteration_time_ms": 11109.225, "sample_time_ms": 11046.446, "load_time_ms": 0.237, "load_throughput": 328766.669, "learn_time_ms": 13.119, "learn_throughput": 5945.432, "synch_weights_time_ms": 11.404}, "counters": {"num_env_steps_sampled": 89000, "num_env_steps_trained": 171600, "num_agent_steps_sampled": 89000, "num_agent_steps_trained": 171600, "last_target_update_ts": 88920, "num_target_updates": 170}, "done": false, "episodes_total": 3481, "training_iteration": 89, "trial_id": "2058a_00000", "date": "2024-04-17_11-02-11", "timestamp": 1713351731, "time_this_iter_s": 269.4467554092407, "time_total_s": 20503.73489356041, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 20503.73489356041, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 11.253524804177546, "ram_util_percent": 22.439425587467362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.007603475823998451, "cur_lr": 0.01}, "td_error": [1.1409322023391724, 1.1409320831298828, 1.1409320831298828, 1.1409320831298828, 1.1409322023391724, 1.1409322023391724, 1.1409322023391724, 0.7883032560348511, 1.1409320831298828, 1.1409322023391724, 1.1409322023391724, 1.1409322023391724, 1.1409322023391724, 0.8119630813598633, 1.1409320831298828, 0.8119635581970215, 1.1409322023391724, 1.1409322023391724, 1.1409322023391724, 3.403850793838501, 0.8119635581970215, 1.2192444801330566, 1.1409319639205933, 1.1409320831298828, 1.1409320831298828, 1.1409322023391724, 0.8119634389877319, 1.1409322023391724, 1.1409320831298828, 1.1409322023391724, 1.1409320831298828, 1.1409319639205933, 1.1409320831298828, 1.1409320831298828, 1.6279596090316772, 1.1409320831298828, 1.1409322023391724, 1.1409320831298828, 1.1409320831298828, 1.1409320831298828, 1.1409322023391724, 1.402048945426941, 1.1409320831298828, 1.1409322023391724, 1.1409322023391724, 1.1409322023391724, 1.1409322023391724, 1.1409322023391724, 1.1409320831298828, 1.1409320831298828, 0.8119633197784424, 1.1409320831298828, 1.1409322023391724, 1.1409320831298828, 1.1409322023391724, 1.1409320831298828, 1.1409322023391724, 1.1409320831298828, 0.8119634389877319, 1.1409322023391724, 0.8119634985923767, 0.8119634985923767, 1.1409320831298828, 1.1409320831298828, 0.8119634389877319, 1.1409320831298828, 1.185950517654419, 1.1409320831298828, 0.8119635581970215, 1.1409320831298828, 3.403850555419922, 1.1409322023391724, 1.1409322023391724, 1.1409319639205933, 1.1409322023391724, 0.8119634985923767, 1.1409322023391724, 1.1409322023391724], "mean_td_error": 1.1592144966125488, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2225.0, "diff_num_grad_updates_vs_sampler_policy": 2224.0}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 173550, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 173550, "last_target_update_ts": 89960, "num_target_updates": 172}, "sampler_results": {"episode_reward_max": 3.531320672510963, "episode_reward_min": -9.99986494666872, "episode_reward_mean": -0.9545412140689296, "episode_len_mean": 25.07, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00013991382494317781, 0.08939053026660591, 0.00013929114659103238, 0.00013894214492129347, 0.00013857890379196584, 0.48195743528737756, 0.00013942209389498556, 0.06297451612832433, 0.18453478820507788, 0.09670529442182359, 0.00014004612066692603, 0.00013977912339992258, 0.0001338782700936883, 0.0001391341169738322, -9.999861214068385, 0.00014028713469440283, 0.00013996656576083694, 0.00013965161449274564, 0.0001393861178857187, 1.4488208492691623, 0.00013770935748599493, 0.0001374360676638764, 0.03680064754461856, 0.22306440733908223, 0.4541098693043848, 0.00013781617966429735, -9.999862457503594, 0.032017830543362547, 0.00013679026547957007, 0.00013649376258763422, 0.0001381769387529237, 0.0001378014704310381, 0.5059255294341655, 0.00013708016535420468, 0.00013678501181971253, 0.0001378242373578375, 0.00013745068071980494, 0.3784310039941671, -9.999863263474547, 0.0001364400012234045, 0.000138302155221965, 0.0001379260070415184, 1.4432743611038372, 3.531320672510963, 0.00013690577033086536, 0.0001381340936413357, -9.999862140852581, -9.99986251459809, 0.00013706061049092227, 0.00013676293568124932, 0.00013842347507633953, 0.00013814734634004345, 0.00013777203859956927, 0.00013734550705199675, 0.0001370465947489662, 0.0001387466779377754, -9.999861599728941, 0.3275681835361812, 0.18762000660098865, 0.4228637106954916, 0.00013614203916125205, 0.49335621706712374, 0.00013542085579015725, 0.041352920644099095, 0.0001347463566039791, 0.00013620112628205276, 0.06168202408533815, 0.34803047812424026, -9.792177377139566, 0.1330955279227799, 0.00013641879245125093, -8.61559204414179, 0.00013578034259569146, 0.0001353377705051991, -9.99986494666872, 0.0001360756242682579, 0.8916987453634201, -9.999864559624276, 0.7958904928635234, 0.00013472055593453065, 0.0525736890701565, 0.00013620825954008947, 0.00013593235244140864, 0.00013548879052457225, 0.00013520368754885045, 0.0001364691452422457, 0.00013610461283238606, 0.00013574120780220303, 0.00013546718755577463, 0.00013502665113028885, 0.00013675158561204365, 0.0001363855449477018, 0.00013602063997572984, -9.999864254478965, 0.0001353031463112098, 0.0001369892074979334, 0.00013669184243702407, 0.00013639835704479085, 0.0001360342021630646, 0.2187135196471936], "episode_lengths": [25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.4850414675366, "mean_inference_ms": 2.109600905037374, "mean_action_processing_ms": 0.14438579114257316, "mean_env_wait_ms": 1.0727124617576487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010038137435913086, "StateBufferConnector_ms": 0.006612062454223633, "ViewRequirementAgentConnector_ms": 0.17697834968566895}}, "episode_reward_max": 3.531320672510963, "episode_reward_min": -9.99986494666872, "episode_reward_mean": -0.9545412140689296, "episode_len_mean": 25.07, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00013991382494317781, 0.08939053026660591, 0.00013929114659103238, 0.00013894214492129347, 0.00013857890379196584, 0.48195743528737756, 0.00013942209389498556, 0.06297451612832433, 0.18453478820507788, 0.09670529442182359, 0.00014004612066692603, 0.00013977912339992258, 0.0001338782700936883, 0.0001391341169738322, -9.999861214068385, 0.00014028713469440283, 0.00013996656576083694, 0.00013965161449274564, 0.0001393861178857187, 1.4488208492691623, 0.00013770935748599493, 0.0001374360676638764, 0.03680064754461856, 0.22306440733908223, 0.4541098693043848, 0.00013781617966429735, -9.999862457503594, 0.032017830543362547, 0.00013679026547957007, 0.00013649376258763422, 0.0001381769387529237, 0.0001378014704310381, 0.5059255294341655, 0.00013708016535420468, 0.00013678501181971253, 0.0001378242373578375, 0.00013745068071980494, 0.3784310039941671, -9.999863263474547, 0.0001364400012234045, 0.000138302155221965, 0.0001379260070415184, 1.4432743611038372, 3.531320672510963, 0.00013690577033086536, 0.0001381340936413357, -9.999862140852581, -9.99986251459809, 0.00013706061049092227, 0.00013676293568124932, 0.00013842347507633953, 0.00013814734634004345, 0.00013777203859956927, 0.00013734550705199675, 0.0001370465947489662, 0.0001387466779377754, -9.999861599728941, 0.3275681835361812, 0.18762000660098865, 0.4228637106954916, 0.00013614203916125205, 0.49335621706712374, 0.00013542085579015725, 0.041352920644099095, 0.0001347463566039791, 0.00013620112628205276, 0.06168202408533815, 0.34803047812424026, -9.792177377139566, 0.1330955279227799, 0.00013641879245125093, -8.61559204414179, 0.00013578034259569146, 0.0001353377705051991, -9.99986494666872, 0.0001360756242682579, 0.8916987453634201, -9.999864559624276, 0.7958904928635234, 0.00013472055593453065, 0.0525736890701565, 0.00013620825954008947, 0.00013593235244140864, 0.00013548879052457225, 0.00013520368754885045, 0.0001364691452422457, 0.00013610461283238606, 0.00013574120780220303, 0.00013546718755577463, 0.00013502665113028885, 0.00013675158561204365, 0.0001363855449477018, 0.00013602063997572984, -9.999864254478965, 0.0001353031463112098, 0.0001369892074979334, 0.00013669184243702407, 0.00013639835704479085, 0.0001360342021630646, 0.2187135196471936], "episode_lengths": [25, 24, 25, 25, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.4850414675366, "mean_inference_ms": 2.109600905037374, "mean_action_processing_ms": 0.14438579114257316, "mean_env_wait_ms": 1.0727124617576487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010038137435913086, "StateBufferConnector_ms": 0.006612062454223633, "ViewRequirementAgentConnector_ms": 0.17697834968566895}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 173550, "num_env_steps_sampled": 90000, "num_env_steps_trained": 173550, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.049441815588055, "num_env_steps_trained_throughput_per_sec": 7.8964115403967075, "timesteps_total": 90000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 8913.282, "sample_time_ms": 8850.376, "load_time_ms": 0.235, "load_throughput": 331263.378, "learn_time_ms": 13.087, "learn_throughput": 5960.119, "synch_weights_time_ms": 11.503}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 173550, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 173550, "last_target_update_ts": 89960, "num_target_updates": 172}, "done": false, "episodes_total": 3521, "training_iteration": 90, "trial_id": "2058a_00000", "date": "2024-04-17_11-06-18", "timestamp": 1713351978, "time_this_iter_s": 246.95583653450012, "time_total_s": 20750.69073009491, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 20750.69073009491, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 12.133048433048435, "ram_util_percent": 22.540740740740738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.01725255697965622, "cur_lr": 0.01}, "td_error": [1.1422901153564453, 1.1422902345657349, 1.1422898769378662, 1.1422901153564453, 1.1422901153564453, 1.1422898769378662, 1.1422902345657349, 1.1422901153564453, 1.1422902345657349, 1.1422902345657349, 1.1422898769378662, 1.1422901153564453, 1.1422902345657349, 1.1422902345657349, 1.1422901153564453, 1.1422902345657349, 1.1422901153564453, 1.1422899961471558, 1.1422899961471558, 1.1422901153564453, 1.1422902345657349, 1.1422901153564453, 1.1422901153564453, 3.341700792312622, 1.1422901153564453, 1.1422903537750244, 1.1422902345657349, 1.1422901153564453, 1.1422902345657349, 0.8150325417518616, 1.1422898769378662, 1.1422902345657349, 1.1422902345657349, 1.1422902345657349, 1.1422902345657349, 0.8150325417518616, 1.1422903537750244, 1.1422899961471558, 1.1422902345657349, 1.1422902345657349, 1.1422902345657349, 1.1422902345657349, 1.1422901153564453, 1.1422898769378662, 1.1422899961471558, 1.1422902345657349, 1.1422899961471558, 1.1843205690383911, 1.1422903537750244, 1.1422902345657349, 1.1422897577285767, 1.1422901153564453, 1.1422902345657349, 1.1422902345657349, 1.1422899961471558, 1.1422903537750244, 1.1422901153564453, 1.1422901153564453, 1.1422901153564453, 1.1422901153564453, 1.1422902345657349, 0.8150325417518616, 1.1422902345657349, 1.1422902345657349, 1.1422901153564453, 0.8150323629379272, 1.1422902345657349, 1.1422901153564453, 1.1422901153564453, 0.8150327205657959, 1.1422902345657349, 1.1422899961471558, 1.1422901153564453, 1.1422901153564453, 1.1422902345657349, 1.1422899961471558, 0.8150326013565063, 1.1422903537750244], "mean_td_error": 1.1458529233932495, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2250.0, "diff_num_grad_updates_vs_sampler_policy": 2249.0}}, "num_env_steps_sampled": 91000, "num_env_steps_trained": 175500, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 175500, "last_target_update_ts": 91000, "num_target_updates": 174}, "sampler_results": {"episode_reward_max": 3.531320672510963, "episode_reward_min": -29.940204443115235, "episode_reward_mean": -1.4422666421676658, "episode_len_mean": 25.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.000138302155221965, 0.0001379260070415184, 1.4432743611038372, 3.531320672510963, 0.00013690577033086536, 0.0001381340936413357, -9.999862140852581, -9.99986251459809, 0.00013706061049092227, 0.00013676293568124932, 0.00013842347507633953, 0.00013814734634004345, 0.00013777203859956927, 0.00013734550705199675, 0.0001370465947489662, 0.0001387466779377754, -9.999861599728941, 0.3275681835361812, 0.18762000660098865, 0.4228637106954916, 0.00013614203916125205, 0.49335621706712374, 0.00013542085579015725, 0.041352920644099095, 0.0001347463566039791, 0.00013620112628205276, 0.06168202408533815, 0.34803047812424026, -9.792177377139566, 0.1330955279227799, 0.00013641879245125093, -8.61559204414179, 0.00013578034259569146, 0.0001353377705051991, -9.99986494666872, 0.0001360756242682579, 0.8916987453634201, -9.999864559624276, 0.7958904928635234, 0.00013472055593453065, 0.0525736890701565, 0.00013620825954008947, 0.00013593235244140864, 0.00013548879052457225, 0.00013520368754885045, 0.0001364691452422457, 0.00013610461283238606, 0.00013574120780220303, 0.00013546718755577463, 0.00013502665113028885, 0.00013675158561204365, 0.0001363855449477018, 0.00013602063997572984, -9.999864254478965, 0.0001353031463112098, 0.0001369892074979334, 0.00013669184243702407, 0.00013639835704479085, 0.0001360342021630646, 0.2187135196471936, 0.00013446436667003544, 0.00013409728652799674, 0.000133718800302444, 0.0001334064413907599, 0.0001330332255276871, 0.5061661152829147, -9.99986580187327, 2.240606979657602, 0.0001335070773033461, 0.00013313329896330088, 0.00013468300425607937, 0.00013430120880815555, 0.4905856999594314, 0.00013363239248839631, -9.999866710499305, 0.1547513766413887, 0.0001339828630374382, -9.999866329942865, 0.0001332945849341658, 0.0001329525448387753, -9.999865167405062, 0.00013444992301282185, 0.03952702110984608, 1.120367705357555, 0.0001334507109890934, 0.00013474348791940542, -29.940204443115235, -9.999865966496474, 0.00013372017338059622, 0.06822460944096867, 0.19398456552860854, 0.34802966633826404, 0.00013428078740912344, 0.0001339658005659888, 0.00013358945296758652, 0.00013540726585351112, 0.00013496711841612497, 0.00013468420460489245, 0.0001343159249805593, 0.00013393620515909655], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 28, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.61313267869343, "mean_inference_ms": 2.1093055578742446, "mean_action_processing_ms": 0.14436085595128553, "mean_env_wait_ms": 1.062108257867269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009381532669067383, "StateBufferConnector_ms": 0.006617546081542969, "ViewRequirementAgentConnector_ms": 0.17630910873413086}}, "episode_reward_max": 3.531320672510963, "episode_reward_min": -29.940204443115235, "episode_reward_mean": -1.4422666421676658, "episode_len_mean": 25.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.000138302155221965, 0.0001379260070415184, 1.4432743611038372, 3.531320672510963, 0.00013690577033086536, 0.0001381340936413357, -9.999862140852581, -9.99986251459809, 0.00013706061049092227, 0.00013676293568124932, 0.00013842347507633953, 0.00013814734634004345, 0.00013777203859956927, 0.00013734550705199675, 0.0001370465947489662, 0.0001387466779377754, -9.999861599728941, 0.3275681835361812, 0.18762000660098865, 0.4228637106954916, 0.00013614203916125205, 0.49335621706712374, 0.00013542085579015725, 0.041352920644099095, 0.0001347463566039791, 0.00013620112628205276, 0.06168202408533815, 0.34803047812424026, -9.792177377139566, 0.1330955279227799, 0.00013641879245125093, -8.61559204414179, 0.00013578034259569146, 0.0001353377705051991, -9.99986494666872, 0.0001360756242682579, 0.8916987453634201, -9.999864559624276, 0.7958904928635234, 0.00013472055593453065, 0.0525736890701565, 0.00013620825954008947, 0.00013593235244140864, 0.00013548879052457225, 0.00013520368754885045, 0.0001364691452422457, 0.00013610461283238606, 0.00013574120780220303, 0.00013546718755577463, 0.00013502665113028885, 0.00013675158561204365, 0.0001363855449477018, 0.00013602063997572984, -9.999864254478965, 0.0001353031463112098, 0.0001369892074979334, 0.00013669184243702407, 0.00013639835704479085, 0.0001360342021630646, 0.2187135196471936, 0.00013446436667003544, 0.00013409728652799674, 0.000133718800302444, 0.0001334064413907599, 0.0001330332255276871, 0.5061661152829147, -9.99986580187327, 2.240606979657602, 0.0001335070773033461, 0.00013313329896330088, 0.00013468300425607937, 0.00013430120880815555, 0.4905856999594314, 0.00013363239248839631, -9.999866710499305, 0.1547513766413887, 0.0001339828630374382, -9.999866329942865, 0.0001332945849341658, 0.0001329525448387753, -9.999865167405062, 0.00013444992301282185, 0.03952702110984608, 1.120367705357555, 0.0001334507109890934, 0.00013474348791940542, -29.940204443115235, -9.999865966496474, 0.00013372017338059622, 0.06822460944096867, 0.19398456552860854, 0.34802966633826404, 0.00013428078740912344, 0.0001339658005659888, 0.00013358945296758652, 0.00013540726585351112, 0.00013496711841612497, 0.00013468420460489245, 0.0001343159249805593, 0.00013393620515909655], "episode_lengths": [25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 28, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.61313267869343, "mean_inference_ms": 2.1093055578742446, "mean_action_processing_ms": 0.14436085595128553, "mean_env_wait_ms": 1.062108257867269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009381532669067383, "StateBufferConnector_ms": 0.006617546081542969, "ViewRequirementAgentConnector_ms": 0.17630910873413086}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 175500, "num_env_steps_sampled": 91000, "num_env_steps_trained": 175500, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.7487100588196562, "num_env_steps_trained_throughput_per_sec": 7.30998461469833, "timesteps_total": 91000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 91000, "timers": {"training_iteration_time_ms": 10955.89, "sample_time_ms": 10893.287, "load_time_ms": 0.225, "load_throughput": 346673.426, "learn_time_ms": 12.928, "learn_throughput": 6033.211, "synch_weights_time_ms": 11.535}, "counters": {"num_env_steps_sampled": 91000, "num_env_steps_trained": 175500, "num_agent_steps_sampled": 91000, "num_agent_steps_trained": 175500, "last_target_update_ts": 91000, "num_target_updates": 174}, "done": false, "episodes_total": 3561, "training_iteration": 91, "trial_id": "2058a_00000", "date": "2024-04-17_11-10-45", "timestamp": 1713352245, "time_this_iter_s": 266.7687075138092, "time_total_s": 21017.45943760872, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21017.45943760872, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 11.275789473684208, "ram_util_percent": 22.66210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.014772382564842701, "cur_lr": 0.01}, "td_error": [1.425349473953247, 1.133899450302124, 1.133899211883545, 1.133899211883545, 1.133899450302124, 1.133899211883545, 1.133899211883545, 1.133899211883545, 1.133899211883545, 0.8098243474960327, 1.133899211883545, 1.133899211883545, 1.1338993310928345, 1.133899211883545, 1.133899450302124, 0.8098243474960327, 1.1338990926742554, 1.133899211883545, 1.133899211883545, 1.133899211883545, 0.8098243474960327, 1.133899211883545, 1.1338993310928345, 1.1338993310928345, 1.133899450302124, 1.133899211883545, 1.133899211883545, 0.8098242282867432, 1.1338993310928345, 1.133899211883545, 1.133899211883545, 1.133899211883545, 1.1338990926742554, 1.133899211883545, 1.133899211883545, 1.1338990926742554, 1.133899211883545, 1.1338990926742554, 1.1338993310928345, 1.1338993310928345, 1.1338990926742554, 1.1338990926742554, 2.2474355697631836, 0.8098243474960327, 1.133899211883545, 0.8098243474960327, 1.1338993310928345, 1.133899211883545, 0.8098243474960327, 1.133899211883545, 1.133899211883545, 1.133899211883545, 1.133899450302124, 1.1338990926742554, 1.133899211883545, 1.133899211883545, 1.133899211883545, 1.133899211883545, 1.133899211883545, 1.133899211883545, 1.1338990926742554, 1.133899211883545, 1.133899211883545, 1.1338990926742554, 1.133899211883545, 1.133899211883545, 3.466137409210205, 1.1338990926742554, 1.133899211883545, 1.133899211883545, 1.133899211883545, 1.133899211883545, 0.8098243474960327, 1.1338993310928345, 0.8098243474960327, 1.133899211883545, 1.133899211883545, 3.4919605255126953], "mean_td_error": 1.1746506690979004, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2275.0, "diff_num_grad_updates_vs_sampler_policy": 2274.0}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 177450, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 177450, "last_target_update_ts": 91520, "num_target_updates": 175}, "sampler_results": {"episode_reward_max": 2.240606979657602, "episode_reward_min": -29.940204443115235, "episode_reward_mean": -1.329389335199489, "episode_len_mean": 25.14, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00013472055593453065, 0.0525736890701565, 0.00013620825954008947, 0.00013593235244140864, 0.00013548879052457225, 0.00013520368754885045, 0.0001364691452422457, 0.00013610461283238606, 0.00013574120780220303, 0.00013546718755577463, 0.00013502665113028885, 0.00013675158561204365, 0.0001363855449477018, 0.00013602063997572984, -9.999864254478965, 0.0001353031463112098, 0.0001369892074979334, 0.00013669184243702407, 0.00013639835704479085, 0.0001360342021630646, 0.2187135196471936, 0.00013446436667003544, 0.00013409728652799674, 0.000133718800302444, 0.0001334064413907599, 0.0001330332255276871, 0.5061661152829147, -9.99986580187327, 2.240606979657602, 0.0001335070773033461, 0.00013313329896330088, 0.00013468300425607937, 0.00013430120880815555, 0.4905856999594314, 0.00013363239248839631, -9.999866710499305, 0.1547513766413887, 0.0001339828630374382, -9.999866329942865, 0.0001332945849341658, 0.0001329525448387753, -9.999865167405062, 0.00013444992301282185, 0.03952702110984608, 1.120367705357555, 0.0001334507109890934, 0.00013474348791940542, -29.940204443115235, -9.999865966496474, 0.00013372017338059622, 0.06822460944096867, 0.19398456552860854, 0.34802966633826404, 0.00013428078740912344, 0.0001339658005659888, 0.00013358945296758652, 0.00013540726585351112, 0.00013496711841612497, 0.00013468420460489245, 0.0001343159249805593, 0.00013393620515909655, 0.00013269252376866576, -9.999867690305518, 0.00013201844193914063, 0.10957823349578066, 0.2028843836329996, 0.037665872368011076, 0.00013245220174656005, 0.00013216035009076154, 0.0001318275308744637, 0.00013152628914734826, 0.19840002385977218, 0.00013261804013833556, 0.18761473788684518, 0.0001319896890185435, 0.00013163110825258653, -9.999867431784157, 0.00013227582531313235, 0.00013194242496833804, 0.0001316406585300596, 0.00013128396912868138, 0.33305520850246534, 0.00013277701409542282, -9.999867559135529, -9.999867862935444, 0.0001330671126379509, 0.00013268209382107332, 0.0001323892292915321, 0.00013205525774965298, 0.00013175297557071154, 0.00013324589980740796, 0.2652729370501546, 0.00013257426402469536, -9.87400346345169, 0.00013194952275550522, 0.0001336228309339486, 0.09670027612371909, 0.00013292358527642543, 0.00013253939538812988, 0.00013224715977488483], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 28, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.74541161034983, "mean_inference_ms": 2.109211818316549, "mean_action_processing_ms": 0.14433826888983325, "mean_env_wait_ms": 1.0520171492562989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009284734725952148, "StateBufferConnector_ms": 0.006279945373535156, "ViewRequirementAgentConnector_ms": 0.17314434051513672}}, "episode_reward_max": 2.240606979657602, "episode_reward_min": -29.940204443115235, "episode_reward_mean": -1.329389335199489, "episode_len_mean": 25.14, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00013472055593453065, 0.0525736890701565, 0.00013620825954008947, 0.00013593235244140864, 0.00013548879052457225, 0.00013520368754885045, 0.0001364691452422457, 0.00013610461283238606, 0.00013574120780220303, 0.00013546718755577463, 0.00013502665113028885, 0.00013675158561204365, 0.0001363855449477018, 0.00013602063997572984, -9.999864254478965, 0.0001353031463112098, 0.0001369892074979334, 0.00013669184243702407, 0.00013639835704479085, 0.0001360342021630646, 0.2187135196471936, 0.00013446436667003544, 0.00013409728652799674, 0.000133718800302444, 0.0001334064413907599, 0.0001330332255276871, 0.5061661152829147, -9.99986580187327, 2.240606979657602, 0.0001335070773033461, 0.00013313329896330088, 0.00013468300425607937, 0.00013430120880815555, 0.4905856999594314, 0.00013363239248839631, -9.999866710499305, 0.1547513766413887, 0.0001339828630374382, -9.999866329942865, 0.0001332945849341658, 0.0001329525448387753, -9.999865167405062, 0.00013444992301282185, 0.03952702110984608, 1.120367705357555, 0.0001334507109890934, 0.00013474348791940542, -29.940204443115235, -9.999865966496474, 0.00013372017338059622, 0.06822460944096867, 0.19398456552860854, 0.34802966633826404, 0.00013428078740912344, 0.0001339658005659888, 0.00013358945296758652, 0.00013540726585351112, 0.00013496711841612497, 0.00013468420460489245, 0.0001343159249805593, 0.00013393620515909655, 0.00013269252376866576, -9.999867690305518, 0.00013201844193914063, 0.10957823349578066, 0.2028843836329996, 0.037665872368011076, 0.00013245220174656005, 0.00013216035009076154, 0.0001318275308744637, 0.00013152628914734826, 0.19840002385977218, 0.00013261804013833556, 0.18761473788684518, 0.0001319896890185435, 0.00013163110825258653, -9.999867431784157, 0.00013227582531313235, 0.00013194242496833804, 0.0001316406585300596, 0.00013128396912868138, 0.33305520850246534, 0.00013277701409542282, -9.999867559135529, -9.999867862935444, 0.0001330671126379509, 0.00013268209382107332, 0.0001323892292915321, 0.00013205525774965298, 0.00013175297557071154, 0.00013324589980740796, 0.2652729370501546, 0.00013257426402469536, -9.87400346345169, 0.00013194952275550522, 0.0001336228309339486, 0.09670027612371909, 0.00013292358527642543, 0.00013253939538812988, 0.00013224715977488483], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 26, 25, 25, 25, 25, 25, 28, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.74541161034983, "mean_inference_ms": 2.109211818316549, "mean_action_processing_ms": 0.14433826888983325, "mean_env_wait_ms": 1.0520171492562989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009284734725952148, "StateBufferConnector_ms": 0.006279945373535156, "ViewRequirementAgentConnector_ms": 0.17314434051513672}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 177450, "num_env_steps_sampled": 92000, "num_env_steps_trained": 177450, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.587292739309229, "num_env_steps_trained_throughput_per_sec": 6.995220841652996, "timesteps_total": 92000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 11113.246, "sample_time_ms": 11052.085, "load_time_ms": 0.227, "load_throughput": 344229.495, "learn_time_ms": 12.644, "learn_throughput": 6168.85, "synch_weights_time_ms": 11.194}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 177450, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 177450, "last_target_update_ts": 91520, "num_target_updates": 175}, "done": false, "episodes_total": 3600, "training_iteration": 92, "trial_id": "2058a_00000", "date": "2024-04-17_11-15-24", "timestamp": 1713352524, "time_this_iter_s": 278.7711589336395, "time_total_s": 21296.23059654236, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21296.23059654236, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 10.532828282828282, "ram_util_percent": 22.78030303030304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.019764725118875504, "cur_lr": 0.01}, "td_error": [0.8157235980033875, 1.1400423049926758, 1.1400419473648071, 1.1400419473648071, 1.1400421857833862, 1.2093583345413208, 1.1400420665740967, 1.1400420665740967, 1.1400423049926758, 1.1400418281555176, 1.1400421857833862, 1.1400418281555176, 1.1400420665740967, 1.1400421857833862, 1.1400421857833862, 1.1400420665740967, 1.1400418281555176, 0.8157228231430054, 1.1400423049926758, 1.1400421857833862, 1.1400423049926758, 1.1400421857833862, 1.1400418281555176, 1.1400420665740967, 1.1400419473648071, 1.1400420665740967, 1.1400423049926758, 1.1400421857833862, 1.1400421857833862, 1.1400421857833862, 1.1400423049926758, 1.1400419473648071, 1.1400419473648071, 1.1400421857833862, 1.1400421857833862, 1.1400420665740967, 1.1400420665740967, 0.8157233595848083, 1.1400420665740967, 1.1400421857833862, 1.1400419473648071, 1.1400420665740967, 1.1400421857833862, 1.1400419473648071, 0.8157236576080322, 3.404604434967041, 1.1400423049926758, 1.1400418281555176, 1.1400423049926758, 0.815723180770874, 1.1400421857833862, 1.1400420665740967, 1.1400418281555176, 1.140041470527649, 0.8157235383987427, 1.1400421857833862, 1.1400421857833862, 1.1400420665740967, 1.1400421857833862, 1.1400419473648071, 1.1400420665740967, 0.8157236576080322, 0.8157235980033875, 0.8157232403755188, 1.1400420665740967, 1.1400420665740967, 1.1400418281555176, 1.1400419473648071, 0.8157236576080322, 0.8157235980033875, 1.1400419473648071, 1.1400421857833862, 1.1400423049926758, 1.1400418281555176, 0.815723180770874, 1.1400420665740967, 0.8157232999801636, 1.1400421857833862], "mean_td_error": 1.1159104108810425, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2300.0, "diff_num_grad_updates_vs_sampler_policy": 2299.0}}, "num_env_steps_sampled": 93000, "num_env_steps_trained": 179400, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 179400, "last_target_update_ts": 92560, "num_target_updates": 177}, "sampler_results": {"episode_reward_max": 3.094392402312552, "episode_reward_min": -29.940204443115235, "episode_reward_mean": -1.3169515373128848, "episode_len_mean": 25.12, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0001329525448387753, -9.999865167405062, 0.00013444992301282185, 0.03952702110984608, 1.120367705357555, 0.0001334507109890934, 0.00013474348791940542, -29.940204443115235, -9.999865966496474, 0.00013372017338059622, 0.06822460944096867, 0.19398456552860854, 0.34802966633826404, 0.00013428078740912344, 0.0001339658005659888, 0.00013358945296758652, 0.00013540726585351112, 0.00013496711841612497, 0.00013468420460489245, 0.0001343159249805593, 0.00013393620515909655, 0.00013269252376866576, -9.999867690305518, 0.00013201844193914063, 0.10957823349578066, 0.2028843836329996, 0.037665872368011076, 0.00013245220174656005, 0.00013216035009076154, 0.0001318275308744637, 0.00013152628914734826, 0.19840002385977218, 0.00013261804013833556, 0.18761473788684518, 0.0001319896890185435, 0.00013163110825258653, -9.999867431784157, 0.00013227582531313235, 0.00013194242496833804, 0.0001316406585300596, 0.00013128396912868138, 0.33305520850246534, 0.00013277701409542282, -9.999867559135529, -9.999867862935444, 0.0001330671126379509, 0.00013268209382107332, 0.0001323892292915321, 0.00013205525774965298, 0.00013175297557071154, 0.00013324589980740796, 0.2652729370501546, 0.00013257426402469536, -9.87400346345169, 0.00013194952275550522, 0.0001336228309339486, 0.09670027612371909, 0.00013292358527642543, 0.00013253939538812988, 0.00013224715977488483, 0.00013105228626104733, 0.0001307375041244079, 0.00013039118177511874, 0.0777440933932689, 0.00012973376720106156, 0.00013117021841834413, 0.00013085487016719906, 0.00013050792657047898, 0.5516147131808834, 0.00012984750455003003, 0.00013131354270718988, 0.00013096416591878068, 0.00013064484365019754, 0.00013028035057566535, 0.0001247439403488856, 0.00013096807435467904, 3.094392402312552, 0.0001303035774874364, -9.999870058989542, 0.00012441983762748182, 0.00013177765587802832, 0.00013145938368312726, 0.00013110923145263437, -9.999869210770337, 0.6186147949151813, 0.00013139567807773326, 0.0001310792461312433, 0.000130731113311842, 0.0001304129251573233, 0.00013004972319010047, 0.5648342092089105, 0.00013127686717289533, 0.00013092768525481389, -9.999869391432114, 0.00013024424982430378, 0.00013191390373645302, 0.00013161226759462118, -9.999868744240617, 0.0001309399727598569, 0.0001305925783468561], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 28, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.8064529257374, "mean_inference_ms": 2.108533282270691, "mean_action_processing_ms": 0.14429555867925445, "mean_env_wait_ms": 1.0417479657876385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009636163711547852, "StateBufferConnector_ms": 0.006204366683959961, "ViewRequirementAgentConnector_ms": 0.17289113998413086}}, "episode_reward_max": 3.094392402312552, "episode_reward_min": -29.940204443115235, "episode_reward_mean": -1.3169515373128848, "episode_len_mean": 25.12, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0001329525448387753, -9.999865167405062, 0.00013444992301282185, 0.03952702110984608, 1.120367705357555, 0.0001334507109890934, 0.00013474348791940542, -29.940204443115235, -9.999865966496474, 0.00013372017338059622, 0.06822460944096867, 0.19398456552860854, 0.34802966633826404, 0.00013428078740912344, 0.0001339658005659888, 0.00013358945296758652, 0.00013540726585351112, 0.00013496711841612497, 0.00013468420460489245, 0.0001343159249805593, 0.00013393620515909655, 0.00013269252376866576, -9.999867690305518, 0.00013201844193914063, 0.10957823349578066, 0.2028843836329996, 0.037665872368011076, 0.00013245220174656005, 0.00013216035009076154, 0.0001318275308744637, 0.00013152628914734826, 0.19840002385977218, 0.00013261804013833556, 0.18761473788684518, 0.0001319896890185435, 0.00013163110825258653, -9.999867431784157, 0.00013227582531313235, 0.00013194242496833804, 0.0001316406585300596, 0.00013128396912868138, 0.33305520850246534, 0.00013277701409542282, -9.999867559135529, -9.999867862935444, 0.0001330671126379509, 0.00013268209382107332, 0.0001323892292915321, 0.00013205525774965298, 0.00013175297557071154, 0.00013324589980740796, 0.2652729370501546, 0.00013257426402469536, -9.87400346345169, 0.00013194952275550522, 0.0001336228309339486, 0.09670027612371909, 0.00013292358527642543, 0.00013253939538812988, 0.00013224715977488483, 0.00013105228626104733, 0.0001307375041244079, 0.00013039118177511874, 0.0777440933932689, 0.00012973376720106156, 0.00013117021841834413, 0.00013085487016719906, 0.00013050792657047898, 0.5516147131808834, 0.00012984750455003003, 0.00013131354270718988, 0.00013096416591878068, 0.00013064484365019754, 0.00013028035057566535, 0.0001247439403488856, 0.00013096807435467904, 3.094392402312552, 0.0001303035774874364, -9.999870058989542, 0.00012441983762748182, 0.00013177765587802832, 0.00013145938368312726, 0.00013110923145263437, -9.999869210770337, 0.6186147949151813, 0.00013139567807773326, 0.0001310792461312433, 0.000130731113311842, 0.0001304129251573233, 0.00013004972319010047, 0.5648342092089105, 0.00013127686717289533, 0.00013092768525481389, -9.999869391432114, 0.00013024424982430378, 0.00013191390373645302, 0.00013161226759462118, -9.999868744240617, 0.0001309399727598569, 0.0001305925783468561], "episode_lengths": [25, 26, 25, 25, 25, 25, 25, 28, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.8064529257374, "mean_inference_ms": 2.108533282270691, "mean_action_processing_ms": 0.14429555867925445, "mean_env_wait_ms": 1.0417479657876385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009636163711547852, "StateBufferConnector_ms": 0.006204366683959961, "ViewRequirementAgentConnector_ms": 0.17289113998413086}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 179400, "num_env_steps_sampled": 93000, "num_env_steps_trained": 179400, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.5942654656779514, "num_env_steps_trained_throughput_per_sec": 7.008817658072005, "timesteps_total": 93000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 93000, "timers": {"training_iteration_time_ms": 11180.915, "sample_time_ms": 11117.225, "load_time_ms": 0.223, "load_throughput": 349450.664, "learn_time_ms": 12.929, "learn_throughput": 6033.033, "synch_weights_time_ms": 11.75}, "counters": {"num_env_steps_sampled": 93000, "num_env_steps_trained": 179400, "num_agent_steps_sampled": 93000, "num_agent_steps_trained": 179400, "last_target_update_ts": 92560, "num_target_updates": 177}, "done": false, "episodes_total": 3640, "training_iteration": 93, "trial_id": "2058a_00000", "date": "2024-04-17_11-20-02", "timestamp": 1713352802, "time_this_iter_s": 278.2291944026947, "time_total_s": 21574.459790945053, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21574.459790945053, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 10.885353535353536, "ram_util_percent": 22.88484848484849}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0354325957596302, "cur_lr": 0.01}, "td_error": [1.1303097009658813, 1.1303099393844604, 1.130309820175171, 1.1303097009658813, 1.130309820175171, 1.13031005859375, 1.130310297012329, 1.130309820175171, 1.130309820175171, 1.130309820175171, 0.7831457257270813, 1.1303099393844604, 1.1303099393844604, 1.1303097009658813, 1.1303097009658813, 0.8082370758056641, 1.130309820175171, 1.130309820175171, 1.1303097009658813, 3.497561454772949, 1.1303101778030396, 1.1303095817565918, 1.13031005859375, 1.1303097009658813, 3.533546209335327, 0.8082370758056641, 0.8082370758056641, 1.1303104162216187, 1.130309820175171, 0.8082370758056641, 1.130309820175171, 1.1303099393844604, 3.497561454772949, 0.8082370758056641, 1.1303099393844604, 0.8082371950149536, 1.1303099393844604, 1.130309820175171, 1.130309820175171, 1.1303097009658813, 1.1303099393844604, 1.1303097009658813, 1.1303106546401978, 1.8450284004211426, 1.130309820175171, 1.1303097009658813, 1.130309820175171, 1.1303099393844604, 1.1303101778030396, 1.1303097009658813, 1.1303097009658813, 3.471961498260498, 1.1303095817565918, 1.1303099393844604, 1.130309820175171, 0.8082371354103088, 1.1303095817565918, 1.1303099393844604, 1.1303099393844604, 1.1303095817565918, 1.130310297012329, 1.130309820175171, 1.1303099393844604, 1.1303094625473022, 1.1303097009658813, 1.1303095817565918, 0.8082371950149536, 1.1303097009658813, 0.8082371354103088, 1.1303099393844604, 1.1303097009658813, 1.1303097009658813, 1.1303099393844604, 1.1303104162216187, 0.8082375526428223, 1.130309820175171, 1.1303106546401978, 1.13031005859375], "mean_td_error": 1.2152613401412964, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2325.0, "diff_num_grad_updates_vs_sampler_policy": 2324.0}}, "num_env_steps_sampled": 94000, "num_env_steps_trained": 181350, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 181350, "last_target_update_ts": 93600, "num_target_updates": 179}, "sampler_results": {"episode_reward_max": 7.51477217502984, "episode_reward_min": -9.999871271461735, "episode_reward_mean": -0.8896820769169059, "episode_len_mean": 24.96, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00013128396912868138, 0.33305520850246534, 0.00013277701409542282, -9.999867559135529, -9.999867862935444, 0.0001330671126379509, 0.00013268209382107332, 0.0001323892292915321, 0.00013205525774965298, 0.00013175297557071154, 0.00013324589980740796, 0.2652729370501546, 0.00013257426402469536, -9.87400346345169, 0.00013194952275550522, 0.0001336228309339486, 0.09670027612371909, 0.00013292358527642543, 0.00013253939538812988, 0.00013224715977488483, 0.00013105228626104733, 0.0001307375041244079, 0.00013039118177511874, 0.0777440933932689, 0.00012973376720106156, 0.00013117021841834413, 0.00013085487016719906, 0.00013050792657047898, 0.5516147131808834, 0.00012984750455003003, 0.00013131354270718988, 0.00013096416591878068, 0.00013064484365019754, 0.00013028035057566535, 0.0001247439403488856, 0.00013096807435467904, 3.094392402312552, 0.0001303035774874364, -9.999870058989542, 0.00012441983762748182, 0.00013177765587802832, 0.00013145938368312726, 0.00013110923145263437, -9.999869210770337, 0.6186147949151813, 0.00013139567807773326, 0.0001310792461312433, 0.000130731113311842, 0.0001304129251573233, 0.00013004972319010047, 0.5648342092089105, 0.00013127686717289533, 0.00013092768525481389, -9.999869391432114, 0.00013024424982430378, 0.00013191390373645302, 0.00013161226759462118, -9.999868744240617, 0.0001309399727598569, 0.0001305925783468561, 0.06357971386073273, 0.0001290698337091918, -9.999871271461735, 0.00012843372071370024, 0.00012303322309630663, 0.00012433056251714102, 0.0001291605251494305, 0.06718880769304869, 0.18835936397493222, 0.00012314507959250792, 0.00012958879561783768, 0.00012924472700316875, 0.00012894756965918657, 0.0001235244104838127, 0.3510488234873934, 0.00012925301719953007, 4.046472916889875, 0.0001286156611395427, 0.00012320714061844952, 0.00012801711536859873, 0.00012488201688688, 0.00012973184487947176, 0.04789563635011374, 0.0001291283419466877, 0.7736852899658476, 0.7014865178112016, 0.00012936363965753076, 0.00012902076405858678, 0.000128724634501807, 0.000123311308152608, 0.0001247094635804643, 0.00012955307706009753, -9.999870790028051, 0.00012891220366363624, 0.17642986100114558, 0.00013027506339724308, -9.99987008734521, -9.246560482577223, 0.6089497398024181, 7.51477217502984], "episode_lengths": [25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 26, 25, 24, 24, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 25, 26, 25, 24, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.8858068343816, "mean_inference_ms": 2.1080557254612926, "mean_action_processing_ms": 0.1442651605049331, "mean_env_wait_ms": 1.0317223702286633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010161399841308594, "StateBufferConnector_ms": 0.006600141525268555, "ViewRequirementAgentConnector_ms": 0.17440032958984375}}, "episode_reward_max": 7.51477217502984, "episode_reward_min": -9.999871271461735, "episode_reward_mean": -0.8896820769169059, "episode_len_mean": 24.96, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00013128396912868138, 0.33305520850246534, 0.00013277701409542282, -9.999867559135529, -9.999867862935444, 0.0001330671126379509, 0.00013268209382107332, 0.0001323892292915321, 0.00013205525774965298, 0.00013175297557071154, 0.00013324589980740796, 0.2652729370501546, 0.00013257426402469536, -9.87400346345169, 0.00013194952275550522, 0.0001336228309339486, 0.09670027612371909, 0.00013292358527642543, 0.00013253939538812988, 0.00013224715977488483, 0.00013105228626104733, 0.0001307375041244079, 0.00013039118177511874, 0.0777440933932689, 0.00012973376720106156, 0.00013117021841834413, 0.00013085487016719906, 0.00013050792657047898, 0.5516147131808834, 0.00012984750455003003, 0.00013131354270718988, 0.00013096416591878068, 0.00013064484365019754, 0.00013028035057566535, 0.0001247439403488856, 0.00013096807435467904, 3.094392402312552, 0.0001303035774874364, -9.999870058989542, 0.00012441983762748182, 0.00013177765587802832, 0.00013145938368312726, 0.00013110923145263437, -9.999869210770337, 0.6186147949151813, 0.00013139567807773326, 0.0001310792461312433, 0.000130731113311842, 0.0001304129251573233, 0.00013004972319010047, 0.5648342092089105, 0.00013127686717289533, 0.00013092768525481389, -9.999869391432114, 0.00013024424982430378, 0.00013191390373645302, 0.00013161226759462118, -9.999868744240617, 0.0001309399727598569, 0.0001305925783468561, 0.06357971386073273, 0.0001290698337091918, -9.999871271461735, 0.00012843372071370024, 0.00012303322309630663, 0.00012433056251714102, 0.0001291605251494305, 0.06718880769304869, 0.18835936397493222, 0.00012314507959250792, 0.00012958879561783768, 0.00012924472700316875, 0.00012894756965918657, 0.0001235244104838127, 0.3510488234873934, 0.00012925301719953007, 4.046472916889875, 0.0001286156611395427, 0.00012320714061844952, 0.00012801711536859873, 0.00012488201688688, 0.00012973184487947176, 0.04789563635011374, 0.0001291283419466877, 0.7736852899658476, 0.7014865178112016, 0.00012936363965753076, 0.00012902076405858678, 0.000128724634501807, 0.000123311308152608, 0.0001247094635804643, 0.00012955307706009753, -9.999870790028051, 0.00012891220366363624, 0.17642986100114558, 0.00013027506339724308, -9.99987008734521, -9.246560482577223, 0.6089497398024181, 7.51477217502984], "episode_lengths": [25, 25, 25, 26, 26, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 25, 25, 25, 26, 24, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 26, 25, 24, 24, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 25, 26, 25, 24, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.8858068343816, "mean_inference_ms": 2.1080557254612926, "mean_action_processing_ms": 0.1442651605049331, "mean_env_wait_ms": 1.0317223702286633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010161399841308594, "StateBufferConnector_ms": 0.006600141525268555, "ViewRequirementAgentConnector_ms": 0.17440032958984375}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 181350, "num_env_steps_sampled": 94000, "num_env_steps_trained": 181350, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.575033677632367, "num_env_steps_trained_throughput_per_sec": 6.971315671383115, "timesteps_total": 94000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 94000, "timers": {"training_iteration_time_ms": 11234.244, "sample_time_ms": 11169.134, "load_time_ms": 0.246, "load_throughput": 316643.159, "learn_time_ms": 13.127, "learn_throughput": 5941.804, "synch_weights_time_ms": 11.702}, "counters": {"num_env_steps_sampled": 94000, "num_env_steps_trained": 181350, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 181350, "last_target_update_ts": 93600, "num_target_updates": 179}, "done": false, "episodes_total": 3680, "training_iteration": 94, "trial_id": "2058a_00000", "date": "2024-04-17_11-24-42", "timestamp": 1713353082, "time_this_iter_s": 279.7272789478302, "time_total_s": 21854.187069892883, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21854.187069892883, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 10.785929648241206, "ram_util_percent": 23.020100502512562}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.018433721736073494, "cur_lr": 0.01}, "td_error": [1.1450817584991455, 1.145081877708435, 0.8111511468887329, 0.8111512660980225, 1.1450821161270142, 4.14643669128418, 1.1450817584991455, 1.1450819969177246, 3.395692825317383, 1.1450821161270142, 1.1450817584991455, 1.145081877708435, 1.145081639289856, 1.145081877708435, 1.1450817584991455, 1.1450821161270142, 1.1450817584991455, 1.1450819969177246, 1.1450819969177246, 0.8111509084701538, 1.145081639289856, 1.1450821161270142, 1.1450817584991455, 1.145081639289856, 1.1450819969177246, 1.145081877708435, 0.7859428524971008, 1.1450819969177246, 1.1450819969177246, 1.145081877708435, 0.8111512660980225, 1.145081877708435, 1.145081877708435, 0.8111512660980225, 1.1450817584991455, 1.1450819969177246, 1.1450819969177246, 0.8111511468887329, 1.1450817584991455, 1.1450817584991455, 1.145081877708435, 1.145081639289856, 0.6058453917503357, 1.1450819969177246, 1.145081639289856, 0.8111511468887329, 1.145081877708435, 1.1450817584991455, 1.145081877708435, 0.8111512660980225, 0.8111512064933777, 3.3964593410491943, 1.190778374671936, 1.145081639289856, 1.1450821161270142, 1.1450821161270142, 1.145081877708435, 1.145081877708435, 1.1450817584991455, 1.1450817584991455, 0.8111511468887329, 1.1450817584991455, 0.8111512064933777, 1.145081877708435, 1.145081877708435, 1.145081877708435, 1.1450819969177246, 1.1450819969177246, 1.1450819969177246, 1.145081639289856, 1.145081877708435, 1.1450817584991455, 1.1450819969177246, 1.145081877708435, 1.145081877708435, 1.145081639289856, 1.145081639289856, 1.267090082168579], "mean_td_error": 1.1848182678222656, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2350.0, "diff_num_grad_updates_vs_sampler_policy": 2349.0}}, "num_env_steps_sampled": 95000, "num_env_steps_trained": 183300, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 183300, "last_target_update_ts": 94640, "num_target_updates": 181}, "sampler_results": {"episode_reward_max": 7.51477217502984, "episode_reward_min": -19.999877383203174, "episode_reward_mean": -1.5594199898884704, "episode_len_mean": 24.89, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00013177765587802832, 0.00013145938368312726, 0.00013110923145263437, -9.999869210770337, 0.6186147949151813, 0.00013139567807773326, 0.0001310792461312433, 0.000130731113311842, 0.0001304129251573233, 0.00013004972319010047, 0.5648342092089105, 0.00013127686717289533, 0.00013092768525481389, -9.999869391432114, 0.00013024424982430378, 0.00013191390373645302, 0.00013161226759462118, -9.999868744240617, 0.0001309399727598569, 0.0001305925783468561, 0.06357971386073273, 0.0001290698337091918, -9.999871271461735, 0.00012843372071370024, 0.00012303322309630663, 0.00012433056251714102, 0.0001291605251494305, 0.06718880769304869, 0.18835936397493222, 0.00012314507959250792, 0.00012958879561783768, 0.00012924472700316875, 0.00012894756965918657, 0.0001235244104838127, 0.3510488234873934, 0.00012925301719953007, 4.046472916889875, 0.0001286156611395427, 0.00012320714061844952, 0.00012801711536859873, 0.00012488201688688, 0.00012973184487947176, 0.04789563635011374, 0.0001291283419466877, 0.7736852899658476, 0.7014865178112016, 0.00012936363965753076, 0.00012902076405858678, 0.000128724634501807, 0.000123311308152608, 0.0001247094635804643, 0.00012955307706009753, -9.999870790028051, 0.00012891220366363624, 0.17642986100114558, 0.00013027506339724308, -9.99987008734521, -9.246560482577223, 0.6089497398024181, 7.51477217502984, -9.99987216311065, -9.99987753443669, 0.0001274059393800712, -9.999872835654731, 0.00012184022880282361, 0.0001279527940291806, 0.00012257679942266633, 0.00012752108953179722, 0.00012727903302338969, 0.00012194992560785003, 0.00012295864201833628, -8.685946420576679, 0.00012767591554255442, 1.0171190627946964, 0.00012709996644155627, 2.2921671618747657, 0.11819777038314416, 0.00012735627178807554, 0.0001220237862250438, 0.00012677515996576216, -9.99987147140503, 0.00012312642645801586, -9.999871907820879, 0.0001278479257991573, 0.5399917297063185, 0.0001281250764024933, 0.13541222892062266, 0.00012770264826318726, 0.00012745990271482993, 0.21977179394111662, 0.83099118203559, 0.08530710824803182, -9.999872098738788, -9.999872341346672, -9.999877685086322, 0.00012859291343912132, 0.00012318539606548582, 0.00012799457887977447, -19.999877383203174, 1.018521785851916], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 26, 25, 24, 24, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 25, 26, 25, 24, 25, 26, 25, 25, 25, 26, 25, 25, 26, 24, 25, 24, 25, 25, 24, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 26, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 24, 26, 26, 25, 25, 24, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.94835026021923, "mean_inference_ms": 2.1072877714876386, "mean_action_processing_ms": 0.14422495841570093, "mean_env_wait_ms": 1.0219469772550227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010141134262084961, "StateBufferConnector_ms": 0.00673985481262207, "ViewRequirementAgentConnector_ms": 0.17560601234436035}}, "episode_reward_max": 7.51477217502984, "episode_reward_min": -19.999877383203174, "episode_reward_mean": -1.5594199898884704, "episode_len_mean": 24.89, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00013177765587802832, 0.00013145938368312726, 0.00013110923145263437, -9.999869210770337, 0.6186147949151813, 0.00013139567807773326, 0.0001310792461312433, 0.000130731113311842, 0.0001304129251573233, 0.00013004972319010047, 0.5648342092089105, 0.00013127686717289533, 0.00013092768525481389, -9.999869391432114, 0.00013024424982430378, 0.00013191390373645302, 0.00013161226759462118, -9.999868744240617, 0.0001309399727598569, 0.0001305925783468561, 0.06357971386073273, 0.0001290698337091918, -9.999871271461735, 0.00012843372071370024, 0.00012303322309630663, 0.00012433056251714102, 0.0001291605251494305, 0.06718880769304869, 0.18835936397493222, 0.00012314507959250792, 0.00012958879561783768, 0.00012924472700316875, 0.00012894756965918657, 0.0001235244104838127, 0.3510488234873934, 0.00012925301719953007, 4.046472916889875, 0.0001286156611395427, 0.00012320714061844952, 0.00012801711536859873, 0.00012488201688688, 0.00012973184487947176, 0.04789563635011374, 0.0001291283419466877, 0.7736852899658476, 0.7014865178112016, 0.00012936363965753076, 0.00012902076405858678, 0.000128724634501807, 0.000123311308152608, 0.0001247094635804643, 0.00012955307706009753, -9.999870790028051, 0.00012891220366363624, 0.17642986100114558, 0.00013027506339724308, -9.99987008734521, -9.246560482577223, 0.6089497398024181, 7.51477217502984, -9.99987216311065, -9.99987753443669, 0.0001274059393800712, -9.999872835654731, 0.00012184022880282361, 0.0001279527940291806, 0.00012257679942266633, 0.00012752108953179722, 0.00012727903302338969, 0.00012194992560785003, 0.00012295864201833628, -8.685946420576679, 0.00012767591554255442, 1.0171190627946964, 0.00012709996644155627, 2.2921671618747657, 0.11819777038314416, 0.00012735627178807554, 0.0001220237862250438, 0.00012677515996576216, -9.99987147140503, 0.00012312642645801586, -9.999871907820879, 0.0001278479257991573, 0.5399917297063185, 0.0001281250764024933, 0.13541222892062266, 0.00012770264826318726, 0.00012745990271482993, 0.21977179394111662, 0.83099118203559, 0.08530710824803182, -9.999872098738788, -9.999872341346672, -9.999877685086322, 0.00012859291343912132, 0.00012318539606548582, 0.00012799457887977447, -19.999877383203174, 1.018521785851916], "episode_lengths": [25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 26, 25, 25, 24, 25, 26, 25, 24, 24, 25, 25, 25, 24, 25, 25, 25, 24, 25, 25, 25, 25, 24, 25, 24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 25, 26, 25, 24, 25, 26, 25, 25, 25, 26, 25, 25, 26, 24, 25, 24, 25, 25, 24, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 26, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 24, 26, 26, 25, 25, 24, 25, 26, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 430.94835026021923, "mean_inference_ms": 2.1072877714876386, "mean_action_processing_ms": 0.14422495841570093, "mean_env_wait_ms": 1.0219469772550227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010141134262084961, "StateBufferConnector_ms": 0.00673985481262207, "ViewRequirementAgentConnector_ms": 0.17560601234436035}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 183300, "num_env_steps_sampled": 95000, "num_env_steps_trained": 183300, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 3.8870348188010304, "num_env_steps_trained_throughput_per_sec": 7.57971789666201, "timesteps_total": 95000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 95000, "timers": {"training_iteration_time_ms": 11161.35, "sample_time_ms": 11097.347, "load_time_ms": 0.234, "load_throughput": 332745.842, "learn_time_ms": 12.802, "learn_throughput": 6093.023, "synch_weights_time_ms": 11.194}, "counters": {"num_env_steps_sampled": 95000, "num_env_steps_trained": 183300, "num_agent_steps_sampled": 95000, "num_agent_steps_trained": 183300, "last_target_update_ts": 94640, "num_target_updates": 181}, "done": false, "episodes_total": 3720, "training_iteration": 95, "trial_id": "2058a_00000", "date": "2024-04-17_11-28-59", "timestamp": 1713353339, "time_this_iter_s": 257.27607679367065, "time_total_s": 22111.463146686554, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 22111.463146686554, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 11.660655737704918, "ram_util_percent": 23.14808743169398}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.061163514852523804, "cur_lr": 0.01}, "td_error": [1.1526696681976318, 3.363826274871826, 1.1526696681976318, 1.1526694297790527, 3.363826036453247, 3.363722801208496, 1.1526702642440796, 1.1526696681976318, 1.1526703834533691, 1.1526708602905273, 1.1526703834533691, 1.1526710987091064, 0.8166084289550781, 1.1526706218719482, 1.1526705026626587, 2.0967628955841064, 1.2970306873321533, 1.1526708602905273, 1.1526696681976318, 0.8166088461875916, 1.1526696681976318, 1.9038989543914795, 1.1526697874069214, 1.15267014503479, 1.1526700258255005, 1.15267014503479, 1.1526695489883423, 1.1526695489883423, 1.15267014503479, 1.1526696681976318, 1.1526708602905273, 0.8166080117225647, 0.9157462120056152, 1.1526700258255005, 1.1526703834533691, 1.152669906616211, 1.1526713371276855, 1.1526705026626587, 1.1526700258255005, 1.1526703834533691, 1.1526696681976318, 1.1526696681976318, 0.8166080713272095, 1.1526694297790527, 1.1526700258255005, 1.1526713371276855, 1.1526696681976318, 1.1526702642440796, 1.1526706218719482, 1.1526703834533691, 1.1526696681976318, 1.1526700258255005, 1.15267014503479, 1.1526708602905273, 1.152669906616211, 1.1526696681976318, 1.1526708602905273, 1.1526696681976318, 0.8166079521179199, 1.1526695489883423, 1.1526696681976318, 1.1526694297790527, 1.1526696681976318, 1.1526695489883423, 1.15267014503479, 1.152671456336975, 0.8166079521179199, 0.8166078925132751, 0.8166079521179199, 1.1526695489883423, 1.152671456336975, 1.1526695489883423, 1.15267014503479, 1.15267014503479, 1.15267014503479, 0.816608190536499, 1.15267014503479, 1.1526696681976318], "mean_td_error": 1.2194850444793701, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2375.0, "diff_num_grad_updates_vs_sampler_policy": 2374.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 185250, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 185250, "last_target_update_ts": 95680, "num_target_updates": 183}, "sampler_results": {"episode_reward_max": 7.51477217502984, "episode_reward_min": -19.999877383203174, "episode_reward_mean": -2.499412230444514, "episode_len_mean": 25.03, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00012488201688688, 0.00012973184487947176, 0.04789563635011374, 0.0001291283419466877, 0.7736852899658476, 0.7014865178112016, 0.00012936363965753076, 0.00012902076405858678, 0.000128724634501807, 0.000123311308152608, 0.0001247094635804643, 0.00012955307706009753, -9.999870790028051, 0.00012891220366363624, 0.17642986100114558, 0.00013027506339724308, -9.99987008734521, -9.246560482577223, 0.6089497398024181, 7.51477217502984, -9.99987216311065, -9.99987753443669, 0.0001274059393800712, -9.999872835654731, 0.00012184022880282361, 0.0001279527940291806, 0.00012257679942266633, 0.00012752108953179722, 0.00012727903302338969, 0.00012194992560785003, 0.00012295864201833628, -8.685946420576679, 0.00012767591554255442, 1.0171190627946964, 0.00012709996644155627, 2.2921671618747657, 0.11819777038314416, 0.00012735627178807554, 0.0001220237862250438, 0.00012677515996576216, -9.99987147140503, 0.00012312642645801586, -9.999871907820879, 0.0001278479257991573, 0.5399917297063185, 0.0001281250764024933, 0.13541222892062266, 0.00012770264826318726, 0.00012745990271482993, 0.21977179394111662, 0.83099118203559, 0.08530710824803182, -9.999872098738788, -9.999872341346672, -9.999877685086322, 0.00012859291343912132, 0.00012318539606548582, 0.00012799457887977447, -19.999877383203174, 1.018521785851916, 0.3049485333413563, 0.00012630384362955185, 0.00012600106101919904, -9.999874260293911, 0.06067393062772778, 0.00012669862423809832, 0.00012641160533973818, -9.999873891491658, -9.999874153493117, 0.00012557480516705045, 0.00012681112831669907, 0.00012650591172281127, 0.5433810333821131, -9.99987402717031, 0.060066584949741895, 0.00012648779458446528, -19.999873815046655, -9.999874076978664, 0.06067410491243504, 0.00012538527453948643, -9.959581420475143, 0.28553320759173495, -9.931035865350761, 0.00012646852522340188, 0.00012619415946220634, 0.00012688601311203857, 0.08531083747790473, 0.00012630705250327138, -9.881444815835726, 0.00012578421448304313, 0.09525909052158688, -9.999873196800797, 0.00012649799517190256, 0.11855536671045863, 0.00012597357840271473, -19.940605843464724, 0.00012201519201891676, 0.00012676625450405482, 0.000126478929449167, 0.0001261753078645268], "episode_lengths": [24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 25, 26, 25, 24, 25, 26, 25, 25, 25, 26, 25, 25, 26, 24, 25, 24, 25, 25, 24, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 26, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 24, 26, 26, 25, 25, 24, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 27, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 27, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.0759307980401, "mean_inference_ms": 2.1067430538971994, "mean_action_processing_ms": 0.14419699075732675, "mean_env_wait_ms": 1.0124567113258962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010209321975708008, "StateBufferConnector_ms": 0.006746530532836914, "ViewRequirementAgentConnector_ms": 0.17461061477661133}}, "episode_reward_max": 7.51477217502984, "episode_reward_min": -19.999877383203174, "episode_reward_mean": -2.499412230444514, "episode_len_mean": 25.03, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00012488201688688, 0.00012973184487947176, 0.04789563635011374, 0.0001291283419466877, 0.7736852899658476, 0.7014865178112016, 0.00012936363965753076, 0.00012902076405858678, 0.000128724634501807, 0.000123311308152608, 0.0001247094635804643, 0.00012955307706009753, -9.999870790028051, 0.00012891220366363624, 0.17642986100114558, 0.00013027506339724308, -9.99987008734521, -9.246560482577223, 0.6089497398024181, 7.51477217502984, -9.99987216311065, -9.99987753443669, 0.0001274059393800712, -9.999872835654731, 0.00012184022880282361, 0.0001279527940291806, 0.00012257679942266633, 0.00012752108953179722, 0.00012727903302338969, 0.00012194992560785003, 0.00012295864201833628, -8.685946420576679, 0.00012767591554255442, 1.0171190627946964, 0.00012709996644155627, 2.2921671618747657, 0.11819777038314416, 0.00012735627178807554, 0.0001220237862250438, 0.00012677515996576216, -9.99987147140503, 0.00012312642645801586, -9.999871907820879, 0.0001278479257991573, 0.5399917297063185, 0.0001281250764024933, 0.13541222892062266, 0.00012770264826318726, 0.00012745990271482993, 0.21977179394111662, 0.83099118203559, 0.08530710824803182, -9.999872098738788, -9.999872341346672, -9.999877685086322, 0.00012859291343912132, 0.00012318539606548582, 0.00012799457887977447, -19.999877383203174, 1.018521785851916, 0.3049485333413563, 0.00012630384362955185, 0.00012600106101919904, -9.999874260293911, 0.06067393062772778, 0.00012669862423809832, 0.00012641160533973818, -9.999873891491658, -9.999874153493117, 0.00012557480516705045, 0.00012681112831669907, 0.00012650591172281127, 0.5433810333821131, -9.99987402717031, 0.060066584949741895, 0.00012648779458446528, -19.999873815046655, -9.999874076978664, 0.06067410491243504, 0.00012538527453948643, -9.959581420475143, 0.28553320759173495, -9.931035865350761, 0.00012646852522340188, 0.00012619415946220634, 0.00012688601311203857, 0.08531083747790473, 0.00012630705250327138, -9.881444815835726, 0.00012578421448304313, 0.09525909052158688, -9.999873196800797, 0.00012649799517190256, 0.11855536671045863, 0.00012597357840271473, -19.940605843464724, 0.00012201519201891676, 0.00012676625450405482, 0.000126478929449167, 0.0001261753078645268], "episode_lengths": [24, 25, 25, 25, 24, 24, 25, 25, 25, 24, 24, 25, 26, 25, 24, 25, 26, 25, 25, 25, 26, 25, 25, 26, 24, 25, 24, 25, 25, 24, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 26, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 24, 26, 26, 25, 25, 24, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 27, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 27, 24, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.0759307980401, "mean_inference_ms": 2.1067430538971994, "mean_action_processing_ms": 0.14419699075732675, "mean_env_wait_ms": 1.0124567113258962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010209321975708008, "StateBufferConnector_ms": 0.006746530532836914, "ViewRequirementAgentConnector_ms": 0.17461061477661133}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 185250, "num_env_steps_sampled": 96000, "num_env_steps_trained": 185250, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.230897365555582, "num_env_steps_trained_throughput_per_sec": 8.250249862833385, "timesteps_total": 96000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9056.614, "sample_time_ms": 8991.11, "load_time_ms": 0.249, "load_throughput": 313607.853, "learn_time_ms": 13.566, "learn_throughput": 5749.61, "synch_weights_time_ms": 11.638}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 185250, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 185250, "last_target_update_ts": 95680, "num_target_updates": 183}, "done": false, "episodes_total": 3760, "training_iteration": 96, "trial_id": "2058a_00000", "date": "2024-04-17_11-32-56", "timestamp": 1713353576, "time_this_iter_s": 236.36701273918152, "time_total_s": 22347.830159425735, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 22347.830159425735, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 12.720833333333333, "ram_util_percent": 23.233630952380953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.021381523460149765, "cur_lr": 0.01}, "td_error": [1.166582703590393, 0.8188361525535583, 1.1665828227996826, 1.1665831804275513, 1.3849130868911743, 0.8188360333442688, 1.1665830612182617, 1.1665830612182617, 1.1665828227996826, 1.1665830612182617, 0.818835973739624, 1.1665828227996826, 1.166582703590393, 1.1665830612182617, 1.1665828227996826, 1.1665828227996826, 1.1665830612182617, 3.3380162715911865, 1.1665832996368408, 1.1665831804275513, 1.1665836572647095, 1.1665828227996826, 1.1665830612182617, 1.1665830612182617, 1.1665829420089722, 1.1665831804275513, 1.1665829420089722, 1.1665828227996826, 1.1665836572647095, 3.3380167484283447, 1.1665834188461304, 1.1665831804275513, 1.1665828227996826, 1.1665838956832886, 1.166582703590393, 1.1665828227996826, 1.1665840148925781, 0.8188360929489136, 0.818835973739624, 1.1665834188461304, 1.1665834188461304, 1.1665834188461304, 1.1665830612182617, 1.1665832996368408, 1.1665830612182617, 1.1665830612182617, 1.1665834188461304, 1.1665829420089722, 1.1665829420089722, 1.166582703590393, 1.166582703590393, 1.1665828227996826, 1.1665828227996826, 1.1665834188461304, 1.1665831804275513, 1.1665832996368408, 0.8188360333442688, 1.1665828227996826, 1.1665829420089722, 1.1665830612182617, 1.1665830612182617, 1.1665832996368408, 1.166582703590393, 1.1665831804275513, 1.16658353805542, 1.1665828227996826, 1.166582703590393, 1.1665829420089722, 1.1665829420089722, 1.1665829420089722, 1.1665828227996826, 1.1665829420089722, 1.1665828227996826, 1.1783287525177002, 1.1665831804275513, 1.1665831804275513, 1.166582703590393, 1.166582703590393], "mean_td_error": 1.1984608173370361, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2400.0, "diff_num_grad_updates_vs_sampler_policy": 2399.0}}, "num_env_steps_sampled": 97000, "num_env_steps_trained": 187200, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 187200, "last_target_update_ts": 96720, "num_target_updates": 185}, "sampler_results": {"episode_reward_max": 1.2841891435383297, "episode_reward_min": -19.999877383203174, "episode_reward_mean": -2.5957494264623646, "episode_len_mean": 25.18, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.99987147140503, 0.00012312642645801586, -9.999871907820879, 0.0001278479257991573, 0.5399917297063185, 0.0001281250764024933, 0.13541222892062266, 0.00012770264826318726, 0.00012745990271482993, 0.21977179394111662, 0.83099118203559, 0.08530710824803182, -9.999872098738788, -9.999872341346672, -9.999877685086322, 0.00012859291343912132, 0.00012318539606548582, 0.00012799457887977447, -19.999877383203174, 1.018521785851916, 0.3049485333413563, 0.00012630384362955185, 0.00012600106101919904, -9.999874260293911, 0.06067393062772778, 0.00012669862423809832, 0.00012641160533973818, -9.999873891491658, -9.999874153493117, 0.00012557480516705045, 0.00012681112831669907, 0.00012650591172281127, 0.5433810333821131, -9.99987402717031, 0.060066584949741895, 0.00012648779458446528, -19.999873815046655, -9.999874076978664, 0.06067410491243504, 0.00012538527453948643, -9.959581420475143, 0.28553320759173495, -9.931035865350761, 0.00012646852522340188, 0.00012619415946220634, 0.00012688601311203857, 0.08531083747790473, 0.00012630705250327138, -9.881444815835726, 0.00012578421448304313, 0.09525909052158688, -9.999873196800797, 0.00012649799517190256, 0.11855536671045863, 0.00012597357840271473, -19.940605843464724, 0.00012201519201891676, 0.00012676625450405482, 0.000126478929449167, 0.0001261753078645268, 0.06905800591053685, -9.99987503446857, 0.0001247009844435223, 0.00012439010407933488, 0.00012405809927644795, 0.7085719837250605, 0.00012503046616849323, 0.00012476566936056683, -6.905613525484359, 0.00012412275142030483, 1.2841891435383297, 0.00012518500186625237, 0.052351587379332105, 0.00012456575728966106, 0.00012430447714300704, 0.00012512053889623476, 0.000124855360833874, 0.060186026522326054, 0.00012423936513371152, -9.99987602052429, 0.00012590995394403846, 0.000125643000445863, -19.99987462434411, 0.00012506135703517366, 0.00012472576385217615, 0.16072826660468992, 0.0001252474965819972, 0.0001249817806760234, -9.99987533047454, 0.00012433600453346175, 0.0001256903644676482, 0.06718555513036883, 0.00012517596293353789, 0.07724478247437798, 0.0001245460908350553, 0.11050287592775304, 0.0001256547400129734, 0.0001253729563036716, 0.0001251082726195116, -9.999875156828624], "episode_lengths": [26, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 24, 26, 26, 25, 25, 24, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 27, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 27, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.19919050040016, "mean_inference_ms": 2.1063941131410355, "mean_action_processing_ms": 0.1441800967041714, "mean_env_wait_ms": 1.0031624981422351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009963274002075195, "StateBufferConnector_ms": 0.006432056427001953, "ViewRequirementAgentConnector_ms": 0.17635631561279297}}, "episode_reward_max": 1.2841891435383297, "episode_reward_min": -19.999877383203174, "episode_reward_mean": -2.5957494264623646, "episode_len_mean": 25.18, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.99987147140503, 0.00012312642645801586, -9.999871907820879, 0.0001278479257991573, 0.5399917297063185, 0.0001281250764024933, 0.13541222892062266, 0.00012770264826318726, 0.00012745990271482993, 0.21977179394111662, 0.83099118203559, 0.08530710824803182, -9.999872098738788, -9.999872341346672, -9.999877685086322, 0.00012859291343912132, 0.00012318539606548582, 0.00012799457887977447, -19.999877383203174, 1.018521785851916, 0.3049485333413563, 0.00012630384362955185, 0.00012600106101919904, -9.999874260293911, 0.06067393062772778, 0.00012669862423809832, 0.00012641160533973818, -9.999873891491658, -9.999874153493117, 0.00012557480516705045, 0.00012681112831669907, 0.00012650591172281127, 0.5433810333821131, -9.99987402717031, 0.060066584949741895, 0.00012648779458446528, -19.999873815046655, -9.999874076978664, 0.06067410491243504, 0.00012538527453948643, -9.959581420475143, 0.28553320759173495, -9.931035865350761, 0.00012646852522340188, 0.00012619415946220634, 0.00012688601311203857, 0.08531083747790473, 0.00012630705250327138, -9.881444815835726, 0.00012578421448304313, 0.09525909052158688, -9.999873196800797, 0.00012649799517190256, 0.11855536671045863, 0.00012597357840271473, -19.940605843464724, 0.00012201519201891676, 0.00012676625450405482, 0.000126478929449167, 0.0001261753078645268, 0.06905800591053685, -9.99987503446857, 0.0001247009844435223, 0.00012439010407933488, 0.00012405809927644795, 0.7085719837250605, 0.00012503046616849323, 0.00012476566936056683, -6.905613525484359, 0.00012412275142030483, 1.2841891435383297, 0.00012518500186625237, 0.052351587379332105, 0.00012456575728966106, 0.00012430447714300704, 0.00012512053889623476, 0.000124855360833874, 0.060186026522326054, 0.00012423936513371152, -9.99987602052429, 0.00012590995394403846, 0.000125643000445863, -19.99987462434411, 0.00012506135703517366, 0.00012472576385217615, 0.16072826660468992, 0.0001252474965819972, 0.0001249817806760234, -9.99987533047454, 0.00012433600453346175, 0.0001256903644676482, 0.06718555513036883, 0.00012517596293353789, 0.07724478247437798, 0.0001245460908350553, 0.11050287592775304, 0.0001256547400129734, 0.0001253729563036716, 0.0001251082726195116, -9.999875156828624], "episode_lengths": [26, 24, 26, 25, 24, 25, 24, 25, 25, 24, 25, 24, 26, 26, 25, 25, 24, 25, 26, 25, 25, 25, 25, 26, 25, 25, 25, 26, 26, 25, 25, 25, 25, 26, 25, 25, 27, 26, 25, 25, 26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 27, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.19919050040016, "mean_inference_ms": 2.1063941131410355, "mean_action_processing_ms": 0.1441800967041714, "mean_env_wait_ms": 1.0031624981422351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009963274002075195, "StateBufferConnector_ms": 0.006432056427001953, "ViewRequirementAgentConnector_ms": 0.17635631561279297}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 187200, "num_env_steps_sampled": 97000, "num_env_steps_trained": 187200, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.06446341162295, "num_env_steps_trained_throughput_per_sec": 7.925703652664752, "timesteps_total": 97000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 97000, "timers": {"training_iteration_time_ms": 11227.928, "sample_time_ms": 11161.215, "load_time_ms": 0.224, "load_throughput": 348075.021, "learn_time_ms": 12.46, "learn_throughput": 6259.844, "synch_weights_time_ms": 13.393}, "counters": {"num_env_steps_sampled": 97000, "num_env_steps_trained": 187200, "num_agent_steps_sampled": 97000, "num_agent_steps_trained": 187200, "last_target_update_ts": 96720, "num_target_updates": 185}, "done": false, "episodes_total": 3800, "training_iteration": 97, "trial_id": "2058a_00000", "date": "2024-04-17_11-37-02", "timestamp": 1713353822, "time_this_iter_s": 246.04546356201172, "time_total_s": 22593.875622987747, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 22593.875622987747, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 12.136857142857142, "ram_util_percent": 23.37257142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0389329195022583, "cur_lr": 0.01}, "td_error": [1.1628671884536743, 1.1628669500350952, 1.1628670692443848, 1.1628670692443848, 1.1628670692443848, 1.1628670692443848, 1.1628670692443848, 1.1628671884536743, 1.1628671884536743, 1.1628667116165161, 1.1628670692443848, 1.6027660369873047, 0.825251579284668, 0.8252511024475098, 1.1628670692443848, 0.8252513408660889, 1.1628670692443848, 1.1628671884536743, 1.1628670692443848, 0.8252513408660889, 1.1628668308258057, 1.1628671884536743, 1.1628668308258057, 1.1628670692443848, 0.825251579284668, 1.1628671884536743, 1.1628669500350952, 0.8252516984939575, 1.1628670692443848, 1.1628670692443848, 1.1628670692443848, 1.1628670692443848, 1.1628670692443848, 1.1628669500350952, 1.1628670692443848, 1.1628670692443848, 0.8252514600753784, 0.8252512812614441, 1.1628671884536743, 1.1628670692443848, 1.1628670692443848, 1.1628673076629639, 1.1628670692443848, 1.1628670692443848, 1.1628670692443848, 0.8252516984939575, 1.1628670692443848, 0.8252512812614441, 0.8252513408660889, 1.1628670692443848, 1.1628671884536743, 1.1628671884536743, 1.1628670692443848, 1.1628671884536743, 1.1628670692443848, 1.1628671884536743, 0.8252516984939575, 1.1628671884536743, 1.1628673076629639, 1.1628671884536743, 2.237555742263794, 1.1628671884536743, 1.1628670692443848, 1.1628671884536743, 1.1628671884536743, 1.1628671884536743, 1.1627334356307983, 1.1628671884536743, 1.1628671884536743, 1.1628670692443848, 1.1628670692443848, 0.825251579284668, 1.1628671884536743, 1.1628670692443848, 1.1628670692443848, 1.1628669500350952, 2.8476574420928955, 1.1628671884536743], "mean_td_error": 1.147613763809204, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2425.0, "diff_num_grad_updates_vs_sampler_policy": 2424.0}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 189150, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 189150, "last_target_update_ts": 97760, "num_target_updates": 187}, "sampler_results": {"episode_reward_max": 2.9974044307229724, "episode_reward_min": -19.99987462434411, "episode_reward_mean": -1.6922946672669124, "episode_len_mean": 25.01, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.959581420475143, 0.28553320759173495, -9.931035865350761, 0.00012646852522340188, 0.00012619415946220634, 0.00012688601311203857, 0.08531083747790473, 0.00012630705250327138, -9.881444815835726, 0.00012578421448304313, 0.09525909052158688, -9.999873196800797, 0.00012649799517190256, 0.11855536671045863, 0.00012597357840271473, -19.940605843464724, 0.00012201519201891676, 0.00012676625450405482, 0.000126478929449167, 0.0001261753078645268, 0.06905800591053685, -9.99987503446857, 0.0001247009844435223, 0.00012439010407933488, 0.00012405809927644795, 0.7085719837250605, 0.00012503046616849323, 0.00012476566936056683, -6.905613525484359, 0.00012412275142030483, 1.2841891435383297, 0.00012518500186625237, 0.052351587379332105, 0.00012456575728966106, 0.00012430447714300704, 0.00012512053889623476, 0.000124855360833874, 0.060186026522326054, 0.00012423936513371152, -9.99987602052429, 0.00012590995394403846, 0.000125643000445863, -19.99987462434411, 0.00012506135703517366, 0.00012472576385217615, 0.16072826660468992, 0.0001252474965819972, 0.0001249817806760234, -9.99987533047454, 0.00012433600453346175, 0.0001256903644676482, 0.06718555513036883, 0.00012517596293353789, 0.07724478247437798, 0.0001245460908350553, 0.11050287592775304, 0.0001256547400129734, 0.0001253729563036716, 0.0001251082726195116, -9.999875156828624, 0.06709877763095386, 2.9974044307229724, 0.00012336294844408368, 0.00012311784901531308, 0.9278523470842684, -9.999876136650805, 0.00011373527232598007, -9.999876600321862, 0.0001231544086066827, 0.00012292356151994408, 0.00011413957152680524, 0.00012383750385974455, 0.0001235905170145807, 0.00012335803359791536, 0.12288415611678517, -9.999886158182477, 0.00012351491207339202, 0.00012326920903653278, 0.00012303793176449092, 0.0001228096776330144, 0.00012446381269016305, 0.00011428559502249393, 0.0001239956437643809, 0.0001237480263554351, 0.0001235149505273117, 0.0001240756863929245, 0.0001139298943589331, 0.00012361042727565286, 0.00012336434446787246, 0.00012313271039720658, 0.0001242848931038308, 0.00011412162363100364, 0.00012381806667269922, -9.999876428818345, 0.00012333874662130923, 0.0001245315578696659, 0.00012419879848394355, 0.00012393905399930686, -9.999886194387841, 0.08938063988189432], "episode_lengths": [26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 27, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 26, 23, 26, 25, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.31288184689384, "mean_inference_ms": 2.1060325820237904, "mean_action_processing_ms": 0.14416261592702276, "mean_env_wait_ms": 0.994049830980556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010128259658813477, "StateBufferConnector_ms": 0.0063173770904541016, "ViewRequirementAgentConnector_ms": 0.1750342845916748}}, "episode_reward_max": 2.9974044307229724, "episode_reward_min": -19.99987462434411, "episode_reward_mean": -1.6922946672669124, "episode_len_mean": 25.01, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.959581420475143, 0.28553320759173495, -9.931035865350761, 0.00012646852522340188, 0.00012619415946220634, 0.00012688601311203857, 0.08531083747790473, 0.00012630705250327138, -9.881444815835726, 0.00012578421448304313, 0.09525909052158688, -9.999873196800797, 0.00012649799517190256, 0.11855536671045863, 0.00012597357840271473, -19.940605843464724, 0.00012201519201891676, 0.00012676625450405482, 0.000126478929449167, 0.0001261753078645268, 0.06905800591053685, -9.99987503446857, 0.0001247009844435223, 0.00012439010407933488, 0.00012405809927644795, 0.7085719837250605, 0.00012503046616849323, 0.00012476566936056683, -6.905613525484359, 0.00012412275142030483, 1.2841891435383297, 0.00012518500186625237, 0.052351587379332105, 0.00012456575728966106, 0.00012430447714300704, 0.00012512053889623476, 0.000124855360833874, 0.060186026522326054, 0.00012423936513371152, -9.99987602052429, 0.00012590995394403846, 0.000125643000445863, -19.99987462434411, 0.00012506135703517366, 0.00012472576385217615, 0.16072826660468992, 0.0001252474965819972, 0.0001249817806760234, -9.99987533047454, 0.00012433600453346175, 0.0001256903644676482, 0.06718555513036883, 0.00012517596293353789, 0.07724478247437798, 0.0001245460908350553, 0.11050287592775304, 0.0001256547400129734, 0.0001253729563036716, 0.0001251082726195116, -9.999875156828624, 0.06709877763095386, 2.9974044307229724, 0.00012336294844408368, 0.00012311784901531308, 0.9278523470842684, -9.999876136650805, 0.00011373527232598007, -9.999876600321862, 0.0001231544086066827, 0.00012292356151994408, 0.00011413957152680524, 0.00012383750385974455, 0.0001235905170145807, 0.00012335803359791536, 0.12288415611678517, -9.999886158182477, 0.00012351491207339202, 0.00012326920903653278, 0.00012303793176449092, 0.0001228096776330144, 0.00012446381269016305, 0.00011428559502249393, 0.0001239956437643809, 0.0001237480263554351, 0.0001235149505273117, 0.0001240756863929245, 0.0001139298943589331, 0.00012361042727565286, 0.00012336434446787246, 0.00012313271039720658, 0.0001242848931038308, 0.00011412162363100364, 0.00012381806667269922, -9.999876428818345, 0.00012333874662130923, 0.0001245315578696659, 0.00012419879848394355, 0.00012393905399930686, -9.999886194387841, 0.08938063988189432], "episode_lengths": [26, 25, 26, 25, 25, 25, 25, 25, 26, 25, 25, 26, 25, 25, 25, 27, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 26, 23, 26, 25, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 24, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.31288184689384, "mean_inference_ms": 2.1060325820237904, "mean_action_processing_ms": 0.14416261592702276, "mean_env_wait_ms": 0.994049830980556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010128259658813477, "StateBufferConnector_ms": 0.0063173770904541016, "ViewRequirementAgentConnector_ms": 0.1750342845916748}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 189150, "num_env_steps_sampled": 98000, "num_env_steps_trained": 189150, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.2689146777265465, "num_env_steps_trained_throughput_per_sec": 8.324383621566765, "timesteps_total": 98000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 8792.736, "sample_time_ms": 8730.589, "load_time_ms": 0.23, "load_throughput": 339549.26, "learn_time_ms": 12.922, "learn_throughput": 6036.44, "synch_weights_time_ms": 11.682}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 189150, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 189150, "last_target_update_ts": 97760, "num_target_updates": 187}, "done": false, "episodes_total": 3840, "training_iteration": 98, "trial_id": "2058a_00000", "date": "2024-04-17_11-40-56", "timestamp": 1713354056, "time_this_iter_s": 234.26045179367065, "time_total_s": 22828.136074781418, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 22828.136074781418, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 12.733333333333336, "ram_util_percent": 23.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.04989682883024216, "cur_lr": 0.01}, "td_error": [1.1397664546966553, 1.1397665739059448, 1.139765739440918, 1.1397666931152344, 1.1397658586502075, 1.1397663354873657, 1.1397664546966553, 1.1397663354873657, 1.1397664546966553, 1.1397660970687866, 1.1397658586502075, 1.139766812324524, 1.1397664546966553, 0.8157976865768433, 1.1397665739059448, 1.139766812324524, 1.1397664546966553, 1.1397658586502075, 1.1397652626037598, 1.1377899646759033, 1.1397666931152344, 1.1397663354873657, 1.139765739440918, 0.7765978574752808, 1.1397664546966553, 1.1397663354873657, 1.1397663354873657, 0.8157969117164612, 1.1397666931152344, 1.1397665739059448, 1.139765977859497, 1.1397660970687866, 1.1397645473480225, 0.8157976269721985, 1.1397653818130493, 1.1397664546966553, 1.1397653818130493, 1.139765739440918, 1.1397664546966553, 1.1397663354873657, 1.1397664546966553, 1.1397645473480225, 0.8157964944839478, 1.1397666931152344, 1.1397663354873657, 1.1397665739059448, 0.8157972097396851, 1.1397664546966553, 1.139765739440918, 1.1397660970687866, 1.1397666931152344, 1.1397649049758911, 1.139765977859497, 1.1397666931152344, 1.1397665739059448, 1.1397660970687866, 1.1397664546966553, 1.1397658586502075, 1.1397660970687866, 1.1397664546966553, 1.1397664546966553, 1.1397664546966553, 1.1397665739059448, 1.1397664546966553, 1.1397662162780762, 1.1397666931152344, 1.1397647857666016, 1.1397666931152344, 1.1397665739059448, 1.1397664546966553, 1.1397660970687866, 1.1397660970687866, 0.8157969117164612, 1.1397664546966553, 1.1397658586502075, 1.139765977859497, 0.8157973289489746, 1.1397664546966553], "mean_td_error": 1.1060106754302979, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2450.0, "diff_num_grad_updates_vs_sampler_policy": 2449.0}}, "num_env_steps_sampled": 99000, "num_env_steps_trained": 191100, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 191100, "last_target_update_ts": 98800, "num_target_updates": 189}, "sampler_results": {"episode_reward_max": 3.2471881663233364, "episode_reward_min": -19.99987462434411, "episode_reward_mean": -1.1956933630604825, "episode_len_mean": 24.97, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00012590995394403846, 0.000125643000445863, -19.99987462434411, 0.00012506135703517366, 0.00012472576385217615, 0.16072826660468992, 0.0001252474965819972, 0.0001249817806760234, -9.99987533047454, 0.00012433600453346175, 0.0001256903644676482, 0.06718555513036883, 0.00012517596293353789, 0.07724478247437798, 0.0001245460908350553, 0.11050287592775304, 0.0001256547400129734, 0.0001253729563036716, 0.0001251082726195116, -9.999875156828624, 0.06709877763095386, 2.9974044307229724, 0.00012336294844408368, 0.00012311784901531308, 0.9278523470842684, -9.999876136650805, 0.00011373527232598007, -9.999876600321862, 0.0001231544086066827, 0.00012292356151994408, 0.00011413957152680524, 0.00012383750385974455, 0.0001235905170145807, 0.00012335803359791536, 0.12288415611678517, -9.999886158182477, 0.00012351491207339202, 0.00012326920903653278, 0.00012303793176449092, 0.0001228096776330144, 0.00012446381269016305, 0.00011428559502249393, 0.0001239956437643809, 0.0001237480263554351, 0.0001235149505273117, 0.0001240756863929245, 0.0001139298943589331, 0.00012361042727565286, 0.00012336434446787246, 0.00012313271039720658, 0.0001242848931038308, 0.00011412162363100364, 0.00012381806667269922, -9.999876428818345, 0.00012333874662130923, 0.0001245315578696659, 0.00012419879848394355, 0.00012393905399930686, -9.999886194387841, 0.08938063988189432, 0.00012266096967338255, 0.00012238590054412053, 0.0001221420450203624, -9.9998780984995, 0.00012165363135876062, 0.00012269573113352444, 0.00012242050625405258, 0.00012217651293964455, 0.00012193574559185532, 0.40747655051529125, 0.00012286422046362856, 0.10195765043129516, 0.0001223896577134059, 0.00012213988888619943, 0.00012186175267744644, -9.999877466034064, 0.0001222894966459372, 0.00012204828424702298, 0.00012179990541096244, 0.00012152331366075683, 0.0001232849247903481, 0.00012300705331311958, 3.2471881663233364, -9.999877482466998, 0.0001222677879705757, 0.00012290410481041915, 1.990130186813828, 0.00012239043362436544, 0.00012214882328042556, 0.00012190003547557783, 0.05308460744892997, 0.0001228666341169977, 0.00012262086096302103, 0.00012237834093053014, 0.0001221286182445899, 0.0001232477260313042, -9.999876983446518, 0.00012278835448693097, 0.00012251271438983626, 0.00012226835373774068], "episode_lengths": [25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 26, 23, 26, 25, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.41870285181517, "mean_inference_ms": 2.105647729640874, "mean_action_processing_ms": 0.1441419722473663, "mean_env_wait_ms": 0.9851175167148648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009758472442626953, "StateBufferConnector_ms": 0.0064144134521484375, "ViewRequirementAgentConnector_ms": 0.1766808032989502}}, "episode_reward_max": 3.2471881663233364, "episode_reward_min": -19.99987462434411, "episode_reward_mean": -1.1956933630604825, "episode_len_mean": 24.97, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00012590995394403846, 0.000125643000445863, -19.99987462434411, 0.00012506135703517366, 0.00012472576385217615, 0.16072826660468992, 0.0001252474965819972, 0.0001249817806760234, -9.99987533047454, 0.00012433600453346175, 0.0001256903644676482, 0.06718555513036883, 0.00012517596293353789, 0.07724478247437798, 0.0001245460908350553, 0.11050287592775304, 0.0001256547400129734, 0.0001253729563036716, 0.0001251082726195116, -9.999875156828624, 0.06709877763095386, 2.9974044307229724, 0.00012336294844408368, 0.00012311784901531308, 0.9278523470842684, -9.999876136650805, 0.00011373527232598007, -9.999876600321862, 0.0001231544086066827, 0.00012292356151994408, 0.00011413957152680524, 0.00012383750385974455, 0.0001235905170145807, 0.00012335803359791536, 0.12288415611678517, -9.999886158182477, 0.00012351491207339202, 0.00012326920903653278, 0.00012303793176449092, 0.0001228096776330144, 0.00012446381269016305, 0.00011428559502249393, 0.0001239956437643809, 0.0001237480263554351, 0.0001235149505273117, 0.0001240756863929245, 0.0001139298943589331, 0.00012361042727565286, 0.00012336434446787246, 0.00012313271039720658, 0.0001242848931038308, 0.00011412162363100364, 0.00012381806667269922, -9.999876428818345, 0.00012333874662130923, 0.0001245315578696659, 0.00012419879848394355, 0.00012393905399930686, -9.999886194387841, 0.08938063988189432, 0.00012266096967338255, 0.00012238590054412053, 0.0001221420450203624, -9.9998780984995, 0.00012165363135876062, 0.00012269573113352444, 0.00012242050625405258, 0.00012217651293964455, 0.00012193574559185532, 0.40747655051529125, 0.00012286422046362856, 0.10195765043129516, 0.0001223896577134059, 0.00012213988888619943, 0.00012186175267744644, -9.999877466034064, 0.0001222894966459372, 0.00012204828424702298, 0.00012179990541096244, 0.00012152331366075683, 0.0001232849247903481, 0.00012300705331311958, 3.2471881663233364, -9.999877482466998, 0.0001222677879705757, 0.00012290410481041915, 1.990130186813828, 0.00012239043362436544, 0.00012214882328042556, 0.00012190003547557783, 0.05308460744892997, 0.0001228666341169977, 0.00012262086096302103, 0.00012237834093053014, 0.0001221286182445899, 0.0001232477260313042, -9.999876983446518, 0.00012278835448693097, 0.00012251271438983626, 0.00012226835373774068], "episode_lengths": [25, 25, 27, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 23, 25, 25, 25, 26, 23, 26, 25, 25, 23, 25, 25, 25, 25, 24, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.41870285181517, "mean_inference_ms": 2.105647729640874, "mean_action_processing_ms": 0.1441419722473663, "mean_env_wait_ms": 0.9851175167148648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009758472442626953, "StateBufferConnector_ms": 0.0064144134521484375, "ViewRequirementAgentConnector_ms": 0.1766808032989502}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 191100, "num_env_steps_sampled": 99000, "num_env_steps_trained": 191100, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.452945421949948, "num_env_steps_trained_throughput_per_sec": 8.683243572802398, "timesteps_total": 99000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 99000, "timers": {"training_iteration_time_ms": 8917.019, "sample_time_ms": 8853.775, "load_time_ms": 0.231, "load_throughput": 337691.693, "learn_time_ms": 12.859, "learn_throughput": 6065.785, "synch_weights_time_ms": 11.576}, "counters": {"num_env_steps_sampled": 99000, "num_env_steps_trained": 191100, "num_agent_steps_sampled": 99000, "num_agent_steps_trained": 191100, "last_target_update_ts": 98800, "num_target_updates": 189}, "done": false, "episodes_total": 3880, "training_iteration": 99, "trial_id": "2058a_00000", "date": "2024-04-17_11-44-40", "timestamp": 1713354280, "time_this_iter_s": 224.57929372787476, "time_total_s": 23052.715368509293, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 23052.715368509293, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 13.215673981191227, "ram_util_percent": 23.57993730407523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0091053182259202, "cur_lr": 0.01}, "td_error": [1.1297087669372559, 1.1297088861465454, 1.1297088861465454, 0.8032434582710266, 1.1297087669372559, 1.1297087669372559, 1.1297088861465454, 1.1297087669372559, 1.1297088861465454, 1.1297087669372559, 1.1297088861465454, 1.1297087669372559, 0.8032435774803162, 1.1297087669372559, 1.1297088861465454, 1.218823790550232, 0.8032436370849609, 1.1297088861465454, 1.1297088861465454, 3.494960308074951, 1.1297087669372559, 1.1297087669372559, 1.1297087669372559, 0.8032436370849609, 1.129709005355835, 1.1297087669372559, 1.1297087669372559, 0.8032436966896057, 1.1297087669372559, 1.1297087669372559, 1.1297087669372559, 1.1297088861465454, 1.1297087669372559, 1.1297087669372559, 0.8032435774803162, 1.1297087669372559, 1.1297087669372559, 1.1297088861465454, 1.1297087669372559, 1.1297087669372559, 1.1297087669372559, 1.1297088861465454, 2.029169797897339, 1.1297088861465454, 1.1297088861465454, 0.8032433986663818, 1.1297087669372559, 0.8032435178756714, 1.1297087669372559, 1.1297087669372559, 1.1297087669372559, 1.1297088861465454, 1.1297088861465454, 1.1297087669372559, 0.8032435774803162, 1.1297088861465454, 0.8032435178756714, 1.1297087669372559, 1.1297088861465454, 1.1297087669372559, 1.1297087669372559, 1.1297088861465454, 0.8032435178756714, 1.1297087669372559, 1.1297087669372559, 1.1297087669372559, 0.8032435178756714, 1.1297087669372559, 1.1297087669372559, 1.1297087669372559, 1.1297087669372559, 1.1297087669372559, 0.8032433986663818, 1.1297088861465454, 0.8032435178756714, 1.1297087669372559, 1.1297088861465454, 1.1297087669372559], "mean_td_error": 1.1141102313995361, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 78.0, "num_grad_updates_lifetime": 2475.0, "diff_num_grad_updates_vs_sampler_policy": 2474.0}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 193050, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 193050, "last_target_update_ts": 99840, "num_target_updates": 191}, "sampler_results": {"episode_reward_max": 3.2471881663233364, "episode_reward_min": -19.99987849751792, "episode_reward_mean": -0.8144818330456235, "episode_len_mean": 25.01, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.00012446381269016305, 0.00011428559502249393, 0.0001239956437643809, 0.0001237480263554351, 0.0001235149505273117, 0.0001240756863929245, 0.0001139298943589331, 0.00012361042727565286, 0.00012336434446787246, 0.00012313271039720658, 0.0001242848931038308, 0.00011412162363100364, 0.00012381806667269922, -9.999876428818345, 0.00012333874662130923, 0.0001245315578696659, 0.00012419879848394355, 0.00012393905399930686, -9.999886194387841, 0.08938063988189432, 0.00012266096967338255, 0.00012238590054412053, 0.0001221420450203624, -9.9998780984995, 0.00012165363135876062, 0.00012269573113352444, 0.00012242050625405258, 0.00012217651293964455, 0.00012193574559185532, 0.40747655051529125, 0.00012286422046362856, 0.10195765043129516, 0.0001223896577134059, 0.00012213988888619943, 0.00012186175267744644, -9.999877466034064, 0.0001222894966459372, 0.00012204828424702298, 0.00012179990541096244, 0.00012152331366075683, 0.0001232849247903481, 0.00012300705331311958, 3.2471881663233364, -9.999877482466998, 0.0001222677879705757, 0.00012290410481041915, 1.990130186813828, 0.00012239043362436544, 0.00012214882328042556, 0.00012190003547557783, 0.05308460744892997, 0.0001228666341169977, 0.00012262086096302103, 0.00012237834093053014, 0.0001221286182445899, 0.0001232477260313042, -9.999876983446518, 0.00012278835448693097, 0.00012251271438983626, 0.00012226835373774068, 0.7085682238994752, 0.00012106132275811204, 0.10054079922885209, 0.00012049530075632856, 0.00012015029810485948, 0.00012141565735942102, 0.00012109773366476679, 0.00012080477471361015, 0.00012051828431883903, 0.09385924512236825, 0.00012154149159662473, 0.0001212463842763189, 0.24829983778574738, 0.00012061555715337134, 0.1055497878911857, 0.6139460915168113, 0.00012091226810159542, 0.0001206252682154687, 0.00012027952206001458, 0.00011997732378914677, 0.00012198906963829403, 0.00012166813989418082, 0.0001213724179942548, 0.00012108323201021137, 0.00012073485962567454, 0.00012162298930560733, 0.00012130398032479935, 0.0658241758229028, 0.5061528371504127, 0.00012039193945477718, 0.052000930474804065, 0.00012156255445834385, -9.999878731923799, 0.00012097865890160497, 0.07490438215512625, 0.00012202722465348768, 0.00012177893144029722, -19.99987849751792, 0.00012118405711916839, 0.08284397066864682], "episode_lengths": [25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 27, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.53861761408245, "mean_inference_ms": 2.105498986426271, "mean_action_processing_ms": 0.1441361685816138, "mean_env_wait_ms": 0.9763719269431143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009392976760864258, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.17429876327514648}}, "episode_reward_max": 3.2471881663233364, "episode_reward_min": -19.99987849751792, "episode_reward_mean": -0.8144818330456235, "episode_len_mean": 25.01, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.00012446381269016305, 0.00011428559502249393, 0.0001239956437643809, 0.0001237480263554351, 0.0001235149505273117, 0.0001240756863929245, 0.0001139298943589331, 0.00012361042727565286, 0.00012336434446787246, 0.00012313271039720658, 0.0001242848931038308, 0.00011412162363100364, 0.00012381806667269922, -9.999876428818345, 0.00012333874662130923, 0.0001245315578696659, 0.00012419879848394355, 0.00012393905399930686, -9.999886194387841, 0.08938063988189432, 0.00012266096967338255, 0.00012238590054412053, 0.0001221420450203624, -9.9998780984995, 0.00012165363135876062, 0.00012269573113352444, 0.00012242050625405258, 0.00012217651293964455, 0.00012193574559185532, 0.40747655051529125, 0.00012286422046362856, 0.10195765043129516, 0.0001223896577134059, 0.00012213988888619943, 0.00012186175267744644, -9.999877466034064, 0.0001222894966459372, 0.00012204828424702298, 0.00012179990541096244, 0.00012152331366075683, 0.0001232849247903481, 0.00012300705331311958, 3.2471881663233364, -9.999877482466998, 0.0001222677879705757, 0.00012290410481041915, 1.990130186813828, 0.00012239043362436544, 0.00012214882328042556, 0.00012190003547557783, 0.05308460744892997, 0.0001228666341169977, 0.00012262086096302103, 0.00012237834093053014, 0.0001221286182445899, 0.0001232477260313042, -9.999876983446518, 0.00012278835448693097, 0.00012251271438983626, 0.00012226835373774068, 0.7085682238994752, 0.00012106132275811204, 0.10054079922885209, 0.00012049530075632856, 0.00012015029810485948, 0.00012141565735942102, 0.00012109773366476679, 0.00012080477471361015, 0.00012051828431883903, 0.09385924512236825, 0.00012154149159662473, 0.0001212463842763189, 0.24829983778574738, 0.00012061555715337134, 0.1055497878911857, 0.6139460915168113, 0.00012091226810159542, 0.0001206252682154687, 0.00012027952206001458, 0.00011997732378914677, 0.00012198906963829403, 0.00012166813989418082, 0.0001213724179942548, 0.00012108323201021137, 0.00012073485962567454, 0.00012162298930560733, 0.00012130398032479935, 0.0658241758229028, 0.5061528371504127, 0.00012039193945477718, 0.052000930474804065, 0.00012156255445834385, -9.999878731923799, 0.00012097865890160497, 0.07490438215512625, 0.00012202722465348768, 0.00012177893144029722, -19.99987849751792, 0.00012118405711916839, 0.08284397066864682], "episode_lengths": [25, 23, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 26, 25, 25, 25, 25, 24, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 25, 25, 25, 25, 27, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 431.53861761408245, "mean_inference_ms": 2.105498986426271, "mean_action_processing_ms": 0.1441361685816138, "mean_env_wait_ms": 0.9763719269431143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009392976760864258, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.17429876327514648}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 193050, "num_env_steps_sampled": 100000, "num_env_steps_trained": 193050, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 1950, "num_env_steps_sampled_throughput_per_sec": 4.415988978355633, "num_env_steps_trained_throughput_per_sec": 8.611178507793484, "timesteps_total": 100000, "num_steps_trained_this_iter": 1950, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 9006.574, "sample_time_ms": 8943.97, "load_time_ms": 0.231, "load_throughput": 338040.62, "learn_time_ms": 12.844, "learn_throughput": 6073.059, "synch_weights_time_ms": 11.209}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 193050, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 193050, "last_target_update_ts": 99840, "num_target_updates": 191}, "done": true, "episodes_total": 3920, "training_iteration": 100, "trial_id": "2058a_00000", "date": "2024-04-17_11-48-27", "timestamp": 1713354507, "time_this_iter_s": 226.46099400520325, "time_total_s": 23279.176362514496, "pid": 683489, "hostname": "requantum", "node_ip": "172.26.129.123", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "QSimPyEnv", "env_config": {"obs_filter": "rescale_-1_1", "reward_filter": null, "dataset": "/home/ubuntu/qsimpy/qdataset/qce/expanded1000_2-27_synds_100_sub_60_qce.csv"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.01, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 78, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f66bf06eb00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "target_network_update_freq": 500, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": true, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 5, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 23279.176362514496, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 13.192569659442723, "ram_util_percent": 23.685139318885447}}
